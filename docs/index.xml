<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Vishal Bakshi&#39;s Blog</title>
<link>https://vishalbakshi.github.io/blog/</link>
<atom:link href="https://vishalbakshi.github.io/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>Machine Learning blog by Vishal Bakshi</description>
<generator>quarto-1.7.32</generator>
<lastBuildDate>Wed, 18 Jun 2025 07:00:00 GMT</lastBuildDate>
<item>
  <title>Takeaways from Gemini Deep Research Report on Small Batch Training Challenges</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensor</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.nn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CrossEntropyLoss</span></code></pre></div>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I’ve recently been training models on the fastai <a href="https://github.com/fastai/imagenette?tab=readme-ov-file">Imagenette dataset</a> to gain some intuition on what improves downstream performance (accuracy). <a href="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/">My latest experiment</a> was to train three models on different batch sizes and learning rates (for a fixed 5 epochs) to understand the relationship between the two.</p>
<p>I posted my initial musing (after I had analyzed results for batch sizes 32 to 2048) that lowering the batch size might continue to yield higher accuracy. Jeremy validated this approach:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
That’s a great question! Stable low bs training isn’t easy, but it’s a good plan :)
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1930486029607416069?ref_src=twsrc%5Etfw">June 5, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>I also prompted Allen AI’s <a href="https://paperfinder.allen.ai/chat/606ffc67-5539-47a9-8c8a-ec5820666ccc?profile=paper-finder-only">Paper Finder</a> with:</p>
<blockquote class="blockquote">
<p>strategies to make low batch size training more stable and improve accuracy for image recognition</p>
</blockquote>
<p>Imagenette is unlocking an entire new lane of research and experimentation for me, helping me towards my <a href="https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/">TinyScaleLab project goal</a> of training and analyzing high performant tiny language models.</p>
<p>In this blog post, I’ll walk through the Gemini Deep Research and Ai2 Paper Finder findings. The full Deep Research report is in <a href="https://docs.google.com/document/d/1AWoW4sOQ_iR_3pxsTRzYOT0cql60ux0Sjrt4rbLilZM/edit?usp=sharing">this Google Doc</a>.</p>
</section>
<section id="geminis-deep-research-report" class="level2">
<h2 class="anchored" data-anchor-id="geminis-deep-research-report">Gemini’s Deep Research Report</h2>
<p>Here was my initial prompt:</p>
<blockquote class="blockquote">
<p>I recently have been training xresnet18, xresnet34 and xse_resnext50 on the Imagenette dataset by fast.ai (which is a 10k subset of ImageNet with 10 easily classified classes). I have trained on batch sizes from 1 to 2048. Generally speaking, the highest accuracy achieved increases from a batch size of 1 to a batch size of 8, 16 or 32 (depending on the model/learning rate) and then decreases as batch size increases to 2048. This makes me want to explore small batch size training for this project. Jeremy Howard tweeted that “Stable low bs training isn’t easy, but it’s a good plan”. I want you to help me answer two questions in this chat:</p>
<ol type="1">
<li><p>Why is stable low batch size training difficult?</p></li>
<li><p>What techniques are there (either in literature/arxiv, blog posts or forums) to make low batch size training stable? I’m most interested in improving the accuracy of low batch size trainings.</p></li>
</ol>
</blockquote>
<p>I’ll paste the entire executive summary it generated, as its a good one (emphasis mine):</p>
<blockquote class="blockquote">
<p>Training deep learning models with small batch sizes presents a unique set of challenges, primarily stemming from high gradient variance during optimization and the inherent limitations of standard Batch Normalization with few samples. However, this training regime also offers the potential for <mark>improved model generalization</mark>. This report investigates the difficulties associated with stable low batch size training and explores techniques to mitigate these issues, with a particular focus on enhancing model accuracy. For architectures like xresnet, overcoming the instability of Batch Normalization with small batches is a critical first step, often addressed by substituting it with alternatives like <mark>Group Normalization</mark>. Stability and accuracy can be further improved through <mark>careful management of learning rates</mark>, including the use of adaptive schedulers and awareness of optimizer-specific phenomena such as the “surge” in optimal learning rates for Adam-family optimizers. <mark>The choice of optimizer itself</mark>, typically between SGD with momentum and adaptive methods like AdamW, also plays a significant role, alongside appropriate <mark>regularization strategies tailored to the small-batch context</mark>.</p>
</blockquote>
<p>The report starts by outlining why small batch sizes lead to unstable training. Gradient updates using a small batch size “may not accurately reflect the gradient of the true loss function that would be computed over the entire dataset” and “is an estimate derived from a very limited subset of the training data”.</p>
</section>
<section id="small-batch-sizes-the-double-edged-sword" class="level2">
<h2 class="anchored" data-anchor-id="small-batch-sizes-the-double-edged-sword">Small Batch Sizes: The Double Edged Sword</h2>
<p>On one hand, small batch size for a fixed number epochs provide more gradient updates and thus lower the loss. In the plot below (xresnet18) the ideal batch size (16-32) performs better than larger batch sizes. On the other hand, the larger number of updates will take longer and the GPU will be less utilized.</p>
<p><strong>xresnet18</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="data:image/png;base64,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" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="bs_vs_acc.png"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/data:image/png;base64,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" class="img-fluid figure-img" alt="bs_vs_acc.png"></a></p>
<figcaption>bs_vs_acc.png</figcaption>
</figure>
</div>
<blockquote class="twitter-tweet blockquote" data-dnt="true" align="center" data-conversation="none">
<p lang="en" dir="ltr">
We covered this in some of our earlier courses - lower batch sizes provide more updates, which should give better results for a fixed # epochs.
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1927192030335132090?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Additionally, as the Gemini report goes on to say:</p>
<blockquote class="blockquote">
<p>Small batches can lead to gradients that are “bigger and chaotic” because an incorrect prediction on a single data point within a tiny batch can result in a disproportionately large loss and, subsequently, a large gradient update compared to its effect in a larger batch…high gradient noise, stemming from the limited data used for each estimation, leads to more volatile and less precise parameter updates</p>
</blockquote>
<p>This was a good opportunity to do a quick refresher on cross entropy loss so I worked through <a href="https://github.com/fastai/fastbook/blob/master/05_pet_breeds.ipynb">Chapter 5 of fastbook</a> again and wrote up <a href="https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/">a blog post</a> and <a href="https://www.youtube.com/watch?v=swHhoP53jq4">video walkthrough</a> on that.</p>
<p>Suppose we have a batch size of two for a binary classification task:</p>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="90fce2ca-d659-41a1-9e29-457566223b40" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor([[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5</span>], [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]], requires_grad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-2">acts</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>tensor([[0.4000, 9.5000],
        [4.0000, 5.0000]], requires_grad=True)</code></pre>
</div>
</div>
<p>With the following targets—the first batch item target is the first class (index <code>0</code>), which has a very wrong small activation.</p>
<div id="cell-19" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span></code></pre></div>
</div>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="14e2581f-1023-4b2d-e27b-4abdfd25ab17" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CrossEntropyLoss()(acts, targ)</span>
<span id="cb5-2">loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>tensor(4.7067, grad_fn=&lt;NllLossBackward0&gt;)</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a9c7c33f-a43e-49d1-a45b-adb6bf7a6fca" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">loss.backward()</span>
<span id="cb7-2">acts.grad</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>tensor([[-0.4999,  0.4999],
        [ 0.1345, -0.1345]])</code></pre>
</div>
</div>
<p>Now suppose we had the same two items but in a batch size of 8.</p>
<div id="cell-23" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor(</span>
<span id="cb9-2">    [[ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4000</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">9.5000</span>], <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># same item as before</span></span>
<span id="cb9-3">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0000</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0000</span>], <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># same item as before</span></span>
<span id="cb9-4">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3367</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1288</span>],</span>
<span id="cb9-5">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2345</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2303</span>],</span>
<span id="cb9-6">     [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1229</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1863</span>],</span>
<span id="cb9-7">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.2082</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6380</span>],</span>
<span id="cb9-8">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4617</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2674</span>],</span>
<span id="cb9-9">     [ <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5349</span>,  <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8094</span>]], requires_grad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
</div>
<p>Adding 6 items to the targets.</p>
<div id="cell-25" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span></code></pre></div>
</div>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c1f16f85-df02-4d87-f5c2-2ca579425447" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> CrossEntropyLoss()(acts, targ)</span>
<span id="cb11-2">loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>tensor(1.5563, grad_fn=&lt;NllLossBackward0&gt;)</code></pre>
</div>
</div>
<p>Note that the loss is smaller.</p>
<div id="cell-28" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="01eb068c-1918-4dad-c0f4-594b01c14ee5" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">loss.backward()</span>
<span id="cb13-2">acts.grad</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>tensor([[-0.1250,  0.1250],
        [ 0.0336, -0.0336],
        [-0.0560,  0.0560],
        [ 0.0626, -0.0626],
        [ 0.0352, -0.0352],
        [-0.0069,  0.0069],
        [ 0.0686, -0.0686],
        [ 0.0540, -0.0540]])</code></pre>
</div>
</div>
<p>The loss and gradients are much smaller. The impact of the one confidently wrong prediction has decreased with larger batch size.</p>
<p>There are also two other factors at play, as the Gemini report states:</p>
<blockquote class="blockquote">
<p>On one hand, the noisy gradients can cause the optimization process to oscillate significantly around an optimal solution, making it challenging for the model to settle into a good minimum and potentially slowing down overall convergence</p>
</blockquote>
<blockquote class="blockquote">
<p>On the other hand, this very noise and the resultant exploratory behavior can be beneficial. The stochasticity introduced by small batches can act as a form of implicit regularization, helping the model to escape sharp, narrow local minima in the loss landscape and instead find flatter, broader minima</p>
</blockquote>
<p>The push and pull between the pros (faster updates, implicit regularization) and cons (longer training time, GPU underutilization, oscillating around minima, chaotic gradients/high gradient noise) makes small batch training a fascinating topic. The very characteristics that provide benefit to the training process also damage it.</p>
</section>
<section id="small-batch-size-and-batch-normalization" class="level2">
<h2 class="anchored" data-anchor-id="small-batch-size-and-batch-normalization">Small Batch Size and Batch Normalization</h2>
<p>In addition to making the gradient noisy, small batch sizes make Batch Normalization statistics noisy.</p>
<blockquote class="blockquote">
<p>BN standardizes the activations within a network by calculating mean and variance statistics per batch. When batch sizes are very small (e.g., 1, 2, or 4 samples), these batch-wise statistics become extremely noisy and unreliable estimators of the true population statistics across the entire dataset</p>
</blockquote>
<p>From the <a href="https://arxiv.org/abs/1803.08494">Group Normalization paper</a> (for which I have done a <a href="https://www.youtube.com/watch?v=ZCTcxNEGens">video walkthrough</a>):</p>
<blockquote class="blockquote">
<p>normalizing along the batch dimension introduces problems — BN’s error increases rapidly when the batch size becomes smaller, caused by inaccurate batch statistics estimation.</p>
</blockquote>
<p>The three models I’m using all have a considerable number of Batch Normalization layers.</p>
<div id="cell-37" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.vision.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span></code></pre></div>
</div>
<div id="cell-38" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="bbe244fe-90e6-455f-fdb1-f14334b8c350" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb16-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> module <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> xresnet18().modules():</span>
<span id="cb16-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(module, nn.BatchNorm2d): bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb16-4">bn_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>22</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="9b07f053-6422-4605-ea78-61677ea481f9" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb18-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> module <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> xresnet34().modules():</span>
<span id="cb18-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(module, nn.BatchNorm2d): bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb18-4">bn_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>38</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="176953d5-7ca7-4866-bd9c-695e5105e9a5" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb20-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> module <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> xse_resnext50().modules():</span>
<span id="cb20-3">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(module, nn.BatchNorm2d): bn_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb20-4">bn_count</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>55</code></pre>
</div>
</div>
</section>
<section id="techniques-for-stable-and-accurate-low-batch-size-training" class="level2">
<h2 class="anchored" data-anchor-id="techniques-for-stable-and-accurate-low-batch-size-training">Techniques for Stable and Accurate Low Batch Size Training</h2>
<p>The fascinating complexity of stable small batch training is summarized in the report with the following:</p>
<blockquote class="blockquote">
<p>Addressing the challenges of small batch training requires a multi-pronged approach, focusing on adapting learning rate strategies, rethinking normalization layers, selecting appropriate optimizers, and employing advanced gradient management and regularization techniques.</p>
</blockquote>
<section id="learning-rate" class="level3">
<h3 class="anchored" data-anchor-id="learning-rate">Learning Rate</h3>
<blockquote class="blockquote">
<p>for small batches, the high gradient noise often necessitates smaller learning rates to prevent divergence and ensure stability</p>
</blockquote>
<p>We can see that there’s evidence for that from my <a href="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/">Imagenette experiments</a>. For the xresnet18, xresnet34 and xse_resnext50 models (top to bottom charts, respectively), 1e-3 yields higher accuracy for lower batch sizes than 1e-2.</p>
<p><strong>xresnet18</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="data:image/png;base64,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" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="image.png"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/data:image/png;base64,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" class="img-fluid figure-img" alt="image.png"></a></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<p><strong>xresnet34</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAiMAAAG1CAYAAAAr/fRyAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAACI6ADAAQAAAABAAABtQAAAAAocikxAABAAElEQVR4AexdB3xUVfb+0nvvPUCoUqWJglhQFHtBFBXF3l3R/a9YcNfG7qrYwIYFu6BrL1gQFKVK7xDSe+99kv85d/KSSTJJJnVKzv39htfue+/e7w2Z753yHbsGapAmCAgCgoAgIAgIAoKAmRCwN9N95baCgCAgCAgCgoAgIAgoBISMyBdBEBAEBAFBQBAQBMyKgJARs8IvNxcEBAFBQBAQBAQBISPyHRAEBAFBQBAQBAQBsyIgZMSs8MvNBQFBQBAQBAQBQUDIiHwHBAFBQBAQBAQBQcCsCAgZMSv8cnNBQBAQBAQBQUAQEDIi3wFBQBAQBAQBQUAQMCsCjma9u4k3r6+vR0ZGBry8vGBnZ2fiWdJNEBAEBAFBQBAQBMyJAOuqlpaWIjw8HPb27ds/rIKMMBGJiooyJ55yb0FAEBAEBAFBQBDoJgKpqamIjIxs92yrICNsEeHGk/H29m53MnJAEBAEBAFBQBAQBCwHgZKSEmVM0H7H2xuZVZARzTXDRETISHuPUvYLAoKAICAICAKWiYD2O97e6Np34LR3huwXBAQBQUAQEAQEAUGgFxEQMtKLYMqlBAFBQBAQBAQBQaDrCAgZ6TpmcoYgIAgIAoKAICAI9CICQkZ6EUy5lCAgCAgCgoAgIAh0HQEhI13HTM4QBAQBQUAQEAQEgV5EQMhIL4IplxIEBAFBQBAQBASBriMgZKTrmMkZgoAgIAgIAoKAINCLCAgZ6UUw5VKCgCAgCAgCgoAg0HUEhIx0HTM5QxAQBAQBQUAQEAR6EQEhI70IplxKEBAEBAFBQBAQBLqOQLfIyIoVKxAbGwtXV1dMnToV27Zt6/DOL7zwAoYPHw43NzelUX/fffehqqqqw3PkoCAgCAgCgoAgIAgMDAS6TEZWr16NRYsW4bHHHsPOnTsxbtw4zJ49Gzk5OUYR++ijj/Dggw+q/ocOHcJbb70FvsZDDz1ktL/sFAQEAUFAEBAEBIGBhYBdA7WuTJktIZMnT8by5cvVafX19cracffddyvS0fpad911F5iErFu3runQ/fffj61bt+KPP/5o2tfRClf98/HxQXFxsRTK6wgoOWZxCNTXN6Cmsk59qnlZUQe1pPVqbZ2XVfpj/N/RN9gdvqHu8Av1gF+IO1w9nSxuXjIgQUAQEARMQcDU3+8uVe2tqanBjh07sHjx4qYx2NvbY9asWdi8eXPTPsOVk08+GR988IFy5UyZMgUJCQn4/vvvce211xp2a7FeXV0N/miNJyNNEDAHArq6+mYioREIIg81RB6YTDDRaFqq9drm/qqfrsfDZjLix+SEiIlvCBEUWmey4h3gCnuHLhs3ezweuYAgIAgIAr2NQJfISF5eHnQ6HUJCQlqMg7cPHz7cYp+2MX/+fPB506dPB7/11dXV4bbbbuvQTbN06VL861//0i4hS0GgRwjU6+pRVlSNiuIavVWCLRFEHDQiYbheU1nbglzU1dT36N7ayY5O9nB2d4SLmyOc6ePSap33Obs50Jgqaaz1KM6uRGF2BcoKqlFVVovM+GL10a7HS3tHO/gEsQWlkaiopYciKnwfaYKAICAIWAsCff4Xa8OGDXj66afxyiuvqGDX+Ph43HvvvXjiiSfw6KOPGsWJLS8cl6I1toxERUVpm7IUBFogUFutQ2lBlf6TX0U/4I3rvKTtciIiXXNGtri82nBydVBEgkmEIhNMHhShcFIkwsXNSRGMlsea+zoQGWndKkqIYBw7gqz4I0g4wMujREYqVDcXdw+4eHjA08sDDk5usLNzoTk4o67WiawyjkSY7KGrdkZehSvyU10AOm5n56qWgCM8fF30lpRGV49y+5BlxcvfFXb2dq2HItuCgCAgCJgVgS6RkcDAQDg4OCA7O7vFoHk7NDS0xT5tgwkHu2RuuukmtWvMmDEoLy/HLbfcgocffhjs5mndXFxcwB9pggBb09gyYEg2eJ0tBmofkY2q8tpOgWIrgoc3fa88WlsnGsmEOy/1FguNUGjEg7fte/gDXldbi9ykBLJuHFEEhJfF2Vntjru6opwIR3m7xzs+4IDqYhcUprQkKXb27NZxhZu3Fzz9vOEd6ENWFD8EhAcgIDIAnv4+RKjcaa4OHV9ejgoCgoAg0MsIdImMODs7Y+LEiSoY9eKLL1ZD4QBWDk7lQFVjraKiog3hYELDrYuxs8YuL/usHAHNhaKsGUQsSjWSoQiH3sJhiquECYOXv4t68+e3f0+Kp+Cl+tC6u5dzv1kE+HtdkpuNDLZ60IetHzlJx6EjF2Xr5h8RhbC44Qgbqv/4hYWjltLeq8rLUE2kXb8soyWRE9qntpmolNE6L1v0K6f/U+xWojiVhgpa11tZDCPUOYKllnaXEA/KaD2Yxm0HR1c4ubory4y7tzfcfTzh6uGltl09POFELwr8/76h8aPW6b683bxfR9sNBtstjzX3a9xv5Hytj7ZseX3tenwfbb15DHZ2dmqcjs4uaunk4gpHGjcvefyOjUu1zn1IpsCpcak/R9+vTV86V8haO18c2S0I9ACBLpERvg+7T6677jpMmjQJHJDKGiJs6Vi4cKEaxoIFCxAREQGO++B2wQUXYNmyZZgwYUKTm4atJbxfIyWqo/xjkwj0lgvF3ce5mVwwyWgkG56N6+aMkWALRlb8sUarx2FaHkUluWBaNzcvbz3pIPIRSuQjdMhQ+pH3bN1N/WC6+/i22d/ZDiZBHHNSXUFEhcgKj0sjNUxaKmlfWUExua6KKX6mVG3XVJajroaIi44DxvUWJl1dFXRlRIjKCsh609ldB95xBycn9YyayI0iMURwFPHRSIxGfvQESB1zpXXq49hIfPgZB0bHCLkZeF8hmbERBLpMRubNm4fc3FwsWbIEWVlZGD9+PNauXdsU1JqSktLCEvLII4+QL9sOvExPT0dQUJAiIk899ZSR4cgua0SAA0DTDxeiJL9SuU6640Lx9Gu2Ynj5kYXDkGzQMWMxF+bAqr5eRzEaKU2uFrZ65KenspmvxXDsHRwRPGhws9WDCIhPSKj6v9CiYy9u8P8zdrPwxzswuEtXZldYXnoJ8lLzaD75KMyk55lbRMG0JWR5IIHCBoq70ZaKtNjTfZzg4eNK8SlkifJzg7OrE1mf7NWH3a+8ri316w5tjne1j70dX1d/nZbX1t9Pux4TszrK/qutrqJPtVrWNS7129V0nPaTFUpb1vI29df343WDbTqmPWMdudz4g7LSLmFsrDPHBkWOGo2oUWMRdcIYBEXHKoyM9ZV9goAtI9BlnRFzgGFqnrI5xjbQ75l+tBA/vXVAZaq0h4UluVDaG2N7+8sKC4h46K0dvMw+Hq9+sFr39wkOQSi7WxpdLsGxg+lN2bl1N6vb5tTmkjzK7MmqQBFl9xRmlSM3pZQIS9t4Fp9gN0QM9UX4MD+E05JdZLbSFLmpJXLTRF6ayUxLEtOa/BiQmkbyw/3r6DrFuTlNAcsaTq5kPYticnLCWETTh914TDKlCQLWioCpv99CRqz1CZt53BwPsGNtMrZ9k6BeGPmHJ2SQd1OMhnKfWIALpSsw8Y9ETsJxA/JxhFwauW0u4UxlDUKHDGuK8+B1D1+/Nv1seQdbUjLii5BxtAjpxwqRl1ZGloOWM/YOdFWkJHyoHyKGETkha5f8sDZjVE8yCTmJx5FyYC9SD+5D+qEDbYguu3I0YsKWE9/QcMGwGUJZswIEhIxYwUOy1iFWlNTgl3cOIPVQoZrCiJNCcepVw8mPbj1ZGPymW5iZodJqVaApZbfkJieCfyAMmx25BQKjolWMh2b18I+IFD+/IUi0Xl2h10JJP8YEpRC5qWUqgNWwmye538KJlEQQOWHLCVtShJw0I8QBzlnHjyGVyQl9Mo4colTumuYOtObpH2BATsYShi01n1p0lg1BwAIQEDJiAQ/BFodg6JZhIS8mISNPDrP4qbLVI+3g/iarB2e5cHBn68YWDs5sYZdLOC1DKMjU2dWtdTfZ7gQBVqjNPF6sLCcZZDnJSSqlzJqWphMOSjZ067B4m5CTZmA5HZxdg3pysk+tt87I8g4KUbEm7NJhC4pXQGDzBWRNELAABISMWMBDsKUh8A/JzrVJ5JZJVG4ZvzAPzL75BNKoaJsNYmnzTti1Hb+8+QpK81q6XBydnBE8OI7iPJpdLl4BQfKD2AcPkLOqshKInJDlhAltdlIJ6utakhM3L6cWbh1/+o6JQFvzw+Dg2oyjenLCrp1ssqK0tuRxargWDMvkZKC5D5vRkjVLQUDIiKU8CRsYRxu3zDRyy1xp+W6Z8qJCrH93JY5s+l09BQ8/f8SMHqdcLuFDR1BaZSwcHLucUGYDT9T8U6ir0SE7sYTiTcitQ5aTrIQSylBpKb3PAnXhcRQQSy6dCAqKDYj0JPeYBHNqT6+mqpKy2A42uXWyKd5JrzOj9QBhFq0sJ0xMokaNAaeXSxME+hMBISP9ibYN3yv9CGXLvK3PlnF0tsdMcsuMmGbZbhmOB9m/4Wf8/v7byhXDcR8nnncRTpl7tRK3suHHZbVTYyKSnVzS5NbJJHJSR9YUw8ZZWWFxPnpyQnEnQdFETqRQYBNErCuTdmi/IicpB/apGCgtHVnrFBQzSLlzmJxEjjzBqM6N1leWgkBvICBkpDdQHMDXMOaWOefm0fAP97BoVAoz0/HzG8tVdgIPNDh2CM6+9W6EkDtGmvUgoKPihrnJpcqtw66dTMrcqalqSU44YDpsCJETCorljJ3gGC+ydLUtL2E9s+7dkVaWlqg4KZWtQ26d/LSUFjdgks5aOExMOOYkYsQoKong3qKPbAgCPUVAyEhPERzA57Nb5meyhqSRkBm3ERSgeuq8YRadLaOrq8Vf33yBzf/7WAlSseLlKVdcjRPnXERvz9aT5TOAv3YdTp3LBnD6sD7mRE9Oqqn6smHjgOpQJifk1gkj904AEWc3KgMgTY8Auy05hVgLiGXibthYMI5VgfXkZBzCh49QSrOGfWRdEOgqAkJGuoqY9FcIpJFb5mcWMSNCYi1uGVZB/en1l0g9NFnNIWbsBJx1852U9mi8eKM8autHgHVu8jPKKBiWY070H9Y+ad1cPZ3AgbAccM3ZOrzOH87kGeiZO6UFeUgjdw67dFIP7EFxTkvtf1YRZlcOE/rBJ04e8Hi1/m7JtmkICBkxDSfp1YgAu2V2/JCE7d82Z8tYulumprICf3zyPnb9+K2S6ubgvNOvuxkjpp8mfzgH2DebyUkBqcOyCBuTkxyKPymhwouthdg0WDj+xD/MXZEUjazwkrVQBipJKSFFWM2lk0oExVDwj2Xqp1xyBYaddIpo7GhfIlmahICQEZNgkk6MgDW6ZY7v2Ipf3noVZfl56iGOOvUMzLz2Rrh7+8hDFQQUArWUsVNEMvYFmeUkcFeuX9J2cQ5XNDYOEsehaBYUtqZoRMWb1WMHUCYPB4EXZWVg77ofsefnH0gGv1IBxqnDky+8HKNOPZ3ic5yMgyh7BQEDBISMGIAhq+0j0MYtM5+yZU6y3GwZrhWzftUbOLrlDzUpLj531k13IWbs+PYnKUcEAQMEOHOniAgJk5RmokIkhWrvtBZm007jeBTfRjePIimh7Ppxh0+Qm81n9FSWlWL32m+x84evqZKzvjigJ4mrTb7gUow542yJK9G+JLI0ioCQEaOwyE4NgdZuGc6SmX2T5WbLNNTXY9/6n/D7B++Q9Hi5qmw6if4YTrvsSvljqD1UWfYIAc7gKcmtbEFQmKywdYULBhpr9o528A3Wx6I0W1Lc1T5by+xhXZO9v6zFX99+gXJ6KeDGrtGJ512McWfPkTRhY18Q2QchI/IlaBeB1m4ZlnOfcSVlyzhbZtZJfnoqflm5Qmko8KRCBg9V6bpcGVeaINDXCDBxV5WLmywpja4filGpqzFOUtil40u1dwwJCrt8fEPc4ehkmf/PTMWxrqYGB35bh+1ff9YU9MopweNnn4eJFOzKxf2kCQIaAkJGNCRk2QIBa3LLcLrutq8+w9bPV9ObaZ2ygJwy71pMOPd8CaJr8VRlwxwIcNBsaUFVoyWFCAqRE45N4U9rTRRtfHYkIOsdqCcpgaQoGzGcaiEN9oEDuYGsrbEUPasbb/3y0yYNE06pH3Pm2Zh0/qU0zyBrm5KMtw8QEDLSB6Ba8yWNumVYxIze1iyxpVPF0p/feLnpj9yg8RMx66Y74R0UbInDlTEJAk0IcPBneVFNU9CsRlIKMsrJxdhSG4VP4ngU1kaJHOFPqbR+CIzwtKpgWXahHt+xDVu/WK2qDvOcOC2Yg1w52NU/PIJ3SRugCAgZGaAP3ti0y4urScTsIFjandvIU8gtwyJmFuiW4XiQjR+/RxH836t0XTb5crru8JNPHbApl8aeqeyzPgSYpFSW1uoDZ4mY5FCxwNTDBagormkxGdZGiRzhh6iRRE5o6R1gHVWjeX4p+/aQpWSNElZTkyJT0LCTpmPqxXNJDVncqi0e9ADZEDIyQB50Z9NMoz92PxERqWwUMTuNsmWGW2i2zLHtm/Erp+s2BseNPv0snHrNDXDz9OpsmnJcELBKBPgHnINk0w4VkuJxgRJx4wrHho0zdiKJmEQRMWG3jquH5afUZhw9pNw3CWQx0RoLp025+Aqaw0htlywHAAJCRgbAQ+5oiuyW+et7EjH7LlEJP6lsGQt1y5QV5GPd268hnsgIN9/QMFJQvRvRo8d2NEU5JgjYHAKc0cPVjNMOFahyDFm0zrEpTY1iToKjvZrICcvfW3JAbG5yoor7OrJpY1NF4chRo8lScgWl408Qa2fTg7XdFSEjtvtsO52Ztbhl2Ne8d91a/P7hKrCaKteQmXzhZZh66TxyIbl0Ok/pIAjYOgI1lXVIJ0VZJiepVCuKg2MNG8ebhKl4E3LrUMwJB8Vaojgb18HZ/vX/KAvnV9Tr9HEznBU39ZK5iJt0kkrVN5yXrNsOAkJGbOdZdmkmLdwypCap3DJTLa9GC1cQ/Ymq62YcOajmFxo3DGffcje4xLk0QUAQMI5AeVG1cuekklvHaLwJuXA4zkSLOeHMHUtqpaSYzDolrFdSV1OthuYfEaViSjguzMHR0ZKGK2PpBQSEjPQCiNZ0CeWWIZfMdnLNcD0Odsucc8tokra2rGyZulpK16UAt61ffKrekJxc3TD9ygWkUTBH0nWt6QsnYzU7AhxvUphZoUgJW064aGDreBNvijfhWBOVqcPxJhQcawmtoqQYu0jRdRcpu3LQOjfvoBBlGR192iwq0inVli3hOfXGGISM9AaKVnINvVvmAGXLFKkRj6JsmekWmC2Tdmg/pesuR0FGmhonB7SdeeMdokdgJd8zGaZlI8DxJjkUY8LuHLaQZieUtJS3p3iToCgvfZYOpRCHWUC8CROR3T99jx3ffUlB9sUKYA9fP0w8/xKMm3UOWExNmnUjIGTEup+fyaNnUy2n7apsGQt1y1SVl2Hjh6tUfAhPjNN1z1h4m6oAOlArpJr8gKWjINBNBGqq6lQVY/4bkUYEhXVODBsLrTEh4RRi/pgz3qS2ugr71/9McSWfN1ULdvXwJIHDCzDhnAuU7Lzh2GXdehAQMmI9z6pbI2W3DGfKcMaMpbpl2Ix8bNsm/PrO6021LMacORunzl9I5mLPbs1bThIEBIHuIdAUb8KWE3LrlLfWN6F4E04djiKrCbt1OKW4vxurLh/64zdy5X5KLqh0dXsnF1eMPetcTKIaOJ7+Af09JLlfDxEQMtJDAC35dGtwy3Cg2rq3X8Xxv7YqKP3CInDWLXchatQYS4ZWxiYIDAgEVLwJFQBMbUwhTj9aiNqqlvom3oGuiB1D1XnPH9Tv2ib19TrEb9usYstyko6rZ8LBrSdQPAmruvpStW5p1oGAkBHreE5dHiX/8fj57QNKydHRAt0y/EdkD/mA//jkPUrXrVSy0FMuvlzpCkhQWpcft5wgCPQLAireJKm0MVOnZbyJh48zzrxuFL1I+PfLWAxvwqQpafcObPliTVPmnZ29PUacMhNTLrocgVExht1l3QIREDJigQ+lJ0Nq7ZYJiPDAbBIxs6RsmbyUJErXfRmZx46oqYYNG6HSdeUPRk+evJwrCPQ/AhxvwnEmm784jqLsCjWAMadHYtolQ8xWRoID4LkoH5MTrcVNPom0SuYhdMhQbZcsLQwBISMW9kB6Mpw2bpnp4ZhxxVBKf7OMUuRcUnwLVdblkuJcydPZzQ0zrroe48jPy28x0gQBQcA6Eait0WHz/+Kx7zd9/IZfqDtmLRyF4Bhvs00oOyFe1b85Rm4cknVV45h43kUkEXCdpASb7am0f2MhI+1jY1VHshKK8f2rey3WLVNZWoLPlz7WVK1zCKkpnnnDbfAKCLQqnGWwgoAg0D4CyQfy8et7h1RRP3t7OxVHcuLsaHLDmu9lIz8tVVUKPvTHBjVwtsDOufsBEU5s/zGa5YiQEbPA3vs3/eSJrchPL4clumXKiwrx2ZOPIC81Ga5e3jj75rswdOrJvQ+CXFEQEATMjkBVWS02fHgYx3flqrGEDvZWVhKfIPNqgSTs3I4fX3uRiFKRUnCdftV1mDjnIrHKmv0box+AkBELeRA9GUZZYRXeXbyJikkBC5+ZTtVrLUeVsCQvRxGRwswMePj5Y+4jTyIgMron0x0Q59aTS6u+pAS6klJaFkNXWgpdMYlTkYWJl3YuLvA+ZzacwsIGBB4ySetCgANKj27Nwu+fHEUNZd9wEP2MuUMxkoQWzakZxETkx9dfglYlmItsnnPHIrHQWsDXS8iIBTyEng7h0KYMMo0eRsggb1z+j0k9vVyvnV+YlYFPn3gYpXm5JOEcTETkKVVpt9duYMEX4uJ+9WVlejLRSCB0tNQIho4IRj0RDR0RDv0+Ihl8nIgGE4+GqqrOZ0dxNp6nngrfK66g5QzYSb2OzjGTHv2KQEl+JdatOoQMKuLHLXZsIE6/ZgTcvc33wsREad+6H7H+vZWoq66Gi4cHZt10J0ZQzRtp5kNAyIj5sO+1O//45n7E/5WDSXNiMfXCwb123Z5ciF0y7JphFw1rh1xOFhHvwKCeXLLfz62nP1S6YiINbJVoIg283rhPEYdmAtGCYNA5WtBcTwZu7+UFB29v2NOHlw7eXmq9NjkFFX/91XRpx5AQ+F52GXwvvwxO4eFN+2VFEDA3Apzht+eXVGz5+jjq6xpIJdUJp187EoOImJizFWSk44flzzbFsY2ccbqKY3Nxt6w6XebEqD/vLWSkP9Hug3vxf/S3/74R1eV1uPSBExEW59sHd+naJTmK/bOnl6CK3vSDomNx2cNPgOtI9Gfjtx+2Lig3B1sm2N1RxkSClu1tM+lQHz3BaCBXSU8bu1PsiUA4ePvAgYiFvQ8RCoqb0ROMxv2NBENPNpqJhz29sdk5tJ8JVZ2QiKJPP0XxF19AV6R/82RfnQdZSfzYWjJzplhLevoA5fxeQyAvrQy/vHNAxbbxRUdRtt8pl8fB2dV8FXh1dXUqw28rZfk1NNTDi16Y5tx5PyJHje61ecuFTENAyIhpOFlsr+ykEnz277/oP7QDbnhuBhzMGLXOIKUfPojP//1PEjKrQGjcMFy6+F8Uw+LVZfyUm6O8XG+VIIKgXBm8ZLLA7g12afCSCIZattkmywT9oelxox/3ZuuEEVJB5EJ/nMiGEVJhT2SkrxvHl5T+/DMRk89QsWVL0+0cg4Lgc9mlZC2ZC+fIiKb9siIImAuBulodtn6diN2/pKjyFKzeetYNJyB0sI+5hqTum3H0EL5f/hyKs7PAhH7yhZfhlCuupkBXJ7OOayDdvE/JyIoVK/DMM88gKysL48aNw8svv4wpU6YYxfe0007Db7/91ubYnDlz8N1337XZb2yHqZMxdq617uOaM1u/TsDg8UE49zbzSqgn792NL599QvlhI0eOxiX/WNKimia/vZf+up7IRGO8hEYyKLaiBdloJB294eYAxVUoiwRbJdhCoawStE4ESZEH3vbyJELR6ALRttmSweSCauNYkwZKTVISij77DEWfk7WkoED/tWZrySmnUGzJXHidfjrsnOQPrLX+f7eVcacfKcQv7x5EWUG1CryfeG4s1ZSJNevLFL9ArX93pSrExzgHxw5RKcABkVG2ArtFz8PU3287MnvrVWNMnM7q1auxYMECvPbaa5g6dSpeeOEFfEom5SNHjiA4OLjNVQroD2eNgVk8Pz9fEZg333wT119/fZv+xnaYOhlj51rrvs+f3YHM+GLMnD8co08139vv8R1b8c2ypWCzZ+z4ibhw0WJw4Sqt1RUWIone0GvT9aJI2v5Ol/TDqdwXRApU3IQiFa0JBJMMIg70Ue4PXqptslp4uJs1er/T+fVRB3Yxlf76K4rWrEH5JhJ9amwOgYHwvZSsJXMvh3OU/JHVcJFl/yNQXVmHjZRtc4SybrgFRXuRlWSU2dWij23dhJ9WLlduZkcnZ5x6zUKMn33+gPw70p/fClN/v7tMRpiATJ48GcuXL1fzqafsgij643f33XfjwQcf7HSOTF6WLFmCzMxMeJDv3JRm6mRMuZY19Kmh/8xv3b8RHDdy7ZPTKEC0/6tnMk6HN/1OgWDPKVXVuMnTcN69/wdHg7fvhtpapNx4Eyq2bQMHWrpPmqS3UpB1ooW1QiMRHKipyISXSmE1ZyqgNXwPOhtjTUqKcuEUff45dETyteZx8skqE8frDLKWOJsvu0EbjywHJgLxO3KULkl1RR0cnOxx8qVxGHNahFl//MsKC/Djqy8gac9O9VD4BWv2bffCk+QJpPUNAqb+fneJjLCFw93dHZ+Rufjiiy9uGvl1112HIjLVf/XVV0372lsZM2YMpk2bhjfeeKO9LqimbAf+aI0nw4SnmDIgvOkHzdZbwu5c/PDaPlXC+5onpplluvvW/4SfXn9ZZY5wNPo5t/+N1BZbBl1mPf44Cj/6GPb0nYhd/Qlchg41y1gH+k2VtWT9Br215M8/m+BwCAgga8klFFtC1pIYKSjWBIys9BsCZYXV+PX9Q0g9qHctcrG9MxeMpMD3vo+5am+S7AzY/eO3+P2Dd1BXW6MXbKSK4kOniGBje5j1ZL+pZMS+KzfJy8uDjmqPhNBbsGHjbY4f6axtozfo/fv346abbuqw69KlS+Hj49P0YSIykBpX5uUWbYYqmXzfnT98jZ9ee0kRkbGzzsG5d9zXhogUrl6jiAg7hsOffVaICANnpsbWD+/ZZyP6rTcx5JefEXDbrXAIClTWkvyVb+L47HOQvHAhSr7/HhwUK00Q6C8EPP1ccMHd4zBj3jBlHWFS8vHjW8FWE3M1tshOOOcCXPPvFxAUO1i5bb5+7mlScX1JBeiba1wD/b5dIiM9Beutt94CW0baC3bVrr948WJlBWFLCH9SU1O1QwNiafgW0d8T3vrFGqxfpbdaTTz/EiUa1DrQs2L7dmQ98YQaWtC994LdAdIsAwHnyEgE/+1vGEpxJZHLX1bpwEwYKzZvQfqi+xE/8zRk//cZVCcmWsaAZRQ2jwD/+I+lir/zHp6s4kfYbfPjyv34mdKBOb7EXI0Vo69+6jlMvuhylWmzn6zB7/3jHnAGjrT+R6BLZCSQguQcyFSfnZ3dYqS8HRoa2mJf641ySuf85JNPcOONN7Y+1GbbhSWxyR1j+GnTyUZ3FOdWgj9cjCpiWP9peLDpcuNHq/DHJ+8pZKddPh8zr7mhjX+XA1XT7rlXpdd6zzkXAbfeYqNPwrqnxZk1XrNmIZrcoXFkLQm843Y4UoC5jgKOC95+GwnnzkHygutQ/O13Yi2x7kdtNaP3C/XAZf+YqEQciZ+QrHw2uPYWZ+CYq3GK76nzr8cVS55WWiScAvzJkn/gzzUfqqB9c41rIN63S2TEmczBEydOxLp165qw4gBW3uY4kI4aZ9xwHMg111zTUbcBf0xz0YQO8aH02f4RDWLtj1/feR3bvvpM4c8k5OS589sQkfqKCqTeeZf6QXMZNRJhTz3Vps+Af4AWCIBTRASC7rkHcb+uQ+QrK+B52mng1GgOPM544AHEnzoT2f/+D6oTEixw9DIkW0KA9ZJYTfrSv0+kUhJuKgX4yxd24c/PjkFXW2+2qUaNGoPrnlkOjo9jkbQt//sYnzz2fyjM7GKWoNlmYP037lIAK0+XU3s5YPX1119X7hbOjllDaYaHD1MNFYod4bTfCPrjx3Efhm3GjBlqP1tHutpMDYDp6nUtsf/3r+5F4p489R+WZeD7utXX6yg+5GUc+O0XZaqcdePtGHfWnDa3ZctJ+n2LULp2LTgwctCna0SevA1K1rOjlrLZiv73udIuqTOI9+KMKN95V8Dr7LPRH8Ju1oOYjLS3EaipqiMSEo+Df2SoS3Nl8lkLT0BgpGdv36pL1zv852/45a1XSP26nAoBuuD0627GmDNmy4tXl1Bs7mzq73eXyQjfgtN6NdGz8ePH46WXXlKaI3yMRc5iY2OxatUq3lSNNUhGjBiBn376CWeddZa22+SlqZMx+YIW2lGnq8fblNLL1TDnLp6E4Ji+zRzS1dWSOuEyHN28kf6j2VOVy79h1KlnGEUn79VXkfsiBbWS+T9m1TtwJwuZNOtHoIEC0ss2bqRMnE9RtmEDKJ9cTcqeAsh9L76IdEvmwiUuzvonKjOwWAQS9+ZhPWXcVJbWwt7RTr2IjZ8VrVzV5hp0CRUBXfvK80g9sFcNYcikqTj7lrvh7mP+shzmwqS79zX197tbZKS7g+rueaZOprvXt5TzMuKL8MWzO+Hq4YSFz0zv0/+MdZRV8c3zS5GwcztlyjjifNIQGTrVeGpbKbnh0sg9wy30icfhRz9Q0mwPgVqykLBmCSu91mVkNk3Q7cQTlcqr9znnwN61WfCuqYOsCAI9RKCipAbrPziMJCIm3MKH+uLM60fCO8A8Gks8BnZf7/juSxVHx6KPTERYk2TwiZP5sDQTETD191vIiImA9kc3ln9nGfihk4Jx9k2j++yWNVWV+OqZJ5Cyfy+JmDnjwgcexiAS/zHWqo4eRfKVV4HjRfyuvhqhjz5irJvssyEE2FpSTnolheR+LSP9EsrnV7NjpVyfCy9UxMR12DAbmrFMxRIQYFfwoT8zsfHTY1R6Qqfqcp165TAMmxpqVhdJTlICvn/5WeSnpSiY2I0989obWihRWwJ+ljoGISOW+mQ6GNenVBgvhwrknbFgBEaeHN5Bz+4fqiovUwXvMo8ehpOrm6ozw8FbxpqSep97BWrT0uBOyrvRb66U+ifGgLLhfbXZOap6MFcRNpT8Z5VXf9Iu8Zh+ill/KGwY+gE7teLcCqoCfBBZCSUKgyEnBuG0+SPg6ulkNkzYkvzHJ++SpUQv7OkXHok5d92P0CFDzTYma7mxkBFreVKN46wqr8VbD2xUFS+vW3oKyRP3vkJhBRWy+99TS4jwHCdXkCcufehfCIsbbhQpJfV+8y2qWqwTaVfEUsCqo1//pRobHZTsNBsCbLLmWjhFFMDOtXE0awmr7jIp8T7/PNiL9LzZno+t3bie4ud2/piC7d8mqrIY7j7OSrk1+oQAs06Vi4aufWUZWFaeFalPnns16ZRcRi51B7OOy5JvLmTEkp+OkbEd+ysbP715AP7hHrhqyVQjPXq2q6wgH58++QgK0lOV7/Pyh59AUMygdi+a9eRTKPzgAyX1HvPJxxCzfLtQDbgDNWnpKHz/PVUXh9133Fjx1f/qa+B35Tw4+EqQ34D7UvTRhHOSS5SVpDBL/z0bMzMC0y6Lg5Oz+X78K8tK8csby0kn5U816/Dho8hKsgg+wR1rbfURRBZ/WSEjFv+IWg6Q6zewv3TcrChMv7x3TX/FOdlERB4GC/p4BgRi7iNPEumJbDkAg61CMslnPbpE7YlcsRxeZ55pcFRWBQE9AjqqGcXVgwve/wB1jUKIdm5uqnqw/3UL4BwdLVAJAj1GoK5Gh01fHMe+9WnqWr4h7qoKcF9nG3Y0cI5vOfj7r6TP9BpJyFeSJpQbzlh4m8pGlAKgLZETMtISD4ve4i/2ew9tItNftarj0JumyIKMNGURKcvPg09IKBGRp4jBt6wtZAhOxY4dSL5+IUAVeQPvuRtBd9xheFjWBYE2CHChvpIffkD+O6tQTXpDqpGoGivABtywEG6U/i9NEOgpAikH8/Hru4dQXlyjMg0nnReLiefEkLvEvqeX7vb5xTlZSh4h48hBdY1hU0/BrJvvhJtX38oydHvAZjhRyIgZQO/uLQsyy/Hxv7bCwdEeNy2bAcdeMkHmJifis6ceRUVxEfwjopRFxNO/fZ9rbUYGEilglcvRe82ejYgXnpfgxO4+1AF4HpPqii1bkP/2Oygn7RKtuU2YAH8iJV5nnAG7VpWftT6yFARMQYBj63776EhTob2QQd4klDYKvsHuppzeJ31YOHL7V//Dpk8/RD1lnnn6+WM2FReNHTuhT+5nbRcVMmJFT2zPulT8QelsUSP9cOG9vfMFzow/gs+ffgycPRMcOwSXPfw43L192kWlnkyNSZS6W33wEFxIoC72ow9VvEi7J8gBQaADBDglvGDVuyj55htwMDQ3J3LbsPvG95JL5LvVAXZyqGMEmPQe3ZaN3z85Si6SOlJJdcD5d4xFxHDzBthnJ8TjO0oBLiRrNLcT51yEGVddRy+Xzh1PyMaPChmxogf8zct7kHIgHydfGocJZ/fcz552cD8+/8+/UEt6ImHDRuDSB/+psmfag4T/c2fcfz+VmP8BDv7+eql3kvSXJgj0FIHanBwUfvgRCqkMRD1V4ObmwOquV11JAa9XwzEoqKe3kPMHKAKlBVX4+e0DyIwvph98e+XiDh9qXkJSW12F3z54B3t++k49Fa4MPOfuB+iFcPAAfUqAkBErefRcHOrNRb+jjpZXPjoFARE9q8uQtHsHvnruadTVVCN69Fhc9PdHSTyoYxXDvNdeRy7VGIKjo17qneqTSBMEehMBzrop+vwLFLz7LmpTU9WlubKw94UXIOD668EpwtIEga4iUFerw/ev7kPqwQJlIbngrnFKvbWr1+nt/gm7tuPHV19ULnIH+rs6Y/5CTDzvot6+jVVcz1QyYr7IH6uAse8HmXG8SBERzqPntN6etGPbNuGL/z6hiAhLFl/yj392SkRKf11PNWdeVLcNfeQRcKE0aYJAbyNg7+4O/2uuxpC1PyDipRdVUCu7b4qpWF/CBRci5ZZbUL55M1VMbejtW8v1bBgBRycHzLltjHJxs2rrN8v3gMtqmLsNnjBZVQHmmjYsJb/hvZVIP6wPcjX32Cz1/kJGzPxkmNFzix7p36Ng0YMb11OtmX9TAFUdhp00HRfe/1Cnvsrq+Hhk/P3vJLTWoMzmrBEhTRDoSwQ4gNWbKgLHknZNzEcfwYsLZ9rZofz3jUhZeAMSL70MxV9/3RRn0pdjkWvbBgIc8D/n9rGIHOGnZOS/Jbd3pgUQEq5lc9EDj2DYtBkKaE2XxDZQ7/1ZCBnpfUy7dMWURjISNcq/S+cZdt77y1r8sGKZKux0wsxZOO/ev1NmjpNhlzbruqIipN5xJ+qpTLb7lCkIfeihNn1khyDQlwi4nzgBkS+/pKwlfvPngzVKqg8dQsb//QPxs85C/ptvgrVMpAkCnSGgCAkFsTIhqWULCROS4/oYpc7O7cvjrDky4pRT1S3it4vlryOshYx0hE4fHysvrqbiS2XqLlFkGelO++vbL/DzyuXKujF+9vlUVfKeTqWJG8hsmL5oEWpTUuBEgaoRL74gNWe6A76c0ysIOMfEIHTJoxi6/lcE/e1vcAgMVCJqOc8+h/jTTkf20n+3qIvTKzeVi9gcAqzKOkdl1fg2EpLdVN/G/ISEU3wdnV1QkptDpTgSbA733pqQkJHeQrIb10k7pHfRBEV7kUhO19K/2Le+6dOP8Nv7b6k7T7noclIAvBV2JDbVWcv+739VnRE78uNHvrJCas50Bpgc7xcEWEY+8LZbEffrOoQ99RQFtcapatEc9Bp/9mxFoCv37e+XschNrBMBJiTn3TEOEcOIkFSRheQlIiSJ5iUkTi6uiB03QQEav32LdQLbD6Pu/JerHwYxUG+R0khGuuqiYSLy2wdvY/NnHynopl+5gKK1rzcp5qSIAgYL33tfnRf+76VwHW68UN5AfSYyb/MjwAX3fC+7FIModiRq5Rtwn3aSKszHqedJc+ci+ZprqVjfeuWWNP9oZQSWhoAT6Y6cd6c+q6aGCcmLu5GdaF53X9zkaQomdtVIM46AkBHjuPT53ob6BpWOxjfi4FVTG1dPXffWK9hB7hlup19/C6ZecoVJp1fs2oWsf/5T9Q28804VSGjSidJJEDADAuxv95wxAzHvvINBX3yu0oA5/bzir7+QRmUKEs47n/RLVqO+qsoMo5NbWjICekIylqqS+4AJyddkIclOMh8hGTxxirJa56UkoSgr05KhM9vYhIyYCfq89DJUltaq3PjQIe0roxoOj6WG177yPPb8/IPKQDib4kNOPPdCwy7trtdmZSHt7ntUlgJnMATeKTVn2gVLDlgcAq4jRyKC3Itxv/yMgJtuhL2XF2oSExW5jj/9DOS+vBx1VMZAmiCgIeDs6ojzSXdEERJSav2aLCRcBdgczc3TC1GjRqtbi3XE+BMQMmIclz7fq6X0RpJvk2vSdNbqSJPh2xf+A07htaf0yPNI1W/M6Wd3dpo6zm+OaXfeBV1eHlzILcPuGVNiS0y6uHQSBPoRAafQUAQ/8ADi1q9HyOIH4RQeDl1hIfJWrACTkswlj6E6IbEfRyS3smQEmggJvfCxdDwTktyUUrMMWXPVHJO4EaP4d/4raPQ02dlTBJpTetsvXKfdgyWGv3r2SbCoGav5XbDoIUoXm6kd7nDJ8SWZDz+CqgMHwAGCkSuWw96jZ+JqHd5QDgoC/YCAg6cH1bm5DkN++hERy56D6+jR4OrBRWvWIGHOHKTedRfqiKRIEwQUIbl7HEIH+6C6og5fvbDLLIRkyCSKfaKWcZQqDxfJd7P1N1PISGtE+mGb8+AzSXmVW3Qn+iI1lRX4/N//BMu8O7q4KFXVOFL1M7WxVkPJd1QngUhMBCmtOkdGmnqq9BMELB4BO/peexP5iP10DWLefw+eVBmYW9kv61SgK7snpQkCTEguIELCVX7NRUi8A4MQMpjKHtAL4vEdW+WhtEJAyEgrQPpjM/1oIerrGuDl7wqf4I7rxvy8cgW48J2zmzsuf+gJxIwdb/IQSzdsQO6y51X/kIcWw2PqFJPPlY6CgDUhwMGu7pMnI4pS1Qd9+QUcQ0JQc/w4kudfjZqkJGuaioy1jxBwdiNCcs/4ZkLy4i7kpfWvyyZust46Iim+bR+ykJG2mPT5nlQtpfeEjiXgOXMmYed2NR6Wd48YMcrksVXTH+KMBxql3ufNg99VV5l8rnQUBKwZAdcRIxD70YdwiolGbUYGkigVuOrwYWuekoy9lxBwaSQkwbFkISknl83zu4mQ6IUne+kWHV5m6BR9im/Kvt1koanosO9AOyhkxAxPXAte7SylNz8thYKuKsCiOVGjxpg8Uh2Vak+l1Mf6sjK4TZqI0IcfMkmDxOQbSEdBwMIRYGXh2A8/hAsREw7cTr52ASp27rTwUcvw+gMBJiQX3jMOwTFeqCqvVTEk+ZTd2B/NPyIKfmERqnhe4u6/+uOWVnMPISP9/KhKC6pQmFXBtcFUHYWObp9xTP82Fxo3TGXQdNRXO6aXer8ftckpcAwPQyTFidiRiJQ0QWCgIeBIsvIx770LtxNPRH1pKVJuuBFlGzcONBhkvkYQcHF3woX3jtcTkrJafPn8LvQHIWF3orhqjDwQ2iVkxDgufbZXs4pwIBX/h+ioZRzVk5GwoaarpHI9j/I//1RFx6Io3dExoPNsnY7GIMcEAWtGwMHbG9FvvQkPEk9roBR3Lg5Z8v331jwlGXsvIcB/fzmGhMtxVBEh4Syb/Iy+t5BoKb6Ju7aDJRuk6REQMtLP34SupPRmNpKR8GEjTBpl0ZdfomDVKtU3fOnTYKEoaYLAQEfAnqoBR1FKu/eccwH6459+/wMoXL1moMMi8ycEXD30FpLAKE8lQvkVWUgKMsr7FJswsnR7+PmTC74SqQf29um9rOniQkb68WnVkwR82mF9cbzOUnqrKN6jICNNjS5saOdkpHI3FYR6dInqH3jH7fA+55x+nJncShCwbATYVRn+zDPwpWBuTq3Meuwx5K1cadmDltH1CwJMSC762wRohORLspAUZPYdIWHBSU2eIX6b1KrRHrKQEQ2JfliyFDHnuLu4OypfZUe3zIw/og77hobB3btjufja7Gyk3n23knr3nHUmAknwSZogIAi0RMCOlItD//kYAm6+WR3IfW4Zcp57jrhJQ8uOsjXgEFCE5N4JCIgkC0lJjYohKczqO0KiuWri/9qC+nrdgMPb2ISFjBhDpY/2afEikcP9KCC1Y+i1eJHwTqwiSur9rruhyyWp96FxJPX+H5F676PnJ5e1fgQ4gDD4/kUkKX+/mkz+yjfJSvJPNFDdJ2kDGwFXT7aQjEdARCMhWbaLkg36hpBEnTCGXko9UFFchMxjRwc28I2z7/gXUSDqVQQ0MhLVieoq3zSzMZMmbFj7cR9K6n3JElTt2wcHHx9EvvIKWCZbmiAgCHSMQMBNNyH08X+pgpMsIZ9O9W5YTl7awEbAzdMZF93HhISIQqOFpCi79/VAHBydMGjCJAW2FM7Tf+eEjPTT/71qKtKUlaivGNkZGWGxs8xjejdNR8GrBW+/g5KvvwHI/Bzx4gtwjorqp9nIbQQB60fA74orEPH8MsDJCaU/rEUqFZOsp6BCaQMbAUVIKIbEP5wtF+SyWbYTfUFImlw1FDcirkJJ7e23/3XphwvRQAGsviHu8A7oWALeUOwsMCrG6BjLfv9d+bv5YMhikno/SS8zbLSz7BQEBAGjCHCgdxRZFO0o46acNEhSbrwJuhLzlJk3OkDZaRYE3LzIQtJISMqZkFCWTVFO71pIBk2YCAciwkXZmchPTTbLPC3ppmIZ6aenkXIwX92pM6sId+pM7IxLpHN6IkU+wXfu5fC7en4/zUJuIwjYHgKeM6aTFslbsCdNkkpSaU1ecB3qSLVV2sBGwN1bT0j8wjyoym41ScfvQnFu7xESZ1c3xIzR1xo7tl2yaoSM9MP/NzbBafoinUnA83C04FVjYmf81pbGUu+kKMnKkqGPPipS7/3wDOUWto2A+4kTVNVfB1JtraY6NklXU4G9tHTbnrTMrlMEmJBcfN8E+IW6o6ywmlw2vUtImlw127d0OhZb7yBkpB+ecHFuJUrzqyiDxg7hw3w7vWN7Ymcc8c8WEa5C6hhGUu8vidR7p2BKB0HARARchw+nejYfgOvacDmFZCIk1fHxJp4t3WwVAWUhaUNIeie2aMikqfQyaY+cxOMoyc2xVQhNmle3yMgKkhmPjY2Fq6srpk6dim3btnV4s6KiItx5550Iox9QFxcXDBs2DN8PIElmLYsmbIgPnF0dO8Sqsqy0XbGznGXLlF/bjnCPXP4yuPaGNEFAEOg9BJxjYhBDFX+d44agjvR7kqnibyVlq0kb2Ah4+LhQls0EFfOnLCTP70RJXs8JCWtIhQ/XZ0yy5shAbl0mI6tXr8aiRYvwGCkY7iT/6rhx4zB79mzk5BhndTWULnfWWWchid7mP/vsMxw5cgQrSfkwgt4+BkrTXDSmxItkxetzzluLnRV//TUK3npbQRb+9FNwO+GEgQKfzFMQ6FcEnEJCyGXzPlzHjIGOXqRSrrse5Vu29usY5GaWhwATkosXNRKSAr3LpiS/54Rk6JRparIDXY21y2RkGb2d30wKhgsXLsSoUaPw2muvwd3dHW+/rf+hbP0V4v0FBQX4kuqmnHLKKcqiMnPmTEViWve1xW1dXT3SjxSqqUWP6rxonRYvYih2Vrl3LzIfeVRdI+DWW6nGxhxbhErmJAhYDAKOfn6IfucduFOWWn1FBVJvuQWl69ZZzPhkIOZBQBESspD4BLuBK7BzDElPCYlWxTft0AHSNik2z8Qs4K5dIiNs5dixYwdmzZrVNHR70tnn7c2bjUcDf01v9NOmTVNumhB64xg9ejSefvpp6DpQPKyurkYJBWoafppuaGUr2YnFqK3Wwc3LCYEkNdxZay12VksWpzRSWGVBJs/TT0fQvfd0dgk5LggIAr2AAAsIRr3+GrjEAv//S7vnXnAxSmkDGwEPX7KQ3HcifIKIkFAsIGfZMDHpbvMJDkVQzCDSGqlHws7t3b2M1Z/XJTKSR+luTCKYVBg23s7KyjLc1bSekJCg3DN8HseJPErZH89RPYgnn3yyqU/rlaVLl8KHFEW1T5QVi3mlHNAXxosc4U8y7Xatp9pi25jYWSbhVUeEhH3Y4c/8V6TeWyAmG4JA3yJgTzFukS+8AJ+LLwb98UPmg4tR8N77fXtTubrFI+Dpp3fZeBMhKcljC8nOHhGS5qwa4y/1Fg9ILwywS2SkO/erJy2M4OBgvPHGG5g4cSLmUdXMhx9+WLl32rveYhLxKi4ubvqkpqa219Xi96ceaqzSe4J/p2NtLXbGeiLlv/2uJKsjX3qJpN47t6x0ehPpIAgIAl1CwM7REWEUp+W34Fp1XjZZdnOXrxDVzC6haHudPf1cVdqvd6CrnpCQhaSssHsWEs1Vk7xnF2qruncNa0e4S2QkkLI3HEh6PJuizA0bb4eGhhrualrnDBrOnuHztDZy5EhlSWG3j7HGGTfeJEBk+DHWz9L3VZbVICelVA0zamTnZKS12FnhJx+rcz0pxsZl8GBLn66MTxCwWQS47DsrHQfec7eaY97y5ch+eimpKtfb7JxlYp0j4OVPhGTRiVCEhCQcOIaEs2262thN4xMcgrraGiTt2dnV022if5fIiLOzs7JurDMI5GLLB29zXIixxkGr8ZSrz/20dvToUZXmy9ez5ZZ2iAJXqTo5V4HkwKfOWlPw6rARKmiu+Au9f1oUVjtDTo4LAn2PAFf8DSLBwRCy7HIrpIybzMUPoaGuru9vLnewWASYkHDar1eAKym0EiGhtN+uEhL+bmnWkYGqxtolMsLfBk7r5dTcd999F4cOHcLtt9+O8vJylV3DxxcsWAB2s2iNj3M2zb333gsmId99950KYGXdEVtvXZGAZyw0sTNWXi0mnFhl1YniZTyI0EkTBAQBy0DA/9prEP7f/6gClcVffaUCW+sp6F7awEWA642xUisTk+KcSnz1wi4lId8VRLS4kYSd26AbgAS3y2SEYz6effZZLKHS9ePHj8fu3buxdu3apqDWlJQUZGZmNj0DDj798ccfsX37dowdOxb33HOPIiYPPvhgUx9bXGEJeE3sLHpU5y4aQ7Gz0LjhKPxI76Lxu/JKCVq1xS+IzMmqEfC58EJEvvwy7Mi6W/brr5T6eyt0ZeVWPScZfM8Q8A4kQkI6JJ7+LqrKLxfXKy82naSy+JkbiaBV08t92sH9PRuMFZ7dZTLCc7zrrruQnJwMTsHdunWrUmHV5r5hwwasWrVK21RLduFs2bIFVRSYc/z4cTz00EMtYkhadLaRjYKMcvoi1sDRyR5hcT6dzspQ7MyOAleryepkR7EzPpde0um50kEQEAT6HwGvM05HFFmJ7T2o1Dz9HUy5/nrUFeo1hfp/NHJHS0BAERJK++Vsm6LsCpX2ayohsbd3wJCJU9U04v/abAnT6dcxdIuM9OsIrfRmWhYN16JxdGoO3m1vOk3xIkNHNFlFWNyMxZekCQKCgGUi4DF1CqLp5cvB1xdV+/cr+fjadmQOLHMGMqreRoD1RziolQlJYZaekFSUGE/WaH3vJjVWKpw30IKjhYy0/jb00rbmojEli4ZvqYmdhUREoZTcXtz85s9XS/lHEBAEzoOn7QAAQABJREFULBcBtzGjEUMF9hwpo7CGLL/J86nib1KS5Q5YRtbnCOgJyQSwQBoTEnbZ1FR2HugcPXocnFzdUFaQj6yEY30+Tku6gZCRPngadTVUXfdYkbqyKfVoDMXOPBNS0FBbq+pi8B85aYKAIGD5CLgMGaIq/nKhvdqMDCRRgb2qw4ctf+Aywj5DwCfIXcWQePg4ozCzHH99n9TpvRwpBmnQ+ImqXzxZRwZSEzLSB087M74Yutp6xYr9wzw6vYOh2Bm++0H197vqqk7Pkw6CgCBgOQg4UfFPtpC4kI6SjtSqk69dgAoqJipt4CLgG+yO064ZoQDY82uqiiPpDI24AVo4T8hIZ9+Mbhw3TOnl/PHOmiZ2FhQQBB29VTmQFL73nHM7O02OCwKCgIUh4EjCkDHvroIbqU1zan7KDTeibONGCxulDKc/EYgdE4joEwJQr2vAH5927noZPGES7B0cUZCRhvz01P4cqlnvJWSkD+DXgldNSenl22vBq955eul4n8sug72rax+MTC4pCAgCfY2AA6lHR7+5Eh6nzkADZRCm3nEnSn7QWzz7+t5yfctEYPrcOCIYdkjen4+kfXkdDtLF3QPRo8eqPgPJVSNkpMOvRdcPlhdVE5slvQEyiERRcTxTmiZ25nEkXtWh8btynimnSR9BQBCwUATs3dwQRZLxysJJMWDpi+5H4Zo1FjpaGVZfI+AX6oGxZ0Sp27B1RFfXrEhu7N6aGuvxARQ3ImTE2DehB/s0q0hwtBdcPZ06vZKh2JlveRU8ZkyHc3R0p+dJB0FAELBsBFgQLfyZZ+DLLxckgpi15DHkv/mmZQ9aRtdnCEyeE0uiZs5KoZXjRzpqQyadpF5MM+OPUDXgji0pHV3Hmo4JGenlp5VyUO9qMSWLhm+ddeyIGoF7rQ4uunpI4GovPxC5nCBgRgTsqEBo6GOPIeCWW9Qocp59DjnPPScVf834TMx1a2c3R0y7eLC6PWfWdCSG5unnDy4Lwu349q1qaev/CBnpxSfcUE8S8If0ZCR6VIBJV85oJCN+pRXgaHzPU0816TzpJAgIAtaBAAexBy+6D8F/f0ANOH/lm8h67J9o0OmsYwIyyl5DYMRJYQiO8UJtlQ5bvjze4XXj2DpCLf6vgZHiK2Skw69D1w7mppaiqqyWRGscEDLY26STNbEz34oqZc7lNylpgoAgYHsIBNx4I0KfeBywt0cRxY+kP/AApMCe7T3njmZkZ2+HGVcOU10Ob85CdmJJu901NdbUA3vpd6Ws3X62ckDISC8+Sc0qEjncj2rvdA6tEjs7clCNwK+6Dr6URSNNEBAEbBcBv7lzEbFsGeDkhNIf1iJlwXWozcmx3QnLzNogEDrIB8NPClX7f199lGTfG9r04R1+YREIiIymlGAdEndtN9rHlnZ2/otpS7Pt47mkHGiMFxlpWhaNEjujYoMOFCsSccaZcPQ37bw+noZcXhAQBPoQAe9zZiP6jddhT3pClXv2IGnuFajcN/CqtPYhxBZ/6WmXDIGTiwNykkpwZGtWu+ONmzxNHTu23fYL5wkZafdr0LUDNVV1VEugWJ0UfYJppCJt907V37eiGgFSh6ZrgEtvQcCKEfCgSuaD1qyGM8nI12VnU4G9a1D87XdWPCMZelcQ8PBxwSTKruG2+Yvj4N8PY01z1STu3oHammpjXWxmn5CRXnqU6UeLlMKed6AruCaBKS15/S+qW6C7J1zHjTPlFOkjCAgCNoIA17GJXf0JPGfORANZSDMohiTnuWUS2Gojz7ezaYwj3REuqMcVfdurWxM8aAi8SJm7jr4fKft2d3ZJqz4uZKSXHl9TlV4Ts2g4XiQrJUndPfrU02CKbHwvDVUuIwgIAhaCgIOnJyJfWYGAm29WI8pfuRJpd94F3QAIWLSQR2C2YTg42WP63KHq/nvWGa9bw78LmgDasW227aoRMtJLX0UteNVUCfj8n39CmaMe/sHzpCheLz0GuYwgYHUIcAZd8P2LEP7ss7BzcUHZhg1ImnclapKTrW4uMuCuIRAzJoDq1vjr69Z8ZrxujUZGju/YpoJZu3YH6+ktZKQXnlVJXqWqxshpWxGUSWNKS1j9serm5ewKzxB9ZLUp50kfQUAQsE0EfM4/DzEffADHkBDUHD+OxCvmoXzTJtucrMxKIcCWD7aO2NNvR/K+fFW7pjU0kSNHk5q3F6pKS5DemH3Zuo8tbAsZ6YWnqFlFQklbxIVU9jprNWlpyEyIV93CGwsidXaOHBcEBAHbR8BtzGjEfroGbhRDVl9cjJSbb0HBe++LYqsNP3p93ZpINUNjdWvsyXI2ZOIUdTzehl01QkZ64UveJAFvYkpv0SefoMjdRd05kspFSxMEBAFBQEPAKTgY0e+9C5+LLwZIYyL76aeR+eijqK+p0brI0sYQmHTeILh5OSkL+971aW1mN2RysxprA9U5ssUmZKSHT7WeNELSDheqq5giAc+Ki4Wf/a+JjIQPG9HDEcjpgoAgYGsI2FPsSNjSpxH8j38oxdZi+puRcv1C1OUNjKJptvY8O5sPW9RPuniI6rb9u8Q2dWtix06Ao7MLSnJzSJskobPLWeVxISM9fGzZSaWoqayDi4cjgqjmQGet5IcfUFxVgToyvTm5uCIwKqazU+S4ICAIDEAEOJ4gYOH1iHr9Ndh7eaFy504kkkBa1UG9avMAhMSmpzxymkHdmq9aEg7+rYgdN0HNP367bdaqETLSw6936sF8dYWoEf4qCKmzyxV+/DEKG100oXHDwP5AaYKAICAItIeA54wZpEdCAmmDBqEuMxNJ868Gv9RIsy0EVN2aeY11azZlIpvUWQ2bpsYab6NqrEJGDJ92N9ab4kVGda66Wrn/AKr27EWRp14UTVw03QBcThEEBiACLoMHKYE0DyImDVVVSL9vEXJefJHqmtQPQDRsd8qhg6luzVR9duXGVnVrBlMQqx0VWcwjfaqirEybA0HISA8eaVV5raotwJeIMiF4tfDjj9TdSoL0xCVsqMSL9AB+OVUQGFAIOHh7I+q1V+F/ww1q3vmvvoa0u+8hgbTyAYWDrU+W69Y4Ut0aruh7ZFtz3Ro3Su+NGjVaTd8WrSNCRnrwzebAVQ5s9gt1h5e/a4dX0lGaXgnVnqihar4ldfqo+LChwzs8Rw4KAoKAIGCIAAukhfzf3xH276Wwc3ZG2bp1SL7qKtSkphp2k3UrRsDDl+rWnKuPJdz8ecu6NZqr5pgNxo0IGenBl1bTFzEli6bo8y9U/YnyYfqIad/QMLh7+/Tg7nKqICAIDFQEfCntN+b99+AYFITqY8eQdPlclG/ZOlDhsLl5jz8zGt6NdWt2/JDUNL8hk/QpvhlHD6G8SJ/F2XTQyleEjHTzAXKud4oWvNpJvAj7dQs/0SuuVo7Vm9nCxUXTTeTlNEFAEGAEWBgt9rNP4Tp6NNjymnLjjSj4SO8KFoSsGwHDujW7uW5NToWakHdgEEIGUz0b+v05vsO2yKeQkW5+Z4uyK1BWUA17RzuED/Xt8CrlmzajNjkF9lQUq8BeL1gTNmxkh+fIQUFAEBAEOkPAiaTjYz54H94XXKAXSHv8CWQ+9k80iEBaZ9BZ/PFYrltDL7r1dQ348zO9YjcPeuiUaWrstqbGKmSkm19JzUUTHudLeiEdp+cWNr6teJFpNSuxUQZexM66ibycJggIAoYI2Lu6Ivy//0HwA/eDyn+jiNKAU264EXUFBYbdZN3KEFB1a67Q161J2puH5AN6GQmtcF7K/j2ortBbTKxsakaHK2TEKCyd72xK6e0ki6Y2PV1V4VRXPGMmCaRVithZ5/BKD0FAEOgCAkog7aabEPnqK7D38EDFX3+pOJKqI0e6cBXpamkIcN2aMac31q1Zcwy6unr4R0TBLyyC1uuQuPsvSxtyt8cjZKQb0Olq66l6YqMEPJV/7qgVrl4DUMyI+0knIa+yTHUVsbOOEJNjgoAg0F0EvE47DbFrVsMpJhq1GRlIumo+Sn76qbuXk/MsAIHJ5zfXrdm3IY2MX3bQrCO2pMYqZKQbX7bMhGLU1dTDzdsZAeGe7V6BC1sVffaZOu43/ypkHD2s1kXsrF3I5IAgIAj0EAGXIUMwiFw1HidPQwOZ8dPvuRe5y1eIQFoPcTXX6S3q1nybiIqSGiIj+riRxF3bUVdba66h9ep9hYx0A87Ug3pfbDS5aFjCt71W+uNP0JHf1pGCzLzOOAOZjWRExM7aQ0z2CwKCQG8g4ODri6g33oD/dQvU5fKWL0f63+5DvQ3FGPQGTtZyDa5bExTthZoqHbZ8eRxhVErEw89fuf1TKXbEFpqQkW48RVNTerXAVd95VNyqqhIFGfrS0CJ21g3Q5RRBQBDoEgJ2jo4IWbwYYU89CTg5oZTcNVzXhuPYpFkXAoZ1aw5tzkRuahniJk1Vk7AVV42QkS5+J9lElkdfBG4dScBXHTqEyl27APqD4Hv55cg6pg8kE7GzLgIu3QUBQaBHCPhedhli3l0Fh4AAVB8+jEQSSOMAV2nWhUDYEB8MmxpCGiMA163RBNDi/9pCYYk665qMkdF2i4ysWLECsbGxcKWUsqlTp2Lbtm1GLq3ftWrVKhVww0E32ofPs9ampfQGRnmSgqpzu9Mo/PgTdczrrFlwCg5GxrHGeBERO2sXMzkgCAgCfYOA+4knYhALpI0aBV1hIZKvX4jCNRRcL82qEDj5kjhVtyYroQRVFSFwcafMqeIiZB47alXzMDbYLpOR1RQYtWjRIjz22GPYuXMnxpEK4OzZs5GTk2Ps+mqfNxV4yqTS19onOTm53b6WfkAjIyxG017TlZSg+Jtv1GH/+fPVUgteFbGz9lCT/YKAINCXCDiFhSHmww/gde45AKWFZi15DFkkktZgIwGQfYmdpVzbsG7Nlq+SEDNuohqaLRTO6zIZWbZsGW6++WYsXLgQo4hlv/baa3B3d8fbb7/d7vNii0hoaGjTJ4QCOq2xsQS8FrzakYum+Muv0EB6Ii5D4+A2aZIyoWXF6900kkljjU9exiwI2AYC9m5uiKC/4UF/u1dNiOPaUm66GXVkLZFmHQiMOzMK3oGuZBGhgqv2+lpnrMbKv0/W3LpERmooVXXHjh2YNWtW05zt7e3V9ubNm5v2tV4pKytDTEwMoqKicNFFF+HAgQOtu7TYrq6uRglZFww/LTqYaSM/vVylVTk62yNsiHEJeP5CFH6sr0PjS9U0mYgVpKWK2JmZnpncVhAQBFoiwH+TAm+7DZErlsOeXiQrtm5F0lwKsj9q/ab+ljO1zS1HJweccjnVp6GWesQTDo5OKMrORH6q9XoceC5dIiN5eXnQ6XRobdng7aysLL5emzZ8+HBlNfnqq6/wwQcfkJWgHieffDLS0vSZJW1OoB1Lly6Fj49P04dJjCU0LYsmYpgfuJCRsVaxZQtqEhPVf3KfCy9SXbR4ERE7M4aY7BMEBAFzIOB15pmIoQKeTpGRqKW/x8lXXoXSdevMMRS5ZxcRGDQuEFEUKtCgc4Krt946cmx7+waBLl7eLN2N/6L24lCmTZuGBQsWYPz48Zg5cyY+//xzBFHZ69dff73duyymdLRiqkKpfVJTU9vt258HTHHRFH6kt4r4XHwRHDw91PC0eBFx0fTn05J7CQKCQGcIuA4bhthP18CdEhFYgyTtzruQR653azf5dzZvaz/O1q3pc/V1a6qr9C/r1p7i2yUyEhgYCAcHB2RnZ7d4lrzNMSGmNCfKd58wYQLi45urELY+z8XFBRz0avhp3ae/t2trdMiML1a3jW5HAr6WrEOlv/6q+viRi0ZrInamISFLQUAQsDQEHP38EP3mSvg1BtvnvvAiMu6/H/UU9ybNchHwD6O6NadFkpWeLSN2yEk8jpLc9hNJLHcm+pF1iYw4Oztj4sSJWGdgymO3C2+zBcSUxm6effv2IYwiu62pZRwrUkWKPP1c4BvibnToRZwqR/NznzyZglf1Pr3KslIROzOKluwUBAQBS0HAjl4SQ5c8itB//UtpI5V8/wOSriaBNMqClGa5CEw+PxbuFNJg5xiuBmnNWTVdIiM8W07rXblyJd59910cImGv22+/HeXl5Sq7ho+zS4bdLFp7/PHH8RMp/yUkJKhU4GuuuQac2nsTVZi0pqa5aDill01krVsDBfcWrvlU7eY6NFoTsTMNCVkKAoKApSPgR2rRMe+8DQeyllQfPIRECmytPn7c0oc9YMfn4u6Eky4aQtaROIXBkS3WGzfSZTIyb948PPvss1iyZImKA9m9ezfWrl3bFNSakpKi9ES0b0chpYxxKvDIkSMxZ84clSGzadMmlRas9bGGZUpjPZqoUQFGh1v6yy/QUYCvQ1AgvAyyjbTg1XAROzOKm+wUBAQBy0KALbuxn34KF4on4b9pnPrLLmhplonAiJOpbk3MODW4jCMHKONTH05gmaNtf1RdJiN8qbvuuktZNzgFdyulhbEKq9Y2bNgAVl3V2vPPP9/UlzNuvvvuOxUzoh23hmVZYRUKM8vJIgJEjvAzOmQtcNWP3iTY5Kk1LXhVxM40RGQpCAgClo6Ac2QEot9dBedBg1BHrpoUsmTrioosfdgDcnz2VKz19GunwM4hiObfgD0//26VOHSLjFjlTHswaM0qEhzrDVePZqKhXbLqyFF9rQcK7uWieFrjegEidqahIUtBQBCwJgS0wFZHKmdRE38cqbffIUGtFvoAw+J8ERSrt47s+nGDVWZDCRkx4culScBzXrexVki5+tw4b9/JQF1WxM6MoSX7BAFBwFoQcIqIQBRl2thTdiMX/ky/bxEaSEpemuUhcOpV56pBVRbH4+CfKZY3wE5GJGSkE4Dq60kC/lCB6hU9si0Z0ZG6bMlXX6vjhoGrvEOLFxGxMwWP/CMICAJWiABrkUS9+grsSHKhjNzwmVTTRnRILO9BRo8eBldPjmnU4Y9PfkFNlXWRRiEjnXynclNKUV1eB2dXB4QM8m7Tu5iUZVksyHnwYCUcZNhBixcRsTNDVGRdEBAErA0Bd5J0iHh+GUhoCsUkXJlL9W2kWRYCnOU5csZ0NaiK4sPYsda65OGFjHTyfUo9mK96RI7wh71DS7gM69CwyFnrlF8RO+sEXDksCAgCVoOA1xlnIOxx0iGhlr/yTeQbJCpYzSRsfKDDpur1vuprE7Dr50QU51ZYzYxb/rpazbD7b6Ba8KqxeJGKbdtVYJcdFZti+XfDJmJnhmjIuiAgCNgCAr6XXYag++5TU8n5939Q/M03tjAtm5lD+PCRcPP2oaSaatRVpeLPz9pXOre0SQsZ6eCJ1FTWITuhRPVgsbPWTavO63PBBXDw8mpxWBM78wsLhzt/OaQJAoKAIGADCATccjP8FlyrZpKx+CGUbfzDBmZlG1Owt3dA3CS91EZ9bTwS9+RBE+y09BkKGengCaUdKaQqww3wCXaDd6Bbi5612TlgoTNurQNXeZ8WvBoWN5w3pQkCgoAgYBMIsDs65MEH4X3eeQBl1qTdey8q9+61ibnZwiTiJutdNfb2SSrQeOOao1SlpN7ipyZkpINHpDFKY1k0RaRQyP8R3Siwy3V4W8KhBa+K2FkHAMshQUAQsEoE7OztEb70aXiccgoaKIA/9ZZbUU0lP6SZH4Ho0ePg5OqG2spiODnnoTCrAvs3pJt/YJ2MQMhIBwClNKb0to4XaaithSqKR+caVufVLiViZxoSshQEBAFbRcCOCqdGvvQiXMeMUeqsrNJa26qiu63O3ZLn5UjPZdD4iWqIwVG5arnt20RUltZY8rAhZKSdx8NRyCW5lWCp3YjhLSXgS39dj7qcHDgEBMD77LPaXCE/LRU1VH7bycUVgVExbY7LDkFAEBAEbAEBew8PRL3+GpxjY1GXkYlUqmOjK7bO2ii28Dy0OcRN0btqijL302+QJ/0e1WHLV5ZtuRIyoj29VkvNRRM6xIc0RhxbHC386CO17Tv3cvDbQeuWeeyw2iViZ62RkW1BQBCwNQQc/f1JpfVNOAYFofrYMb1sfFWVrU3TquYzeMIkkqJwREFGGsad4anGfvDPDLBulqU2ISPtPJn2Unq5nHYFFQckkwn8rmiuQ2N4GS1eZKCIneVX5mNd8jrsyN6B1NJUVOuqDeGQdUFAELBxBLiwnpKNp6zCyp07RTbezM/bxd0D0aPHqlEUZx/A0MkhXEMPG1cftVj13Jav/GYG0FJuz5HHnEnDrXVKr1ad1/OM0+EUHm50yANJ7GxL5hY88NsDKK5uaZr1dfFFsHuw+oS4hzSt8z5tm/u0FoozCqjsFAQEAYtHgAP5WTY+5cabULZ+PTIfewxhTz4p/8fN9OQ4qyZpz07Eb9+Mix64gNJ8c5F5vBjHtmdj2JRQM42q/dsKGTGCTXZiCWqrdKpCb1BUs35IfXk5ir/8Up1hLHCVDwwUsTNWn/3o8Ed4Zvsz0DXoEO4RDgfKcc+pyFGWkaLqIvDnaOFRIwjrdznbOyPIPaiJnGjkpfXSxcGl3WvIAUFAELAcBNwnTULEsueQdvc9KP7f53AMCETwIr1ImuWMcmCMZAjpjfzy1itUOZ6tIWWYeE4stn6dgE2fH8egcUEU0+hgUUAIGTHyOLR4kaiRfrCjAFatFX/zLZiQcLCWxzR9gJB2TFsOBLEzdsM8sfkJfHX8KzXtC4dciCXTloBJA5OUkpoSZFdkK2LC5MRwnbf5U1BVgJr6GqSXpauPhp+xpVhZjKEi+wQBy0SAq5eH/uufyHp0CfLfeAOOgQHwX7DAMgdrw6Py9PNH2NDhYEv98e1bMf6sc3BoUwZK8qqobk0STrpoiEXNXsiIkcfRHC/CFRD1TdWhaQxc9bvqSiIpxsNtbF3sjInEfevvw968vbC3s8cDkx7ANSOvaTLFstvFx8VHfYb5DdPga7Os0dUgtzJXERNFVsr1JKU1eWHC0hMri+YS0txDTg5ObcYiOwQBQaB3EfCbOxe6/ALkvvACsp9eCgf/APicTyJp0voVgaHkqmEycoxcNeNnn4dTLhuKH17fh90/p2LkyeHwCWop5tmvg2t1MyEjrQCpKqtFTrJeAj5qZLMEPAdlVR89CjtXV6pDc3Grs5o3teBVWxQ725O7RxERJhHezt54duazmBZu3ELUjIjxNWcHZ0R4RqiP8R4Ub0VWFo5FaW1ZMdzmsZhqZXG0c8Qw/2EYEzgGowNHq2Wsd6xyL7U3BtkvCAgC3UMg4NZbUJdHolsffICMxYvh4OsLz+mndO9icla3EIibfBJ+//AdpB3ch6qyMtIfCUTkCD+kHS6kujXHMOd2fZBrty7eyycJGWkFaOrhAhV17B/uAU+/5liFwg/16bw+F5wPBx/jtWZsWezsi2Nf4IktT6C2vhZxvnF46fSXEOUd1Qq93t1kK4uvq6/6DPdvq3Kr3a0rVpaD+QfBn9VHVqvT3R3dcULgCU3khIkKW1MksFZDV5aCQPcQ4P9DIQ8thq4gHyXf/4C0e+5BzKp34DbWcn4Auzcz6znLLywCAZHRyE9LQcKu7Rg143RMv2IoVj+5XV+3hoQ9DV+6zTkzISOt0G+KFzEojFeXm4uSn39WPX2vvLLVGc2btih2xuTjub+ew4eHPlQTPTP6TDw1/Sl4OHk0T9zMa6ZaWTLLM7E/b7/67MvbhwP5B1BRV4HtWdvVR5tGoFtgEzlhC8oJAScot5N2XJaCgCBgGgLszg7797+VQmv5ps1IvfU2xHz4IVwGDzLtAtKrxwhwVg2TEc6qYTISEO6JMTMjsHd9GjauOYZ5j0yGg4PxsIMe37wLFxAyYgAWuwVSGyXgDVN6i/73P4Ak4N3GjYPbCScYnNFyVUvptRWxs8KqQpW2uy1rm5roHePvwK1jb1WxIi1nbvlb/JYW7hmuPmfHnq0GrKvXIaE4oYmcMFHh7J+8yjxsSN2gPtrM2J3DxERz77ClRrJ8NHRkKQi0j4A9CUNGvPQyUq6/HlX795NK602I+fhjOIUEt3+SHOk1BIaSGuvWL1YjcfcO1NZUU70aF0w+fxCObstGYWY59v+WTsJofWvlNmUyQkYMUCrMrEBZYTUcHKkIVJyvOtJAxfAKP9Gb9P2unm/Qu+2qFrxqC2JnRwqO4N7196pMF3ZlPD3jabBVxJYapyIP9RuqPpcMvURNraquCocLDoMtJ/xhgsJCbkklSerzbcK3qp+jvSOG+w1vQVAG+QyySqJmS89U5mKZCDh46mXjk+dfjZrkZD0h+fADOHh7W+aAbWhUwYOGwCsgCKX5uUjeuxtxlPLr6uGEqRcNxm8fHcG2bxIxjETR3Lzaqon3JwxCRgzQ1qwi4UN94Oisz8Eu27ABdVlZcPDzg9fs2Qa9265qlpGwoSPaHrSiPT8l/YRH/nwElXWViPKKUvEhcX5xVjSD7g/V1dEV44PHq492laKqIuzP36/IyYG8A2rJQbPs5uGPFn/Crit26WjWE15K/ImGoiwHOgKOVMsr6q03kXTVVU2y8dG0bU9JAdL6DgG2CnMg66613yhXDZMRbqOmh+PAxnTkpZZhC+mPnH61eX+3hIwYfAeMpfRqiqu+l18Oe5fmgFaD09SqLYid1TfUY8XuFXhj7xtqTtPCpuGZmc8M+HgJDqKdHjFdfRgYdudx/IlmOeElB8WW15aDXVqaW4v7BrkFtSAnHCzLmUjSBIGBiIBzZCSiqY5N8tXXoHLHDqQvul9V/rVzlJ+ivvw+cNwIk5HjO7ahXqejujUOqgjsjCuG4YvnduLgHxkYPSMCQdHNIp99OR5j15ZvQCMqdbU6ZBxtKQFfnZiI8k2bQKkV8J03zxh+TfusXeysrKYMizcuxoa0DWpO1426Dn+b+DewO0JaSwQM409mx+qtZXX1dW3iT44V/n975wEYVbX08T9pJCEQAqEkQOhF6dJVFBQFVHyAXZooYkNAQIXHE1B5YENRwYZPVJRiASwon4oCinREUCz0GhICBEJCQkjyzdxlYwLZzW6y5e7uf9677u69557yO5fs7Jw5M9uNWCo/7P8BelhF/U8Kbi9W/xN1wqWQQCAQKBQ2/vvvkThpEuKefpo72Nw4+TUvaorwqPLITDuJg39tQ62LmxutxTesiIZtq2L7hmRxZv0bfUZf4rV54DfNuQdAY/afzc5FZHQYdFuvSur8+cZr1JVXQhNB2ROrv4gvLtHsPbkXw78fbnyZaoj2SZdOQq/6vewNl9fOI6BKmwZ506Nvw77GVV3mMvxPjlh8T9SCcuDUgXz/ky92fWGUK+h/okqKxm7RIG0UEvBXApHt2lnCxg8fgROffGoJG//ISH8drtfHpZaQ+m3a4/cVy7Bj3ep8ZUQ71qlvA2Obb+KOE9ghSomRVM8LPaYycg76/t8lvohIggQ601++uRkZSF24yDhXnOOqFsoPduZj/iI/HfwJj618DGln0owvwJe7vmwsKxgD539KRSAiJAKtq7Y2DmtFukOp4PZifX8863gh/5NpV06DdceP9T6+koC/ESjfrRuqT5qIwxMm4uibb4pComHjB/jbME0zHl2qUWVEo7F2GXRvvgWkfKVwtL2+DtJl80atAiEtPN1xKiPniO87t6W3VlNL1NUTS5YgNy0NoQkJKHeZ/aiBvhjsTP0e3v39XUzfNB3qK9KqSiu81PUlaIwNivsIxITHoHPNzsahreg8aH4eVUqsPihqHaGQQCAQiLn1VgkbfxRHXn4FSVMlbHzlSoi+nmHj3TH3tVu0ko0ZZZGWImk49uxCNdllYxVNoudtoTIiM5B+IkuCwpwS3xCgVpNKxheE1XE1RoKc2cpDY508Xwt2pttXJ/48EV/t/soYwk0Nb8K/O/ybfgvWCfXgq1rhapavaRw96vbwYMtsigTMQaDy/fdL2PijOC7B0A6NPRc2vpgfgObouW/1IrRsOOq0vMTYUaMB0AoqI2YYiffDrpmAwoFzVpEqtcobe61Pb96MrD/+QBnZPRPdx3YeGmvXrVt6fSHYWeKpRAz8eqChiGiulvEdxmNip4lURKyTyVcSIAGPElCFXMPGl+8pyrgElzzw8HCc3vqbR/sQKI3pFl+VHevXmG7IVEZkSv7Z0mtZojku0QFVKlx3HUIkvkhxYnVeNXuws41JG3H7ktvxx7E/EFM2Bm9d+xZubyKWH/ljQCEBEiABbxEoIw6W8c8+i8hOHZEn/nr7hw6F7makuJZAPXFiVUt/yr49SD2c6NrKS1lbwCsjebmFQ8CflfXLtK+XGlhj7rQfcdXK3moZMfNOmo/++ghD/m+IkeG2SaUmmH/DfLSr3s46BL6SAAmQgFcJaNj4mq/OQPjFFyPn+HHsv2cIspOSvdonf2s8Qrb3Wrf16lKNmSTglZEU8RU5nZaN0LLBqF4vGqmfLkSemArDmzdHRPNmxc6V2YOdZedk46nVTxkZd8/mnUWPOj3wfs/3jRwtxQ6OBUiABEjAgwSMsPGz3kJo7QRkHzqE/ffei5yTJz3YA/9vyrpUs91kSzUBr4xYQ8DXaBwjeUXy8mOLOGoVMXOwM034NuSbIfj474/FN7cMRlwyAs9d8Rx0yymFBEiABMxIQLf4JvzvfwiuEousv//G/gcfRG5mphm76pN9qt/W4jdy6O8/kJ5qCfRphoEEvDKyb9tRYx5qSXyRUytWGtp4cHQ0KqgzlQNi9Rcx2xKN5ky5/cvbsSl5E6JCozDj6hkY0nwI/UMcmFMWIQES8C4BI2z8rFkIiorC6Q0SNn7MGGjSUkrpCVSIrYJq9RpqXAEJD7+29BW6qIaAVkays3KgUedUEiTYi9VxNfqmmxxO3mTGYGdLdi3BoK8HISkjCRp6fO71c3FFzStc9MiwGhIgARJwP4HwJk1Q87WZKCO+JKe+W4bDTz5phF1wf8v+30LD9p2MQWo0VrNIiZSRmTNnok6dOgiXbIsdOnTAunXrHBrPfAmvrjs3evcufrusQxWWstBByUWTm5Mn6ZXDEZF5BOk//mjkoYm53X4eGmuzZgt2lpObgxc3vIixP45FVk6WoYCoIqKp7SkkQAIk4GsEyrVvj/gXnodkdUPqx5/gyCuv+NoQTNlfjcaqsu+3X5Elu5fMIE4rIwsWLMCoUaMwceJEbNq0CS1btkT37t2RnGzf63nPnj0YI6a2zp07m2HcRh/2b7OEgNcQuKnzFxjnynW+HGESddURMVOwsxNZJ/DQ9w9h9u+zja7f2/xevNL1FZQPK+/IUFiGBEiABExJoMK116K6fN+oHH39DRyb84Ep++lLnapUoyZi4mogR5a+dm/eYIquO62MvPjii7hXPJwHDx6Mi2UL1htvvIHIyEi88847NgeUIymL+/XrhyfFzFavXj2b5Tx9weq8WqtBeclDs9Bo3lHHVS1s3dLr7WBnO1N34s4ld2LVwVUIDw7H81c8j+GXDEdwULCnkbI9EiABEnA5gZjbbkXs8IeNepOmTMHJryzRo13eUIBUqCsUDUy2VOOUMnLmzBls3LgR3STBkVWCxHymn1evtr329NRTT6Fq1aq45557rLfZfc3KysJJ2c5V8LB7Qwkuak6Qzrc2QqtutVBh9zrknjiB0Bo1EOWE5cbqL+LNYGfL9y9Hv6/6YV/aPsSXi8ec6+aAYcVL8EDwFhIgAVMTiH3gARg/FjWf0+Njkf7zz6bur9k71+Dcrhq1jJyVcBbeFqeUkZSUFKiVo1q1aoX6rZ8PHz5c6Jz1w08//YT/yTatWeIZ7ahMlYRJ0bKjxXrUqlXL0VsdLqeaoS7PXHZzQ6R/Mte4r6L4imgkQEclcfufRlFv7KRRZerNX9/E8O+HIz07HW2rtcW8G+ZBA5pRSIAESMDfCOjf7Grj/43yPWSno4aNH/Yww8aXYpLjGjRCuZhKOHP6NPaL74i3xSllxNnOpknW2wEDBhiKSGys49lgx40bhxNiqbAe+/fvd7Zph8uf3roVmb/9ZnhsV7z5ZsfvO5WGY4cOGOXjGjZ2+D5XFMzIzsDoFaMxY/MM5Mn/7mhyhxHavVK4JZy9K9pgHSRAAiRgNgJG2PjnJGx8x47I1bDx992HM+KPSHGegIaFb9C2g3GjGXLVOKWMqEIRLJaDpKSkQiPXz9WrVy90Tj/s3LkT6rjaq1cvhISEGMf777+Pzz//3Hiv14uSspKgrkKFCoWOosq54tzxDy1WEY0r4kgeGmub3gp2diDtAPp/3R/f7v0WIUEhmNRpkpFxNzQo1No1vpIACZCA3xIwwsbPeNUSNv7YMeyTsPFnJXw8xXkC1l01Ozasge4O9aY4pYyEyX7vNm3aYNmyZfl9zs3NNT536mTZKpR/Qd40kX3iW8XysFmy4FqPG2+8EV27djU+u2P5pWD7xb3XB9jqCOWM46rW641gZ2sT1+KOJXdg+/HtqBxeGbO7z8ZNjW4qbpi8TgIkQAJ+RSBYgqHVeutNhMrOx+yDB3F4wkTGICnBDNdq2hxlI8sh40SqbMj4qwQ1uO4Wp5QRbVa39ar/x3vvvYc//vgDD4hTUXp6urG7Rq8PHDgQusyionFImjVrVuioWLEiypcvb5xT5cabckJ20OSJU64mZgpv0cKprnjSeVX9Qz7840Pc9+19SM1KRdPKTY1Ed62qtnKqzyxMAiRAAv5CIEQs9TVeehFiZkfat9/ixKLF/jI0j40jOCQUdVu3NdpT64g3JcTZxm+77TYcOXIEEyZMMJxWW7VqhaVLl+Y7te7bt0/i0zit4zjbjVKXzxOLzvF58416Yu68w6kw6QWDnbnbeVWDlz29+ml8tvMzo6+96vXChE4TEB4SXmoGrCCwCKjzebYJvOZ9jbr+aPKFv2m+xtUV/Y1o2hRVhg/HEQk5kTR5MiLbtUWYGzY8uKKvZq1Do7H+uWoFNBrrFf0GO/Vd6MoxlZFf3XmurNAddekWX91Zow6t6kviClFlRCOupoo2HT91CoIiHE8ed2TfHrz/6DDJ9BuOYbMXIMiJHTjO9F0dVe/95l5sSdkiSfyCMLrNaAy4eIDXHhZn+s6y5iGg/8R1t1tqaqp5OuVDPVFFpG7duvC2JdeHkHm0q3miZO8dNMjIYRNxySWo/f57KCPWEopjBM5knsZrQ+5EjvxQGfT8DMQm1HHsRgdLOfr9HbAzpp7EUVdeaRwOMs0v5qlgZ5pdt17Fethzcg+ev/J5XBp/aX4f+IYEHCVgVUQ01o8GKNQtkhTHCKhP3CFJZZ+YmIgE8U8gO8e4ebKUscPmmWex+1//wmmJCn707bcRe//9nuyCT7cVFh6B2i1aI118KDMz0r02loBVRkpD3FP+IvqH74mOT+C+FvehZvmapeky7w1QAro0oxYRVUQqS2p2ivMEqlSpYigkZyV0dmgod605T9D9d4TVrIFqT/wHiWPH4ciMmSh32eWIaN7M/Q37SQs3jhoH9R/xppjfucObdGy07cmdNGHBYVREbMwDTxdPwOojohYRSskIWJdnVLGjmJdAtFhGjIBoojQeeuwx5EowL4pjBLytiGgvqYw4Nlf5pU5LsLPjXgp2lt8JviEBJwlwecFJYAWKk10BGCZ+q/MUN2kiQsQKeGb3biQ/L9l+KT5DgMqIk1PlrWBnTnaTxUmABEgg4AgES+iIONmQoHJ87jycWrEi4Bj46oCpjDg5c55conGyayxOAj5DoEuXLhg5cqTP9Jcd9R0CUZddhkqDBhodPjT+PzgrUVop5idAZcTJOfKU86qT3WJxEiABEiCBcwSqSHDOsg0bIEeSuyY+MYHRWX3gyaAy4sQkeTLYmRPdYlES8CsCZyQqMoUESkMgSPKbxYvPSBnZ/XRK0pekfvJJaarjvR4gQGXECchHD+w30i1rsLPYWrWduJNFSYAEbBGoU6cOnn76aSOVhAY1HDp0qK2iPE8CDhMIl9xoVUaOMMonTX0GZ/budfheFvQ8ASojTjD3VLAzJ7rEoiTgFwReeOEFtGzZEr/88gueeOIJvxgTB+F9ApXuuguR7dsjLyMDB2W7b55s+6WYkwCVESfmhf4iTsBiURJwgsBVV12F0aNHo379+sbhxK0sSgI2CViis05FkCRnzfx1C1LefNNmWV7wLgEqI07w504aJ2CxKAk4QaBtW0vmUCduYVEScIhAaHw8qktiV5WU117H6V9/deg+FvIsASojDvJmsDMHQbEYCZSAQLly5UpwF28hAccIRPe6ARWuuw6QKLq6XJOb7r0cLI71OPBKURlxcM4Z7MxBUCxGAiRAAiYkUH3iBIRUr47svfuQ9OxzJuxhYHeJyoiD888lGgdBsRgJkAAJmJBAcHQ04p95BpJ6GakffYS07783YS8Dt0tURhycezqvOgiKxUiABEjApATKdewA3WGjkvifJ3BWgqJRzEEgxBzdMHcvGOzM3PPD3vkegeXLl+d3es+ePfnv+YYE3E2gyiMjkb5qFbL+/huJEi6+5huvi7GkjLubZf3FEKBlpBhAepnBzhyAxCIkQAIk4AMEgsLC/onOKon0Uhd85AO99v8uUhlxYI4Z7MwBSCxCAiRAAj5CILxxI1QZPcrobdKzzyJr924f6bn/dpPKiANzS38RByCxCAmQAAn4EIFKAwcislNH5J0+jUOPPY687Gwf6r3/dZXKiANzyp00DkBiERIgARLwIQJlgoIQP1Wis0o+pMytW5Hy+us+1Hv/6yqVkWLmlMHOigHEyyRAAiTgowRCJe5I3KSJRu9T3ngTGZt+8dGR+H63qYwUM4cMdlYMIF4mARIgAR8moJFZK9zYC8jNxaHHH0fOKUZn9cZ0UhkphjqXaIoBxMskQAIk4OMEqkum6JD4OGTv34+kqVN8fDS+2X0qI8XMG51XiwHEyyRAAiTg4wSCJatvDdlVo9FZT3y6ECe//dbHR+R73acyYmfOGOzMDhxeIgESIAE/IhDZrh0qD7nHGNHhJyYgOznZj0Zn/qFQGbEzRwx2ZgcOL5EACZCAnxGo8vDDKHvRRchJTTWis+bl5fnZCM07HCojduaGwc7swOElEnAzgZUrV6JXr16Ij483wnUvXry41C3eJXlJNPT3+UfTpk1LXTcr8H0CZSQ6a43nn0OZsmWR/uOPOD53ru8PykdGQGXEzkTRX8QOHF4iATcTSE9PR8uWLTFz5kyXtfTyyy8jMTEx/9gvDouVKlXCLbfc4rI2WJFvEyjboAGqjh5tDCL5ueeRtXOnbw/IR3pPZcTORHEnjR04vEQCbibQs2dPTJ48GX369CmypaysLIwZMwY1atRAuXLl0KFDBywvkICvqJuiJY18dYktYT02bNiA48ePY/DgwUUV57kAJRDTvx/KXXYZ8uQZO/ToY8g7cyZASXhu2Mzaa4M1g53ZAMPTPk9A18FPZ+d4fBwRocHG8oirGh42bBi2bduG+fPnG0s5ixYtQo8ePbBVomk2bNjQoWb+97//oVu3bqhdu7ZD5VkoMAhodNa4KVOw+8YbkSnP2JEZM1F11COBMXgvjZLKiA3widv/NK7ExMUjskK0jVI8TQK+R0AVkYsn/J/HO77tqe6IDHPNn5x9+/Zh9uzZ0Ff1KVFRK8nSpUuN81Pki6Q4OXToEL7++mvMpV9AcagC8npotaqo/tRTODhiBI7OmoWoKzojsm3bgGThiUFzmcYG5cTtfxlX4ho2sVGCp0mABLxFQK0fOTk5aNSoEaKiovKPFZISfue5Nf6C5++///4Luvree++hYsWK6N279wXXeIIElECF7tciWpcJxZqoyfRyTp0iGDcRcM3PFDd1zpvV0nnVm/TZtjsJ6HKJWik8Ldquq+SUfCkEBwdj48aNxmvBelUJUdm8eXP+6QqSDK2g6FLVO++8gwEDBiBMdlBQSMAWgWrj/42MdeuQffAgkib/F/HPTLVVlOdLQYDKSBHwGOysCCg85TcEdFurq5ZLvAWldevWhmUkWQJTde7cuchuNJBdEbZELSg7duzAPfdYglzZKsfzJBAsym38c89i74CBOCHby6O6dEGFHp5X5v19JrhMU8QMFwp2lkDHtiIQ8RQJuJ2AWj/UumG1cOzevdt4r34iujzTr18/DBw4EAsXLoReWye/XqdKSvglS5YU2zd1XNXdN82aNSu2LAuQQGSbNqh8770GiMMTJyI7KYlQXEygRMqI7vuvU6cOwsPDjX/Q+kfAlugfirbi9KNrs7r9rlWrVpgzZ46t4qY4XyjYWZDrTMumGBw7QQI+QkC33aoFRA+VUaNGGe8nTJhgfFYHVlVGRktMiMaNGxu+H+vXr0dCQoJx3dZ/Tpw4gU8//ZRWEVuAeL5IAlUeehDhEhwvR56fxHH/Rp5k+aW4joDTyzQLFiww/ii88cYbhiIyffp0dO/eHX/99ReqVq16Qc80oND48ePRpEkTY232yy+/NPb0a1m9z4xCfxEzzgr7FGgEuog53F447tDQUDz55JPG4QwbjTWSkZHhzC0sSwLQ6KzxEp11d9+bkP7zzzj+wQeoJMowxTUEnLaMvPjii7hXzFUaJOjiiy+GKiWRkZGGM1hRXdI/KBq06CKJ91+/fn2MkG1SLVq0wE8//VRUcVOcY7AzU0wDO0ECJEACpiJQtl49VH3sUaNPyS9MQ9b27abqny93xill5IxEoVPvdQ0SZJUgCQ6jn1evXm09ZfNVf+UsW7bMsKJcccUVNstpZMWTJ08WOmwWdvEFBjtzMVBWRwIkQAJ+RCDmjjtQTmKOaFTWgxKdNZfRWV0yu04pIykpKYYHe7Vq1Qo1rp8PHz5c6FzBD7pGq9vtdAvd9ddfj1dffRXXXHNNwSKF3qsTmppSrUetWrUKXXfnBwY7cydd1k0CJEACvk1Ad6PF//e/CI6JQdaffyLllVd8e0Am6b1TykhJ+1y+fHnDC16dy/4rk6iOaMvt5JAYN24cVIGxHprMylNidV5lsDNPEWc7JEACJOBbBEKqVEHc008ZnT76v3eQbmcTh2+NzHu9dcqBNTY21ggwlHTetib9rImnbIku5Vj3/Otumj/++MPYgqf+JEVJWUnfrIc35NC5yKvxjRh51Rv82SYJkAAJ+AKB8uKeEH3zTTjxyac4NHYs6kkMkuDzguv5wjjM0kenLCO6zNJG9lur34dVcmV7k37u1KmT9VSxr3qP+oWYTRjszGwzwv6QAAmQgHkJVBcrfqhsJT97KBGHn55s3o76QM+cUkZ0PLrEMkuSBmleB7VwPPDAA0hPT89Pwa37/nWZxSrq//Htt99i165dRvlp06YZcUb69+9vLWKaVwY7M81UsCMkQAIkYHoCQRI7K/7ZZwCx/p/84guccCDgnukH5aUOOrVMo3287bbbcOTIEWjgIXVa1WUXzZRpdWrV6Ii6LGMVVVQefPBBHDhwABEREUa8kQ9kf7bWYzax+otUb9BIxsBgZ2abH/aHBEiABMxGIFKC8sVKIsaU117D4SefQuQllyA0Ls5s3TR9f8rIdts8s/dSt/nqzhp1aD0/4ZUr+770ten4fcV36NDnVlx+O4PZuJIt6/IOgczMTCNUet26dY2Iyd7phW+3Soa+PX+e6H1edjb29OuPzC1bEClpBhJmv4MyBX6Ue6IPZm3D0e/vf0wYZh2JB/vFYGcehM2mSIAESMBPCJSRaMA1JJleGbH+Z6xdi2Pvve8nI/PcMKiMnGPNYGeee+jYEgk4QmDlypXo1asX4uPjobEdFstuBVeIOs9rioratWsbu/Y0z9Y777zjiqpZRwATCJPnqJrsqlE5IpHKMyVFCsVxAlRGzrFisDPHHxqWJAFPEFB/s5YtW0ITc7pSbr31VmMHoGbu1Zxa8+bNMxLtubIN1hWYBCreeguiukhOJVm2OaTRWU24a9SsM+O0A6tZB1LaflmdVxnsrLQkeT8JuIZAz549oYctsVo4VJlITU1Fs2bN8Oyzz6KLfBnYEnW2X7FihbG7T5N4qqhlhEICriCgFry4/07Grhv/hay//8aRl6aLteRxV1Tt93XQMnJuihnszO+fdQ7QSkB91s+ke/5wsa/8sGHDjJxY8+fPxxZxHLzlllvQo0cPbLeTvOzzzz9H27Zt8dxzz6FGjRpo1KgRxowZg9OnT1vp8JUESkUgpHJlxE1+2qjj2LvvIt2BvG2latBPbqZlRCaSwc785GnmMBwjkJ0BTIl3rKwrS/37EBBWziU1agiB2bNnQ1/Vp0RFlQq1fOj5KVOmFNmOxjvSjOHh4eFYtGgRNN+Whh44evSocV+RN/EkCThJoHzXrqgo4StSFyyQ6KzjUO/zzxAsO0IptgnQMiJs8oOdhUcgNqG2bVq8QgIkYAoCW7duNZJ2qmVDk3BaD12C2blzp9FH6zl9vV/iQKho9Gc1pX/44Ydo3749rrvuOrwozoYaxJHWEQMR/+MiAtUefwxh4iR9VtKlJE6aBB+IouGikZesGlpGhFu+v0iDhgx2VrLniHf5EoHQSECtFJ4WbddFcurUKSNP1saNG43XgtWq8qGyefPm/NPW+ERxEoxKl2c0bpFVLrroIuOLQgMzNmzY0HqaryRQKgJBkZGIf/457LnjTqR9vRT7jqcayfXCPJiFvlQD8PDNVEYE+KG//zSw03nVw08fm/MOAbEMuGq5xDsDAFpL1MucnBwkJyejc+fORXbDmpyz4MXLLrsMH3/8MVSZsSotf4ujoUaNrlmzZsGifE8CpSYQ0aKFKCBP4/BTTyFjzRrDsbXqI48gpn8/BkU7jy6XaQQIg52d91TwIwmYgIAqDGrdsFo4du/ebbxXPxFdnunXrx80F9bChQuNKLPrJI275sJaYic/yJ133onK4mA4ePBgbNu2DRrL5NFHH8Xdd99tpKswwbDZBT8jULFvH8NnJFKWBfPEUTpJ/Jn29h+ArF27/WykpRtOwCsjDHZWugeId5OAuwhs2LDBsICoFURFk3Tqe82LpaKOqqqMjB492ogT0rt3b6xfvx4JkkXVlqg1RBN36lZg3VWjCo0GVnvllVds3cLzJFBqAmHyTCa8OxvVJ02EJtc7vWkTdsvzmiJJZ/POni11/f5QQcDnptn1y3oseuZJxMTF4+7pb/nDnHIMJJBPgHlV8lGU+A0ZlhgdbyyCQPahQ0icMBHpsqtLJbxpU8SJtSS8caMiSvv+KeamcXAO851XGzZx8A4WIwESIAESIIGSEQiVrei1Zr2FOFlSDKpQAZm//47dN9+MIzNmIu/MmZJV6gd3BfwyjdV5Nb4RlRE/eJ45BBIgARIwPQHdXl6xT2/U+/ILRF19NSDh41NmzBCl5Bac/u130/ffHR0MaGXECHa282+DK3fSuOPxYp0kQAIkQAK2CIRWrYqaM15FjRenITgmxgghv0eCpSVPmxZweW0CWhlhsDNb/0R4ngRIgARIwBME1EpSQYLv1VvypfEqe9ZxdNbb4uDaBxmbfvFEF0zRRkArI/n+Igx2ZoqHkZ0gARIggUAlECKJG9VCUnPmDIRUqYIzspV9r+z2OizOrbkZksLBzyWglRGrvwiXaPz8KefwSIAESMBHCJQXHxL1JYnu2xcSGhjH35+DXf/qjXQJmubPEtjKyHYfiLy6fz3w4zRJqpHjz88hx0YCJEACJHCOgCbVi5/yX9l1MwshksIge/9+7LtrMBInTkKOBAP0RwloZaTng4+gy8AhiG98kTnnVtO8f3o3sOwpYE4fIO2wOfvJXpEACZAACbicQFTny1Hvi89R8Y7bjbo1C/CuG3rhlEQO9jcJaGUkrmFjtLm+NyKiyptzXjWx2JVjAX3dvQJ4/TJg+7fm7Ct7RQIkQAIk4HICwRI1OG7iRCRIZulQieR69vBh7B96Hw6NHYcciSTsLxLQyojpJ1ETmrXuBwwVRaRacyAjBfjwZuD/xgNnAzc4junnjR0kARIgARcTKNehPep9thiV7roLkO+GE4sXY6dYSU5KegN/EPwtsBoAACmSSURBVCojvjCLVSRM8JDvgPZDLb1dPQN451rg6E5f6D37SAIlIqBJ7DRvTLxErNTtj4vlj29pZfny5UZdWl/B47D82qSQgNkJBEVEoNrYx1F77ocIq1cPOSkpOPjwcByQTMBnjx41e/ft9o/KiF08JroYGg5c9zxw+1wgIkZSDcv+8zevBLZ8bKJOsisk4DoC6enpaNmyJWbOnOm6Ss/V9NdffyExMTH/qCrBpygk4CsEIiVhZN1FC1H5vvuA4GCkfb0Uu66/ASe+XCIbcPJ8ZRiF+kllpBAOH/jQ5HrgfkmwlHApcCYNWDgEWPwgkOWfHtY+MCPsopsI9OzZE5MnT0afPuK8XYRkZWVhzJgxqFGjBspJJtQOHTpALR+OiCof1atXzz+Cgvin0BFuLGMeAkFly6LqIyNR56MFKNu4seE/ckj+PRx4aBiyk5LN01EHe8J/gQ6CMlWx6JrAoC8szq1lZAo3fwi81QVI3GKqbrIz5iSgv5wysjM8frj6F9uwYcOwevVqzJ8/H1u2bMEtt9yCHj16YPv27cWCb9WqFeJky+Q111yDVatWFVueBUjArAQiJOtv3Y8/Quzwh2WzQyhOff+97Li5AamffupTVpIy8gfC9DYdR1MQm/VhcWu/9oiV5NN7ZdvvITHXhQHX/ld8S+SzOr9SAp5AZmYmdkskx7p16yI8XJb6RFQR6TC3g8fZrL1zLSJ1Z1gJRP07Fi1ahN69ext379u3D/VkzVxf1afEKt26dUP79u0xRaJWFiW6PKPWk7Zt20ItK2+//TbmzJmDtWvX4pJLLinqFhTFsMiCPEkCXiaQ+fffSBz/H2Ru3Wr0pNyllyLu6acQKtZDb4mj39+0jHhrhlzVbp3LLcs2jXoCObLD5utHgfn95BvnmKtaYD0kYDoCW+WPbY7k8GjUqBGiZOuj9VixYgV27rQ4dlvP6ev9999vjKGxmLPvk3X2Nm3a4FL5Q/3OO+8Yry+99JLpxsgOkYCzBMLl30OdeXNR9dFHUUaWcdJ//hm7et2IY3PnIi8319nqPFo+xKOtsTH3EChXGbhjHrD2TeDbJ4C/lgBvbAb6zgLqXOaeNlmrzxKICImAWik8Ldquq+SURKEMFse9jRs3Gq8F61XlQ2XzZvk3cE4qVKhgfXvBq1pSfvpJLIwUEvADAmVCQlD5nrsRdVVXJP7nCZyWfyNJTz2NtK++Rtx/JyOsdm1TjpLKiCmnpQSd0mWZjvLrr3Yn4JO7ZdvvDuC9G8Sv5HHgCrGWBAWXoFLe4o8EdMmjpMslZuHRWnYTqGUkOTkZnTt3LrJbDRo0KPL8+SdVaVH/EQoJ+BOBsrI0W3vO+zg+dx6SX3wRGRs2GDluqowYgUoDB6CMKPNmEi7TmGk2XNGXuJaWIGkt75QkS2KWWz5VlJJewImDrqiddZCAxwio9UMVBauFQ31f9L36iejyTD/JaDpw4EAsXLjQ8ItZt24dpk6diiVLxDJoQ6ZPn47PPvsMO3bswG+//YaRI0fie3H4e+ihh2zcwdMk4LsEysgusUr9+6He558hslNH5IkPWfKzz2LPnXciS/4NmEmojJhpNlzVl7Jipu7zuhxvAWHyfu8qWbaR5Zo/v3JVC6yHBNxOYIP8klMLiB4qo0aNMt5PmDDB+Dx79mxDGRk9ejTUF0SdW9evX48ECZltS86cOQMt37x5c1x55ZX49ddf8d133+FqyZRKIQF/JRBWsyYSxD+qujizBskyZuavW7C7T1+kvPEm8rKzTTFs7qYxxTS4sRMapVWXbRLPrZ+3lyA51zwlW8AsOyvc2DKrNgEB7gQp/SSQYekZsgbzEMiWaMOHJ07CKXH2Vil70UVGhuBweXWHcDeNO6j6Yp2V6wP3fAt0Gmbp/Tpxcv1fNyBluy+Ohn0mARIgARIoBYFQCfZX843XEf/8cwiOjkbWH39g9y23Ivnll5ErlkNvCZdpvEXek+2GSPyR7hJ/5E4JHR8pO28Oyx50DSX/y4fiV2L6MDOeJMW2SIAESMDvCagTe7Tkfaq35EuU795dEq+exdHX38DJL77w2tipjHgNvRcabnStxCQR/5G6VwDZ6cBnEkZ+4VAJJZ/mhc6wSRIgARIgAW8SCImNRc2Xp6OGOHZHdbsa0eeCCnqjTyVSRjRxVZ06dYyIjpoPQr3YbcmsWbOMrXcxMTHQQyMk2itvqx6edxGBCrKFccBi4Kr/SJRW2dq19SNxbpWtkQc3uagBVkMCJEACJOBLBCr06I5aM2Z4dbuv08rIggULDK/2iRMnYtOmTUZWze5i5tH9/kWJhl6+44478MMPPxh5JGrVqoVrr70WBw8eLKo4z3mCgMYc0dgjg78GomsBx3eLH4lYTX6eAZg8Sp8n8LANEiABEiABzxJwejeNWkLatWuHGaJFqeTKl5cqGA8//DDGjh1bbO81UJFaSPR+jRHgiDjqjetIXSxzHoHTx4HPhwN/fG650OAaoLdsC46qcl5BH/6YI1vXNIngGclsXPsyyeETOLH+uBOk9M8tGZaeIWsIXAKOfn879VdZ9+hr+OVx48blk9XU27r0otkzHZGMjAxky77mSpUq2SyuCaz0sIoOhuImAhExwK3vAxveAZbKvO6QnTcak6SvxCip18VNjbq52uxM4JAsO2l8lb0/A/sk9Ln6yKhUqgdcPgpocRugjr0UEiABEiABrxNwShlJSUkxQjBXq1atUMf1859//lnonK0Pjz/+uJFlUxUYW6JRFJ988klbl3ne1QTEsxrt7gESOgIfD5Ztv38B7/cGOsuXdpd/m9+ScEYUjf3it2RVPg5skKSB/yizBi5VulSO7RJLkGxzXv6MKCUjgdb9JeaK63KmWBrhf0mABEiABJwh4JQy4kzFRZV95plnMH/+fCOFtzWdeVHl1PKi0RatopYRXQqiuJlAtaYSSn65WEhkuW3Te8CP04A9PwE3vQ1UTHBz405UfzpVrB1r/lE+NKBb7tnCFZSrakkSqMsytS8FqkhAn+wMYOO74hvzCnDyAPDVGGDl85YYLG3vlug/Eq2WQgIkQAIk4HECTikjsbINSDNlJiUlFeqofq4ugVTsyQsvvABVRjT0cosWLewVRVlJfawHxQsEwiKBG+XLul4X4IsRYnGQJY43LpdzrwIX/8sLHZImTx0R5UOWW3TJRa0fh3+Tk+fFR4kWZUmVDuMQBUSDvanFp6CosnGpWEXaDZGUrh8AP02XnD37LZmOf3pREg0+BLS/F4ioWPAuvicBEiABEnAzAad204SFhaFNmzZYtmxZfrfUgVU/d+rUKf/c+W+ee+45PP3001i6dCnatm17/mV+NiOBZn0lJsmPQA2Zr8wTwEcDRTkZKdaF0+7vrSb12/Kxpb0Z7YEXGljaX/uGJWCbKiKV5dwl0qc+bwIjJYjbI3L0lfdtBgGxcu18RaRgrzUUviokw38B/jVT/EhEcVFH3h8mA9ObA8ueAtJTCt7B914gsHLlSvSSwEzx8fEynWWwePFil/Zi1apVCJF0661atXJpvayMBEjAeQIhzt6iyyeDBg0ylIr27dtDs2Cmp6dj8GDxNRDRHTI1atQwsmfq52clQ6Amtpo7dy7q1KmDwxIXXyVKkvXoQTExgZg6wN1Lge/lS3rVdFnimG2xlNz8DlBVlj1cIRoBVrcWG1YPsXzoslDq3gtrrtrUYvWoI1aPBLGAlC/st3ThDQ6cCQ61+Iy0vAP4fZFlWSp5m+V1zeui2MgzfenDgMZmoXicgP5dadmyJe6++2707SvKsQslNTXV+FulCfLOt/S6sBlWRQIk4CABp5WR2267DUeOHDEUDFUs9FeFWjysTq2a3lt32Fjl9ddfh+7Cufnmm62njFeNUzJp0qRC5/jBhAT0C/uaJ2XZ5kqJ1ipJ9vTL+q2uQI+p8mV9l30LRFHDUeXjyF+ifIjSYVVA0hILlywjz09cS1E+1N9DlY+OEsa+UuEyrvykcVeay/PZVL7w/v7a4kdySKwma8Rqsn6WRWG5bCQQU9uVrbKuYgj07NkTetgS3XE3fvx4zJs3D6pcNGvWzPjx06VLF1u35J+///77caekUddlZ1dbXPIb4RsSIAGHCTitjGjNw4YNM46iWtEgZwVlz549BT/yva8SqH8V8MAqYJEoJDu/B76UL+ddy4FeL9v3scjNAZJ+E4uH3Kv+HvtWAxlHC1MIEoWnRpt/LB81ZWkmvELhMp74pEp0k+uBxtfJGGUpcuULlv7qtueN71m2A+sOo9iGnuiN29rIE4Uw77QHltvOG0GZiAhjueW80yX+qH+Htm3bZjjF61LOokWL0KNHD2zduhUNG9qeo9mzZ2PXrl344IMPMHny5BK3zxtJgARcR6BEyojrmmdNPkUgqirQ71NgtTizql/FtsWWeB43yZd1rXaWoZw9IwHGNlsUDyPGh+x6yTpZeJghEZbytcUxVh1Oa4pfipm214p/Ahp0sxyqROmOm10/AL/OlWOeWFD6yLbn0UD1ZoXH5SOfVBH56xJR/jwsjTdtRJlIcZB2gagFVpUKfVVFRGXMmDGGlVbPT5kypchWtm/fbgRn/PHHHw1/kSIL8SQJkIDHCVAZ8ThyH29QrQeXjRAlQhSJTwZb/Dve6W5Zyji+Bziw3rKFtuAwy4qVQ5darDtd4lr5TsAx9VHR48BG8SURS8lfX4l/yULLoRaUzmNEmfL8F3tBvIH4Xq0fGs25UaNGhYavSzeVK1c2zhX0Sevfvz80p5YuzWgMo/PvK1QJP5AACXicAJURjyP3kwb1C1h32+gOG/1y1rgkVokQ/w6r4qGv1ZsD6pfhy6LjvUOsIrqtWOOvqMOrKiZ61OtqyfWjSosPiC6XqJXC06LtukpOnTpl+HtoRGj1+ygoViVk82ax0J2TChUqIC0tDRs2bMAvv/ySv8ysuwF12Up31XzzzTe46ipZjqSQAAl4nACVEY8j96MGw6MB3VmjFoI9opjEtRAlRL6QYxuL8iEWFH8UXZq5ZTbQ9d+ilLwoW5AXWJZwdBlHd/lcMRqof7Xzjr0eZKXbZF21XOLBbhdqqnXr1oZlRBN0du7cudA164cGDRpY3xqvqnioRaWgvPbaa/j+++/xySefoG7dugUv8T0JkIAHCVAZ8SBsv2xK/Sta3GI5/HKANgalTqx9ZPtvl8dl27M48f7ygSUw2wc/A/GtLZaSRrITxF+VMhtYXHlarR87duzIr3L37t1Qa4fmtdJlln79+hnbc6dNmwZVTnSXn8Y80qCK118vjsjnie7y0x03BaVq1arQaNDnny9Yhu9JgATcT8BPf766HxxbIAGDQEwd4IaXgBG/SgTXB8UXRpYidFvw/DstCQe3fiKh6mVHEcVpArqkokqGHioa40jfa9wiFXVU1bhGo0ePRuPGjdG7d2+sX78eCQkJxnX+hwRIwHcIlJH10jyzd9fRFMRmHwf7FwAENHT9mteAdbOAM2mWAWuEV90SrJmCNW6LByUzMxNqUdAlCHv5oDzYJZ9rigx9bsrYYRMRcPT7m5YRE00au+IHBKKqAN0mWsLTdx0vMVhiJFPwTuCzh4BXLpEgam/LbqNMPxgoh0ACJEACriNAZcR1LFkTCfxDQJWQKx+z5M255ilAswif2AcsEQfXl1tK5uAZYjlJ/6c835EACZBAABOgMhLAk8+he4BA2fKWuCwjtwA9n5c8NzUkC7HkZ/pGrCYviTOlBlTTRIQUEiABEghgAlRGAnjyOXQPEtAIsx2GSqZgiX1x46uS50a2kZ4+ZklC+JLEYVn2tGQKPurBDrEpEiABEjAPASoj5pkL9iQQCISEAZcMlARPG4C+4j9SpYmEyxfLiEZ3nS6Wkv8Ti0maWE4oJEACJBBABKiMBNBkc6gmIhAsIX40PssDq4Fb51iyFGdnSN4f8SXZ/q2JOsqukAAJkID7CTDomfsZswUSsE1Ag6JdfCNwUS9gx3cSPE0UE90CTCEBEiCBACJAZSSAJptDNTEBjWTb8BrLYeJusmskQAIk4A4CXKZxB1XWSQIkQAIkQAIk4DABKiMOo2JBEiABEiABEiABdxCgMuIOqqyTBEig1ARWrlyJXr16IT4+HpppePHixaWu86effsJll12GypUrIyIiAk2aNMFLL0luIQoJkIBXCdBnxKv42TgJkIAtAunp6WjZsiXuvvtu9O3b11Yxp86XK1cOw4YNMzL76ntVTu677z7o+6FDJQ4MhQRIwCsEqIx4BTsbJQESKI5Az549oYctycrKwvjx4zFv3jykpqaiWbNmePbZZ9GlSxdbtxTKAqyF6tSpg4ULF+LHH3+kMmKTGi+QgPsJUBlxP2O2QAKmIqCJus+eyfV4n0LCgozlFlc1rBaObdu2Yf78+cZSzqJFi9CjRw9s3boVDRs2dKiZX375BT///DMmT57sUHkWIgEScA8BKiPu4cpaScC0BFQReWvECo/3b+jLVyK0bLBL2t23bx9mz54NfVWfEpUxY8Zg6dKlxvkpU6bYbadmzZo4cuQIzp49i0mTJmHIkCF2y/MiCZCAewlQGXEvX9ZOAiTgBgJq/cjJyUGjRo0K1a5LN+qcqhIVFZV/rX///njjjTfyP+uyzKlTp7BmzRqMHTsWDRo0wB133JF/nW9IgAQ8S4DKiGd5szUS8DoBXS5RK4WnRdt1lagiERwcjI0bNxqvBeu1KiGbN0tSwnNSoUIF61vjtW5dSVQo0rx5cyQlJRnWESojBhL+hwS8QoDKiFews1ES8B4B3SbrquUSb42idevWhmUkOTkZnTt3LrIbau1wRHJzc6EWFQoJkID3CFAZ8R57tkwCJGCHgFo/duzYkV9i9+7dUGtHpUqVjOWZfv36YeDAgZg2bZqxS0Z9QJYtW2Zs273++uvz7yv4ZubMmUhISDDii+h5jWXywgsvYPjw4QWL8T0JkICHCVAZ8TBwNkcCJOAYgQ0bNqBr1675hUeNGmW8HzRoEN59913DUVV3wYwePRoHDx5EbGwsOnbsiBtuuCH/nvPfqBVk3LhxUMUmJCQE9evXN7YDa6wRCgmQgPcIlJFtfnnea96xlk+ePIno6GicOHEC56/9OlYDS5FAYBLIzMw0vnjVRyI8PDwwIZRy1GRYSoC8PaAJOPr97TqPsoDGzcGTAAmQAAmQAAmUlACVkZKS430kQAIkQAIkQAIuIUBlxCUYWQkJkAAJkAAJkEBJCVAZKSk53kcCJEACJEACJOASAlRGXIKRlZAACZAACZAACZSUAJWRkpLjfSRAAiRAAiRAAi4hwDgjLsHovkr2H8tA1tkcI9tpGWkmSKJnyv+NV201KEg+Fziv1/SMnDbuMV71jKidBctpPcb9BerTM8b9564ZBfgfEiABEiABEnAzASojbgZc2uqHzfsFv+5PLW01Tt9/gTJjKDfnlCGpzVBm5JxVOYoqG4K2tWPQsV5ldJCjTuVIQxlyumHeQAIkQAIkEHAESrRMoyGV69SpYwRR6tChA9atW2cT3O+//46bbrrJKK85MaZPn26zLC9cSKBCeAgqRoYiOiIU5eV9efnSLxcWjEg5wkODUDYkCGHBQQgNLoNg0SBUiXCF5EoovBz5T3ZOHs7kSO6Os7nIzM5FxpkcpMuRlnUWaZlnceJ0NlIzsnHg+Gks3nwIYxduRdcXlqPj1GUYMf8XzF27D7uOnIIPxNZzBTbWQQIkQAIkUAICTltGFixYAA3LrOm4VRFR5aJ79+7466+/ULVq1Qu6kJGRgXr16uGWW27BI488csF1nrBPYM49HewXsHFVv/w1tq6G1809915fVQp+1jN5uVouT87Lq5QxXvWM8flceb1PL+hrgfqM++Vz0sksrN19DGt2HcXmfanG589EOdFDpWr5suesJpWM13qx5Wg5McjwPyRAAiRAAk6Hg1cFpF27dpgxY4ZBT3M91KpVCw8//DDGjh1rl6haU0aOHGkcdgued9HRcLLn3caPXiKQmZ2DTfuOY+0ui3LyiywznRHLSkGpIspJh7oWxUSXdupXoXKilqgDxzNQPTpcLF7BBXGV+L0vhzLXJHbPP/88Nm7ciMTERCxatAi9e/cuMQu9ceHChXj99deNhHuaqbdp06aYNGmS8YPKVsW+zNDWmHieBDxFwNHvb6csI2fOnDH+MGiiKasEBQWhW7duWL16tfVUqV/1j0TBlN46GIrvEAgPDcal9WONQ3utyslmUUjUaqLHJrGcHEnLwpdbEo1Dy8RGiXJSz6KcdJLX+lWi/NZyckqWuHTpaqceyenYlWJ53X003VDaFj14KVonxCiWgJb09HS0bNkSd999N/r27esSFqrgXHPNNZgyZQoqVqxoJNvr1asX1q5da2T+dUkjrIQESMBpAk4pIykpKcjJyUG1atUKNaSf//zzz0LnSvNh6tSpePLJJ0tTBe81EQFVTtT6oYeKKifqlLtGLCdrdx/Fxr3HkXIqC0tEOdFDJTYqTCwnek8lwyG2YVXfUk50SSvxZKYoGxalY9eRdIvyIQqILmnZkjDxAUoWRY0C9OzZ0zhssdAfLOPHj8e8efOQmpqKZs2aGRl4u3TpYuuWC3zWVCn57LPP8MUXX1AZsUmNF0jA/QScUkbc3x1LC2p5saYL1zNqGdGlIIp/EFDlRHfc6AE0NLYu/7r/hGE1+Uc5OYMlW0U5kUOlcjlRTlQxMRSUylDlRLc1e1tOizOvYdkQZcNi7RClQxQQPacOv7ZEl6nUb6a+jEOtQPVkmaqBvMZXjDAckW3d54rz6hd0Vr7IPS0hZcu61No1bNgwbNu2DfPnz0d8fLyxjNOjRw9s3boVDRs2dGh4usyclpaGSpUqOVSehUiABNxDwCllJDY2FsHBwUhKSirUG/1cvXr1QudK86Gs/NHSgxIYBNQ/or34j+hhVU62HDghPie6rHMMG/Yew9H0M/hq62HjUCqVRDlpX0eXdeSoXxmNqpZ3m3KiX95qrTCsHCkWZUOXWNTacTD1tM1J0h1OtSuLwiGKhkXhUMWjnCgeUcbuKJs3uvmCKiKvDLrZza1cWP3w9z5BaHj4hRdKcGbfvn3GEou+qiKiMmbMGCxdutQ4rxYPR+SFF17AqVOncOuttzpSnGVIgATcRMApZSQsLAxt2rTBsmXL8h3J9JeFftZfKRQScAUBVU7aiaKhx7CrYPhRbD1oWdZRn5MNe47jmCgnS38/bBzaZoxsf1Zlxroc1Lia88qJBpfbk5Lxjz9HAWuH+nnYEm1blQ2rhcN4LxaPWjERCJFt1xTXE1Drhy4ZN2rUqFDlunRTubJlOTAqKir/Wv/+/Y0dgPkn5M3cuXON5WBdpilqJ2DBsnxPAiTgXgJOKSPaFV0+GTRoENq2bYv27dsba7DqaDZ48GCjpwMHDkSNGjWgfh8q6vSqplTr+4MHDxqe7PqHokGDBsZ5/ocE7BFQP4o2tSsZx0NdG5xTTizLOqqcqM/JcYl18n+/JxmH1qWxWSyWE4uvSpPqFuVErRxqZcn34TCWVCz+HBrt9tzu5Qu6ozFcEipF5ls2Clo71ErjS6LLJWql8LRou64StWaolVZ32uhrQbEqIZs3b84/XaFChfz3+kaXdoYMGYKPP/7YcMAvdJEfSIAEPE7AaWXktttuw5EjRzBhwgQcPnwYrVq1MkyjVqdWNZvqDhurHDp0qJBjmJpF9bjyyiuxfPlyazG+koDDBCzKSYwoJzFQ5SRbgrJtPXjO50SXdfYcMwKxfbMtCXqoaNC42hIVdu/RDCNQm63GNKhcPcOPw7K0YrF4lEOC3Ouq7ba22vbUeQ0+6KrlEk/1+fx2WrdubVhGkpOT0blz5/MvG59t/dhRh1fdoaMKyfXXX1/kvTxJAiTgWQJOxxnxbPcsrTm6T9kbfWOb5iOgyslvopxYg7Ctl2BsGjXWKvJdjBriKGpdWqlfVfw4YmWZRV6ryBZj/bL2F/HlGBlq/dixY4cxFap8vPjii+jatavhbJqQkABdelm1ahWmTZtm/ODRH0m6ZNyiRQubSoYuzahl9+WXXy60XTgiIgLR0dFFTrsvMyxyQDxJAh4k4Oj3N5URD04Km/IOgbOqnBw6icMnThsOpXVlF4vu6AkE8eUvUrWcqvJxvqgy8e677yI7OxuTJ0/G+++/D13+VQf7jh07Gn4gzZs3P/8247Nu+12xYsUF16x1XnBBTvgyw6LGw3Mk4EkCVEY8SZttkYBJCfCLtPQTQ4alZ8gaApeAo8rIP84dgcuKIycBEiABEiABEvAiASojXoTPpkmABEiABEiABAAqI3wKSIAESIAESIAEvEqAyohX8bNxEiABEiABEiABKiN8BkggAAhosDdKyQiQXcm48S4ScIYAlRFnaLEsCfgYgdDQUKPHGRkZPtZz83RXo0irnB/p1Tw9ZE9IwPcJOB2B1feHzBGQQOAQ0C/QihUrQiOVqkRGRvpVUDd3z6Tm3tJgasotJIR/Lt3Nm/UHLgH+6wrcuefIA4SANaO2VSEJkGG7bJia3kIjvvpTZF6XwWFFJOAiAlRGXASS1ZCAWQnol2hcXJyRmVajllKcI6DZygvm23LubpYmARJwhACVEUcosQwJ+AEBXbKh34MfTCSHQAJ+SIAOrH44qRwSCZAACZAACfgSASojvjRb7CsJkAAJkAAJ+CEBKiN+OKkcEgmQAAmQAAn4EgGf8BmxBh3S7H8UEiABEiABEiAB3yBg/d62fo/b6rVPKCNpaWlG/2vVqmVrHDxPAiRAAiRAAiRgUgL6PR4dHW2zd2VEWzF9nGgNPHTo0CFcddVV2LBhg83BtGvXDuvXry/yelHXVGNTBWf//v2oUKFCkfeZ4WRRfXdlv1xRf0nqcOYeR8oWV8be9aKu8fmwPGVFsXH2+StpHY7e54py9uqwdY3PiHefEVvzUtTz6UjZ4srYu17UNT4fgKoYqojEx8fb3SLvE5YR3eNfs2ZNIwKiPaVBty3aum7vmt5j676iHmpPn7PXd1f0xRX1l6QOZ+5xpGxxZexdt3eNz4ftf1eOPn/2+Nqrw9H7XFHOXh32rmn/+Yx45xkpbl4KPluOlC2ujL3r9q4F+vNhzyJinaPgSSLWD77w2r59e7vdtHf9/GtZWVl45plnMG7cOJQtW9Zuvd6+eH7fXd0fV9RfkjqcuceRssWVsXf9/Gt8Pv55ys5n888Vx9+VtA5H73NFOXt1FHWNz8g/818Un3+uOvauJHU4c48jZYsrY+/6+df4fDg271rKJ5ZpHB+OcyXVhKYa24kTJ0xtGXFuVCztKgJ8PlxF0n/r4TPiv3PripHx+XCcos9ZRhwfmmMl1bTWpUsXJsFyDFfAleLzEXBT7vSA+Yw4jSygbuDz4dh0B7RlxDFELEUCJEACJEACJOBOAgx65k66rJsESIAESIAESKBYAlRGikXEAiRAAiRAAiRAAu4kQGXEnXRZNwmQAAmQAAmQQLEEqIwUi4gFSIAESIAESIAE3EmAyog76bJuEiABEiABEiCBYglQGbGD6Msvv0Tjxo3RsGFDvP3223ZK8lIgEujTpw9iYmJw8803B+LwOWY7BDTFhIYMuPjii9GiRQt8/PHHdkrzUqARSE1NRdu2bdGqVSs0a9YMs2bNCjQEF4yXW3svQGI5cfbsWeMPyQ8//GAERmvTpg1+/vlnVK5c2cYdPB1oBJYvX27kXHjvvffwySefBNrwOV47BBITE5GUlGR82Rw+fBj69+Pvv/9GuXLl7NzFS4FCICcnBxqdNTIyEunp6YZConnXAvn7hZYRG0//unXr0LRpU9SoUQNRUVHo2bMnvvnmGxuleToQCegv3/Llywfi0DnmYgjExcUZiogWq169OmJjY3Hs2LFi7uLlQCGggdBUEVFRpUSTyflAzlq3To/fKiMrV65Er169jEyBZcqUweLFiy8AOXPmTNSpUwfh4eHo0KEDVAGximYJVkXEKvr+4MGD1o989XECpX0+fHz47H4xBFz5fGzcuBH6S1gzhFP8g4Arng9dqmnZsqWRBPbRRx81FFb/oFOyUfitMqKmL51oVTiKkgULFmDUqFGYOHEiNm3aZJTt3r07kpOTiyrOc35GgM+Hn02oi4fjqudDrSEDBw7EW2+95eIesjpvEnDF81GxYkX8+uuv2L17N+bOnWss63lzTF5vW0xDfi8COW/RokWFxinZFfMeeuih/HPyyyUvPj4+b+rUqca5VatW5fXu3Tv/+ogRI/I+/PDD/M984z8ESvJ8WEcvPkV5N910k/UjX/2QQEmfj8zMzLzOnTvnvf/++35IhUOyEijp82G9X18feOCBPHFyLngq4N77rWVEHhCbcubMGajptFu3bvllgoKCjM+rV682zmkq6N9++81Ymjl16hS+/vprqOWE4v8EHHk+/J8CR2iLgCPPh3yT4K677sJVV12FAQMG2KqK5/2QgCPPhzo3p6WlGaPXrPG67KM7NwNZQgJx8CkpKcYabrVq1QoNXz//+eefxrmQkBBMmzYNXbt2RW5uLh577LGA9nQuBMrPPzjyfCgCVWbVzKom25o1axrbNzt16uTndDg8R54PsaxCl4J1W6/VX23OnDlo3rw5Afo5AUeej71792Lo0KH5jqsPP/xwwD8bAamMOPpv4cYbb4QeFBIoisB3331X1GmeIwFcfvnlxo8YoiCBogio5X3z5s1FXQrYcwG5TKPb7HRrlZrKCop+1m14lMAmwOcjsOe/uNHz+SiOUGBf5/NRsvkPSGUkLCzMCEK0bNmyfGq6FKOfaWbPRxKwb/h8BOzUOzRwPh8OYQrYQnw+Sjb1frtMo06nO3bsyKei26fULFapUiUkJCQY23oHDRpkhORVk9n06dONtf/Bgwfn38M3/kuAz4f/zq0rRsbnwxUU/bcOPh9umFt/3T+kWy4F1wWHKCD5Q3711VfzRDHJE002T7f6rlmzJv8a3/g3AT4f/j2/pR0dn4/SEvTv+/l8uH5+mZvGDQoeqyQBEiABEiABEnCcQED6jDiOhyVJgARIgARIgATcTYDKiLsJs34SIAESIAESIAG7BKiM2MXDiyRAAiRAAiRAAu4mQGXE3YRZPwmQAAmQAAmQgF0CVEbs4uFFEiABEiABEiABdxOgMuJuwqyfBEiABEiABEjALgEqI3bx8CIJkAAJkAAJkIC7CVAZcTdh1k8CJEACJEACJGCXAJURu3h4kQRIwFUEunTpgpEjR7qqOtZDAiTgRwSojPjRZHIoJEACJEACJOCLBKiM+OKssc8kQAIkQAIk4EcEqIz40WRyKCRgdgJnz57FsGHDEB0djdjYWDzxxBOQlFtGt1977TU0bNgQ4eHhqFatGm6++WazD4f9IwEScBGBEBfVw2pIgARIoFgC7733Hu655x6sW7cOGzZswNChQyGZs9G6dWsMHz4cc+bMwaWXXopjx47hxx9/LLY+FiABEvAPAsza6x/zyFGQgOkJqANrcnIyfv/9d5QpU8bo79ixY/H5559j8uTJGDx4MA4cOIDy5cubfizsIAmQgGsJcJnGtTxZGwmQgB0CHTt2zFdEtFinTp2wfft2XH311ahduzbq1auHAQMG4MMPP0RGRoadmniJBEjAnwhQGfGn2eRYSMBHCURFRWHTpk2YN28e4uLiMGHCBLRs2RKpqak+OiJ2mwRIwBkCVEacocWyJEACpSKwdu3aQvevWbPGcFoNDg5GSEgIunXrhueeew5btmzBnj178P333xcqzw8kQAL+SYAOrP45rxwVCZiSwL59+zBq1Cjcd999hiXk1VdfxbRp0/Dll19i165duOKKKxATE4OvvvoKubm5aNy4sSnHwU6RAAm4lgCVEdfyZG0kQAJ2CAwcOBCnT59G+/btodaQESNGGDtqVq1ahYULF2LSpEnIzMw0rCW6ZNO0aVM7tfESCZCAvxDgbhp/mUmOgwRIgARIgAR8lAB9Rnx04thtEiABEiABEvAXAlRG/GUmOQ4SIAESIAES8FECVEZ8dOLYbRIgARIgARLwFwJURvxlJjkOEiABEiABEvBRAlRGfHTi2G0SIAESIAES8BcCVEb8ZSY5DhIgARIgARLwUQJURnx04thtEiABEiABEvAXAlRG/GUmOQ4SIAESIAES8FECVEZ8dOLYbRIgARIgARLwFwJURvxlJjkOEiABEiABEvBRAlRGfHTi2G0SIAESIAES8BcCVEb8ZSY5DhIgARIgARLwUQL/D5P8h4vh0nDsAAAAAElFTkSuQmCC" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="image.png"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/data:image/png;base64,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" class="img-fluid figure-img" alt="image.png"></a></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<p><strong>xse_resnext50</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="data:image/png;base64,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" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="image.png"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/data:image/png;base64,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" class="img-fluid figure-img" alt="image.png"></a></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<blockquote class="blockquote">
<p>small batch sizes (e.g., 2 to 32) can be more robust to learning rate choices</p>
</blockquote>
<p>I witnessed the second point during my training runs as well. For xresnet34 and a batch size of 8 or 16, the difference in accuracy between learning rates of 1e-4, 1e-3 and 1e-2 was 10%. For a batch size of 1024, the difference in accuracy was 40%. xresnet18 had a similar trend while xse_resnext50 was more robust to changes in learning rates (1e-4, 1e-3, 1e-2) as the accuracy varied about 10-20% across batch sizes of 2 to 1024. In the charts above, this is visualized by the diverging LR curves as batch size increases.</p>
<blockquote class="blockquote">
<p>A learning rate warm-up strategy, where training begins with a very small learning rate that is gradually increased to its target value over a few initial epochs, can significantly stabilize the early phases of training.</p>
</blockquote>
<p>My training runs already did this by default (using fastai’s <code>Learner</code> and <code>vision_learner</code>), though I haven’t experimented with any available parameters related to this (e.g.&nbsp;number of warmup steps).</p>
<blockquote class="blockquote">
<p>The optimal learning rate strategy is non-linear, optimizer-dependent, and may require empirical tuning guided by these more nuanced theoretical understandings.</p>
</blockquote>
</section>
<section id="alternative-forms-of-normalization" class="level3">
<h3 class="anchored" data-anchor-id="alternative-forms-of-normalization">Alternative Forms of Normalization</h3>
<p>Gemini found in its research that alternative forms of normalization (other than Batch Normalization) can improve small batch size performance. Most notably, in the Group Normalization paper they found that Group Normalization resulted in a 10% lower error rate than Batch Normalization for small batch sizes. Group Normalization calculates mean and variance for a group of channels for a single image, thereby being <em>batch independent</em>, so a small batch size doesn’t make the statistics any noisier (as is the case for Batch Normalization where the mean and variance are calculated across all images in the batch). However, there’s two sides to this trade-off. As the paper states:</p>
<blockquote class="blockquote">
<p>BN’s mean and variance computation introduces uncertainty caused by the stochastic batch sampling, which helps regularization. This uncertainty is missing in GN (and LN/IN). But it is possible that GN combined with a suitable regularizer will improve results. This can be a future research topic.</p>
</blockquote>
<p>Gemini also suggests Layer Normalization (calculating mean and variance across all channels for a single image) and Instance Normalization (across a single channel for a single image) as these are both also batch independent. However, the Group Normalization paper finds that these two perform worse than Group Normalization.</p>
</section>
<section id="optimizers-and-regularization" class="level3">
<h3 class="anchored" data-anchor-id="optimizers-and-regularization">Optimizers and Regularization</h3>
<p>Finally, Gemini suggested to try out different optimizers (and tuning their hyperparameters) and regularization techniques (weight decay, data augmentation), both things I wanted to experiment with going into this project.</p>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>Based on Gemini’s research and my reading of the Group Normalization paper I plan on experimenting on the following:</p>
<ul>
<li>Replace Batch Normalization layers with Group Normalization.</li>
<li>Add a regularization method like weight decay.</li>
<li>Try out different optimizers using Benjamin Warner’s <a href="https://optimi.benjaminwarner.dev/">optimi</a> library.</li>
<li>Try out different data augmentation techniques from Benjamin Warner’s <a href="https://fastxtend.benjaminwarner.dev/vision.augment.batch.html">fastxtend</a> library.</li>
</ul>
<p>At each step, I use <code>lr_find</code> and sample three stable LRs, and focus on small batch sizes of {2, 4, 8, 16, 32, 64}. I’m particularly interested in seeing how these experiments affect the three models I’m using (xresnet18, xresnet34, xse_resnext50) as xse_resnext50 was more robust to larger LRs than the other two.</p>
<p>I’ll be documenting my findings in blog posts as well as on my <a href="https://www.youtube.com/@vishal_learner">YouTube channel</a> so please subscribe to follow along!</p>


</section>

 ]]></description>
  <category>python</category>
  <category>fastai</category>
  <category>imagenette</category>
  <category>TinyScaleLab</category>
  <category>deep learning</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-18-small-batch-report/</guid>
  <pubDate>Wed, 18 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>An Analysis of Batch Size vs. Learning Rate on Imagenette</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.vision.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.callback.wandb <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> WandbCallback</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> wandb</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span></code></pre></div>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In <a href="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/">my previous blog post</a> and <a href="https://youtu.be/5xCUEaowcTE">video</a> I worked through my initial imagenette experiments.</p>
<blockquote class="blockquote">
<p>Imagenette is a subset of 10 easily classified classes from Imagenet (tench, English springer, cassette player, chain saw, church, French horn, garbage truck, gas pump, golf ball, parachute).</p>
</blockquote>
<p>With a batch size of 64 and three different LRs (1e-4, 1e-3, 1e-2) I achieved the following results using three models (xresnet34, xse_resnext50, xresnet18):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Model/Learning Rate</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">xresnet34/1e-2</td>
<td style="text-align: center;">0.7929</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-2</td>
<td style="text-align: center;">0.7926</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-2</td>
<td style="text-align: center;">0.7870</td>
</tr>
<tr class="even">
<td style="text-align: center;">xresnet34/1e-3</td>
<td style="text-align: center;">0.7776</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-3</td>
<td style="text-align: center;">0.7743</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-3</td>
<td style="text-align: center;">0.7526</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-1</td>
<td style="text-align: center;">0.7373</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-4</td>
<td style="text-align: center;">0.6532</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet34/1e-4</td>
<td style="text-align: center;">0.6446</td>
</tr>
<tr class="even">
<td style="text-align: center;">xresnet18/1e-4</td>
<td style="text-align: center;">0.6171</td>
</tr>
</tbody>
</table>
<p>There was a hierarchy of LRs: 1e-2 performed best, followed by 1e-3 and 1e-4.</p>
<p>In this notebook I’m going to expand my training runs to more batch sizes: [1, 2, 4, 8, 16, 32, 64, 128, 256, 512, 1024, 2048]. In each case, I’ll use <code>lr_find</code> to determine three stable learning rates.</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<div id="cell-7" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb2-3">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.read_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/content/2025-06-04-imagenette-runs.csv"</span>)</span>
<span id="cb2-4">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"run"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: x.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb2-5">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"run"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: x.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]).astype(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>)</span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _lr(x):</span>
<span id="cb2-8">    _map <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"05"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"06"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-6"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"07"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.0001"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.001"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.01"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.1"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-1"</span>}</span>
<span id="cb2-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> _map[x.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb2-10"></span>
<span id="cb2-11">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"run"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: _lr(x))</span>
<span id="cb2-12">df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Categorical(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], categories<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-7"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-6"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-5"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-4"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-3"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1e-1"</span>])</span></code></pre></div>
</div>
<p>In total there were 123 training runs.</p>
<div id="cell-9" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8d4136e7-853b-4711-a504-aeb14b3ff108" data-execution_count="10">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">df.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(123, 5)</code></pre>
</div>
</div>
<p>The best training run goes to xresnet34 with a batch size of 16 and a learning rate of 1e-3.</p>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:81}}" data-outputid="2e30e554-1c1a-495f-9be6-aa7b0fe29193" data-execution_count="11">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">df[df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'acc'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'acc'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>()]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div id="df-bd697f8f-dc53-42ec-9e0e-ea34025e8e15" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">acc</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th">lr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>imagenette-xresnet34-bs-16-lr-0.001</td>
<td>0.800764</td>
<td>xresnet34</td>
<td>16</td>
<td>1e-3</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bd697f8f-dc53-42ec-9e0e-ea34025e8e15')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bd697f8f-dc53-42ec-9e0e-ea34025e8e15 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bd697f8f-dc53-42ec-9e0e-ea34025e8e15');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
</div>
<p>The top 10 training runs were for a LR of 1e-3 or 1e-2.</p>
<div id="cell-13" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:363}}" data-outputid="c8fa0fa4-c586-4b1c-c1cd-c541e1b8a267" data-execution_count="12">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">df.sort_values(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>, ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>).head(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div id="df-77f8aa8d-c052-47a9-9bb5-915ebc8e4364" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">run</th>
<th data-quarto-table-cell-role="th">acc</th>
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th">lr</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">9</td>
<td>imagenette-xresnet34-bs-16-lr-0.001</td>
<td>0.800764</td>
<td>xresnet34</td>
<td>16</td>
<td>1e-3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">66</td>
<td>imagenette-xresnet18-bs-32-lr-0.01</td>
<td>0.799745</td>
<td>xresnet18</td>
<td>32</td>
<td>1e-2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75</td>
<td>imagenette-xresnet18-bs-64-lr-0.01</td>
<td>0.797452</td>
<td>xresnet18</td>
<td>64</td>
<td>1e-2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>imagenette-xresnet18-bs-16-lr-0.01</td>
<td>0.796433</td>
<td>xresnet18</td>
<td>16</td>
<td>1e-2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>imagenette-xresnet18-bs-8-lr-0.001</td>
<td>0.795414</td>
<td>xresnet18</td>
<td>8</td>
<td>1e-3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25</td>
<td>imagenette-xresnet34-bs-8-lr-0.001</td>
<td>0.795414</td>
<td>xresnet34</td>
<td>8</td>
<td>1e-3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>imagenette-xresnet34-bs-16-lr-0.01</td>
<td>0.795159</td>
<td>xresnet34</td>
<td>16</td>
<td>1e-2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">84</td>
<td>imagenette-xresnet18-bs-128-lr-0.01</td>
<td>0.791338</td>
<td>xresnet18</td>
<td>128</td>
<td>1e-2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">76</td>
<td>imagenette-xresnet34-bs-64-lr-0.01</td>
<td>0.790573</td>
<td>xresnet34</td>
<td>64</td>
<td>1e-2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">67</td>
<td>imagenette-xresnet34-bs-32-lr-0.01</td>
<td>0.789554</td>
<td>xresnet34</td>
<td>32</td>
<td>1e-2</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-77f8aa8d-c052-47a9-9bb5-915ebc8e4364')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-77f8aa8d-c052-47a9-9bb5-915ebc8e4364 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-77f8aa8d-c052-47a9-9bb5-915ebc8e4364');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-cea70ab5-c2c5-42c0-a9aa-2d37f96325b0">
      <button class="colab-df-quickchart" onclick="quickchart('df-cea70ab5-c2c5-42c0-a9aa-2d37f96325b0')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-cea70ab5-c2c5-42c0-a9aa-2d37f96325b0 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<p>All three models achieved a max accuracy within 1.2% of each other.</p>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:210}}" data-outputid="1bff0dea-551a-4909-d258-99917c965ff5" data-execution_count="14">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">df.groupby([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model"</span>])[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().sort_values(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">acc</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">model</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">xresnet34</td>
<td>0.800764</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">xresnet18</td>
<td>0.799745</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">xse_resnext50</td>
<td>0.788280</td>
</tr>
</tbody>
</table>

</div><br><label><b>dtype:</b> float64</label>
</div>
</div>
<p>A batch size of 16 yielded the highest accuracy, with 8, 32, 64 and 128 within 1%. Accuracy drops significantly for a batch size of 1, 1024 and 2048 showing that too large or too small a batch size is detrimental to training.</p>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:492}}" data-outputid="aca37107-cb01-462f-d674-f85c9ce8b482" data-execution_count="16">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">df.groupby([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>])[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().sort_values(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">acc</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">16</td>
<td>0.800764</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32</td>
<td>0.799745</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">64</td>
<td>0.797452</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">8</td>
<td>0.795414</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">128</td>
<td>0.791338</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4</td>
<td>0.784968</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">256</td>
<td>0.764841</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">512</td>
<td>0.731975</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.719745</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1024</td>
<td>0.662166</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2048</td>
<td>0.485350</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.452229</td>
</tr>
</tbody>
</table>

</div><br><label><b>dtype:</b> float64</label>
</div>
</div>
<p>As we saw earlier, the highest accuracy was achieved with a learning rate of 1e-3, with 1e-2 right on its tail.</p>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:304}}" data-outputid="4ed7d42b-5d78-43c1-bade-052f414da0ed" data-execution_count="18">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">df.groupby([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], observed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>().sort_values(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">acc</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lr</th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-3</td>
<td>0.800764</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-2</td>
<td>0.799745</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-4</td>
<td>0.715414</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-5</td>
<td>0.526624</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-6</td>
<td>0.304713</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-7</td>
<td>0.150828</td>
</tr>
</tbody>
</table>

</div><br><label><b>dtype:</b> float64</label>
</div>
</div>
<p>Finally, I’ll look at the maximum accuracy achieved for each model/learning rate/batch size combination.</p>
<p>For xresnet18, some interesting patterns:</p>
<ul>
<li>For each learning rate, the maximum accuracy increases up to a point, then decreases, illustrating how batch sizes too small or too large lead to worse performance
<ul>
<li>1e-4: acc increases up to bs=8 then decreases</li>
<li>1e-3: acc increases up to bs=8 then decreases</li>
<li>1e-2: acc increases up to bs=32 then decreases</li>
</ul></li>
</ul>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:175}}" data-outputid="53e68ba5-db55-4fcf-f64e-2de3b94683f5" data-execution_count="21">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.query(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model == 'xresnet18'"</span>)</span>
<span id="cb10-2">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<div id="df-a8a72bd5-679d-4766-8624-a87fadf17809" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">32</th>
<th data-quarto-table-cell-role="th">64</th>
<th data-quarto-table-cell-role="th">128</th>
<th data-quarto-table-cell-role="th">256</th>
<th data-quarto-table-cell-role="th">512</th>
<th data-quarto-table-cell-role="th">1024</th>
<th data-quarto-table-cell-role="th">2048</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lr</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-4</td>
<td>0.388535</td>
<td>0.608153</td>
<td>0.693503</td>
<td>0.704968</td>
<td>0.698089</td>
<td>0.665478</td>
<td>0.624713</td>
<td>0.512102</td>
<td>0.400000</td>
<td>0.310318</td>
<td>0.146497</td>
<td>0.000255</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-3</td>
<td>0.452229</td>
<td>0.709809</td>
<td>0.778344</td>
<td>0.795414</td>
<td>0.789299</td>
<td>0.784968</td>
<td>0.769427</td>
<td>0.744713</td>
<td>0.719236</td>
<td>0.647389</td>
<td>0.544459</td>
<td>0.336306</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-2</td>
<td>0.285605</td>
<td>0.649682</td>
<td>0.738089</td>
<td>0.778089</td>
<td>0.796433</td>
<td>0.799745</td>
<td>0.797452</td>
<td>0.791338</td>
<td>0.747006</td>
<td>0.731975</td>
<td>0.661147</td>
<td>0.485350</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a8a72bd5-679d-4766-8624-a87fadf17809')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a8a72bd5-679d-4766-8624-a87fadf17809 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a8a72bd5-679d-4766-8624-a87fadf17809');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-196b94d7-b776-402c-85a0-8001c541b87f">
      <button class="colab-df-quickchart" onclick="quickchart('df-196b94d7-b776-402c-85a0-8001c541b87f')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-196b94d7-b776-402c-85a0-8001c541b87f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<p><strong>xresnet18</strong></p>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:454}}" data-outputid="d3906c9e-8828-4625-b89c-4e4fc9dc3488" data-execution_count="22">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).T.plot(logx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-11-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/index_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We see a similar pattern for xresnet34:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">lr</th>
<th style="text-align: center;">Inflection point (bs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1e-7</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-6</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1e-5</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-4</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1e-3</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-2</td>
<td style="text-align: center;">16</td>
</tr>
</tbody>
</table>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}}" data-outputid="69811696-90e6-49a5-f85d-68a2c7fbfcf1" data-execution_count="23">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.query(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model == 'xresnet34'"</span>)</span>
<span id="cb12-2">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div id="df-20fd735d-8058-4aeb-ae6c-3a7dc3eee40d" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">32</th>
<th data-quarto-table-cell-role="th">64</th>
<th data-quarto-table-cell-role="th">128</th>
<th data-quarto-table-cell-role="th">256</th>
<th data-quarto-table-cell-role="th">512</th>
<th data-quarto-table-cell-role="th">1024</th>
<th data-quarto-table-cell-role="th">2048</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lr</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-7</td>
<td>NaN</td>
<td>0.109554</td>
<td>0.109045</td>
<td>0.087389</td>
<td>0.100892</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-6</td>
<td>NaN</td>
<td>0.243822</td>
<td>0.180127</td>
<td>0.201274</td>
<td>0.159236</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-5</td>
<td>NaN</td>
<td>0.385478</td>
<td>0.456051</td>
<td>0.446879</td>
<td>0.428535</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-4</td>
<td>0.388535</td>
<td>0.597962</td>
<td>0.704459</td>
<td>0.709809</td>
<td>0.715414</td>
<td>0.680764</td>
<td>0.641529</td>
<td>0.560510</td>
<td>0.489172</td>
<td>0.393376</td>
<td>0.269299</td>
<td>0.212229</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-3</td>
<td>0.403567</td>
<td>0.719745</td>
<td>0.784968</td>
<td>0.795414</td>
<td>0.800764</td>
<td>0.787261</td>
<td>0.765860</td>
<td>0.751592</td>
<td>0.728408</td>
<td>0.667771</td>
<td>0.580127</td>
<td>0.430828</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-2</td>
<td>0.246624</td>
<td>0.638217</td>
<td>0.721019</td>
<td>0.776306</td>
<td>0.795159</td>
<td>0.789554</td>
<td>0.790573</td>
<td>0.787006</td>
<td>0.764841</td>
<td>0.723312</td>
<td>0.662166</td>
<td>0.385732</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-20fd735d-8058-4aeb-ae6c-3a7dc3eee40d')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-20fd735d-8058-4aeb-ae6c-3a7dc3eee40d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-20fd735d-8058-4aeb-ae6c-3a7dc3eee40d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7ffdc5c0-ac7a-4ac5-8e6a-abd0a21467a8">
      <button class="colab-df-quickchart" onclick="quickchart('df-7ffdc5c0-ac7a-4ac5-8e6a-abd0a21467a8')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7ffdc5c0-ac7a-4ac5-8e6a-abd0a21467a8 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<p><strong>xresnet34</strong></p>
<div id="cell-28" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:454}}" data-outputid="926c22f9-ed42-4eba-81ef-f61a16f7884e" data-execution_count="24">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).T.plot(logx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-13-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/index_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>And a similar pattern for xse_resnext50 as well:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">lr</th>
<th style="text-align: center;">Inflection point (bs)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1e-7</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-6</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1e-5</td>
<td style="text-align: center;">–</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-4</td>
<td style="text-align: center;">8</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1e-3</td>
<td style="text-align: center;">16</td>
</tr>
<tr class="even">
<td style="text-align: center;">1e-2</td>
<td style="text-align: center;">32</td>
</tr>
</tbody>
</table>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:269}}" data-outputid="bb96c37f-36d4-4ad4-ef06-4ad434436263" data-execution_count="25">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> df.query(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"model == 'xse_resnext50'"</span>)</span>
<span id="cb14-2">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div id="df-0c642622-075f-4525-b8d2-f0b575de9eb9" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">bs</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">32</th>
<th data-quarto-table-cell-role="th">64</th>
<th data-quarto-table-cell-role="th">128</th>
<th data-quarto-table-cell-role="th">256</th>
<th data-quarto-table-cell-role="th">512</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">lr</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-7</td>
<td>0.106497</td>
<td>0.127389</td>
<td>0.150828</td>
<td>0.126624</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-6</td>
<td>0.117452</td>
<td>0.234395</td>
<td>0.291465</td>
<td>0.304713</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-5</td>
<td>0.239745</td>
<td>0.420127</td>
<td>0.502675</td>
<td>0.526624</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-4</td>
<td>0.203057</td>
<td>0.568917</td>
<td>0.661147</td>
<td>0.660382</td>
<td>0.652229</td>
<td>0.639236</td>
<td>0.623949</td>
<td>0.601019</td>
<td>0.575541</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1e-3</td>
<td>0.186752</td>
<td>0.642803</td>
<td>0.766624</td>
<td>0.774267</td>
<td>0.768917</td>
<td>0.743694</td>
<td>0.720510</td>
<td>0.699363</td>
<td>0.671847</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1e-2</td>
<td>0.140637</td>
<td>0.263185</td>
<td>0.564586</td>
<td>0.736306</td>
<td>0.788280</td>
<td>0.770701</td>
<td>0.776306</td>
<td>0.763567</td>
<td>0.725605</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0c642622-075f-4525-b8d2-f0b575de9eb9')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0c642622-075f-4525-b8d2-f0b575de9eb9 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0c642622-075f-4525-b8d2-f0b575de9eb9');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-713a171e-198c-4f12-b708-12d592f77d1d">
      <button class="colab-df-quickchart" onclick="quickchart('df-713a171e-198c-4f12-b708-12d592f77d1d')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-713a171e-198c-4f12-b708-12d592f77d1d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<p><strong>xse_xresnet50</strong></p>
<p>Looking at the accuracy curves for xse_resnext50 we see that it’s more robust to larger batch sizes (the accuracy tapers off slower than xresnet34 and xresnet18 as batch size increases past the inflection point).</p>
<div id="cell-33" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:454}}" data-outputid="dd37f3b1-85fe-45d0-b83e-cb3c9652442b" data-execution_count="26">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">pd.crosstab(df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lr"</span>], _df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bs"</span>], values<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"acc"</span>], aggfunc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>).sort_index(ascending<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).T.plot(logx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-15-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/index_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>I posted my initial musing (after I had analyzed results for batch sizes 32 to 2048) that lowering the batch size might continue to yield higher accuracy. Jeremy validated this approach:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
That’s a great question! Stable low bs training isn’t easy, but it’s a good plan :)
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1930486029607416069?ref_src=twsrc%5Etfw">June 5, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>I recently started using Gemini Pro 2.5 (preview), and hadn’t yet tried out its Deep Research tool. I thought this would be an excellent opportunity to do so. I prompted Gemini with the following:</p>
<blockquote class="blockquote">
<p>I recently have been training xresnet18, xresnet34 and xse_resnext50 on the Imagenette dataset by fast.ai (which is a 10k subset of ImageNet with 10 easily classified classes). I have trained on batch sizes from 1 to 2048. Generally speaking, the highest accuracy achieved increases from a batch size of 1 to a batch size of 8, 16 or 32 (depending on the model/learning rate) and then decreases as batch size increases to 2048. This makes me want to explore small batch size training for this project. Jeremy Howard tweeted that “Stable low bs training isn’t easy, but it’s a good plan”. I want you to help me answer two questions in this chat:</p>
<ol type="1">
<li><p>Why is stable low batch size training difficult?</p></li>
<li><p>What techniques are there (either in literature/arxiv, blog posts or forums) to make low batch size training stable? I’m most interested in improving the accuracy of low batch size trainings.</p></li>
</ol>
</blockquote>
<p>I also prompted Allen AI’s <a href="https://paperfinder.allen.ai/chat/606ffc67-5539-47a9-8c8a-ec5820666ccc?profile=paper-finder-only">Paper Finder</a> with:</p>
<blockquote class="blockquote">
<p>strategies to make low batch size training more stable and improve accuracy for image recognition</p>
</blockquote>
<p>I have shared the Gemini Deep Research and Ai2 Paper Finder findings in <a href="">another blog post</a>.</p>
<p>Imagenette will unlock an entire new lane of research and experimentation for me, helping me towards my <a href="https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/">TinyScaleLab project goal</a> of training and analyzing high performant tiny language models.</p>
<p>Lastly, I’m growing my YouTube channel so if you haven’t already, please check it out and <a href="https://www.youtube.com/@vishal_learner">subscribe</a>!</p>
</section>
<section id="appendix-training-code" class="level2">
<h2 class="anchored" data-anchor-id="appendix-training-code">Appendix: Training Code</h2>
<p>Since I’m going to run a significantly larger number of trainings than my initial notebook, I’ll wrap my code into functions/dictionaries for a tighter loop, similar to what Jeremy did in his <a href="https://www.kaggle.com/code/jhoward/scaling-up-road-to-the-top-part-3?scriptVersionId=99313071&amp;cellId=31">Scaling Up: Road to the Top, Part 3</a> notebook.</p>
<p>I ran <code>lr_find</code> for each model/batch size combination and checked that for all combinations, the loss curve was stable for the selected learning rates.</p>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:37}}" data-outputid="d8684f08-2d75-4679-bf77-4a8360d5a756">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> untar_data(URLs.IMAGENETTE_160)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="99008512" class="" max="99003388" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.01% [99008512/99003388 00:02&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-42" class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">lbl_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb17-2">    n01440764<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tench'</span>,</span>
<span id="cb17-3">    n02102040<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'English springer'</span>,</span>
<span id="cb17-4">    n02979186<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cassette player'</span>,</span>
<span id="cb17-5">    n03000684<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'chain saw'</span>,</span>
<span id="cb17-6">    n03028079<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'church'</span>,</span>
<span id="cb17-7">    n03394916<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'French horn'</span>,</span>
<span id="cb17-8">    n03417042<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'garbage truck'</span>,</span>
<span id="cb17-9">    n03425413<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gas pump'</span>,</span>
<span id="cb17-10">    n03445777<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'golf ball'</span>,</span>
<span id="cb17-11">    n03888257<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parachute'</span></span>
<span id="cb17-12">)</span></code></pre></div>
</div>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">imagenette <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataBlock(blocks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ImageBlock, CategoryBlock),</span>
<span id="cb18-2">                       get_items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_image_files,</span>
<span id="cb18-3">                       get_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pipeline([parent_label, lbl_dict.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__getitem__</span>]),</span>
<span id="cb18-4">                       splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GrandparentSplitter(valid_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>),</span>
<span id="cb18-5">                       item_tfms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomResizedCrop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>, min_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>),</span>
<span id="cb18-6">                       batch_tfms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Normalize.from_stats(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>imagenet_stats))</span></code></pre></div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _dls(bs): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> imagenette.dataloaders(path, bs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>bs)</span></code></pre></div>
</div>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="618ee92e-6b22-4fe4-c71c-3c5fab4c5c3e">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">_dls(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>).bs, _dls(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>).bs, _dls(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>).bs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(64, 128, 256)</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:752}}" data-outputid="785bbfd1-dc53-45c7-ae6b-d7ed244e2e18">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">_dls(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>).show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-21-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/index_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-47" class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">models <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet34'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet18'</span>]</span></code></pre></div>
</div>
<div id="cell-48" class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#batch_sizes = (32, 64, 128, 256, 512, 1024, 2048)</span></span>
<span id="cb24-2">batch_sizes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb24-3">lrs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>)</span></code></pre></div>
</div>
<div id="cell-49" class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">wandb.login()</span></code></pre></div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bs <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> batch_sizes:</span>
<span id="cb26-2">    dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _dls(bs)</span>
<span id="cb26-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> dls.bs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> bs</span>
<span id="cb26-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> model <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> models:</span>
<span id="cb26-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> bs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># avoid Expected more than 1 value per channel when training, got input size torch.Size([1, 4096])</span></span>
<span id="cb26-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lr <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> lrs:</span>
<span id="cb26-7">            wandb.init(</span>
<span id="cb26-8">                project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb26-9">                name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"imagenette-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-bs-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-lr-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>lr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb26-10">                tags<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"bs=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"model=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"lr=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>lr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>]</span>
<span id="cb26-11">                )</span>
<span id="cb26-12">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb26-13">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet18'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb26-14">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet34'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb26-15"></span>
<span id="cb26-16">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> learn.no_logging() <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> learn.no_mbar(): learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, lr)</span>
<span id="cb26-17">            wandb.finish()</span></code></pre></div>
</div>
<p>Using <code>lr_find</code>, I found that xresnet18 was stable for 1e-4, 1e-3 and 1e-2 LRs but the other two were not. Instead, they were stable for LRs of 1e-7, 1e-6 and 1e-5. So I ran training runs for those two models and LRs for batch sizes of 2, 4, 8 and 16.</p>
<div id="cell-52" class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bs <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> batch_sizes:</span>
<span id="cb27-2">    dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _dls(bs)</span>
<span id="cb27-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> dls.bs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> bs</span>
<span id="cb27-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> model <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet34'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span>]:</span>
<span id="cb27-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> bs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># avoid Expected more than 1 value per channel when training, got input size torch.Size([1, 4096])</span></span>
<span id="cb27-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> lr <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-6</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>]:</span>
<span id="cb27-7">            wandb.init(</span>
<span id="cb27-8">                project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb27-9">                name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"imagenette-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-bs-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-lr-</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>lr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb27-10">                tags<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"bs=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>bs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"model=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>model<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"lr=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>lr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>]</span>
<span id="cb27-11">                )</span>
<span id="cb27-12">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xse_resnext50'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb27-13">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet18'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb27-14">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xresnet34'</span>: learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb27-15"></span>
<span id="cb27-16">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> learn.no_logging() <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> learn.no_mbar(): learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, lr)</span>
<span id="cb27-17">            wandb.finish()</span></code></pre></div>
</div>


</section>

 ]]></description>
  <category>python</category>
  <category>fastai</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <category>imagenette</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-18-imagenette/</guid>
  <pubDate>Wed, 18 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Cross Entropy Loss Explained</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>As I’ve been preparing to build <a href="https://vishalbakshi.github.io/blog/index.html#category=TinyScaleLab">highly performant tiny LMs</a>, I realized I needed a refresher on how Cross-Entropy loss works. In this notebook I’m revisiting <a href="https://github.com/fastai/fastbook/blob/master/05_pet_breeds.ipynb">Chapter 5 of fastbook</a> to walk through the code and concepts introduced to build intuition around this loss function.</p>
<p>I was motivated to work on this refresher because I wanted to better visualize with a concrete example how small batch training can lead to noisy gradients.</p>
</section>
<section id="multi-class-classification" class="level2">
<h2 class="anchored" data-anchor-id="multi-class-classification">Multi-Class Classification</h2>
<p>We are going to focus on a single-label, multiple class classification problem using the PETS dataset.</p>
<div id="cell-5" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:37}}" data-outputid="916a6aea-9fc1-4095-a00d-b2d4462f90ed">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.vision.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-2">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> untar_data(URLs.PETS)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="811712512" class="" max="811706944" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.00% [811712512/811706944 00:14&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-6" class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">pets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataBlock(blocks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ImageBlock, CategoryBlock),</span>
<span id="cb2-2">                 get_items<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>get_image_files,</span>
<span id="cb2-3">                 splitter<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>RandomSplitter(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>),</span>
<span id="cb2-4">                 get_y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>using_attr(RegexLabeller(<span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">r'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">(</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">.</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">)</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">\d</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">.</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">jpg</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">$</span><span class="vs" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'name'</span>),</span>
<span id="cb2-5">                 item_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Resize(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">460</span>),</span>
<span id="cb2-6">                 batch_tfms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>aug_transforms(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">224</span>, min_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>))</span>
<span id="cb2-7">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pets.dataloaders(path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"images"</span>)</span></code></pre></div>
</div>
<div id="cell-7" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:230}}" data-outputid="960ea3d6-91e1-47f4-9ddb-cfa755ef7c81">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, resnet34, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>error_rate)</span>
<span id="cb3-2">learn.fine_tune(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Downloading: "https://download.pytorch.org/models/resnet34-b627a593.pth" to /root/.cache/torch/hub/checkpoints/resnet34-b627a593.pth
100%|██████████| 83.3M/83.3M [00:00&lt;00:00, 138MB/s]</code></pre>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.499396</td>
<td>0.378620</td>
<td>0.125169</td>
<td>01:07</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">error_rate</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.536576</td>
<td>0.329664</td>
<td>0.104871</td>
<td>01:08</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.326150</td>
<td>0.241802</td>
<td>0.078484</td>
<td>01:08</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Inspecting one batch, we see that the inputs are a batch of 64 3-channel 224x224 pixel images, and the targets are integers (between 0 and 36, the number of pet classes in the dataset)</p>
<div id="cell-9" class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">x,y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dls.one_batch()</span></code></pre></div>
</div>
<div id="cell-10" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="33f8f547-092a-488e-a111-dcc96b36d461">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">x.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>torch.Size([64, 3, 224, 224])</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3633a063-2f52-47f0-e469-9362a45be99a">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">y</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>TensorCategory([23, 13, 25,  3, 16, 31, 34,  8,  9, 20, 19, 10,  6, 19, 33, 35,
                34, 19, 18, 29, 26, 34, 24, 30, 31,  2,  3, 20, 28, 29,  0, 11,
                22, 31,  3, 36, 15, 16,  0, 18, 32, 17,  3, 18, 16,  6, 16,  2,
                32,  0,  9, 26, 26, 35, 18,  4, 36,  5, 17,  0, 11, 27, 21, 35],
               device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b4a33fcf-0b37-44c9-b9a3-cc80678a5273">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">y.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>torch.Size([64])</code></pre>
</div>
</div>
<p>Passing this batch to the trained model we get back 37 predictions for each item in the batch.</p>
<div id="cell-14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:138}}" data-outputid="d002ca06-5bda-43f9-e418-fec34d0b2f52">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">preds,_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> learn.get_preds(dl<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[(x,y)])</span>
<span id="cb12-2">preds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>tensor([2.0166e-08, 1.0262e-06, 6.8535e-06, 2.8387e-06, 7.7887e-08, 1.4034e-07,
        4.1744e-07, 9.1272e-06, 1.0166e-05, 1.3550e-07, 5.2067e-08, 3.7820e-06,
        4.2456e-06, 1.2272e-08, 1.2251e-07, 1.4040e-07, 7.0171e-06, 4.2623e-04,
        1.3611e-07, 7.3574e-08, 1.6146e-08, 5.0945e-06, 8.1139e-06, 9.9821e-01,
        4.9108e-05, 3.4051e-06, 7.8016e-09, 2.8509e-07, 1.0994e-03, 1.3271e-06,
        1.4462e-04, 4.8486e-07, 1.3296e-07, 7.4560e-07, 6.1535e-08, 7.6703e-07,
        9.5345e-07])</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6b69e953-00de-43f1-bbd2-3e4379dd465a">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">preds.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>torch.Size([64, 37])</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4a8779a2-b7f7-40cf-c5bc-2cdbdecb7913">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">x.shape, y.shape, preds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(torch.Size([64, 3, 224, 224]), torch.Size([64]), torch.Size([37]))</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="73e26c69-068c-4d62-e704-3a365b6fee15">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(preds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]),preds[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>(37, tensor(1.))</code></pre>
</div>
</div>
<p>The predictions for each batch item sum to <code>1.0</code>.</p>
</section>
<section id="building-up-cross-entropy-loss" class="level2">
<h2 class="anchored" data-anchor-id="building-up-cross-entropy-loss">Building Up Cross-Entropy Loss</h2>
<p>We’ll work through a simpler example: binary classification with two classes (and thus two model outputs/activations).</p>
<div id="cell-21" class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">torch.random.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
</div>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2cf74b04-4eda-4dfe-8af7-475b9c628d44">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb21-2">acts</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>tensor([[ 0.6734,  0.2576],
        [ 0.4689,  0.4607],
        [-2.2457, -0.3727],
        [ 4.4164, -1.2760],
        [ 0.9233,  0.5347],
        [ 1.0698,  1.6187]])</code></pre>
</div>
</div>
<p>We want each row (batch item) to sum to 1.0. In other words, we want to turn these activations into probabilities. Passing each item through sigmoid does not help. While it does constrain the value to 0 and 1 it does so independently across the two classes so they don’t add up to 1.0.</p>
<div id="cell-24" class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_function(f, tx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, ty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)):</span>
<span id="cb23-2">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>)</span>
<span id="cb23-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>)</span>
<span id="cb23-4">    x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb23-5">    fig,ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>figsize)</span>
<span id="cb23-6">    ax.plot(x,f(x))</span>
<span id="cb23-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tx <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: ax.set_xlabel(tx)</span>
<span id="cb23-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ty <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: ax.set_ylabel(ty)</span>
<span id="cb23-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> title <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: ax.set_title(title)</span></code></pre></div>
</div>
<div id="cell-25" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:368}}" data-outputid="11a3618a-ebe2-49c2-937f-82be1c97eebb">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">plot_function(f<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.sigmoid, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-16-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/index_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3546e7a1-76ee-4404-98de-87468b39dcbb">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">acts.sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>tensor([[0.6623, 0.5641],
        [0.6151, 0.6132],
        [0.0957, 0.4079],
        [0.9881, 0.2182],
        [0.7157, 0.6306],
        [0.7446, 0.8346]])</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2c5c3e3c-892d-4292-cd84-8997dba4b3a0">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">acts[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>tensor(0.6623)</code></pre>
</div>
</div>
<p>However, taking the difference <em>between the class activations</em> and then passing that through the sigmoid does give us our desired result: probabilities that sum up to 1.0 across classes for each batch item.</p>
<div id="cell-29" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e9b1877f-f9fb-4dd6-f59e-d79f755693ac">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">(acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>tensor([0.6025, 0.5021, 0.1332, 0.9966, 0.5959, 0.3661])</code></pre>
</div>
</div>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a57c5464-916e-4088-809c-c728e94b0b4d">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">(acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>tensor([0.3975, 0.4979, 0.8668, 0.0034, 0.4041, 0.6339])</code></pre>
</div>
</div>
<div id="cell-31" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4a8f3e27-8877-42af-eba9-2fa12ffd447c">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">(acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).sigmoid() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>tensor([1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000])</code></pre>
</div>
</div>
<p>Why does this work? We can see why mathematically.</p>
<section id="deriving-softmax-from-sigmoid" class="level3">
<h3 class="anchored" data-anchor-id="deriving-softmax-from-sigmoid">Deriving Softmax from Sigmoid</h3>
<p>We start with taking the sigmoid of the difference between the first and second class activations.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bsigmoid%7D(x_1-x_2)%5Ctext%7B%20=%20%7D%5Cfrac%7B1%7D%7B1+e%5E%7B-%7B(x_1-x_2)%7D%7D%7D"></p>
<p>Let’s rewrite the denominator, expanding the exponent term:</p>
<p><img src="https://latex.codecogs.com/png.latex?1+e%5E%7B-%7B(x_1-x_2)%7D%7D%20=%201%20+%20%5Cfrac%7B1%7D%7Be%5E%7B(x_1-x_2)%7D%7D%20=%20%5Cfrac%7B1%7D%7B1%7D+%5Cfrac%7B1%7D%7Be%5E%7B(x_1-x_2)%7D%7D%20=%20%5Cfrac%7Be%5E%7B(x_1-x_2)%7D+1%7D%7Be%5E%7B(x_1-x_2)%7D%7D"></p>
<p>Plugging that back into the original sigmoid fraction and simplifying:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7B1+e%5E%7B-%7B(x_1-x_2)%7D%7D%7D%20=%20%5Cfrac%7B1%7D%7B%5Cfrac%7Be%5E%7B(x_1-x_2)%7D+1%7D%7Be%5E%7B(x_1-x_2)%7D%7D%7D%20=%20%5Cfrac%7Be%5E%7B(x_1-x_2)%7D%7D%7Be%5E%7B(x_1-x_2)%7D+1%7D"></p>
<p>Multiplying by a term equivalent to 1 (thanks Gemini):</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7Be%5E%7B(x_1-x_2)%7D%7D%7Be%5E%7B(x_1-x_2)%7D+1%7D%20%5Ctimes%20%5Cfrac%7Be%5E%7Bx_2%7D%7D%7Be%5E%7Bx_2%7D%7D%20=%20%5Cfrac%7Be%5E%7B(x_1-x_2)%7D%5Ctimes%20e%5E%7Bx_2%7D%7D%7B(e%5E%7B(x_1-x_2)%7D+1)%5Ctimes%20e%5E%7Bx_2%7D%7D%20=%20%5Cfrac%7Be%5E%7B(x_1-x_2+x_2)%7D%7D%7Be%5E%7B(x_1-x_2+x_2)%7D+e%5E%7Bx_2%7D%7D=%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D"></p>
<p>We are left with the softmax calculation for the first class probability. The chapter goes on to say:</p>
<blockquote class="blockquote">
<p>The second column (the probability of it being a 7) will then just be that value subtracted from 1.</p>
</blockquote>
<p>The sigmoid of the difference between the second and first class probabilities is 1 minus the sigmoid of the difference between the first and second class probabilities.</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bsigmoid%7D(x_2-x_1)%5Ctext%7B%20=%20%7D1%20-%20%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D%20-%20%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D-e%5E%7Bx_1%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D+e%5E%7Bx_2%7D%7D"></p>
<div id="cell-46" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="197b5713-e23b-405e-d37c-561a6c5b6fd8">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>acts[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).sigmoid()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>tensor([0.3975, 0.4979, 0.8668, 0.0034, 0.4041, 0.6339])</code></pre>
</div>
</div>
<p>We can also derive the same result with a different approach mathematically, I find this one to be simpler:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bsigmoid%7D(x_1-x_2)%5Ctext%7B%20=%20%7D%5Cfrac%7B1%7D%7B1+e%5E%7B-%7B(x_1-x_2)%7D%7D%7D"></p>
<p>Expanding the exponent term in the denominator:</p>
<p><img src="https://latex.codecogs.com/png.latex?e%5E%7B-(x_1-x_2)%7D%20=%20%5Cfrac%7B1%7D%7Be%5E%7B(x_1-x_2)%7D%7D%20=%20%5Cfrac%7B1%7D%7B%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_2%7D%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D%7D"></p>
<p>Plugging that back into the denominator and massaging it:</p>
<p><img src="https://latex.codecogs.com/png.latex?1+%5Cfrac%7Be%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_1%7D%7D%20+%20%5Cfrac%7Be%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_1%7D%20+%20e%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D%7D"></p>
<p>Plugging that back in to the original sigmoid equation:</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctext%7Bsigmoid%7D(x_1-x_2)%5Ctext%7B%20=%20%7D%5Cfrac%7B1%7D%7B1+e%5E%7B-%7B(x_1-x_2)%7D%7D%7D%20=%20%5Cfrac%7B1%7D%7B%5Cfrac%7Be%5E%7Bx_1%7D%20+%20e%5E%7Bx_2%7D%7D%7Be%5E%7Bx_1%7D%7D%7D%20=%20%5Cfrac%7Be%5E%7Bx_1%7D%7D%7Be%5E%7Bx_2%7D+e%5E%7Bx_1%7D%7D"></p>
<p>Mathematically, with some help from Gemini, that makes sense. But what is the conceptual intuition behind it? Why does taking the sigmoid of <em>the difference between activations</em> equate to softmax?</p>
<p>With loads of help with Gemini, I’ve come to the following conclusions/intuitions:</p>
<ul>
<li>sigmoid is designed for a simple binary outcome: A and not-A, so we can’t use it for more than 2 classes.</li>
<li>the difference in logits is a difference in “learned evidence” between the two classes. The value <code>x_1 - x_2</code> represents the log-odds of class 1 relative to class 2 (i.e., it’s equal to <code>log(P(class 1)/P(class 2))</code>). A difference of <code>0</code> (logits <code>x_1</code> and <code>x_2</code> are equal) passed through sigmoid yields a probability of <code>0.5</code>, meaning both classes are equally probable.</li>
<li>sigmoid is the inverse function of the log-odds (or logit) function. sigmoid(0) = 0.5, and log(0.5/(1-0.5)) = 0.</li>
<li>we call binary classification activations “logits” because we eventually turn them into probabilities using sigmoid.</li>
<li>the softmax function is the general template for all classification problems. For the special case of exactly two classes, this general formula mathematically simplifies to be identical to the sigmoid of the difference between the logits.</li>
<li>For 3+ classes, the model’s final activations are still called logits. However, they no longer have a simple interpretation as the log-odds of a single event. We think of them as some kind of learned “raw” or “uncalibrated” scores that softmax converts into a valid probability distribution.</li>
</ul>
<p>Let’s return back to the process of building up Cross Entropy loss.</p>
</section>
<section id="selecting-the-probabilities-used-and-calculating-their-logarithm" class="level3">
<h3 class="anchored" data-anchor-id="selecting-the-probabilities-used-and-calculating-their-logarithm">Selecting the Probabilities Used and Calculating their Logarithm</h3>
<p>So we have now converted logits into probabilities using softmax.</p>
<blockquote class="blockquote">
<p>Our activations, after softmax, are between 0 and 1, and sum to 1 for each row in the batch of predictions.</p>
</blockquote>
<div id="cell-61" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="659a6f60-3fd6-4033-b6ea-1cd5f18815fe">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">sm_acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.softmax(acts, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb37-2">sm_acts</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>tensor([[0.6025, 0.3975],
        [0.5021, 0.4979],
        [0.1332, 0.8668],
        [0.9966, 0.0034],
        [0.5959, 0.4041],
        [0.3661, 0.6339]])</code></pre>
</div>
</div>
<p>Okay great, now how do we use these values? We want to penalize the language model’s predictions when they wrong (the target label is not predicted with the highest probability) and especially when they are wrong <em>and</em> confident (the target label is predicted with a very low probability). On the other hand, we want to encourage the model to pick the right class confidently. We achieve this two-pronged behavior by taking the logarithm of the target probability.</p>
<p>Suppose the target classes (<code>0</code> or <code>1</code>) are as follows for the 6-item batch:</p>
<div id="cell-64" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="98ead48f-4666-473d-8ea2-23834f5efd43">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">targ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb39-2">targ</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>tensor([0, 1, 0, 1, 1, 0])</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="df800045-6655-4507-da0a-5af91422af66">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">sm_acts</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>tensor([[0.6025, 0.3975],
        [0.5021, 0.4979],
        [0.1332, 0.8668],
        [0.9966, 0.0034],
        [0.5959, 0.4041],
        [0.3661, 0.6339]])</code></pre>
</div>
</div>
<p>We index into our probalities using <code>idx</code> (the batch item index) and <code>targ</code> (the probability column index).</p>
<div id="cell-67" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="aa0d1726-a44c-48eb-ce80-827a2242df46">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb43-2">sm_acts[idx, targ]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>tensor([0.6025, 0.4979, 0.1332, 0.0034, 0.4041, 0.3661])</code></pre>
</div>
</div>
<div id="cell-68" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:388}}" data-outputid="3560d3c2-3e53-47d3-c2fe-7bc007c5928e">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">plot_function(torch.log, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log(x)'</span>, tx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-27-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/index_files/figure-html/cell-27-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>The log function is very negative for values close to 0 and less negative for values close to 1. We want our loss function to be very positively large for confidently wrong predictions (i.e.&nbsp;when the target class is predicted with a very low probability) so we want to flip the logarithm’s behavior by multiplying it by -1.</p>
<div id="cell-70" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:410}}" data-outputid="147b1069-226c-4741-e950-8d8808fe8e30">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">plot_function(<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">lambda</span> x: <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>torch.log(x), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, tx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, ty<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'- log(x)'</span>, title <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Log Loss when true label = 1'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-28-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/index_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-71" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="30e9ccac-b0ff-4e76-e05f-2722c489847f">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1">sm_acts[idx, targ]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>tensor([0.6025, 0.4979, 0.1332, 0.0034, 0.4041, 0.3661])</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d72434ec-eca4-48a6-97db-b2cdf9062e9e">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>torch.log(sm_acts)[idx, targ]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>tensor([0.5067, 0.6973, 2.0160, 5.6958, 0.9062, 1.0048])</code></pre>
</div>
</div>
<p>We now have large loss values (2.016, 5.6958) for batch items when the model predicted the target class with a very low probability (0.1332, 0.0034), and we have a relatively smaller loss value (0.5067) when the model predicted the target class with a higher probability than the incorrect class (0.6025).</p>
<p>The PyTorch <code>F.nll_loss</code> function does the indexing and multiplying by negative 1 operations for us, though it expects you to pass it activations after taking the logarithm of them.</p>
<div id="cell-75" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f01c7be6-2b16-48c4-c93e-545c184964ca">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1">F.nll_loss(sm_acts, targ, reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>tensor([-0.6025, -0.4979, -0.1332, -0.0034, -0.4041, -0.3661])</code></pre>
</div>
</div>
<div id="cell-76" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="350aacb0-cae9-4606-9f55-849b99d6a93e">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1">F.nll_loss(torch.log(sm_acts), targ, reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>tensor([0.5067, 0.6973, 2.0160, 5.6958, 0.9062, 1.0048])</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>As long as the activation columns sum to 1 (as they will, if we use softmax), then we’ll have a loss function that shows how well we’re predicting each digit. Therefore, making the activation for the correct label as high as possible must mean we’re also decreasing the activations of the remaining columns.</p>
</blockquote>
<p>We can also directly use <code>CrossEntropyLoss</code></p>
<div id="cell-79" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="103a97e6-a0a6-4ec7-add9-1b887a9226ee">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1">nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>)(acts, targ)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>tensor([0.5067, 0.6973, 2.0160, 5.6958, 0.9062, 1.0048])</code></pre>
</div>
</div>
<div id="cell-80" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="fcf7d116-8fdd-49bd-8f43-9ffefa19e5d5">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mean'</span>)(acts, targ)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>tensor(1.8045)</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Taking the mean of the negative log of our probabilities (taking the mean of the loss column of our table) gives us the negative log likelihood loss, which is another name for cross-entropy loss.</p>
</blockquote>
</section>
</section>
<section id="the-gradient-of-cross-entropy-loss" class="level2">
<h2 class="anchored" data-anchor-id="the-gradient-of-cross-entropy-loss">The Gradient of Cross Entropy Loss</h2>
<p>Let’s recreate with code the following explanation of the cross-entropy loss gradient.</p>
<blockquote class="blockquote">
<p>An interesting feature about cross-entropy loss appears when we consider its gradient. The gradient of cross_entropy(a,b) is just softmax(a)-b. Since softmax(a) is just the final activation of the model, that means that the gradient is proportional to the difference between the prediction and the target. This is the same as mean squared error in regression (assuming there’s no final activation function such as that added by y_range), since the gradient of (a-b)**2 is 2*(a-b). Because the gradient is linear, that means we won’t see sudden jumps or exponential increases in gradients, which should lead to smoother training of models.</p>
</blockquote>
<p>First we’ll calculate the gradients using <code>los.backward()</code>.</p>
<div id="cell-86" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="96b8a5fa-789d-4286-e6b1-cc3a55137dc7">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> acts.requires_grad_()</span>
<span id="cb59-2">acts</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>tensor([[ 0.6734,  0.2576],
        [ 0.4689,  0.4607],
        [-2.2457, -0.3727],
        [ 4.4164, -1.2760],
        [ 0.9233,  0.5347],
        [ 1.0698,  1.6187]], requires_grad=True)</code></pre>
</div>
</div>
<div id="cell-87" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="bbdbb429-a3c1-4688-bb9c-3760d869c144">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sum'</span>)(acts, targ)</span>
<span id="cb61-2">loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>tensor(10.8268, grad_fn=&lt;NllLossBackward0&gt;)</code></pre>
</div>
</div>
<div id="cell-88" class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1">loss.backward()</span></code></pre></div>
</div>
<div id="cell-89" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="411b5c8e-1118-4f02-c551-07a2ed885d7e">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1">acts.grad</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>tensor([[-0.3975,  0.3975],
        [ 0.5021, -0.5021],
        [-0.8668,  0.8668],
        [ 0.9966, -0.9966],
        [ 0.5959, -0.5959],
        [-0.6339,  0.6339]])</code></pre>
</div>
</div>
<p>Then, we’ll manually calculate them using <code>softmax(acts) - targ</code>:</p>
<div id="cell-91" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="66f4ee79-5af1-45e0-8e3f-b39d48487049">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.one_hot(targ, num_classes<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>acts.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>()</span>
<span id="cb66-2">b</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>tensor([[1., 0.],
        [0., 1.],
        [1., 0.],
        [0., 1.],
        [0., 1.],
        [1., 0.]])</code></pre>
</div>
</div>
<div id="cell-92" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e656eb87-1b8c-484b-c904-44378d247480">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1">acts.softmax(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>tensor([[-0.3975,  0.3975],
        [ 0.5021, -0.5021],
        [-0.8668,  0.8668],
        [ 0.9966, -0.9966],
        [ 0.5959, -0.5959],
        [-0.6339,  0.6339]], grad_fn=&lt;SubBackward0&gt;)</code></pre>
</div>
</div>
<p>We see that they are equal! If we want to recreate the gradient when <code>reduction='mean'</code> we can divide <code>softmax(a) - b</code> by the batch size.</p>
<div id="cell-94" class="cell">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1">torch.random.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb70-2">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb70-3">acts <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> acts.requires_grad_()</span></code></pre></div>
</div>
<div id="cell-95" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="71064327-04a8-4b21-b19c-2ea8391b406e">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.CrossEntropyLoss(reduction<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mean'</span>)(acts, targ)</span>
<span id="cb71-2">loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>tensor(1.8045, grad_fn=&lt;NllLossBackward0&gt;)</code></pre>
</div>
</div>
<div id="cell-96" class="cell">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1">loss.backward()</span></code></pre></div>
</div>
<div id="cell-97" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f6b0b28e-6aeb-4217-fbd1-c13f338d78c2">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1">acts.grad</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>tensor([[-0.0663,  0.0663],
        [ 0.0837, -0.0837],
        [-0.1445,  0.1445],
        [ 0.1661, -0.1661],
        [ 0.0993, -0.0993],
        [-0.1056,  0.1056]])</code></pre>
</div>
</div>
<div id="cell-98" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="1ec7f93f-2050-4bd2-fc8f-6acfe5b0ff6f">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1">(acts.softmax(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> acts.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>tensor([[-0.0663,  0.0663],
        [ 0.0837, -0.0837],
        [-0.1445,  0.1445],
        [ 0.1661, -0.1661],
        [ 0.0993, -0.0993],
        [-0.1056,  0.1056]], grad_fn=&lt;DivBackward0&gt;)</code></pre>
</div>
</div>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>Next-token language generation is fundamentally a classification problem. The “classes” are the tokens in the vocabulary. The model predicts the most probable next token, learning to favor target tokens during training using cross-entropy. This refresher on cross-entropy loss helped me solidify my understanding of how this behavior is reinforced.</p>
<p>I’m growing my YouTube channel so if you like this type of content <a href="https://www.youtube.com/@vishal_learner">please subscribe</a>!</p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>fastai</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-11-CELoss/</guid>
  <pubDate>Wed, 11 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Proof, Pricing, and Passion: Finding My Path in Machine Learning</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-09-fireside-chat/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/Z328Nl6c-8k?si=Ey9ehhiHqoCQfmum" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<p>A recent fireside chat with three successful AI consultants—Jason Liu, Andy Walters, and Vignesh Mohankumar—gave me a much clearer, more realistic perspective on what it takes to build a career in this space. While a previous <a href="https://www.youtube.com/watch?v=nyNQtkiW-ME">paradigm-shifting conversation between Jason Liu and Hamel Husain</a> had inspired me, this conversation answered a critical question I’ve been wrestling with:</p>
<blockquote class="blockquote">
<p>What do you think is the minimum amount of professional experience to have before going full-time consulting?</p>
</blockquote>
<p>I was all ears on this one. Below are the responses from Jason, Vignesh and Andy (emphasis mine)</p>
<blockquote class="blockquote">
<p>Jason: <mark><strong>the thing you want to have is proof.</strong></mark> There are people making a million dollars a year doing Zapier integrations and automations. You can probably just figure that out, just charge very little, do a couple of free jobs, get some proof, maybe if you help a business owner with their automations you can ask if they have anyone they can refer you to, then you get the next job and the next job. I think it depends on what kind of things you’re promising and what kind of solutions you’re promising.</p>
</blockquote>
<blockquote class="blockquote">
<p>Vignesh: I think the fact that I was basically a staff level engineer is really what’s helping me now, but it’s not to say that you don’t need that, I think like you said there’s a lot of things you can do, but <mark><strong>I think for the type of work I’m doing it would be very hard to do if you were less than 5 years of experience, or really, honestly, probably 8</strong></mark>….but it’s about what have you actually done and can you actually prove it.</p>
</blockquote>
<blockquote class="blockquote">
<p>Andy: I started with zero AI knowledge. I was previously a programmer. I never worked at a startup that was successful. I worked at little agencies my whole career. I am where I am today so it’s possible. <mark><strong>It all depends on your skill set. It’s about staffing your weaknesses.</strong></mark> If you want to go big and you’re not good at something if you can partner with somebody who’s good at that thing, now you can move on and go further. It depends on how fast you want to scale, how honest you can be with yourself about your weaknesses and how good you are at acquiring the talent to fill in those weaknesses.</p>
</blockquote>
<p>Jason and Vignesh agreed upon the fact that you can land jobs if you can prove that you can deliver results (at the appropriate scale). For someone like me, who has never worked professionally in ML, getting that proof (at scale, in a setting that emulates a real business) is the tricky part. I would imagine that any proof I can currently collect (research projects, Kaggle competitions, educational content, etc.) will help me get a foot in the door at a company or a lab, which will then unlock my ability to get more proof in a professional setting that could translate to consulting. I could be wrong (tweet at me if I am) but going from 0-to-consulting without any other professional ML experience doesn’t seem likely (or, at least I haven’t seen any examples of this, except for unicorns like Jeremy Howard).</p>
<p>But knowing when to start is only half the battle; understanding the pivotal moments that accelerate a consulting career is just as important, which the speakers addressed next.</p>
</section>
<section id="inflection-points-in-consulting" class="level2">
<h2 class="anchored" data-anchor-id="inflection-points-in-consulting">Inflection points in consulting</h2>
<p>Q: What felt like the inflection point for the way that you were able to bring in revenue or demand higher fees?</p>
<blockquote class="blockquote">
<p>Jason: For me a lot of it was coming down to my writing. At some point it became: “Hey Jason, I’ve seen a couple of your blog posts show up on my Slack, I don’t really know who you are, I finally clicked the website and I realized you were available so can we figure out if it makes sense to work together?” And then I would share another blog post after the call and they would be like “turns out my CTO already read this, what is your availability?”</p>
</blockquote>
<blockquote class="blockquote">
<p>Vignesh: There was one month where I got a project and I finished it in a week or two and it was more money than I had made if I just worked full-time, hourly, for a month and a half. It was a really pressing problem that came up. I realized I’d rather sit there for 29 days a month and find a project-based thing that I could do for one day a month, then work hourly. That’s what shifted it for me.</p>
</blockquote>
<blockquote class="blockquote">
<p>Jason: Going from time-based to project-based pricing, and then getting comfortable understanding the value that your project delivers and increase your fee to reflect the size of the problem.</p>
</blockquote>
<p>In the Hamel/Jason discussion on AI consulting, they talk about how publishing free content is a viable marketing plan. This really resonated with me as a fast.ai community member, encouraged by <a href="https://medium.com/@racheltho/why-you-yes-you-should-blog-7d2544ac1045">Rachel Thomas to blog</a> since “it’s like a resume, only better.” After I watched Jason and Hamel’s discussion, I immediately set a goal to publish 50 ML vidoes and 50 ML blog posts in 2025, and it has been driving me forward ever since. Reading that Jason’s leads often come from people reading his blog further solidified by belief that this is the way. Obviously, what you’re writing about matters, but I think that catches up with quantity over time.</p>
<p>Both of these inflection points are about detaching income from hours and tying it to the value you create. But what’s the upper limit? This led to an interesting exchange about whether AI is removing the ceiling on how much impact a single consultant can have.</p>
</section>
<section id="is-there-a-ceiling-for-one-consultant" class="level2">
<h2 class="anchored" data-anchor-id="is-there-a-ceiling-for-one-consultant">Is there a ceiling for one consultant?</h2>
<p>I’ve heard Jason say some iteration of the following in a couple of videos now:</p>
<blockquote class="blockquote">
<p>Jason: I would be surprised if there’s anybody I know that can be like an individual person even doing $10MM a year just feels very difficult whereas if you just have a couple of small operational staff you can probably get pretty far.</p>
</blockquote>
<p>This was the first video (that I’ve watched) where someone pushed back on that.</p>
<blockquote class="blockquote">
<p>Vignesh: If these tools are going to keep getting better, then I don’t know if there is a limit anymore at some point.</p>
</blockquote>
<p>I think this both an inspiring and realistic take. My own self-prescribed limits have continuously been broken with the help of AI. It’s hard for me to quantify how much my growth in ML has accelerated due to AI (as I obviously don’t have a control to compare for that) but anecdotally, every month and every year that I’ve increased my use of AI to augment my learning and implementation skills, I’ve accomplished tasks that I didn’t expect to. You could argue that every project, blog post, and video I’ve published could not have been possible without the support of AI. How this translates to getting paid (and how much I get paid), only time will tell. Going back to the previous topic on when to start consulting, I think the use of AI can help build that proof needed for a 0-to-consulting trajectory. It may require doing a couple free or low-paying jobs, but I think that’s reasonable to expect. This is probably a controversial take, and I’m not condoning or advocating for exploitation, but I do think that when you work for free as a beginner, you are “paying” (with your labor) to get that proof needed to unlock paid work. Working for free can also look like joining a study group/discord server and taking on tasks that need to be done.</p>
<p>While the potential to scale with AI is an exciting thought experiment, financial upside is rarely the sole motivator for taking the risk of going independent. The conversation also explored the fundamental ‘why’ behind this career path, and Vignesh’s reasons resonated deeply with my own.</p>
</section>
<section id="what-attracts-me-to-consulting" class="level2">
<h2 class="anchored" data-anchor-id="what-attracts-me-to-consulting">What attracts me to consulting</h2>
<blockquote class="blockquote">
<p>Q: Why didn’t you join a startup (or starting a company) versus doing your own thing?</p>
</blockquote>
<blockquote class="blockquote">
<p>Vignesh: I just loving working on new problems all of the time, ideally multiple problems at the same time. I think consulting is really interesting because you can price based on the actual value you’re delivering. That keeps me going in some ways—what’s the most valuable things I can be working on? How can I help people the most? The last piece is that I just love owning the brand. Anything I’m writing, anyone I’m meeting is all tied to me…I scale it by finding more valuable projects and more important problems.</p>
</blockquote>
<p>All of these points resonate with me. As a hobby ML researcher, I value the following freedoms:</p>
<ul>
<li>The freedom to start, pause, or stop a project at will.</li>
<li>The freedom of learning and building in public without the constraints of private, proprietary work.</li>
<li>The freedom to choose my focus.</li>
<li>The freedom to control my pace—going slow. Going fast. Going deep. Staying shallow. I choose at all times which of these modes I’m in.</li>
<li>The freedom from an obsession with results, allowing me to instead chase ideas, concepts, and their clear explanation.</li>
</ul>
<p>The cost of these freedoms, currently, is that I do this work for free. Finding a situation where I can continue to have these freedoms is my next challenge.</p>
<p>Vignesh’s drive for autonomy and interesting problems perfectly mirrors the freedoms I value as a hobby researcher. But what I found most encouraging was the discussion that followed, which highlighted that his path isn’t the only one; different personalities and preferences can also lead to fulfilling consulting careers.</p>
</section>
<section id="on-different-paths-to-consulting" class="level2">
<h2 class="anchored" data-anchor-id="on-different-paths-to-consulting">On different paths to consulting</h2>
<p>Vignesh and Andy had diametrically opposed preferences and paths to consulting (emphasis mine):</p>
<blockquote class="blockquote">
<p>Vignesh: I like coding a lot. I love writing code. I love learning things. So it works. It’s like my dream.</p>
</blockquote>
<blockquote class="blockquote">
<p>Andy: I think I’m different than Vignesh in that like I was an okay engineer, but I was never a great engineer, and I really enjoyed the relationship aspect of it, leading people, that kind of stuff, that’s actually more fun to me. I like meetings…I enjoy it. <mark><strong>It’s all about figuring out what you really enjoy and pushing on that a lot.</strong></mark></p>
</blockquote>
<p>I think it was awesome and important for viewers to see these diverse preferences both leading to fulfilling consulting careers. Ultimately, while landing paid work is goal 1B, doing what I enjoy and excites me is 1A and this confirmed that motivation.</p>
<p>The idea that you should build a career around what you genuinely enjoy is a powerful one. And what makes this path so compelling right now is the shared belief among all the speakers that the opportunity is vast enough to accommodate all of these different approaches.</p>
</section>
<section id="the-work-is-literally-falling-off-trucks" class="level2">
<h2 class="anchored" data-anchor-id="the-work-is-literally-falling-off-trucks">The work is literally falling off trucks</h2>
<p>I’ll end with Andy’s closing thoughts:</p>
<blockquote class="blockquote">
<p>Andy: I think the biggest lesson I’ve learned through all of this is it’s all about breaking your context into the next level. There is this cascading series of contexts you have to break yourself into and it’s always uncomfortable and it feels painful and risky…keep pushing, keep growing, and even when it doesn’t work the first time you just keep pulling the thread. It’s surprising how far you can get. We firmly believe that over the next 5 years there’s at least a trillion dollars of integration services on the table for companies to integrate AI into their offerings. The work is literally falling off the trucks. It’s out there to seize, go seize it.</p>
</blockquote>
<p>When you are constantly pushing yourself to grow and take on the next challenging context, you will find yourself working at the edge of your knowledge and capacity. This is an ideal place to be. However, the downside is never truly knowing or feeling how much you have progressed. It’s a constant state of “I am stuck on X which I need to resolve so I can get to Y”. I think documenting your journey (through writing blog posts/tweets and creating videos) helps balance this bleeding-edge approach by concretely and quantitatively showing you what you have learned and how much you have achieved.</p>
<p>Andy’s point that “the work is literally falling off the trucks” should be inspiring to everyone, regardless of whether or not you want to pursue consulting. I think we are still in the very early stages of AI adoption, which means that there is a lot of implementation work that needs to get done. It can seem (falsely) that the field of AI is accelerating at an unsustainable pace, but what is unsustainble in my opinion is that veneer. The fundamentals still matter. Communicating concepts clearly still matters. These are relatively low-hanging fruit.</p>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing thoughts</h2>
<p>I thoroughly enjoying this fireside chat. I came away from it with more questions and some answers.</p>
<p>To be honest, I don’t know where my ML journey is going to take me. When I’m feeling optimistic, I imagine myself working in an organization or independently with the same joy that I find myself working on my personal projects today. On my worst days, I wonder if I’ll ever leave the purgatory of hobby ML. I think the key to my success is to be consistent regardless of what I’m feeling.</p>
<p>Hearing Andy talk about staffing weaknesses and Vignesh about AI raising the ceiling made me reflect on my own approach. When it comes to using AI, and what capabilities it will unlock for me, I keep waiting for a “choir of angels” (<a href="https://xkcd.com/310/">xkcd</a>) but instead have found a steady plodding forward, task to task. I think Vignesh is right about AI removing the ceiling, and Andy is right about supplementing your weaknesses with others’ strengths. Combining these two ideas, I think my task is to become more aware about 1) what my current ceiling is/what my current weaknesses are and 2) understanding how to augment them with AI. The sycophantic nature of AI makes it difficult to use it for identifying my weaknesses, but I’ve found success by asking Claude to be a “hardass” (and then asking it to critique the hardass), or using Gemini 2.5-Pro for such questions, which I find is more straightforward and informative and less of a coach/cheerleader.</p>
<p>I’ll end by saying that I don’t usually write posts like these, and keep these thoughts to myself, but I’m finding that to strengthen my relationship with my audience I will have to share more of myself in my writing. This is the first of what I hope will be many posts connecting what I’m learning from experts in the field to my own journey.</p>
<p>You can reach me on <a href="https://x.com/vishal_learner">Twitter</a> and find more content on my <a href="https://www.youtube.com/@vishal_learner">YouTube channel</a>.</p>


</section>

 ]]></description>
  <category>Career</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-09-fireside-chat/</guid>
  <pubDate>Mon, 09 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>HuggingFace’s Default KV Cache and the flash_attn_varlen_func Docstring</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-03-flash_attn_varlen_func-casual-mask/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U flash<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>attn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>no<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>build<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>isolation</span></code></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoTokenizer, AutoModelForCausalLM, GenerationConfig</span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb2-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> nn</span></code></pre></div>
</div>
<div id="cell-3" class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>)</span>
<span id="cb3-2">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>, attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>, torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span></code></pre></div>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I have recently been working on a research project which has required me to <a href="https://vishalbakshi.github.io/blog/posts/2025-05-04-Understanding-Sequence-Packing/">better understand sequence packing and Flash Attention</a>, and <a href="https://youtu.be/u_v6HHyv4No">eager attention as well</a>. However, I’ve found that both in terms of my interest, and for practical understanding, that hasn’t been enough!</p>
<p>Tangentially, I also recently started using Gemini Pro 2.5 (the chat UI) and have been thoroughly enjoying it after using a year of daily use of Claude Pro. This seemed like a great opportunity to test out Gemini’s functionality to learn about a topic that is complex and currently outside of my comfort zone.</p>
<p>I fed Gemini the Flash Attention GitHub repo and explained that I wanted to thoroughly understand <code>flash_attn_varlen_func</code> to the point where I could make a detailed video walkthrough with visuals. It provided me with this condensed timeline:</p>
<ul>
<li><strong>Phase 1: Python Layer &amp; Sequence Packing Concepts</strong>
<ul>
<li>Tasks: Understand <code>flash_attn_varlen_func</code>’s Python call stack, the role of <code>cu_seqlens</code>, <code>max_seqlen</code>, and <code>torch.autograd.Function</code>.</li>
<li>Time: 1-2 Weeks</li>
<li>Hours: Approximately 15-30 hours</li>
</ul></li>
<li><strong>Phase 2: Core CUDA Kernel Deep Dive</strong>
<ul>
<li>Tasks: Study the FlashAttention research paper(s).</li>
<li>Analyze the C++/CUDA dispatcher code (e.g., in <code>csrc/flash_attn/flash_api.cpp</code>).</li>
<li>Dissect the core CUDA kernels for variable length forward and backward passes (e.g., in <code>csrc/flash_attn/src/</code> like <code>flash_fwd_kernel.h</code> and <code>flash_bwd_kernel.h</code>).</li>
<li>Time: 6-12 Weeks</li>
<li>Hours: Approximately 125-240 hours</li>
</ul></li>
<li><strong>Phase 3: Content Creation (Video/Blog)</strong>
<ul>
<li>Tasks: Plan the structure for your content, create visuals, draft explanations, and prepare code snippets.</li>
<li>Time: 2-3 Weeks</li>
<li>Hours: Approximately 30-50 hours</li>
</ul></li>
<li><strong>Total Estimated for CUDA Path</strong>
<ul>
<li>Overall Timeline: Roughly 2.5 - 4.5 months</li>
<li>Total Focused Hours: Approximately 170 - 320 hours</li>
</ul></li>
</ul>
<p>This is obviously an amibitious goal and timeline, especially because of my limited C++/CUDA knowledge and experience. However, I do believe this is a case of aim-for-the-stars-land-on-the-moon, as I’ve already experienced growth and learning in the first steps of Phase 1.</p>
<p>As I was reading through <a href="https://github.com/Dao-AILab/flash-attention/blob/df1847a74ad0f9cee007ed186fab44f83fa03fad/flash_attn/flash_attn_interface.py#L1370"><code>flash_attn_varlen_func</code></a> source code, I got stuck on the following piece of the docstring:</p>
<pre><code>If causal=True, the causal mask is aligned to the bottom right corner of the attention matrix.
For example, if seqlen_q = 2 and seqlen_k = 5, the causal mask (1 = keep, 0 = masked out) is:
    1 1 1 1 0
    1 1 1 1 1
If seqlen_q = 5 and seqlen_k = 2, the causal mask is:
    0 0
    0 0
    0 0
    1 0
    1 1
If the row of the mask is all zero, the output will be zero.</code></pre>
<p>I didn’t have hands-on experience working with this concept, where the query length is different than the key and value length. Gemini helped me realize that this happens in the extremely common case of autoregressive generation—the next token (query length of 1) attends to the previous tokens (key/value length &gt; 1). The concept of KV cache also came up in our conversation.</p>
<p>I don’t tend to understand things until I see them in code, so in this notebook, I’ll inspect the shapes of Q, K and V during the HuggingFace <code>model.generate</code> call. I’ll also peel back a couple layers and understand how HugginFace uses KV cache. After that exploration, I’ll return back to the <code>flash_attn_varlen_func</code> docstring and walk through the logic behind how the causal mask is shaped.</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/pZpK5uGr7Lo?si=znCX-qawKdcoX0V9" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</section>
<section id="understanding-huggingfaces-default-kv-cache" class="level2">
<h2 class="anchored" data-anchor-id="understanding-huggingfaces-default-kv-cache">Understanding HuggingFace’s Default KV Cache</h2>
<p>I’ll start by understanding how HuggingFace uses KV cache (I was surprised to find that it uses it by default!).</p>
<section id="inspecting-model_kwargs-for-caching-method" class="level3">
<h3 class="anchored" data-anchor-id="inspecting-model_kwargs-for-caching-method">Inspecting <code>model_kwargs</code> for Caching Method</h3>
<p>Looking at the <a href="https://github.com/huggingface/transformers/blob/1094dd34f73dae1d9a91a6632635934516612490/src/transformers/generation/utils.py#L2481"><code>generate</code></a> source code, the first method call of interest when it comes to KV cache seems to be <a href="https://github.com/huggingface/transformers/blob/1094dd34f73dae1d9a91a6632635934516612490/src/transformers/generation/utils.py#L1981"><code>_prepare_cache_for_generation</code></a>, which takes the following arguments: <code>generation_config</code>, <code>model_kwargs</code>, <code>assistant_model</code>, <code>batch_size</code>, <code>max_cache_length</code>, <code>device</code>. Going down the different elif statements, <code>_prepare_cache_for_generation</code> sets the following <code>model_kwargs</code> value:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">model_kwargs[cache_name] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb5-2">    DynamicCache()</span>
<span id="cb5-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> requires_cross_attention_cache</span>
<span id="cb5-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> EncoderDecoderCache(DynamicCache(), DynamicCache())</span>
<span id="cb5-5">)</span></code></pre></div>
<p>Where <code>cache_name</code> is defined earlier in that method as:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">cache_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"past_key_values"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> is_hybrid_cache <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cache_params"</span></span></code></pre></div>
<p>I want to inspect what <code>model_kwargs['past_key_values']</code> is.</p>
<p><a href="https://github.com/huggingface/transformers/blob/1094dd34f73dae1d9a91a6632635934516612490/src/transformers/generation/utils.py#L2369"><code>_prepare_generation_config</code></a> is used in <code>generate</code> to produce <code>generation_config</code> and <code>model_kwargs</code>.</p>
<div id="cell-14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d4927381-46b1-42f6-aec8-9e94d36c16a8" data-execution_count="50">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">generation_config, model_kwargs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model._prepare_generation_config(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb7-2">generation_config, model_kwargs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(GenerationConfig {
   "bos_token_id": 0,
   "eos_token_id": 0
 },
 {})</code></pre>
</div>
</div>
<p>I can now pass those on to <code>_prepare_cache_for_generation</code>, which will internally modify <code>model_kwargs</code>.</p>
<div id="cell-16" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">model._prepare_cache_for_generation(generation_config, model_kwargs, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8192</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span></code></pre></div>
</div>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="533d54c0-fad1-4f4a-9b31-4fe867e16454" data-execution_count="53">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">model_kwargs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>{'past_key_values': &lt;transformers.cache_utils.DynamicCache at 0x78c3b80d9850&gt;}</code></pre>
</div>
</div>
<p>I can see now that <code>model_kwargs</code> has a <code>'past_key_values'</code> key which has a <code>DynamicCache</code> value.</p>
</section>
<section id="how-is-past_key_values-used" class="level3">
<h3 class="anchored" data-anchor-id="how-is-past_key_values-used">How is <code>past_key_values</code> Used?</h3>
<p>I think it makes sense to start by looking at <a href="https://github.com/huggingface/transformers/blob/e8b292e35f331d3c3de85f7e5d3496b0e13d3d6f/src/transformers/models/llama/modeling_llama.py#L223">the forward pass of the LlamaAttention module</a>:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">...</span>
<span id="cb12-2"></span>
<span id="cb12-3">key_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k_proj(hidden_states).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-4">value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.v_proj(hidden_states).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb12-5"></span>
<span id="cb12-6">...</span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> past_key_value <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb12-9">    key_states, value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> past_key_value.update(key_states, value_states, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layer_idx, cache_kwargs)</span></code></pre></div>
<p>The <code>hidden_states</code> pass through <code>k_proj</code> and <code>v_proj</code> to produce <code>key_states</code> and <code>value_states</code>, respectively, which are then passed to <code>past_key_value.update</code> to produce a new set of <code>key_states</code> and <code>value_states</code>. Looking at <a href=""><code>DynamicCache.update</code></a>:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the cache</span></span>
<span id="cb13-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> key_states <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb13-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> layer_idx:</span>
<span id="cb13-4">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># There may be skipped layers, fill them with empty lists</span></span>
<span id="cb13-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache), layer_idx):</span>
<span id="cb13-6">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache.append(torch.tensor([]))</span>
<span id="cb13-7">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache.append(torch.tensor([]))</span>
<span id="cb13-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache.append(key_states)</span>
<span id="cb13-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache.append(value_states)</span>
<span id="cb13-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> (</span>
<span id="cb13-11">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx].numel()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prefers not t.numel() to len(t) == 0 to export the model</span></span>
<span id="cb13-12">    ):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fills previously skipped layers; checking for tensor causes errors</span></span>
<span id="cb13-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> key_states</span>
<span id="cb13-14">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value_states</span>
<span id="cb13-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb13-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx], key_states], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-17">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx], value_states], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb13-18"></span>
<span id="cb13-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx], <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx]</span></code></pre></div>
<p>Let’s walk through each condition in the if-else block.</p>
<section id="if-lenself.key_cache-layer_idx" class="level4">
<h4 class="anchored" data-anchor-id="if-lenself.key_cache-layer_idx"><code>if len(self.key_cache) &lt;= layer_idx</code></h4>
<p>A full <code>key_cache</code> is has <code>n_layers</code> number of elements. If its number of elements is less than or equal to the <code>layer_idx</code> that means that it does not contain <code>key_states</code> for that <code>layer_idx</code> yet (because python starts count from <code>0</code>). For example suppose <code>layer_idx</code> is <code>0</code>, our first layer. <code>if len(self.key_cache) &lt;= layer_idx</code> is <code>True</code>, that means <code>len(self.key_cache)</code> is <code>0</code> and doesn’t contain <code>key_states</code> for the first layer, as would be the case if you were generating the first token of a response. In this case you simply <code>append</code> the <code>key_states</code> to the cache.</p>
<p>If <code>layer_idx</code> is greater than <code>len(self.key_cache)</code> then it appends an empty tensor for the “skipped” layers. This would be a scenario where you were generating the first token of a response (<code>len(self.key_cache)</code> is <code>0</code>) but starting with <code>layer_idx</code> of <code>2</code>.</p>
</section>
<section id="elif-not-self.key_cachelayer_idx.numel" class="level4">
<h4 class="anchored" data-anchor-id="elif-not-self.key_cachelayer_idx.numel"><code>elif not self.key_cache[layer_idx].numel()</code></h4>
<p>If a layer was skipped and it has an empty tensor as its <code>key_cache</code> then this condition is triggered and it simply assigned <code>key_states</code> to that layer’s <code>key_cache</code>.</p>
</section>
<section id="else" class="level4">
<h4 class="anchored" data-anchor-id="else"><code>else</code></h4>
<p>I think this is the most common case, used for autoregressive next-token generation. The <code>key_cache</code> contains a non-empty value for this layer so it concatenates the current value with the new <code>key_states</code>. In this way, the <code>key_cache</code> for this layer grows over the course of next token generation. Specifically, it’s second to last dimension (sequence length) increases by 1 for each token processed.</p>
</section>
<section id="return-self.key_cachelayer_idx-self.value_cachelayer_idx" class="level4">
<h4 class="anchored" data-anchor-id="return-self.key_cachelayer_idx-self.value_cachelayer_idx"><code>return self.key_cache[layer_idx], self.value_cache[layer_idx]</code></h4>
<p>Finally, the concatenated <code>key_cache</code> and <code>value_cache</code> for the given layer are returned. The <code>update</code> step is complete.</p>
<p><code>key_states</code> and <code>value_states</code> after the <code>past_key_values.update</code> step are passed onto the <code>attention_interface</code> which we’ll look at later in this blog post.</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">attn_output, attn_weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attention_interface(</span>
<span id="cb14-2">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb14-3">            query_states,</span>
<span id="cb14-4">            key_states,</span>
<span id="cb14-5">            value_states,</span>
<span id="cb14-6">            attention_mask,</span>
<span id="cb14-7">            dropout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.training <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.attention_dropout,</span>
<span id="cb14-8">            scaling<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.scaling,</span>
<span id="cb14-9">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs,</span>
<span id="cb14-10">        )</span></code></pre></div>
</section>
</section>
<section id="visualizing-the-dynamiccache.update" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-the-dynamiccache.update">Visualizing the <code>DynamicCache.update</code></h3>
<p>To see how the cache update takes place during autoregressive language generation, I’ll monkey-patch a <code>debug_update</code> method.</p>
<div id="cell-35" class="cell" data-execution_count="58">
<details class="code-fold">
<summary>Show `debug_update</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Any, Dict, Iterable, List, Optional, Tuple, Union</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> debug_update(</span>
<span id="cb15-4">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb15-5">    key_states: torch.Tensor,</span>
<span id="cb15-6">    value_states: torch.Tensor,</span>
<span id="cb15-7">    layer_idx: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb15-8">    cache_kwargs: Optional[Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb15-9">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Tuple[torch.Tensor, torch.Tensor]:</span>
<span id="cb15-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb15-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Updates the cache with the new `key_states` and `value_states` for the layer `layer_idx`.</span></span>
<span id="cb15-12"></span>
<span id="cb15-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Parameters:</span></span>
<span id="cb15-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        key_states (`torch.Tensor`):</span></span>
<span id="cb15-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The new key states to cache.</span></span>
<span id="cb15-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        value_states (`torch.Tensor`):</span></span>
<span id="cb15-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The new value states to cache.</span></span>
<span id="cb15-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        layer_idx (`int`):</span></span>
<span id="cb15-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The index of the layer to cache the states for.</span></span>
<span id="cb15-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        cache_kwargs (`Dict[str, Any]`, `optional`):</span></span>
<span id="cb15-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Additional arguments for the cache subclass. No additional arguments are used in `DynamicCache`.</span></span>
<span id="cb15-22"></span>
<span id="cb15-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Return:</span></span>
<span id="cb15-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        A tuple containing the updated key and value states.</span></span>
<span id="cb15-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb15-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the number of seen tokens</span></span>
<span id="cb15-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> layer_idx <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb15-28">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._seen_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> key_states.shape[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb15-29"></span>
<span id="cb15-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Update the cache</span></span>
<span id="cb15-31">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> key_states <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb15-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> layer_idx:</span>
<span id="cb15-33">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"DEBUG: initializing cache for layer_idx </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>layer_idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb15-34">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache), layer_idx):</span>
<span id="cb15-35">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache.append(torch.tensor([]))</span>
<span id="cb15-36">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache.append(torch.tensor([]))</span>
<span id="cb15-37">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache.append(key_states)</span>
<span id="cb15-38">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache.append(value_states)</span>
<span id="cb15-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> (</span>
<span id="cb15-40">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx].numel()  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># prefers not t.numel() to len(t) == 0 to export the model</span></span>
<span id="cb15-41">        ):  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fills previously skipped layers; checking for tensor causes errors</span></span>
<span id="cb15-42">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"DEBUG: filling empty cache for layer_idx </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>layer_idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb15-43">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> key_states</span>
<span id="cb15-44">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value_states</span>
<span id="cb15-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb15-46">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"DEBUG: updating/concatenating cache for layer_idx </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>layer_idx<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb15-47">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx], key_states], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-48">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx], value_states], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb15-49"></span>
<span id="cb15-50">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.key_cache[layer_idx], <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.value_cache[layer_idx]</span></code></pre></div>
</details>
</div>
<div id="cell-36" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.cache_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DynamicCache</span>
<span id="cb16-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ORIGINAL_DYNAMIC_CACHE_UPDATE'</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">globals</span>():</span>
<span id="cb16-3">    ORIGINAL_DYNAMIC_CACHE_UPDATE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DynamicCache.update</span>
<span id="cb16-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Stored original DynamicCache.update."</span>)</span>
<span id="cb16-5"></span>
<span id="cb16-6">DynamicCache.update <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> debug_update</span></code></pre></div>
</div>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3bbb53b2-9b89-4361-cb26-e980bb510959" data-execution_count="60">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The quick brown"</span></span>
<span id="cb17-2">input_ids, attention_mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenizer(prompt, return_tensors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>).values()</span>
<span id="cb17-3">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DEBUG: initializing cache for layer_idx 0
DEBUG: initializing cache for layer_idx 1
DEBUG: initializing cache for layer_idx 2
DEBUG: initializing cache for layer_idx 3
DEBUG: initializing cache for layer_idx 4
DEBUG: initializing cache for layer_idx 5
DEBUG: initializing cache for layer_idx 6
DEBUG: initializing cache for layer_idx 7
DEBUG: initializing cache for layer_idx 8
DEBUG: initializing cache for layer_idx 9
DEBUG: initializing cache for layer_idx 10
DEBUG: initializing cache for layer_idx 11
DEBUG: initializing cache for layer_idx 12
DEBUG: initializing cache for layer_idx 13
DEBUG: initializing cache for layer_idx 14
DEBUG: initializing cache for layer_idx 15
DEBUG: initializing cache for layer_idx 16
DEBUG: initializing cache for layer_idx 17
DEBUG: initializing cache for layer_idx 18
DEBUG: initializing cache for layer_idx 19
DEBUG: initializing cache for layer_idx 20
DEBUG: initializing cache for layer_idx 21
DEBUG: initializing cache for layer_idx 22
DEBUG: initializing cache for layer_idx 23
DEBUG: initializing cache for layer_idx 24
DEBUG: initializing cache for layer_idx 25
DEBUG: initializing cache for layer_idx 26
DEBUG: initializing cache for layer_idx 27
DEBUG: initializing cache for layer_idx 28
DEBUG: initializing cache for layer_idx 29
DEBUG: updating/concatenating cache for layer_idx 0
DEBUG: updating/concatenating cache for layer_idx 1
DEBUG: updating/concatenating cache for layer_idx 2
DEBUG: updating/concatenating cache for layer_idx 3
DEBUG: updating/concatenating cache for layer_idx 4
DEBUG: updating/concatenating cache for layer_idx 5
DEBUG: updating/concatenating cache for layer_idx 6
DEBUG: updating/concatenating cache for layer_idx 7
DEBUG: updating/concatenating cache for layer_idx 8
DEBUG: updating/concatenating cache for layer_idx 9
DEBUG: updating/concatenating cache for layer_idx 10
DEBUG: updating/concatenating cache for layer_idx 11
DEBUG: updating/concatenating cache for layer_idx 12
DEBUG: updating/concatenating cache for layer_idx 13
DEBUG: updating/concatenating cache for layer_idx 14
DEBUG: updating/concatenating cache for layer_idx 15
DEBUG: updating/concatenating cache for layer_idx 16
DEBUG: updating/concatenating cache for layer_idx 17
DEBUG: updating/concatenating cache for layer_idx 18
DEBUG: updating/concatenating cache for layer_idx 19
DEBUG: updating/concatenating cache for layer_idx 20
DEBUG: updating/concatenating cache for layer_idx 21
DEBUG: updating/concatenating cache for layer_idx 22
DEBUG: updating/concatenating cache for layer_idx 23
DEBUG: updating/concatenating cache for layer_idx 24
DEBUG: updating/concatenating cache for layer_idx 25
DEBUG: updating/concatenating cache for layer_idx 26
DEBUG: updating/concatenating cache for layer_idx 27
DEBUG: updating/concatenating cache for layer_idx 28
DEBUG: updating/concatenating cache for layer_idx 29</code></pre>
</div>
</div>
<p>As we can see by the printed output, for the first generated token <code>update</code> initializes cache with <code>self.key_cache.append(key_states)</code> and <code>self.value_cache.append(value_states)</code>. For the subsequent tokens, it updates the cache with <code>torch.cat</code>.</p>
<p>I’ll re-assign the original <code>update</code> to <code>DynamicCache</code> to avoid cluttering with print outs.</p>
<div id="cell-40" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">DynamicCache.update <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ORIGINAL_DYNAMIC_CACHE_UPDATE</span></code></pre></div>
</div>
</section>
</section>
<section id="inspecting-past_key_values-during-model.generate" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-past_key_values-during-model.generate">Inspecting <code>past_key_values</code> During <code>model.generate</code></h2>
<p>With an understanding of how KV cache is updated, I’ll now turn my attention to the key and value cache contents during autoregressive generation.</p>
<div id="cell-43" class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>)</span>
<span id="cb20-2">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>, attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>, torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span></code></pre></div>
</div>
<div id="cell-44" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:35}}" data-outputid="31e79d9e-72c0-4700-a6eb-7e6f795819b0" data-execution_count="63">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The quick brown"</span></span>
<span id="cb21-2">prompt</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>'The quick brown'</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="9f2a2d84-afdd-465d-b95e-583cd7a8860a" data-execution_count="64">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">input_ids, attention_mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokenizer(prompt, return_tensors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>).values()</span>
<span id="cb23-2">input_ids.shape, attention_mask.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>(torch.Size([1, 3]), torch.Size([1, 3]))</code></pre>
</div>
</div>
<p>By setting <code>return_dict_in_generate=True</code> we can retrieve <code>past_key_values</code>.</p>
<div id="cell-47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8339ed0d-7ce1-45bd-8228-4e3a47f656af" data-execution_count="65">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb25-2">outputs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>GenerateDecoderOnlyOutput(sequences=tensor([[  504,  2365,  6354, 16438, 27003,   690,   260, 23790]],
       device='cuda:0'), scores=None, logits=None, attentions=None, hidden_states=None, past_key_values=&lt;transformers.cache_utils.DynamicCache object at 0x78c4f80c4f50&gt;)</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:35}}" data-outputid="df742156-715e-4ca3-f32e-cacc3303d278" data-execution_count="66">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">tokenizer.decode(outputs.sequences[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>'The quick brown fox jumps over the lazy'</code></pre>
</div>
</div>
<p>We have 8 total tokens—3 from the original prompt and 5 new tokens generated.</p>
<div id="cell-50" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4e26edc9-2958-47a7-eee0-7cc23ad3b7cd" data-execution_count="67">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">outputs.sequences.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>torch.Size([1, 8])</code></pre>
</div>
</div>
<p>Inspecting the values in the KV cache: there are 30 items in <code>key_cache</code> and <code>value_cache</code>, corresponding to the 30 layers in the model. For the last generated token (the 8th token) there were <code>7</code> <code>seen_tokens</code>.</p>
<div id="cell-52" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="144271c6-c0d9-443f-b11c-537dd82f3a58" data-execution_count="68">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(outputs.past_key_values.key_cache), <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(outputs.past_key_values.value_cache)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>(30, 30)</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d2af89b4-8842-46d2-c6b5-78e8ad4010d7" data-execution_count="69">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">outputs.past_key_values.seen_tokens</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>7</code></pre>
</div>
</div>
<p>The <code>key_cache</code> tensors all have the same shape: batch size, num_heads, seen_tokens, head_dim.</p>
<div id="cell-55" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="df7616f9-08fe-4fa3-f527-615bf9f83a1c" data-execution_count="70">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> outputs.past_key_values.key_cache: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(k.shape)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b16b73c8-950b-4443-dcea-4701436d9749" data-execution_count="71">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">model.config.num_attention_heads, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb37-2">model.config.num_hidden_layers, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb37-3">model.config.num_key_value_heads</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>(9, 30, 3)</code></pre>
</div>
</div>
<div id="cell-57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="41b06ce8-7bfc-4bc6-8ade-8ce7084457ac" data-execution_count="72">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn.k_proj.out_features</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>192</code></pre>
</div>
</div>
<div id="cell-58" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="316d31cf-cf8b-49e7-ebc7-1cb061de1468" data-execution_count="73">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>192</code></pre>
</div>
</div>
<p>The <code>value_cache</code> is similarly structured.</p>
<div id="cell-60" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f772dcaa-63fe-4315-e142-0cebb1c9e260" data-execution_count="74">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> v <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> outputs.past_key_values.value_cache: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(v.shape)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 7, 64])</code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c4db38cf-43f1-4172-ad94-706d347ecea2" data-execution_count="75">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">init_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outputs.past_key_values.key_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb45-2">init_k.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>torch.Size([1, 3, 7, 64])</code></pre>
</div>
</div>
<p>While the shapes of the <code>key_cache</code> tensors across layers are the same, their contents are not. This is because each layer has its own self attention module with its own <code>k_proj</code> and <code>v_proj</code> layers with their own learned weights.</p>
<div id="cell-63" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:141}}" data-outputid="09ec3082-2e2d-44ea-fa9a-1d7517d05b5f" data-execution_count="76">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> outputs.past_key_values.key_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> torch.allclose(init_k, k)</span></code></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-76-f08f1c95a8ee&gt;</span> in <span class="ansi-cyan-fg">&lt;cell line: 0&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">for</span> k <span class="ansi-green-fg">in</span> outputs<span class="ansi-blue-fg">.</span>past_key_values<span class="ansi-blue-fg">.</span>key_cache<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">assert</span> torch<span class="ansi-blue-fg">.</span>allclose<span class="ansi-blue-fg">(</span>init_k<span class="ansi-blue-fg">,</span> k<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>
</div>
</section>
<section id="inspecting-intermediate-keyvalue-cache-tensors-during-generation" class="level2">
<h2 class="anchored" data-anchor-id="inspecting-intermediate-keyvalue-cache-tensors-during-generation">Inspecting Intermediate Key/Value Cache Tensors During Generation</h2>
<p>Now to understand how KV cache is used during generation: I want to inspect the shape of the key and value cache tensors as the prompt increases by one token at a time.</p>
<p>To achieve this, I’ll add a hook to the first layer’s self attention module’s forward pass using <code>register_forward_hook</code>. I came to an incorrect conclusion in a <a href="https://youtu.be/4OBQkESiL0M?feature=shared&amp;t=965">previous video</a> and <a href="https://vishalbakshi.github.io/blog/posts/2025-04-02-Composer-Callback-Logging-dtypes/#composer-callback-walkthrough:~:text=Self%20attention%20cannot%20utilize%20register_forward_hook%20because%20the%20LlamaDecoderLayer%20does%20not%20call%20self%20attention%20forward%20pass%20with%20any%20positional%20arguments%3A">blog post</a> that you can’t use <code>register_forward_hook</code> for the Llama attention module because it doesn’t capture keyword arguments. What I didn’t realize is that you can capture kwargs with <code>register_forward_hook</code> by setting <code>with_kwargs=True</code>, which I have done below.</p>
<p>I wrapped <code>hook_fn</code> in <code>create_hook_fn</code> because I wanted to print out the <code>count</code> of total generated tokens.</p>
<div id="cell-67" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="222ac421-f62f-444c-d90f-a65a283d8e7b" data-execution_count="77">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_hook_fn():</span>
<span id="cb48-2">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb48-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> hook_fn(module, args, kwargs, output):</span>
<span id="cb48-4">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nonlocal</span> count</span>
<span id="cb48-5">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count, kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>].key_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape)</span>
<span id="cb48-6">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb48-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> hook_fn</span>
<span id="cb48-8"></span>
<span id="cb48-9">_hook_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_hook_fn()</span>
<span id="cb48-10">attn_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn</span>
<span id="cb48-11">hook_handle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_layer.register_forward_hook(_hook_fn, with_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb48-12"></span>
<span id="cb48-13">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb48-14">hook_handle.remove()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 torch.Size([1, 3, 3, 64])
2 torch.Size([1, 3, 4, 64])
3 torch.Size([1, 3, 5, 64])
4 torch.Size([1, 3, 6, 64])
5 torch.Size([1, 3, 7, 64])</code></pre>
</div>
</div>
<p>Let’s parse this output:</p>
<ul>
<li>The first new token generated sees only the 3 tokens in the prompt. The KV cache subsequently has a third dimension of <code>3</code>.</li>
<li>Each new token generated sees one more new token, so the third dimension (seen tokens) of <code>key_cache</code> and <code>value_cache</code> increases by <code>1</code></li>
</ul>
<p>I’ll slightly modify <code>hook_fn</code> so it prints out the first few shapes of <code>key_cache</code>, allowing us to see what all layers’ cache is storing from the perspective of <code>layer_idx=0</code>.</p>
<div id="cell-70" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="779782e8-dc50-4d92-fc8a-0712826d3cf7" data-execution_count="78">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_hook_fn():</span>
<span id="cb50-2">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb50-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> hook_fn(module, args, kwargs, output):</span>
<span id="cb50-4">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nonlocal</span> count</span>
<span id="cb50-5">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count)</span>
<span id="cb50-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>].key_cache[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(k.shape)</span>
<span id="cb50-7">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb50-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> hook_fn</span>
<span id="cb50-9"></span>
<span id="cb50-10">_hook_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_hook_fn()</span>
<span id="cb50-11">attn_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn</span>
<span id="cb50-12">hook_handle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_layer.register_forward_hook(_hook_fn, with_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb50-13"></span>
<span id="cb50-14">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb50-15">hook_handle.remove()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
torch.Size([1, 3, 3, 64])
2
torch.Size([1, 3, 4, 64])
torch.Size([1, 3, 3, 64])
torch.Size([1, 3, 3, 64])
torch.Size([1, 3, 3, 64])
torch.Size([1, 3, 3, 64])
3
torch.Size([1, 3, 5, 64])
torch.Size([1, 3, 4, 64])
torch.Size([1, 3, 4, 64])
torch.Size([1, 3, 4, 64])
torch.Size([1, 3, 4, 64])
4
torch.Size([1, 3, 6, 64])
torch.Size([1, 3, 5, 64])
torch.Size([1, 3, 5, 64])
torch.Size([1, 3, 5, 64])
torch.Size([1, 3, 5, 64])
5
torch.Size([1, 3, 7, 64])
torch.Size([1, 3, 6, 64])
torch.Size([1, 3, 6, 64])
torch.Size([1, 3, 6, 64])
torch.Size([1, 3, 6, 64])</code></pre>
</div>
</div>
<p>Since we are capturing the <code>key_cache</code> shapes from the first layer (<code>layer_idx=0</code>), the other subsequent layer’s cache tensors are 1 token “behind”, since the new token’s hidden states have not passed through the model yet.</p>
<p>Ultimately, I want to tie this all back to the <code>flash_attn_varlen_func</code>’s dostring’s causal mask example, so I’ll take a look at the <code>query_states</code> shape, copying code from the <a href="https://github.com/huggingface/transformers/blob/78d771c3c21922642fc9546ccb973cc7a182ab34/src/transformers/models/llama/modeling_llama.py#L232-L235"><code>LlamaAttention</code> forward pass</a>. I’ll also inspect the length of the <code>key_cache</code> and its shape, and the shape of <code>value_cache</code>.</p>
<div id="cell-73" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b70a2dd1-b26f-46f9-cf7e-311cccd3d82b" data-execution_count="79">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_hook_fn():</span>
<span id="cb52-2">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb52-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> hook_fn(module, args, kwargs, output):</span>
<span id="cb52-4">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nonlocal</span> count</span>
<span id="cb52-5">        input_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hidden_states'</span>].shape[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb52-6">        hidden_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>input_shape, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, module.head_dim)</span>
<span id="cb52-7">        query_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> module.q_proj(kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hidden_states'</span>]).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb52-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"len(past_key_value): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>].key_cache)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"query_states.shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>query_states<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"k.shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>key_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">,"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"v.shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>value_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb52-9">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb52-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> hook_fn</span>
<span id="cb52-11"></span>
<span id="cb52-12">_hook_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_hook_fn()</span>
<span id="cb52-13">attn_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn</span>
<span id="cb52-14">hook_handle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_layer.register_forward_hook(_hook_fn, with_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb52-15"></span>
<span id="cb52-16">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb52-17">hook_handle.remove()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 len(past_key_value): 1, query_states.shape: torch.Size([1, 9, 3, 64]), k.shape: torch.Size([1, 3, 3, 64]), v.shape: torch.Size([1, 3, 3, 64])
2 len(past_key_value): 30, query_states.shape: torch.Size([1, 9, 1, 64]), k.shape: torch.Size([1, 3, 4, 64]), v.shape: torch.Size([1, 3, 4, 64])
3 len(past_key_value): 30, query_states.shape: torch.Size([1, 9, 1, 64]), k.shape: torch.Size([1, 3, 5, 64]), v.shape: torch.Size([1, 3, 5, 64])
4 len(past_key_value): 30, query_states.shape: torch.Size([1, 9, 1, 64]), k.shape: torch.Size([1, 3, 6, 64]), v.shape: torch.Size([1, 3, 6, 64])
5 len(past_key_value): 30, query_states.shape: torch.Size([1, 9, 1, 64]), k.shape: torch.Size([1, 3, 7, 64]), v.shape: torch.Size([1, 3, 7, 64])</code></pre>
</div>
</div>
<p>We see that there are 9 query heads, and 3 KV heads. The total hidden dimension for Q, K and V layers is 3 x 64 = 192.</p>
<p>When the first token is being the generated, the length of the <code>key_cache</code> for <code>layer_idx=0</code> is <code>1</code>, because this is the first attention module’s first forward pass. For subsequent tokens (2, 3, 4, 5) the length of the <code>key_cache</code> is <code>30</code>, as the cache has been instantiated for all 30 layers after the first token is generated.</p>
<p>Finally, we see that the <code>key_cache</code> and <code>value_cache</code> shapes are equal, as expected.</p>
</section>
<section id="which-flash-attention-interface-is-used" class="level2">
<h2 class="anchored" data-anchor-id="which-flash-attention-interface-is-used">Which Flash Attention Interface is Used?</h2>
<p>Since this exercise is part of my journey to understand the <code>flash_attn_varlen_func</code>, I was curious to confirm by visual inspection which Flash Attention interface function was being used. To achieve this, I wrote a “debug” version for the following three functions:</p>
<ul>
<li><a href="https://github.com/huggingface/transformers/blob/78d771c3c21922642fc9546ccb973cc7a182ab34/src/transformers/models/llama/modeling_llama.py#L223"><code>LlamaAttention.forward</code></a></li>
<li><a href="https://github.com/huggingface/transformers/blob/78d771c3c21922642fc9546ccb973cc7a182ab34/src/transformers/integrations/flash_attention.py#L14"><code>flash_attention_forward</code></a></li>
<li><a href="https://github.com/huggingface/transformers/blob/78d771c3c21922642fc9546ccb973cc7a182ab34/src/transformers/modeling_flash_attention_utils.py#L284"><code>_flash_attention_forward</code></a></li>
</ul>
<p>How did I know which functions to modify? Well, largely because I <a href="https://vishalbakshi.github.io/blog/posts/2025-05-04-Understanding-Sequence-Packing/">have done this exercise before</a> when I was trying to understand what triggered the use of <code>flash_attn_varlen_func</code>.</p>
<p>More concisely, I first inspected the forward pass of the attention module:</p>
<div id="cell-79" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="fc396455-d320-43da-9491-a9555f6118a5" data-execution_count="80">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> inspect <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> getsource</span>
<span id="cb54-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(getsource(model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn.forward))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    def forward(
        self,
        hidden_states: torch.Tensor,
        position_embeddings: Tuple[torch.Tensor, torch.Tensor],
        attention_mask: Optional[torch.Tensor],
        past_key_value: Optional[Cache] = None,
        cache_position: Optional[torch.LongTensor] = None,
        **kwargs: Unpack[FlashAttentionKwargs],
    ) -&gt; Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]:
        input_shape = hidden_states.shape[:-1]
        hidden_shape = (*input_shape, -1, self.head_dim)

        query_states = self.q_proj(hidden_states).view(hidden_shape).transpose(1, 2)
        key_states = self.k_proj(hidden_states).view(hidden_shape).transpose(1, 2)
        value_states = self.v_proj(hidden_states).view(hidden_shape).transpose(1, 2)

        cos, sin = position_embeddings
        query_states, key_states = apply_rotary_pos_emb(query_states, key_states, cos, sin)

        if past_key_value is not None:
            # sin and cos are specific to RoPE models; cache_position needed for the static cache
            cache_kwargs = {"sin": sin, "cos": cos, "cache_position": cache_position}
            key_states, value_states = past_key_value.update(key_states, value_states, self.layer_idx, cache_kwargs)

        attention_interface: Callable = eager_attention_forward

        if self.config._attn_implementation != "eager":
            if self.config._attn_implementation == "sdpa" and kwargs.get("output_attentions", False):
                logger.warning_once(
                    "`torch.nn.functional.scaled_dot_product_attention` does not support `output_attentions=True`. Falling back to "
                    'eager attention. This warning can be removed using the argument `attn_implementation="eager"` when loading the model.'
                )
            else:
                attention_interface = ALL_ATTENTION_FUNCTIONS[self.config._attn_implementation]

        attn_output, attn_weights = attention_interface(
            self,
            query_states,
            key_states,
            value_states,
            attention_mask,
            dropout=0.0 if not self.training else self.attention_dropout,
            scaling=self.scaling,
            **kwargs,
        )

        attn_output = attn_output.reshape(*input_shape, -1).contiguous()
        attn_output = self.o_proj(attn_output)
        return attn_output, attn_weights
</code></pre>
</div>
</div>
<p>In there I saw the following lines of interest:</p>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config._attn_implementation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eager"</span>:</span>
<span id="cb56-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config._attn_implementation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sdpa"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> kwargs.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_attentions"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb56-3">        logger.warning_once(</span>
<span id="cb56-4">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`torch.nn.functional.scaled_dot_product_attention` does not support `output_attentions=True`. Falling back to "</span></span>
<span id="cb56-5">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eager attention. This warning can be removed using the argument `attn_implementation="eager"` when loading the model.'</span></span>
<span id="cb56-6">        )</span>
<span id="cb56-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb56-8">        attention_interface <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ALL_ATTENTION_FUNCTIONS[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config._attn_implementation]</span></code></pre></div>
<p>In our case, the <code>else</code> block would trigger and <code>ALL_ATTENTION_FUNCTIONS</code> would be accesssed. Looking at that constant directly we can see that for our model’s <code>_attn_implementation</code> (<code>'flash_attention_2'</code>) the attention interface funtion is <code>flash_attention_forward</code>.</p>
<div id="cell-82" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:35}}" data-outputid="8d40574b-2e73-4ad6-a6b0-7490e87e4108" data-execution_count="81">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">model.config._attn_implementation</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>'flash_attention_2'</code></pre>
</div>
</div>
<div id="cell-83" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:174}}" data-outputid="fc2cd815-84be-44c3-8255-4b6a2f33e5c8" data-execution_count="82">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ALL_ATTENTION_FUNCTIONS</span>
<span id="cb59-2">ALL_ATTENTION_FUNCTIONS[model.config._attn_implementation]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div style="max-width:800px; border: 1px solid var(--colab-border-color);"><style>
      pre.function-repr-contents {
        overflow-x: auto;
        padding: 8px 12px;
        max-height: 500px;
      }

      pre.function-repr-contents.function-repr-contents-collapsed {
        cursor: pointer;
        max-height: 100px;
      }
    </style>
    <pre style="white-space: initial; background:
         var(--colab-secondary-surface-color); padding: 8px 12px;
         border-bottom: 1px solid var(--colab-border-color);"><b>transformers.integrations.flash_attention.flash_attention_forward</b><br>def flash_attention_forward(module: torch.nn.Module, query: torch.Tensor, key: torch.Tensor, value: torch.Tensor, attention_mask: Optional[torch.Tensor], dropout: float=0.0, scaling: Optional[float]=None, sliding_window: Optional[int]=None, softcap: Optional[float]=None, **kwargs) -&gt; Tuple[torch.Tensor, None]</pre><pre class="function-repr-contents function-repr-contents-collapsed" style="">/usr/local/lib/python3.11/dist-packages/transformers/integrations/flash_attention.py&lt;no docstring&gt;</pre>
      <script>
      if (google.colab.kernel.accessAllowed && google.colab.files && google.colab.files.view) {
        for (const element of document.querySelectorAll('.filepath')) {
          element.style.display = 'block'
          element.onclick = (event) => {
            event.preventDefault();
            event.stopPropagation();
            google.colab.files.view(element.textContent, 11);
          };
        }
      }
      for (const element of document.querySelectorAll('.function-repr-contents')) {
        element.onclick = (event) => {
          event.preventDefault();
          event.stopPropagation();
          element.classList.toggle('function-repr-contents-collapsed');
        };
      }
      </script>
      </div>
</div>
</div>
<div id="cell-84" class="cell" data-execution_count="85">
<details class="code-fold">
<summary>Show `_debug_flash_attention_forward</summary>
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional, Tuple</span>
<span id="cb60-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> inspect</span>
<span id="cb60-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> flash_attn <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> flash_attn_func, flash_attn_varlen_func</span>
<span id="cb60-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb60-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb60-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_flash_attention_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> is_flash_attn_greater_or_equal, fa_peft_integration_check, _upad_input, pad_input, prepare_fa2_from_position_ids</span>
<span id="cb60-7"></span>
<span id="cb60-8">_flash_supports_window_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"window_size"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(inspect.signature(flash_attn_func).parameters)</span>
<span id="cb60-9">flash_241 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> is_flash_attn_greater_or_equal(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2.4.1"</span>)</span>
<span id="cb60-10">deterministic_g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb60-11"></span>
<span id="cb60-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _debug_flash_attention_forward(</span>
<span id="cb60-13">    query_states: torch.Tensor,</span>
<span id="cb60-14">    key_states: torch.Tensor,</span>
<span id="cb60-15">    value_states: torch.Tensor,</span>
<span id="cb60-16">    attention_mask: Optional[torch.Tensor],</span>
<span id="cb60-17">    query_length: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb60-18">    is_causal: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>,</span>
<span id="cb60-19">    dropout: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb60-20">    position_ids: Optional[torch.Tensor] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-21">    softmax_scale: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-22">    sliding_window: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-23">    use_top_left_mask: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb60-24">    softcap: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-25">    deterministic: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-26">    cu_seq_lens_q: Optional[torch.LongTensor] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-27">    cu_seq_lens_k: Optional[torch.LongTensor] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-28">    max_length_q: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-29">    max_length_k: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-30">    target_dtype: Optional[torch.dtype] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb60-31">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs,</span>
<span id="cb60-32">):</span>
<span id="cb60-33"></span>
<span id="cb60-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> use_top_left_mask:</span>
<span id="cb60-35">        causal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> is_causal</span>
<span id="cb60-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb60-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">TODO</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">: Remove the `query_length != 1` check once Flash Attention for RoCm is bumped to 2.1.</span></span>
<span id="cb60-38">        causal <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> is_causal <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb60-39"></span>
<span id="cb60-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assuming 4D tensors, key_states.shape[1] is the key/value sequence length (source length).</span></span>
<span id="cb60-41">    use_sliding_windows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb60-42">        _flash_supports_window_size <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> sliding_window <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> key_states.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> sliding_window</span>
<span id="cb60-43">    )</span>
<span id="cb60-44">    flash_kwargs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"window_size"</span>: (sliding_window, sliding_window)} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> use_sliding_windows <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {}</span>
<span id="cb60-45"></span>
<span id="cb60-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> flash_241:</span>
<span id="cb60-47">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> deterministic <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb60-48">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">global</span> deterministic_g</span>
<span id="cb60-49">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> deterministic_g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb60-50">                deterministic_g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.environ.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FLASH_ATTENTION_DETERMINISTIC"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span></span>
<span id="cb60-51">            deterministic <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deterministic_g</span>
<span id="cb60-52">        flash_kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"deterministic"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deterministic</span>
<span id="cb60-53"></span>
<span id="cb60-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> softcap <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb60-55">        flash_kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"softcap"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> softcap</span>
<span id="cb60-56"></span>
<span id="cb60-57">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PEFT possibly silently casts tensors to fp32, this potentially reconverts to correct dtype or is a no op</span></span>
<span id="cb60-58">    query_states, key_states, value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> fa_peft_integration_check(</span>
<span id="cb60-59">        query_states, key_states, value_states, target_dtype</span>
<span id="cb60-60">    )</span>
<span id="cb60-61"></span>
<span id="cb60-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contains at least one padding token in the sequence</span></span>
<span id="cb60-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> attention_mask <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb60-64">        batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query_states.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb60-65">        query_states, key_states, value_states, indices_q, cu_seq_lens, max_seq_lens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _upad_input(</span>
<span id="cb60-66">            query_states, key_states, value_states, attention_mask, query_length</span>
<span id="cb60-67">        )</span>
<span id="cb60-68">        cu_seqlens_q, cu_seqlens_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cu_seq_lens</span>
<span id="cb60-69">        max_seqlen_in_batch_q, max_seqlen_in_batch_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> max_seq_lens</span>
<span id="cb60-70">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"if attention_mask is not None: flash_attn_varlen_func is being used"</span>)</span>
<span id="cb60-71">        attn_output_unpad <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flash_attn_varlen_func(</span>
<span id="cb60-72">            query_states,</span>
<span id="cb60-73">            key_states,</span>
<span id="cb60-74">            value_states,</span>
<span id="cb60-75">            cu_seqlens_q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cu_seqlens_q,</span>
<span id="cb60-76">            cu_seqlens_k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cu_seqlens_k,</span>
<span id="cb60-77">            max_seqlen_q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_seqlen_in_batch_q,</span>
<span id="cb60-78">            max_seqlen_k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_seqlen_in_batch_k,</span>
<span id="cb60-79">            dropout_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dropout,</span>
<span id="cb60-80">            softmax_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>softmax_scale,</span>
<span id="cb60-81">            causal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>causal,</span>
<span id="cb60-82">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>flash_kwargs,</span>
<span id="cb60-83">        )</span>
<span id="cb60-84">        attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pad_input(attn_output_unpad, indices_q, batch_size, query_length)</span>
<span id="cb60-85"></span>
<span id="cb60-86">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If position_ids is provided and check all examples do not contain only 1 sequence, If tensor in increasing</span></span>
<span id="cb60-87">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># then we probably have one sequence, otherwise it is packed. Additionally check we are in pre-fill/training stage.</span></span>
<span id="cb60-88">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use `flash_attn_varlen_func` to prevent cross-example attention and also allow padding free approach</span></span>
<span id="cb60-89">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> position_ids <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (</span>
<span id="cb60-90">        max_length_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> (query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> (torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>())</span>
<span id="cb60-91">    ):</span>
<span id="cb60-92">        batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query_states.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb60-93"></span>
<span id="cb60-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> cu_seq_lens_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> cu_seq_lens_k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb60-95">            query_states, key_states, value_states, indices_q, cu_seq_lens, max_seq_lens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb60-96">                prepare_fa2_from_position_ids(query_states, key_states, value_states, position_ids)</span>
<span id="cb60-97">            )</span>
<span id="cb60-98"></span>
<span id="cb60-99">            cu_seq_lens_q, cu_seq_lens_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cu_seq_lens</span>
<span id="cb60-100">            max_length_q, max_length_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> max_seq_lens</span>
<span id="cb60-101"></span>
<span id="cb60-102">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb60-103">            query_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, query_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), query_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb60-104">            key_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> key_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, key_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), key_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb60-105">            value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value_states.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, value_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), value_states.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb60-106"></span>
<span id="cb60-107">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"position_ids is not None: flash_attn_varlen_func is being used"</span>)</span>
<span id="cb60-108">        attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flash_attn_varlen_func(</span>
<span id="cb60-109">            query_states,</span>
<span id="cb60-110">            key_states,</span>
<span id="cb60-111">            value_states,</span>
<span id="cb60-112">            cu_seqlens_q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cu_seq_lens_q,</span>
<span id="cb60-113">            cu_seqlens_k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cu_seq_lens_k,</span>
<span id="cb60-114">            max_seqlen_q<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_length_q,</span>
<span id="cb60-115">            max_seqlen_k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_length_k,</span>
<span id="cb60-116">            dropout_p<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dropout,</span>
<span id="cb60-117">            softmax_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>softmax_scale,</span>
<span id="cb60-118">            causal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>causal,</span>
<span id="cb60-119">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>flash_kwargs,</span>
<span id="cb60-120">        )</span>
<span id="cb60-121"></span>
<span id="cb60-122">        attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_output.view(batch_size, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, attn_output.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), attn_output.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb60-123"></span>
<span id="cb60-124">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb60-125">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attn_func is being used"</span>)</span>
<span id="cb60-126">        attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flash_attn_func(</span>
<span id="cb60-127">            query_states, key_states, value_states, dropout, softmax_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>softmax_scale, causal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>causal, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>flash_kwargs</span>
<span id="cb60-128">        )</span>
<span id="cb60-129"></span>
<span id="cb60-130">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> attn_output</span></code></pre></div>
</details>
</div>
<div id="cell-85" class="cell" data-execution_count="86">
<details class="code-fold">
<summary>Show `debug_flash_attention_forward</summary>
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional, Tuple</span>
<span id="cb61-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb61-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_flash_attention_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> _flash_attention_forward, flash_attn_supports_top_left_mask</span>
<span id="cb61-4"></span>
<span id="cb61-5">_use_top_left_mask <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> flash_attn_supports_top_left_mask()</span>
<span id="cb61-6"></span>
<span id="cb61-7"></span>
<span id="cb61-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> debug_flash_attention_forward(</span>
<span id="cb61-9">    module: torch.nn.Module,</span>
<span id="cb61-10">    query: torch.Tensor,</span>
<span id="cb61-11">    key: torch.Tensor,</span>
<span id="cb61-12">    value: torch.Tensor,</span>
<span id="cb61-13">    attention_mask: Optional[torch.Tensor],</span>
<span id="cb61-14">    dropout: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb61-15">    scaling: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb61-16">    sliding_window: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb61-17">    softcap: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb61-18">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs,</span>
<span id="cb61-19">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Tuple[torch.Tensor, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]:</span>
<span id="cb61-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> kwargs.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_attentions"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> kwargs.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"head_mask"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb61-21">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb61-22">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`flash_attention_2` does not support `output_attentions=True` or `head_mask`."</span></span>
<span id="cb61-23">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Please set your attention to `eager` if you want any of these features."</span></span>
<span id="cb61-24">        )</span>
<span id="cb61-25"></span>
<span id="cb61-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is before the transpose</span></span>
<span id="cb61-27">    seq_len <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb61-28"></span>
<span id="cb61-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FA2 uses non-transposed inputs</span></span>
<span id="cb61-30">    query <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query.transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb61-31">    key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> key.transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb61-32">    value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value.transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb61-33"></span>
<span id="cb61-34">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># In PEFT, usually we cast the layer norms in float32 for training stability reasons</span></span>
<span id="cb61-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># therefore the input hidden states gets silently casted in float32. Hence, we need</span></span>
<span id="cb61-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cast them back in the correct dtype just to be sure everything works as expected.</span></span>
<span id="cb61-37">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This might slowdown training &amp; inference so it is recommended to not cast the LayerNorms</span></span>
<span id="cb61-38">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># in fp32. (usually our RMSNorm modules handle it correctly)</span></span>
<span id="cb61-39">    target_dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb61-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> query.dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> torch.float32:</span>
<span id="cb61-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> torch.is_autocast_enabled():</span>
<span id="cb61-42">            target_dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.get_autocast_gpu_dtype()</span>
<span id="cb61-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Handle the case where the model is quantized</span></span>
<span id="cb61-44">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(module.config, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_pre_quantization_dtype"</span>):</span>
<span id="cb61-45">            target_dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> module.config._pre_quantization_dtype</span>
<span id="cb61-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb61-47">            target_dtype <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(layer <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> layer <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> module.modules() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(layer, torch.nn.Linear)).weight.dtype</span>
<span id="cb61-48"></span>
<span id="cb61-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FA2 always relies on the value set in the module, so remove it if present in kwargs to avoid passing it twice</span></span>
<span id="cb61-50">    kwargs.pop(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"is_causal"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>)</span>
<span id="cb61-51"></span>
<span id="cb61-52">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DEBUG: calling _flash_attention_forward"</span>)</span>
<span id="cb61-53">    attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _debug_flash_attention_forward(</span>
<span id="cb61-54">        query,</span>
<span id="cb61-55">        key,</span>
<span id="cb61-56">        value,</span>
<span id="cb61-57">        attention_mask,</span>
<span id="cb61-58">        query_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seq_len,</span>
<span id="cb61-59">        is_causal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>module.is_causal,</span>
<span id="cb61-60">        dropout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dropout,</span>
<span id="cb61-61">        softmax_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>scaling,</span>
<span id="cb61-62">        sliding_window<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sliding_window,</span>
<span id="cb61-63">        softcap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>softcap,</span>
<span id="cb61-64">        use_top_left_mask<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>_use_top_left_mask,</span>
<span id="cb61-65">        target_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>target_dtype,</span>
<span id="cb61-66">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs,</span>
<span id="cb61-67">    )</span>
<span id="cb61-68"></span>
<span id="cb61-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> attn_output, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span></code></pre></div>
</details>
</div>
<div id="cell-86" class="cell" data-execution_count="87">
<details class="code-fold">
<summary>Show `debug_forward</summary>
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Callable, Optional, Tuple, Union</span>
<span id="cb62-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_flash_attention_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FlashAttentionKwargs</span>
<span id="cb62-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.cache_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Cache, DynamicCache</span>
<span id="cb62-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.processing_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Unpack</span>
<span id="cb62-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.models.llama.modeling_llama <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> apply_rotary_pos_emb</span>
<span id="cb62-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.models.llama.modeling_llama <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> eager_attention_forward</span>
<span id="cb62-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers.modeling_utils <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ALL_ATTENTION_FUNCTIONS</span>
<span id="cb62-8"></span>
<span id="cb62-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> debug_forward(</span>
<span id="cb62-10">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb62-11">    hidden_states: torch.Tensor,</span>
<span id="cb62-12">    position_embeddings: Tuple[torch.Tensor, torch.Tensor],</span>
<span id="cb62-13">    attention_mask: Optional[torch.Tensor],</span>
<span id="cb62-14">    past_key_value: Optional[Cache] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb62-15">    cache_position: Optional[torch.LongTensor] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb62-16">    <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs: Unpack[FlashAttentionKwargs],</span>
<span id="cb62-17">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Tuple[torch.Tensor, Optional[torch.Tensor], Optional[Tuple[torch.Tensor]]]:</span>
<span id="cb62-18">    input_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> hidden_states.shape[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb62-19">    hidden_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>input_shape, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.head_dim)</span>
<span id="cb62-20"></span>
<span id="cb62-21">    query_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.q_proj(hidden_states).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb62-22">    key_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k_proj(hidden_states).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb62-23">    value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.v_proj(hidden_states).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb62-24"></span>
<span id="cb62-25">    cos, sin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> position_embeddings</span>
<span id="cb62-26">    query_states, key_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> apply_rotary_pos_emb(query_states, key_states, cos, sin)</span>
<span id="cb62-27"></span>
<span id="cb62-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> past_key_value <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb62-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sin and cos are specific to RoPE models; cache_position needed for the static cache</span></span>
<span id="cb62-30">        cache_kwargs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sin"</span>: sin, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cos"</span>: cos, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cache_position"</span>: cache_position}</span>
<span id="cb62-31">        key_states, value_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> past_key_value.update(key_states, value_states, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.layer_idx, cache_kwargs)</span>
<span id="cb62-32"></span>
<span id="cb62-33">    attention_interface: Callable <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> eager_attention_forward</span>
<span id="cb62-34"></span>
<span id="cb62-35">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config._attn_implementation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eager"</span>:</span>
<span id="cb62-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config._attn_implementation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sdpa"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> kwargs.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output_attentions"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>):</span>
<span id="cb62-37">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(</span>
<span id="cb62-38">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"`torch.nn.functional.scaled_dot_product_attention` does not support `output_attentions=True`. Falling back to "</span></span>
<span id="cb62-39">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eager attention. This warning can be removed using the argument `attn_implementation="eager"` when loading the model.'</span></span>
<span id="cb62-40">            )</span>
<span id="cb62-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb62-42">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#attention_interface = ALL_ATTENTION_FUNCTIONS[self.config._attn_implementation]</span></span>
<span id="cb62-43">            attention_interface <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> debug_flash_attention_forward</span>
<span id="cb62-44"></span>
<span id="cb62-45">    attn_output, attn_weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attention_interface(</span>
<span id="cb62-46">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb62-47">        query_states,</span>
<span id="cb62-48">        key_states,</span>
<span id="cb62-49">        value_states,</span>
<span id="cb62-50">        attention_mask,</span>
<span id="cb62-51">        dropout<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.training <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.attention_dropout,</span>
<span id="cb62-52">        scaling<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.scaling,</span>
<span id="cb62-53">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs,</span>
<span id="cb62-54">    )</span>
<span id="cb62-55"></span>
<span id="cb62-56">    attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_output.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>input_shape, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).contiguous()</span>
<span id="cb62-57">    attn_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.o_proj(attn_output)</span>
<span id="cb62-58">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> attn_output, attn_weights</span></code></pre></div>
</details>
</div>
<div id="cell-87" class="cell">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>)</span>
<span id="cb63-2">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span>, attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>, torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span></code></pre></div>
</div>
<p><code>types.MethodType</code> binds a function (<code>debug_forward</code>) as a method for a class (<code>attn_layer_instance</code>).</p>
<div id="cell-89" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> types</span>
<span id="cb64-2">types.MethodType??</span></code></pre></div>
</div>
<pre><code>Init signature: types.MethodType(self, /, *args, **kwargs)
Docstring:      Create a bound instance method object.
Type:           type
Subclasses:    </code></pre>
<div id="cell-91" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">attn_layer_instance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn</span>
<span id="cb66-2"></span>
<span id="cb66-3">original_layer_forward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_layer_instance.forward</span>
<span id="cb66-4"></span>
<span id="cb66-5">attn_layer_instance.forward <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> types.MethodType(debug_forward, attn_layer_instance)</span></code></pre></div>
</div>
<div id="cell-92" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f9c3e320-4cc7-4467-bd12-727167ceb4b9" data-execution_count="91">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_hook_fn():</span>
<span id="cb67-2">    count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb67-3">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> hook_fn(module, args, kwargs, output):</span>
<span id="cb67-4">        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">nonlocal</span> count</span>
<span id="cb67-5">        input_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hidden_states'</span>].shape[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb67-6">        hidden_shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>input_shape, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, module.head_dim)</span>
<span id="cb67-7">        query_states <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> module.q_proj(kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hidden_states'</span>]).view(hidden_shape).transpose(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb67-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(count, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>].key_cache), <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"query_states.shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>query_states<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"k.shape: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>kwargs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'past_key_value'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>key_cache[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>shape<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb67-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for k in kwargs['past_key_value'].key_cache: print(k.shape) # do this for v as well</span></span>
<span id="cb67-10">        count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb67-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> hook_fn</span>
<span id="cb67-12"></span>
<span id="cb67-13">_hook_fn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_hook_fn()</span>
<span id="cb67-14">attn_layer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn</span>
<span id="cb67-15">hook_handle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> attn_layer.register_forward_hook(_hook_fn, with_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb67-16"></span>
<span id="cb67-17">outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(input_ids, pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokenizer.eos_token_id, do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, return_dict_in_generate<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, max_new_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb67-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(outputs.sequences[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape)</span>
<span id="cb67-19"></span>
<span id="cb67-20">hook_handle.remove()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DEBUG: calling _flash_attention_forward
flash_attn_func is being used
1 1 query_states.shape: torch.Size([1, 9, 3, 64]) k.shape: torch.Size([1, 3, 3, 64])
DEBUG: calling _flash_attention_forward
flash_attn_func is being used
2 30 query_states.shape: torch.Size([1, 9, 1, 64]) k.shape: torch.Size([1, 3, 4, 64])
DEBUG: calling _flash_attention_forward
flash_attn_func is being used
3 30 query_states.shape: torch.Size([1, 9, 1, 64]) k.shape: torch.Size([1, 3, 5, 64])
DEBUG: calling _flash_attention_forward
flash_attn_func is being used
4 30 query_states.shape: torch.Size([1, 9, 1, 64]) k.shape: torch.Size([1, 3, 6, 64])
DEBUG: calling _flash_attention_forward
flash_attn_func is being used
5 30 query_states.shape: torch.Size([1, 9, 1, 64]) k.shape: torch.Size([1, 3, 7, 64])
torch.Size([8])</code></pre>
</div>
</div>
<p>From the print statements in my <code>_debug_flash_attention_forward</code> function, I can see that <code>flash_attn_func</code>, the non-variable-length interface, is being used for this generation. That makes sense because I only have 1 item in the batch.</p>
</section>
<section id="understanding-the-flash_attn_varlen_func-causal-mask-docstring" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-flash_attn_varlen_func-causal-mask-docstring">Understanding the <code>flash_attn_varlen_func</code> Causal Mask Docstring</h2>
<p>A quick recap of what we’ve learned so far:</p>
<ul>
<li>HuggingFace’s <code>model.generate</code> uses KV cache by default (<code>DynamicCache</code>) stored as <code>past_key_values</code>.</li>
<li>For most scenarios, the <code>DynamicCache</code> is updated by concatenating the previous token’s <code>key_cache</code> and <code>value_cache</code> with the <code>key_states</code> and <code>value_states</code> generated for the current new token.</li>
<li>As the next token is generated for a given prompt, <code>query_states</code> has a sequence length of <code>1</code>, whereas <code>key_cache</code> and <code>value_cache</code> tensors’ sequence dimension increases by 1. This is directly relates to the <code>flash_attn_varlen_func</code> causal mask docstring example.</li>
<li><code>model.generate</code> utilized the <code>flash_attn_func</code> interface.</li>
</ul>
<p>Let’s look at the <code>flash_attn_varlen_func</code> docstring snippet again:</p>
<pre><code>If causal=True, the causal mask is aligned to the bottom right corner of the attention matrix.
For example, if seqlen_q = 2 and seqlen_k = 5, the causal mask (1 = keep, 0 = masked out) is:
    1 1 1 1 0
    1 1 1 1 1
If seqlen_q = 5 and seqlen_k = 2, the causal mask is:
    0 0
    0 0
    0 0
    1 0
    1 1
If the row of the mask is all zero, the output will be zero.</code></pre>
<p>I’ll annotate the causal mask examples a bit:</p>
<section id="seqlen_q2-and-seqlen_k5" class="level3">
<h3 class="anchored" data-anchor-id="seqlen_q2-and-seqlen_k5"><code>seqlen_q=2</code> and <code>seqlen_k=5</code></h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">k_0</th>
<th style="text-align: center;">k_1</th>
<th style="text-align: center;">k_2</th>
<th style="text-align: center;">k_3</th>
<th style="text-align: center;">k_4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>q_0</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>q_1</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>The final query token (<code>q_1</code>) sees all 5 key tokens. The first query token (<code>q_0</code>) only sees the first four key tokens.</p>
</section>
<section id="seqlen_q5-and-seqlen_k2" class="level3">
<h3 class="anchored" data-anchor-id="seqlen_q5-and-seqlen_k2"><code>seqlen_q=5</code> and <code>seqlen_k=2</code></h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">k_0</th>
<th style="text-align: center;">k_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>q_0</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>q_1</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>q_2</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>q_3</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>q_4</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>Again, the final query token (<code>q_4</code>) sees all key tokens. As a consequence, since there are only two key tokens, the first three query tokens do not see any key tokens.</p>
<p>In each example, we are offsetting the shorter sequence so that its last token aligns with the other sequences’s last token. This is what the <code>flash_attn_varlen_func</code> docstring means by</p>
<blockquote class="blockquote">
<p><code>the causal mask is aligned to the bottom right corner of the attention matrix</code></p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Annotated casual masks"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-03-flash_attn_varlen_func-casual-mask/1.png" class="img-fluid figure-img" alt="Annotated casual masks"></a></p>
<figcaption>Annotated casual masks</figcaption>
</figure>
</div>
<p>In the first case, the query sequence is shorter so we offset it by 3 positions to align with the last two tokens of the key sequence. The “offset” positions are 1s (this satisfies the rule of causality <code>j &lt;= i</code>, query tokens can look back). In the second case, the key sequence is shorter so we offset it by 3 positions to align with the last two tokens of the query sequence. The offset positions are 0s (again, this satisfies causality, the query tokens have nothing to look back to).</p>
<p>The <code>model.generate</code> examples above are like the first case, where there are more key positions than query positions. The query token (the next-token being predicted) can look back at all key tokens.</p>
</section>
<section id="a-math-y-way-to-think-about-it" class="level3">
<h3 class="anchored" data-anchor-id="a-math-y-way-to-think-about-it">A Math-y Way to think About It</h3>
<p>For those of you who like to think through things with math.</p>
<p>Causality (in language modeling) means that a query token vector at the i-th position can only see its own and previous tokens’ key vectors. Having different sequence lengths for Q and K (5 and 2 or 2 and 5 in the <code>flash_attn_varlen_func</code> docstring example or 1 and 3-7 in my inspections above) requires you to pick <em>how</em> Q and K are aligned. In the case of <code>flash_attn_varlen_func</code> they choose to align Q and K such as <em>the last Q token vector is aligned with the last K token vector</em>. This becomes our “present moment” <code>P</code> with causality allowing access to previous tokens only.</p>
<p>Let’s define <code>i</code> as the position of query tokens and <code>j</code> as the position of key tokens. Causality is defined as token pairs that follow the inequality: <code>j &lt;= i + (seqlen_k - seqlen_q)</code>.</p>
<p>For the first causal mask example:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><code>j</code></th>
<th style="text-align: center;"><code>i</code></th>
<th style="text-align: center;"><code>j &lt;= i + (seqlen_k - seqlen_q)</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0 &lt;= 0 + 3 (<code>True</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1 &lt;= 0 + 3 (<code>True</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2 &lt;= 0 + 3 (<code>True</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">3 &lt;= 0 + 3 (<code>True</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">4 &lt;= 0 + 3 (<code>False</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0 &lt;= 1 + 3 (<code>True</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1 &lt;= 1 + 3 (<code>True</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2 &lt;= 1 + 3 (<code>True</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">3 &lt;= 1 + 3 (<code>True</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">4 &lt;= 1 + 3 (<code>True</code>)</td>
</tr>
</tbody>
</table>
<p>Where does <code>j &lt;= i + (seqlen_k - seqlen_q)</code> come from?</p>
<p>Let <code>q_i</code> be a query that is <code>seqlen_q - 1 - i</code> steps before the end of the query sequence, and <code>k_j</code> be a key that is <code>seqlen_k - 1 - j</code> steps before the end of the key sequence. More concretely, for the example where <code>seqlen_q = 2</code> and <code>seqlen_k=5</code>:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">q_i</th>
<th style="text-align: center;">Steps before end</th>
<th style="text-align: center;"><code>seqlen_q - 1 - i</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">q_0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">2 - 1 - 0</td>
</tr>
<tr class="even">
<td style="text-align: center;">q_1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">2 - 1 - 1</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">k_j</th>
<th style="text-align: center;">Steps before end</th>
<th style="text-align: center;"><code>seqlen_k - 1 - j</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">k_0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">5 - 1 - 0</td>
</tr>
<tr class="even">
<td style="text-align: center;">k_1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">5 - 1 - 1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">k_2</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">5 - 2 - 1</td>
</tr>
<tr class="even">
<td style="text-align: center;">k_3</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">5 - 3 - 1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">k_4</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">5 - 4 - 1</td>
</tr>
</tbody>
</table>
<p>By picking a “present moment” <code>P</code> (the last token in each sequence) have a unified timeline <code>p</code> such that causality is defined as: <code>p_j &lt;= p_i</code>. <code>k_j</code> has a position on the timeline <code>p_j = P - (seqlen_k - 1 - j)</code> and <code>q_i</code> has a position on the timeline <code>p_i = P - (seqlen_q - 1 - i)</code>. Causality requires that <code>p_j &lt;= p_i</code> on our “unified timeline”. Writing that out:</p>
<p><code>P - (seqlen_k - 1 - j) &lt;= P - (seqlen_q - 1 - i)</code></p>
<p>Cancelling out the <code>P</code>s and distributing the minus sign:</p>
<p><code>-seqlen_k + 1 + j &lt;= -seqlen_q + 1 + i</code></p>
<p>Isolating <code>j</code> on the lefthand side:</p>
<p><code>j &lt;= -seqlen_q + 1 + i + seqlen_k - 1</code></p>
<p>Simplifying + reordering:</p>
<p><code>j &lt;= i + (seqlen_k - seqlen_q)</code></p>
<p>We can think of this <code>(seqlen_k - seqlen_q)</code> to be an “offset” term between the two sequences.</p>
<p>Looking at this concretely for the second causal mask:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">k_0</th>
<th style="text-align: center;">k_1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>q_0</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>q_1</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>q_2</strong></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>q_3</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>q_4</strong></td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><br></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"><code>j</code></th>
<th style="text-align: center;"><code>i</code></th>
<th style="text-align: center;"><code>j &lt;= i + (seqlen_k - seqlen_q)</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0 &lt;= 0 - 3 (<code>False</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0 &lt;= 1 - 3 (<code>False</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0 &lt;= 2 - 3 (<code>False</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">0 &lt;= 3 - 3 (<code>True</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0 &lt;= 4 - 3 (<code>True</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1 &lt;= 0 - 3 (<code>False</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1 &lt;= 1 - 3 (<code>False</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">1 &lt;= 2 - 3 (<code>False</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1 &lt;= 3 - 3 (<code>False</code>)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1 &lt;= 4 - 3 (<code>True</code>)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>Understanding <code>flash_attn_varlen_func</code> is going to require a sequence (pun intended) of such deep dives. It took me hours to just get through the docstring!! I’m also working on understanding ModernBERT’s sequence packing implementation (to the point of explaining it with visuals) and I expect it to interweave with my Flash Attention study, especially when understanding how ModernBERT prepares and packs sequences and related artifacts in preparation of passing it through the attention mechanism, utilizing <code>flash_attn_varlen_func</code>. It’s an exciting one-two punch for sure! I’m glad I’m working on them together.</p>
<p>I’ll end with listing out again what I’ve learned in this notebook/exercise, with a couple points added about the causal mask:</p>
<ul>
<li>HuggingFace’s <code>model.generate</code> uses KV cache by default (<code>DynamicCache</code>) stored as <code>past_key_values</code>.</li>
<li>For most scenarios, the <code>DynamicCache</code> is updated by concatenating the previous token’s <code>key_cache</code> and <code>value_cache</code> with the <code>key_states</code> and <code>value_states</code> generated for the current new token.</li>
<li>As the next token is generated for a given prompt, <code>query_states</code> has a sequence length of <code>1</code>, whereas <code>key_cache</code> and <code>value_cache</code> tensors’ sequence dimension increases by 1. This is directly relates to the <code>flash_attn_varlen_func</code> causal mask docstring example.</li>
<li><code>model.generate</code> utilized the <code>flash_attn_func</code> interface.</li>
<li>The causal mask is aligned to the bottom-right of the attention matrix (the last tokens of the Q and K sequence are aligned).</li>
<li>Causality, when <img src="https://latex.codecogs.com/png.latex?Q_i"> and <img src="https://latex.codecogs.com/png.latex?K_j"> sequences are of different length, is satisfied by the equation <code>j &lt;= i + (seqlen_k - seqlen_q)</code>.</li>
<li>When there are more query tokens than key tokens, the “offset” (needed to align the last token of each sequence) results in 0s in the mask as there are no key tokens to “look back at”.</li>
<li>When there are more key tokens than query tokens, the “offset” results in 1s as the query tokens can look back at more key tokens.</li>
</ul>
<p>I’m trying to grow my YouTube channel this year so if you enjoyed this blog post, <a href="https://www.youtube.com/@vishal_learner">please subscribe!</a></p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>Flash Attention</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-03-flash_attn_varlen_func-casual-mask/</guid>
  <pubDate>Tue, 03 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Initial Experiments with Imagenette</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.vision.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastai.callback.wandb <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> WandbCallback</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> wandb</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span></code></pre></div>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this blog post I’m going to share my initial experiments as I try to get on the <a href="https://github.com/fastai/imagenette">imagenette leaderboard</a>.</p>
<blockquote class="blockquote">
<p>Imagenette is a subset of 10 easily classified classes from Imagenet (tench, English springer, cassette player, chain saw, church, French horn, garbage truck, gas pump, golf ball, parachute).</p>
</blockquote>
<p>This exercise is a bit of a detour but related to my <a href="https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/">TinyScaleLab project</a> in which I’m trying to analyze the relationship between downstream capabilities and training dynamics for tiny language models (5M-125M) trained on the TinyStories dataset.</p>
<p>I was running some initial rough 1 epoch training runs with my 5M architecture to find the best batch size for training efficiency (memory usage and training speed). I encountered a peculiar result which was counterintuitive to me:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">bs=64</th>
<th style="text-align: left;">256</th>
<th style="text-align: left;">1024</th>
<th style="text-align: left;">2048</th>
<th style="text-align: left;">4096</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Time</td>
<td style="text-align: left;">3hr</td>
<td style="text-align: left;">1hr</td>
<td style="text-align: left;">0.5hr</td>
<td style="text-align: left;">0.5hr</td>
<td style="text-align: left;">OOM</td>
</tr>
<tr class="even">
<td style="text-align: left;">Train loss</td>
<td style="text-align: left;">3.58</td>
<td style="text-align: left;">3.46</td>
<td style="text-align: left;">4.42</td>
<td style="text-align: left;">5.57</td>
<td style="text-align: left;">OOM</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Eval loss</td>
<td style="text-align: left;">3.58</td>
<td style="text-align: left;">3.46</td>
<td style="text-align: left;">4.43</td>
<td style="text-align: left;">5.57</td>
<td style="text-align: left;">OOM</td>
</tr>
</tbody>
</table>
<p>I was expecting that increase the batch size would:</p>
<ol type="1">
<li>speed up training</li>
<li>decrease loss</li>
</ol>
<p>However, increasing batch size from 1024 to 2048 did not speed up training, and increasing batch size from 256 to 2048 did not improve the loss. As always, when I run into something unexpected, I post it on Twitter. I received a number of insightful comments:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
We covered this in some of our earlier courses - lower batch sizes provide more updates, which should give better results for a fixed # epochs.
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1927192030335132090?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>The batch size of 256 was certainly providing more updates in one epoch than a batch size of 1024 or 2048. It’s interesting to note that a batch size of 64, even though providing 4x the number of updates as 256, had a higher loss at the end of the epoch. It’s important to note that I did not measure downstream performance for this experiment.</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
TinyStories is a pretty homogeneous dataset, so one doesn't need as large of a batch size to achieve a smooth gradient compared to a more diverse pretraining dataset.<br><br>You'll want to set the batch size balancing speed and performance.
</p>
— Benjamin Warner (<span class="citation" data-cites="benjamin_warner">@benjamin_warner</span>) <a href="https://twitter.com/benjamin_warner/status/1927194448389169190?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>This was another interesting point. The benefit of increasing batch size is to get a closer representation to the overall dataset. Since the TinyStories dataset is quite homogenous (all dataset items are children’s stories) a smaller batch size will be sufficiently representative of the full dataset. On the flip side, if we have a dataset like the PETS dataset, and used a small batch size of say 32, we could imagine a scenario where the batch only includes images of a single class. The model, which has been learning about a diverse set of animals to this point will perform poorly and the loss will spike. Larger models, having more parameters, may not recover from this spike like small models can. Furthermore, if the dataset contains mislabeled images and you are unfortunate to get a batch of incorrectly labeled cats, your loss spike will be combined with the model learning incorrect information. These were points discussed in a fastai study group!</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
Also, one heuristic that people use is that in most scenarios, you can scale the lr proportionally to the bs.<br><br>Larger bs, better but less frequent updates, can take longer steps.<br><br>Smaller bs, more frequent updates, but need to take smaller steps due to worse direction of updates.
</p>
— Radek Osmulski 🇺🇦 (<span class="citation" data-cites="radekosmulski">@radekosmulski</span>) <a href="https://twitter.com/radekosmulski/status/1927195672056340620?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>In my case, I had used the same learning rate for all batch sizes, and did not utilize the benefit of larger batch sizes taking longer steps (higher learning rate).</p>
<p>Jeremy also encouraged me to do some imagenette speedruns, which is why we’re here!</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
You should maybe try doing some imagenette speed-running – it's a good way to get an intuitive understanding of these issues.
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1927216989837185133?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</section>
<section id="approach-and-results" class="level2">
<h2 class="anchored" data-anchor-id="approach-and-results">Approach and Results</h2>
<p>My data prep and training code can be viewed in the “appendix” below. Before I did this exercise, I ran the code in the <a href="https://docs.fast.ai/tutorial.imagenette.html">fastai “Training Imagenette” tutorial</a> which is where most of the code below comes from. I’ll share my approach and results in this section. I wanted to break this exercise (of trying to get onto the Imagenette leaderboard) into smaller steps, so I focused this notebook on training with a batch size of 64, for three learning rates (1e-4, 1e-3 and 1e-2) for three models: xse_resnext50 (25.6M), xresnet34 (21.3M), xresnet18 (11.2M).</p>
<section id="accuracy-curves" class="level3">
<h3 class="anchored" data-anchor-id="accuracy-curves">Accuracy Curves</h3>
<p>Since I’m most interested in competing on the leaderboard, I’ll focus on observing the accuracy curves of these models, all trained on 5 epochs of the same training/validation split.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Accuracy curves for all 10 training runs"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/1.png" class="img-fluid figure-img" alt="Accuracy curves for all 10 training runs"></a></p>
<figcaption>Accuracy curves for all 10 training runs</figcaption>
</figure>
</div>
<p>The models/learning rate combination with the highest accuracy is xresnet34/1e-2 and xse_resnext50/1e-2. xresnet18/1e-2 is surprisingly competitive at half the parameter count. There is a clear hierarchy of learning rates, 1e-2 performs the best for all three models, followed by 1e-3 and then 1e-4. I used <code>lr_find</code> for each model and found that xresnet18 was stable for 1e-1 though it performs second-to-last place in accuracy for that model.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Model/Learning Rate</th>
<th style="text-align: center;">Accuracy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">xresnet34/1e-2</td>
<td style="text-align: center;">0.7929</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-2</td>
<td style="text-align: center;">0.7926</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-2</td>
<td style="text-align: center;">0.7870</td>
</tr>
<tr class="even">
<td style="text-align: center;">xresnet34/1e-3</td>
<td style="text-align: center;">0.7776</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-3</td>
<td style="text-align: center;">0.7743</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-3</td>
<td style="text-align: center;">0.7526</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet18/1e-1</td>
<td style="text-align: center;">0.7373</td>
</tr>
<tr class="even">
<td style="text-align: center;">xse_resnext50/1e-4</td>
<td style="text-align: center;">0.6532</td>
</tr>
<tr class="odd">
<td style="text-align: center;">xresnet34/1e-4</td>
<td style="text-align: center;">0.6446</td>
</tr>
<tr class="even">
<td style="text-align: center;">xresnet18/1e-4</td>
<td style="text-align: center;">0.6171</td>
</tr>
</tbody>
</table>
<p>Other notable observations:</p>
<ul>
<li>xse_resnext50/1e-2 starts out with the lowest accuracy, but then quickly catches up and finally beats out all other models/LRs but one.</li>
<li>xresnet18/1e-1 accuracy decreases from epoch 1 to 2, then catches up to finish in 7th place.</li>
<li>xresnet34/1e-2 accuracy increasing at slower rate from epoch 1 to 2 than from epoch 2 to 3, catching up quickly to finish in the top spot.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Notable accuracy curves"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/2.png" class="img-fluid figure-img" alt="Notable accuracy curves"></a></p>
<figcaption>Notable accuracy curves</figcaption>
</figure>
</div>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>I want to focus on a couple of thoughts Jeremy shared:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
Maybe on the way you'll want to create some tables like you're making there, but I rarely find them as interesting as small targeted iterations changing one thing at a time.
</p>
— Jeremy Howard (<span class="citation" data-cites="jeremyphoward">@jeremyphoward</span>) <a href="https://twitter.com/jeremyphoward/status/1927241575765061916?ref_src=twsrc%5Etfw">May 27, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Last year I worked through Jeremy’s <a href="https://vishalbakshi.github.io/blog/#category=paddy%20doctor">Kaggle Paddy Docter competition live coding series</a> and learned a ton about just that—small targeted iterations changing one thing at a time.</p>
<p>I’m not quite sure what my plan will be for this Imagenette leaderboard exercise, but I since I started this exploration with the intent to build intuition about batch size/learning rate and downstream performance, it makes sense to pick my best 2-3 models and vary the batch size and learning rate next.</p>
<p>I also am keen on working with Benjamin Warner’s <a href="https://fastxtend.benjaminwarner.dev/callback.progresize.html">fastxtend</a> (which I used last year in the <a href="https://www.kaggle.com/code/vishalbakshi/birdclef-2024-recap-0-61-final-lb-score">BirdCLEF24 Kaggle competition</a> to finish in the top 34%) and <a href="https://optimi.benjaminwarner.dev/">optimi</a> libraries. I’m particularly keen on trying out the different data augmentation techniques provided in fastxtend when I train for longer than 5 epochs.</p>
<p>I’m trying to grow my YouTube channel, so if you like my content, <a href="https://www.youtube.com/@vishal_learner">please subscribe</a>!</p>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<section id="data-prep" class="level3">
<h3 class="anchored" data-anchor-id="data-prep">Data Prep</h3>
<div id="cell-30" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:37}}" data-outputid="4a1c7bd1-fb16-4c4f-8308-939fe9e2b7c4" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> untar_data(URLs.IMAGENETTE_160)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

    <div>
      <progress value="99008512" class="" max="99003388" style="width:300px; height:20px; vertical-align: middle;"></progress>
      100.01% [99008512/99003388 00:03&lt;00:00]
    </div>
    
</div>
</div>
<div id="cell-31" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">lbl_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(</span>
<span id="cb3-2">    n01440764<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tench'</span>,</span>
<span id="cb3-3">    n02102040<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'English springer'</span>,</span>
<span id="cb3-4">    n02979186<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cassette player'</span>,</span>
<span id="cb3-5">    n03000684<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'chain saw'</span>,</span>
<span id="cb3-6">    n03028079<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'church'</span>,</span>
<span id="cb3-7">    n03394916<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'French horn'</span>,</span>
<span id="cb3-8">    n03417042<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'garbage truck'</span>,</span>
<span id="cb3-9">    n03425413<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gas pump'</span>,</span>
<span id="cb3-10">    n03445777<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'golf ball'</span>,</span>
<span id="cb3-11">    n03888257<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parachute'</span></span>
<span id="cb3-12">)</span></code></pre></div>
</div>
<div id="cell-32" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:752}}" data-outputid="73776257-bc3e-4c33-d6cc-ca691b73662c" data-execution_count="6">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">imagenette <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DataBlock(blocks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ImageBlock, CategoryBlock),</span>
<span id="cb4-2">                       get_items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_image_files,</span>
<span id="cb4-3">                       get_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Pipeline([parent_label, lbl_dict.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__getitem__</span>]),</span>
<span id="cb4-4">                       splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> GrandparentSplitter(valid_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'val'</span>),</span>
<span id="cb4-5">                       item_tfms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RandomResizedCrop(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>, min_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.35</span>),</span>
<span id="cb4-6">                       batch_tfms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Normalize.from_stats(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>imagenet_stats))</span>
<span id="cb4-7"></span>
<span id="cb4-8">dls <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> imagenette.dataloaders(path, bs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>)</span>
<span id="cb4-9">dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-5-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/index_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="training-code" class="level3">
<h3 class="anchored" data-anchor-id="training-code">Training Code</h3>
<p>I chose to run everything on a Colab Pro A100 GPU to maximize speed.</p>
<section id="xse_resnext50" class="level4">
<h4 class="anchored" data-anchor-id="xse_resnext50">xse_resnext50</h4>
<div id="cell-36" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:471}}" data-outputid="8338b75d-2a6c-41ec-c54b-dae12a88bc63" data-execution_count="7">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb5-2">learn.lr_find()</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>SuggestedLRs(valley=0.0004786300996784121)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-6-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/index_files/figure-html/cell-6-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="542d3515-ed60-4e15-dfd7-73fab5fe583d" data-execution_count="14">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">wandb.login()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>True</code></pre>
</div>
</div>
<div id="cell-38" class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">wandb.init(</span>
<span id="cb9-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb9-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xse_resnext50-bs-64-lr-1e-4"</span>,</span>
<span id="cb9-4">)</span></code></pre></div>
</div>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="f05260cd-91b1-42a4-8b82-a0465f190a53" data-execution_count="16">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb10-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.437292</td>
<td>1.562259</td>
<td>0.498599</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.898073</td>
<td>1.330338</td>
<td>0.581401</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.625788</td>
<td>1.184957</td>
<td>0.630828</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.491183</td>
<td>1.138762</td>
<td>0.650446</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.425214</td>
<td>1.119943</td>
<td>0.653248</td>
<td>00:15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-40" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-41" class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">wandb.init(</span>
<span id="cb12-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb12-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xse_resnext50-bs-64-lr-1e-3"</span>,</span>
<span id="cb12-4">)</span></code></pre></div>
</div>
<div id="cell-42" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="0356a936-1d9c-40ca-9d7e-b645c0c3a3c7" data-execution_count="19">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb13-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.115490</td>
<td>1.610692</td>
<td>0.511592</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.563322</td>
<td>1.359540</td>
<td>0.592866</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.205948</td>
<td>1.041064</td>
<td>0.673631</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.988717</td>
<td>0.896793</td>
<td>0.712611</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.865071</td>
<td>0.776657</td>
<td>0.752611</td>
<td>00:15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-43" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-44" class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">wandb.init(</span>
<span id="cb15-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb15-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xse_resnext50-bs-64-lr-1e-2"</span>,</span>
<span id="cb15-4">)</span></code></pre></div>
</div>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="b97a464f-d64e-4797-8814-2034c9d3013d" data-execution_count="23">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vision_learner(dls, xse_resnext50, metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, pretrained<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb16-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.025805</td>
<td>4.565277</td>
<td>0.225478</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.586654</td>
<td>1.567472</td>
<td>0.527389</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.162438</td>
<td>0.994889</td>
<td>0.680255</td>
<td>00:15</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.868640</td>
<td>0.672154</td>
<td>0.780892</td>
<td>00:15</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.703673</td>
<td>0.635068</td>
<td>0.792611</td>
<td>00:15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-46" class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">wandb.finish()</span></code></pre></div>
</div>
</section>
<section id="xresnet34" class="level4">
<h4 class="anchored" data-anchor-id="xresnet34">xresnet34</h4>
<div id="cell-48" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:471}}" data-outputid="1ca7b389-6205-4651-af2b-35c00be9e633" data-execution_count="27">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy)</span>
<span id="cb18-2">learn.lr_find()</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>SuggestedLRs(valley=0.0005754399462603033)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-17-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/index_files/figure-html/cell-17-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="db64c191-eac3-4e90-8146-0ea19c8691a1" data-execution_count="28">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">learn.loss_func</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>FlattenedLoss of CrossEntropyLoss()</code></pre>
</div>
</div>
<div id="cell-50" class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">wandb.init(</span>
<span id="cb22-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb22-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet34-bs-64-lr-1e-4"</span>,</span>
<span id="cb22-4">)</span></code></pre></div>
</div>
<div id="cell-51" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="5ff0c3d6-f0e0-4501-c244-eb567e579c59" data-execution_count="35">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb23-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.054720</td>
<td>1.864616</td>
<td>0.371975</td>
<td>00:09</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.605212</td>
<td>1.489624</td>
<td>0.525350</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.307533</td>
<td>1.235453</td>
<td>0.619618</td>
<td>00:09</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.180410</td>
<td>1.153767</td>
<td>0.642038</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.124177</td>
<td>1.139668</td>
<td>0.644586</td>
<td>00:09</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-52" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-53" class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">wandb.init(</span>
<span id="cb25-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb25-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet34-bs-64-lr-1e-3"</span>,</span>
<span id="cb25-4">)</span></code></pre></div>
</div>
<div id="cell-54" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="307e87f9-20f2-419b-beda-9f1f32a62a2c" data-execution_count="39">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb26-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.607826</td>
<td>1.416133</td>
<td>0.538344</td>
<td>00:10</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.204550</td>
<td>1.263326</td>
<td>0.578853</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.946661</td>
<td>0.917620</td>
<td>0.710828</td>
<td>00:09</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.784756</td>
<td>0.758046</td>
<td>0.755414</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.683072</td>
<td>0.704371</td>
<td>0.777580</td>
<td>00:09</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-55" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">wandb.init(</span>
<span id="cb28-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb28-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet34-bs-64-lr-1e-2"</span>,</span>
<span id="cb28-4">)</span></code></pre></div>
</div>
<div id="cell-57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="435b8593-bec7-427e-d136-a51a327efc95" data-execution_count="43">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet34(n_out<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb29-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.571024</td>
<td>2.439970</td>
<td>0.335541</td>
<td>00:09</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.255883</td>
<td>2.097694</td>
<td>0.395414</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.018229</td>
<td>0.989576</td>
<td>0.681529</td>
<td>00:09</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.785577</td>
<td>0.728265</td>
<td>0.762293</td>
<td>00:09</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.623264</td>
<td>0.640818</td>
<td>0.792866</td>
<td>00:09</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-58" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">wandb.finish()</span></code></pre></div>
</div>
</section>
<section id="xresnet18" class="level4">
<h4 class="anchored" data-anchor-id="xresnet18">xresnet18</h4>
<div id="cell-60" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:471}}" data-outputid="3bb76188-48c5-47dd-ad6d-3d66a04be44f" data-execution_count="46">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy)</span>
<span id="cb31-2">learn.lr_find()</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>SuggestedLRs(valley=0.0020892962347716093)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-28-output-4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/index_files/figure-html/cell-28-output-4.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<div id="cell-61" class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">wandb.init(</span>
<span id="cb33-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb33-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet18-bs-64-lr-1e-4"</span>,</span>
<span id="cb33-4">)</span></code></pre></div>
</div>
<div id="cell-62" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="c6dbf534-bb10-48ef-cb77-0eb7b8597ac1" data-execution_count="48">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb34-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>5.608559</td>
<td>4.292247</td>
<td>0.301147</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>1</td>
<td>2.270526</td>
<td>1.728192</td>
<td>0.505478</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.517185</td>
<td>1.401804</td>
<td>0.579108</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.327132</td>
<td>1.287121</td>
<td>0.610446</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.274527</td>
<td>1.265958</td>
<td>0.617070</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-63" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-64" class="cell">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">wandb.init(</span>
<span id="cb36-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb36-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet18-bs-64-lr-1e-3"</span>,</span>
<span id="cb36-4">)</span></code></pre></div>
</div>
<div id="cell-65" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="170bf98b-8634-4d14-88fb-e1422e043217" data-execution_count="52">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb37-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>2.134495</td>
<td>1.742504</td>
<td>0.445860</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.249879</td>
<td>1.266531</td>
<td>0.584204</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.986120</td>
<td>1.082811</td>
<td>0.648153</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.804976</td>
<td>0.767623</td>
<td>0.758471</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.708721</td>
<td>0.734305</td>
<td>0.774267</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-66" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">wandb.init(</span>
<span id="cb39-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb39-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet18-bs-64-lr-1e-2"</span>,</span>
<span id="cb39-4">)</span></code></pre></div>
</div>
<div id="cell-68" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="43fb4098-6228-4d0e-f708-d395b7324de1" data-execution_count="56">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb40-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.665481</td>
<td>2.706135</td>
<td>0.358726</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.278437</td>
<td>1.516189</td>
<td>0.505987</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.017887</td>
<td>1.038873</td>
<td>0.663440</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>3</td>
<td>0.801989</td>
<td>0.718528</td>
<td>0.761529</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.638737</td>
<td>0.650084</td>
<td>0.787006</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-69" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">wandb.finish()</span></code></pre></div>
</div>
<div id="cell-70" class="cell">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">wandb.init(</span>
<span id="cb42-2">    project<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinyscale-lab"</span>,</span>
<span id="cb42-3">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"imagenette-xresnet18-bs-64-lr-1e-1"</span>,</span>
<span id="cb42-4">)</span></code></pre></div>
</div>
<div id="cell-71" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="f9e04227-875a-40b7-8fe7-f4790ac3bc32" data-execution_count="61">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">learn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Learner(dls, xresnet18(), metrics<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>accuracy, cbs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>WandbCallback())</span>
<span id="cb43-2">learn.fit_one_cycle(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.755140</td>
<td>2.272295</td>
<td>0.325860</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.501531</td>
<td>3.738475</td>
<td>0.322293</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.238407</td>
<td>1.375671</td>
<td>0.547516</td>
<td>00:07</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.036412</td>
<td>0.896265</td>
<td>0.707516</td>
<td>00:07</td>
</tr>
<tr class="odd">
<td>4</td>
<td>0.850425</td>
<td>0.815597</td>
<td>0.737325</td>
<td>00:07</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1">wandb.finish()</span></code></pre></div>
</div>


</section>
</section>
</section>

 ]]></description>
  <category>python</category>
  <category>fastai</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <category>imagenette</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-06-01-imagenette/</guid>
  <pubDate>Sun, 01 Jun 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding the Mean Shift Clustering Algorithm (and PyTorch Broadcasting)</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math, matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt, operator, torch</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> partial</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.distributions.multivariate_normal <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MultivariateNormal</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensor</span></code></pre></div>
</div>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb2-2">torch.set_printoptions(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, sci_mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this blog post I’ll walk through the Mean Shift Clustering algorithm as introduced <a href="https://github.com/fastai/course22p2/blob/master/nbs/02_meanshift.ipynb">in Lesson 12 of the fastai course (Part 2)</a>.</p>
<p>The algorithm:</p>
<blockquote class="blockquote">
<ul>
<li>For each data point <code>x</code> in the sample <code>X</code>, find the distance between that point <code>x</code> and every other point in <code>X</code></li>
<li>Create weights for each point in <code>X</code> by using the Gaussian kernel of that point’s distance to <code>x</code></li>
<li>This weighting approach penalizes points further away from <code>x</code></li>
<li>The rate at which the weights fall to zero is determined by the bandwidth, which is the standard deviation of the Gaussian</li>
<li>Update <code>x</code> as the weighted average of all other points in <code>X</code>, weighted based on the previous step</li>
</ul>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Conceptual visual showing the mean shift clustering algorithm weighting by distance. The red point is x."><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/1.png" class="img-fluid figure-img" alt="Conceptual visual showing the mean shift clustering algorithm weighting by distance. The red point is x."></a></p>
<figcaption>Conceptual visual showing the mean shift clustering algorithm weighting by distance. The red point is <code>x</code>.</figcaption>
</figure>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/kfl-cUz9iWw?si=nL8PUaUBmqQcYJMk" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</section>
<section id="generating-clearly-clustered-data" class="level2">
<h2 class="anchored" data-anchor-id="generating-clearly-clustered-data">Generating Clearly Clustered Data</h2>
<p>An important point: we start by creating fake data such that it is knowingly clustered around a set of centroids we can then compare to the final clustering result.</p>
<div id="cell-9" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">n_clusters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb3-2">n_samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span></span></code></pre></div>
</div>
<div id="cell-10" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.rand(n_clusters, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35</span></span></code></pre></div>
</div>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f832bd33-2d31-4058-a7e6-9139a6b3acef" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">centroids.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>torch.Size([6, 2])</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="98fe6cdb-34d3-4a22-bb3a-f6f5e2b5019e" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">centroids</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>tensor([[ 26.759,  29.050],
        [ -8.200,  32.151],
        [ -7.669,   7.063],
        [-17.040,  20.555],
        [ 30.854, -25.677],
        [ 30.422,   6.551]])</code></pre>
</div>
</div>
<p>We’ll generate data around these 6 centroids using PyTorch’s <code>MultivariateNormal</code> which:</p>
<blockquote class="blockquote">
<p>Creates a multivariate normal (also called Gaussian) distribution parameterized by a mean vector and a covariance matrix.</p>
</blockquote>
<p>The covariance matrix in our case is a diagonal matrix with 5s on the diagonal.</p>
<p>We generate 250 samples for each mean vector (centroid).</p>
<div id="cell-15" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> sample(m): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> MultivariateNormal(m, torch.diag(tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>]))).sample((n_samples,))</span></code></pre></div>
</div>
<div id="cell-16" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5684ae06-811e-4a0e-ec3e-f5e9830a41ed" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">torch.diag(tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>]))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>tensor([[5., 0.],
        [0., 5.]])</code></pre>
</div>
</div>
<p>From Gemini this covariance matrix shows:</p>
<blockquote class="blockquote">
<ul>
<li><strong>No Correlation</strong>: The two variables are uncorrelated (covariance is 0.0). For a <code>MultivariateNormal</code> distribution, this implies they are independent.</li>
<li><strong>Equal Variance</strong>: Both variables have the same variance of 5.0.</li>
<li><strong>Shape</strong>: If used in a 2D MultivariateNormal distribution, this will produce a circular cloud of data points, equally spread along both the X and Y axes.</li>
</ul>
</blockquote>
<div id="cell-18" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="93047335-d41d-4def-a752-5e331b1e26b4" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">coords <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MultivariateNormal(centroids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], torch.diag(tensor([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.</span>]))).sample((n_samples,))</span>
<span id="cb12-2">coords.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>torch.Size([250, 2])</code></pre>
</div>
</div>
<p>We see how the <code>MultivariateNormal</code> distribution samples are spread out in a circular shape around the mean, with the density of samples decreasing as you move further away from the centroid.</p>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="440bb3e9-4b5c-4e69-9934-4ca1a298a0be" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">plt.scatter(coords[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], coords[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-2">plt.scatter(centroids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], centroids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span>
<span id="cb14-3">ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.gca() <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get current axes</span></span>
<span id="cb14-4">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, adjustable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-11-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We sample from the <code>MultivariateNormal</code> distribution for all six of our centroids and concatenate the result.</p>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="1889ba4c-48d1-46cb-dfe4-7674b1cc04a5" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">slices <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [sample(c) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> c <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> centroids]</span>
<span id="cb15-2">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat(slices)</span>
<span id="cb15-3">data.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>torch.Size([1500, 2])</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_data(centroids, data, n_samples, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb17-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ax <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: _,ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb17-3">    ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, adjustable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span>
<span id="cb17-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, centroid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(centroids):</span>
<span id="cb17-5">        samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_samples:(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_samples]</span>
<span id="cb17-6">        ax.scatter(samples[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], samples[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb17-7">        ax.plot(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>centroid, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, mew<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
</div>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="8b2d7253-df04-4a27-8d32-c8b6ff94647d" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">plot_data(centroids, data, n_samples)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-14-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="generating-sample-weights" class="level2">
<h2 class="anchored" data-anchor-id="generating-sample-weights">Generating Sample Weights</h2>
<p>With our data generated, we’ll now prepare for the third step in the algorithm: <em>create weights</em>.</p>
<blockquote class="blockquote">
<p>Create weights for each point in X by using the Gaussian kernel of that point’s distance to x</p>
</blockquote>
<p>We’ll start by defining a function which takes some distance <code>d</code> and some bandwidth <code>bw</code> and returns the gaussian normal output given these two inputs. This output will be our <em>weights</em>:</p>
<div id="cell-28" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> gaussian(d, bw): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.exp(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>((d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>bw))<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (bw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>math.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>math.pi))</span></code></pre></div>
</div>
<p>(Wikipedia) the probability density function of the normal distribution is given by:</p>
<p><img src="https://latex.codecogs.com/png.latex?f(x)=%7B%5Cfrac%20%7B1%7D%7B%5Csqrt%20%7B2%5Cpi%20%5Csigma%20%5E%7B2%7D%7D%7D%7De%5E%7B-%7B%5Cfrac%20%7B(x-%5Cmu%20)%5E%7B2%7D%7D%7B2%5Csigma%20%5E%7B2%7D%7D%7D%7D"></p>
<p>In our case, <code>d</code> (the distance from a point in X to another point in X) is equivalent in this function to <img src="https://latex.codecogs.com/png.latex?x-%5Cmu">, and bandwidth <code>bw</code> is the standard deviation <img src="https://latex.codecogs.com/png.latex?%5Csigma">.</p>
<p>As bandwidth increases, the gaussian distribution flattens out (i.e.&nbsp;weights decay slower as distance increases).</p>
<div id="cell-33" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="e1629736-ae5f-4857-afff-f8340d8019b6" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb20-2">plt.plot(x, gaussian(x, bw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bw = 1.0'</span>)</span>
<span id="cb20-3">plt.plot(x, gaussian(x, bw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bw = 2.5'</span>)</span>
<span id="cb20-4">plt.plot(x, gaussian(x, bw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bw = 5.0'</span>)</span>
<span id="cb20-5">plt.plot(x, gaussian(x, bw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.0</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bw = 10.0'</span>)</span>
<span id="cb20-6">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-16-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-16-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>We can also try to use a simpler linear function for our weights.</p>
<div id="cell-35" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> tri(d, i): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>d<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i).clamp_min(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>i</span></code></pre></div>
</div>
<p>Mathematically, this calculates <code>max(0, (i - d) / i)</code> which is equivalent to <code>max(0, 1 - d / i)</code></p>
<p><code>clamp_min</code> ensures that the value of <code>-d+i</code> does not go below <code>0</code>. <code>i</code> becomes the d-intercept.</p>
<p>As <code>i</code> increases, the slope decreases, and weights decay slower as distance increases.</p>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="be09317b-d3b8-4bb4-936b-f9f9f8193618" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb22-2">plt.plot(x, tri(x,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'i = 3'</span>)</span>
<span id="cb22-3">plt.plot(x, tri(x,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'i = 8'</span>)</span>
<span id="cb22-4">plt.plot(x, tri(x,i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>), label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'i = 12'</span>)</span>
<span id="cb22-5">plt.legend()<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-18-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="implementing-the-full-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="implementing-the-full-algorithm">Implementing the Full Algorithm</h2>
<blockquote class="blockquote">
<ul>
<li>For each data point x in the sample X, find the distance between that point x and every other point in X (<code>d = f(x-X)</code>)</li>
<li>Create weights for each point in X by using the Gaussian kernel of that point’s distance to x (<code>weights = gaussian(d)</code>)</li>
<li>Update x as the weighted average of all other points in X, weighted based on the previous step (<code>x = weighted_avg(weights, X)</code>)</li>
</ul>
</blockquote>
<p>Since we are going to update the data after each step of the algorithm, we clone the data to start. As a reminder, these 1500 coordinates come from 250 <code>MultivariateNormal</code> samples given 6 centroids as the mean.</p>
<div id="cell-43" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e19a0afd-3b1f-4189-ea40-f73820d8e75c" data-execution_count="19">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb23-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb23-3">x</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>tensor([29.764, 26.161])</code></pre>
</div>
</div>
<div id="cell-44" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c9005ded-deaa-4406-b70c-119c6584c3f1" data-execution_count="20">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">X.shape, x.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(torch.Size([1500, 2]), torch.Size([2]))</code></pre>
</div>
</div>
<p>We now calculate <em>the distance between that point x and every other point in X</em>. Since <code>x</code> and <code>X</code> share a dimension <code>2</code>, we can just subtract and PyTorch will use broadcasting.</p>
<div id="cell-46" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b58458b1-4d24-4b3d-87c3-07828202e61b" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>torch.Size([1500, 2])</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="568b564f-4973-4b77-b312-4b94f6a6fa1b" data-execution_count="22">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># subtracting the first point from itself</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>tensor([0., 0.])</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="7f96405a-0d6b-4af5-ab8d-1bf57fc26b99" data-execution_count="23">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1">x</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>tensor([29.764, 26.161])</code></pre>
</div>
</div>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e35d50a5-a69d-46f0-99b2-570902ac3787" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1">X[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>tensor([[29.764, 26.161],
        [28.472, 30.493],
        [27.549, 23.130],
        [23.500, 26.879],
        [27.327, 28.650]])</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8afce871-6987-4f4d-a85b-5eb08f5d18fe" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>tensor([[ 0.000,  0.000],
        [ 1.292, -4.333],
        [ 2.215,  3.030],
        [ 6.264, -0.718],
        [ 2.437, -2.489]])</code></pre>
</div>
</div>
<p>We’ll use Euclidean distance, which is the square root of the sum (across the columns, or rather across coordinates) of the difference in coordinates squared.</p>
<div id="cell-52" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="16661ce5-493e-4029-9f13-ac9120032ec2" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>torch.Size([1500, 2])</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="092208c5-a396-4f01-cb0e-c6be84342589" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>tensor([[ 0.000,  0.000],
        [ 1.668, 18.772],
        [ 4.906,  9.184],
        [39.239,  0.515],
        [ 5.939,  6.196]])</code></pre>
</div>
</div>
<p>Summing across the columns to get <img src="https://latex.codecogs.com/png.latex?x%5E2+y%5E2">.</p>
<div id="cell-55" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="0919cf3c-5bb0-4e84-9bc4-53c71e956312" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>torch.Size([1500])</code></pre>
</div>
</div>
<div id="cell-56" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="9e39b39a-6f71-4de2-d839-c6d380711aee" data-execution_count="30">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>tensor([ 0.000, 20.440, 14.089, 39.754, 12.134])</code></pre>
</div>
</div>
<div id="cell-57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="442c76ad-4328-4762-a9a0-32c30a8bd601" data-execution_count="31">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>).sqrt()</span>
<span id="cb45-2">dist.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>torch.Size([1500])</code></pre>
</div>
</div>
<div id="cell-58" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="433c5588-1779-4bcf-e4b5-21017d014186" data-execution_count="32">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1">dist[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>tensor([0.000, 4.521, 3.754, 6.305, 3.483])</code></pre>
</div>
</div>
<p>Since we are performing elementwise multiplication following by a summation, we can use Einstein Summation:</p>
<div id="cell-60" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="554d97b7-31a8-45a3-b1d2-4ee4a8d2fb3f" data-execution_count="33">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">torch.einsum(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ij,ij-&gt;i'</span>, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X, x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X).sqrt()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>tensor([ 0.000,  4.521,  3.754,  ..., 21.305, 21.850, 21.958])</code></pre>
</div>
</div>
<p>We can also use matrix multiplication, though IIUC, you have to pluck out the values on the resulting matrix’s diagonal to get the elementwise product between <code>x-X</code> and itself.</p>
<div id="cell-62" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ce689bc7-0002-472e-ab83-2f3e471a9dac" data-execution_count="34">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1">(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X).shape, (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X).T.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>(torch.Size([1500, 2]), torch.Size([2, 1500]))</code></pre>
</div>
</div>
<div id="cell-63" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="424e1e07-8126-4325-b353-92c59a2375ca" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1">res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> (x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X).T</span>
<span id="cb53-2">res.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>torch.Size([1500, 1500])</code></pre>
</div>
</div>
<div id="cell-64" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3565fc9c-f460-4158-8f7e-8f0926b1cd85" data-execution_count="36">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1">torch.diag(res)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>tensor([  0.000,  20.440,  14.089,  ..., 453.898, 477.408, 482.169])</code></pre>
</div>
</div>
<div id="cell-65" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d964c841-d00e-4173-9a53-acdba5e6b33a" data-execution_count="37">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">torch.diag(res).sqrt()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>tensor([ 0.000,  4.521,  3.754,  ..., 21.305, 21.850, 21.958])</code></pre>
</div>
</div>
<p>We now <em>create weights for each point in X by using the Gaussian kernel of that point’s distance to x</em>.</p>
<div id="cell-67" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="75f33898-b162-4628-8098-56bc99e441b1" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1">weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gaussian(dist, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb59-2">weight</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>tensor([    0.160,     0.031,     0.052,  ...,     0.000,     0.000,     0.000])</code></pre>
</div>
</div>
<p>We have 1500 weights, one for each distance between our current point <code>x</code> and all of the points in <code>X</code>.</p>
<div id="cell-69" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5b48ca56-ce3b-426b-dc41-a73ce4596e99" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1">weight.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>torch.Size([1500])</code></pre>
</div>
</div>
<p>We can now move on to the last step in the algorithm: <em>update x as the weighted average of all other points in X, weighted based on the previous step</em>.</p>
<p>The weighted average is the elementwise product of the <code>weights</code> and <code>X</code>, summed down the rows (two get 2 coordinates) and then divided by the sum of the weights.</p>
<p>Starting from the last dimension, <code>weight</code> and <code>X</code> do not have compatible dimensions (1500 is not 2 or 1), so we have to add a unit axis to <code>weight</code> to allow for broadcasting.</p>
<div id="cell-73" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3c055193-07d4-41b2-9c45-83a7b9c18ddc" data-execution_count="42">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1">X.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>torch.Size([1500, 2])</code></pre>
</div>
</div>
<div id="cell-74" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:141}}" data-outputid="e0b2b54d-21ea-4cee-a98f-0f6f9ba44500" data-execution_count="43">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1">weight<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X</span></code></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-43-f3a5e14a550a&gt;</span> in <span class="ansi-cyan-fg">&lt;cell line: 0&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>weight<span class="ansi-blue-fg">*</span>X

<span class="ansi-red-fg">RuntimeError</span>: The size of tensor a (1500) must match the size of tensor b (2) at non-singleton dimension 1</pre>
</div>
</div>
</div>
<div id="cell-75" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="799bd54d-0612-4a9e-8f4b-adeb29264253" data-execution_count="44">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>torch.Size([1500, 1])</code></pre>
</div>
</div>
<div id="cell-76" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="81c78206-bb4d-4b3d-b05c-77e844403318" data-execution_count="46">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1">weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>tensor([[    4.750,     4.175],
        [    0.886,     0.948],
        [    1.424,     1.196],
        ...,
        [    0.000,     0.000],
        [    0.000,     0.000],
        [    0.000,     0.000]])</code></pre>
</div>
</div>
<p>We then sum down the rows to get two coordinates:</p>
<div id="cell-78" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="94a51182-983c-4f79-c54b-59577b97c8b5" data-execution_count="48">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1">(weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>tensor([296.880, 291.612])</code></pre>
</div>
</div>
<p>This is the same as applying the weights to each column separately:</p>
<div id="cell-80" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="cedc0ce9-89c7-4b77-98dc-be9e885f5cb2" data-execution_count="49">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1">(weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(), (weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> X[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>(tensor(296.880), tensor(291.612))</code></pre>
</div>
</div>
<p>We then divide by the sum of the weights to get our final, updated <code>x</code>:</p>
<div id="cell-82" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="26fcab42-b6a3-448a-b5b8-cf8c85c2f3a6" data-execution_count="50">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1">(weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>weight.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>tensor([28.118, 27.619])</code></pre>
</div>
</div>
<p>Wrapping this up into a function for each <code>x</code> in <code>X</code> we calculate the distance between <code>x</code> and all points in <code>X</code>, calculate the weights for those distances and replace <code>x</code> with the weighted average of those weights and all the points.</p>
<div id="cell-84" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> one_update(X):</span>
<span id="cb76-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(X):</span>
<span id="cb76-3">        dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb76-4">        weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gaussian(dist, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb76-5">        X[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>weight.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
</div>
<div id="cell-85" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="72b4ced3-11b0-4477-e0de-28e7ec8b3e34" data-execution_count="52">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb77-2">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb77-3">x</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>tensor([29.764, 26.161])</code></pre>
</div>
</div>
<div id="cell-86" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1">one_update(X)</span></code></pre></div>
</div>
<div id="cell-87" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4dfc8da8-06c7-4400-a1da-5415bf4bbcaf" data-execution_count="55">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1">X[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>tensor([28.118, 27.619])</code></pre>
</div>
</div>
<p>We can now wrap up into a <code>meanshift</code> function where it performs <code>n</code> such updates.</p>
<div id="cell-89" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb82" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> meanshift(data, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb82-2">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb82-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> it <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n): one_update(X)</span>
<span id="cb82-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> X</span></code></pre></div>
</div>
<div id="cell-90" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="120554f2-356c-4445-c260-6590aa44c457" data-execution_count="68">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>time X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meanshift(data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 1.39 s, sys: 3.12 ms, total: 1.4 s
Wall time: 1.42 s</code></pre>
</div>
</div>
<p>We can now see that in 5 iterations, the weight updates have resulted in the points to converge at the original centroids!</p>
<div id="cell-92" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> plot_data(centroids, data, n_samples, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>):</span>
<span id="cb85-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ax <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>: _,ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb85-3">    ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, adjustable<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add this line</span></span>
<span id="cb85-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, centroid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(centroids):</span>
<span id="cb85-5">        samples <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data[i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_samples:(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>n_samples]</span>
<span id="cb85-6">        ax.plot(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>centroid, markersize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, marker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, mew<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb85-7">        ax.scatter(samples[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], samples[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div id="cell-93" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="2143afe3-6582-445c-d40c-1bf41e2dce13" data-execution_count="70">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1">plot_data(centroids, X, n_samples)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-53-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-53-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="animating-the-algorithm" class="level2">
<h2 class="anchored" data-anchor-id="animating-the-algorithm">Animating the Algorithm</h2>
<div id="cell-95" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.animation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FuncAnimation</span>
<span id="cb87-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> IPython.display <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTML</span></code></pre></div>
</div>
<div id="cell-96" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> do_one(d):</span>
<span id="cb88-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> d: one_update(X)</span>
<span id="cb88-3">    ax.clear()</span>
<span id="cb88-4">    plot_data(centroids, X, n_samples, ax<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ax, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>d)</span></code></pre></div>
</div>
<p>We can visualize the “gravity” of the cluster centroids as the data points are “pulled in” via the weighted average.</p>
<div id="cell-98" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:578}}" data-outputid="57402cb2-2ebd-467a-ed23-a962aa25f28a" data-execution_count="73">
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb89-2">fig,ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb89-3">ani <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FuncAnimation(fig, do_one, frames<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, interval<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, repeat<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb89-4">plt.close()</span>
<span id="cb89-5">HTML(ani.to_jshtml())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<script language="javascript">
  function isInternetExplorer() {
    ua = navigator.userAgent;
    /* MSIE used to detect old browsers and Trident used to newer ones*/
    return ua.indexOf("MSIE ") > -1 || ua.indexOf("Trident/") > -1;
  }

  /* Define the Animation class */
  function Animation(frames, img_id, slider_id, interval, loop_select_id){
    this.img_id = img_id;
    this.slider_id = slider_id;
    this.loop_select_id = loop_select_id;
    this.interval = interval;
    this.current_frame = 0;
    this.direction = 0;
    this.timer = null;
    this.frames = new Array(frames.length);

    for (var i=0; i<frames.length; i++)
    {
     this.frames[i] = new Image();
     this.frames[i].src = frames[i];
    }
    var slider = document.getElementById(this.slider_id);
    slider.max = this.frames.length - 1;
    if (isInternetExplorer()) {
        // switch from oninput to onchange because IE <= 11 does not conform
        // with W3C specification. It ignores oninput and onchange behaves
        // like oninput. In contrast, Microsoft Edge behaves correctly.
        slider.setAttribute('onchange', slider.getAttribute('oninput'));
        slider.setAttribute('oninput', null);
    }
    this.set_frame(this.current_frame);
  }

  Animation.prototype.get_loop_state = function(){
    var button_group = document[this.loop_select_id].state;
    for (var i = 0; i < button_group.length; i++) {
        var button = button_group[i];
        if (button.checked) {
            return button.value;
        }
    }
    return undefined;
  }

  Animation.prototype.set_frame = function(frame){
    this.current_frame = frame;
    document.getElementById(this.img_id).src =
            this.frames[this.current_frame].src;
    document.getElementById(this.slider_id).value = this.current_frame;
  }

  Animation.prototype.next_frame = function()
  {
    this.set_frame(Math.min(this.frames.length - 1, this.current_frame + 1));
  }

  Animation.prototype.previous_frame = function()
  {
    this.set_frame(Math.max(0, this.current_frame - 1));
  }

  Animation.prototype.first_frame = function()
  {
    this.set_frame(0);
  }

  Animation.prototype.last_frame = function()
  {
    this.set_frame(this.frames.length - 1);
  }

  Animation.prototype.slower = function()
  {
    this.interval /= 0.7;
    if(this.direction > 0){this.play_animation();}
    else if(this.direction < 0){this.reverse_animation();}
  }

  Animation.prototype.faster = function()
  {
    this.interval *= 0.7;
    if(this.direction > 0){this.play_animation();}
    else if(this.direction < 0){this.reverse_animation();}
  }

  Animation.prototype.anim_step_forward = function()
  {
    this.current_frame += 1;
    if(this.current_frame < this.frames.length){
      this.set_frame(this.current_frame);
    }else{
      var loop_state = this.get_loop_state();
      if(loop_state == "loop"){
        this.first_frame();
      }else if(loop_state == "reflect"){
        this.last_frame();
        this.reverse_animation();
      }else{
        this.pause_animation();
        this.last_frame();
      }
    }
  }

  Animation.prototype.anim_step_reverse = function()
  {
    this.current_frame -= 1;
    if(this.current_frame >= 0){
      this.set_frame(this.current_frame);
    }else{
      var loop_state = this.get_loop_state();
      if(loop_state == "loop"){
        this.last_frame();
      }else if(loop_state == "reflect"){
        this.first_frame();
        this.play_animation();
      }else{
        this.pause_animation();
        this.first_frame();
      }
    }
  }

  Animation.prototype.pause_animation = function()
  {
    this.direction = 0;
    if (this.timer){
      clearInterval(this.timer);
      this.timer = null;
    }
  }

  Animation.prototype.play_animation = function()
  {
    this.pause_animation();
    this.direction = 1;
    var t = this;
    if (!this.timer) this.timer = setInterval(function() {
        t.anim_step_forward();
    }, this.interval);
  }

  Animation.prototype.reverse_animation = function()
  {
    this.pause_animation();
    this.direction = -1;
    var t = this;
    if (!this.timer) this.timer = setInterval(function() {
        t.anim_step_reverse();
    }, this.interval);
  }
</script>

<style>
.animation {
    display: inline-block;
    text-align: center;
}
input[type=range].anim-slider {
    width: 374px;
    margin-left: auto;
    margin-right: auto;
}
.anim-buttons {
    margin: 8px 0px;
}
.anim-buttons button {
    padding: 0;
    width: 36px;
}
.anim-state label {
    margin-right: 8px;
}
.anim-state input {
    margin: 0;
    vertical-align: middle;
}
</style>

<div class="animation">
  <img id="_anim_imgbf18fa8feeef42df9ff1917d1946c4bf">
  <div class="anim-controls">
    <input id="_anim_sliderbf18fa8feeef42df9ff1917d1946c4bf" type="range" class="anim-slider" name="points" min="0" max="1" step="1" value="0" oninput="animbf18fa8feeef42df9ff1917d1946c4bf.set_frame(parseInt(this.value));">
    <div class="anim-buttons">
      <button title="Decrease speed" aria-label="Decrease speed" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.slower()">
          <i class="fa fa-minus"></i></button>
      <button title="First frame" aria-label="First frame" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.first_frame()">
        <i class="fa fa-fast-backward"></i></button>
      <button title="Previous frame" aria-label="Previous frame" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.previous_frame()">
          <i class="fa fa-step-backward"></i></button>
      <button title="Play backwards" aria-label="Play backwards" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.reverse_animation()">
          <i class="fa fa-play fa-flip-horizontal"></i></button>
      <button title="Pause" aria-label="Pause" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.pause_animation()">
          <i class="fa fa-pause"></i></button>
      <button title="Play" aria-label="Play" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.play_animation()">
          <i class="fa fa-play"></i></button>
      <button title="Next frame" aria-label="Next frame" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.next_frame()">
          <i class="fa fa-step-forward"></i></button>
      <button title="Last frame" aria-label="Last frame" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.last_frame()">
          <i class="fa fa-fast-forward"></i></button>
      <button title="Increase speed" aria-label="Increase speed" onclick="animbf18fa8feeef42df9ff1917d1946c4bf.faster()">
          <i class="fa fa-plus"></i></button>
    </div>
    <form title="Repetition mode" aria-label="Repetition mode" action="#n" name="_anim_loop_selectbf18fa8feeef42df9ff1917d1946c4bf" class="anim-state">
      <input type="radio" name="state" value="once" id="_anim_radio1_bf18fa8feeef42df9ff1917d1946c4bf" checked="">
      <label for="_anim_radio1_bf18fa8feeef42df9ff1917d1946c4bf">Once</label>
      <input type="radio" name="state" value="loop" id="_anim_radio2_bf18fa8feeef42df9ff1917d1946c4bf">
      <label for="_anim_radio2_bf18fa8feeef42df9ff1917d1946c4bf">Loop</label>
      <input type="radio" name="state" value="reflect" id="_anim_radio3_bf18fa8feeef42df9ff1917d1946c4bf">
      <label for="_anim_radio3_bf18fa8feeef42df9ff1917d1946c4bf">Reflect</label>
    </form>
  </div>
</div>


<script language="javascript">
  /* Instantiate the Animation class. */
  /* The IDs given should match those used in the template above. */
  (function() {
    var img_id = "_anim_imgbf18fa8feeef42df9ff1917d1946c4bf";
    var slider_id = "_anim_sliderbf18fa8feeef42df9ff1917d1946c4bf";
    var loop_select_id = "_anim_loop_selectbf18fa8feeef42df9ff1917d1946c4bf";
    var frames = new Array(5);
    
  frames[0] = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90\
bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAP\
YQAAD2EBqD+naQAAY7dJREFUeJzt3Xl8VNXdP/DPnSQzk3USIAvBsAg0KJshVYhEVEBAaBUFFdqK\
C0tLqbLYFqgL9aeWRR8R+iguUK0bUWnFWhChQeCJEsQQViUVlEVCEhAyE7LMJDP398fNvbl3MjOZ\
hCQzk/t5P6+8IDN37hx47PDJ95zzPYIoiiKIiIiISDcMgR4AEREREbUvBkAiIiIinWEAJCIiItIZ\
BkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIi\
ItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEA\
JCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIi\
nWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAi\
IiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZ\
BkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIi\
ItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinWEAJCIiItIZBkAiIiIinQkP\
9ACImuJyuVBcXIzY2FgIghDo4RARtRlRFFFRUYHU1FQYDKzRUNthAKSgV1xcjLS0tEAPg4io3Zw+\
fRpXXHFFoIdBHRgDIAW92NhYANIHYlxcXIBHQ0TUdmw2G9LS0pTPPaK2wgBIQU+e9o2Li2MAJCJd\
4HIXamtcYEBERESkMwyARERERDrDAEhERESkMwyARERERDrDAEhERESkMwyARERERDrDAEhERESk\
MwyARERERDrDAEitZtmyZRAEAfPmzVMeq6mpwZw5c9C5c2fExMRg0qRJKC0tDdwgiYiIiAGQWsfe\
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\
0EMPYdGiRU2+nouig8OYDWNwtvIsukZ3xdbJWwM9HKIOiZ931F5YAaQ25XA4UFBQgNGjRyuPGQwG\
jB49Grt37w7gyKi5WNUjIuo4uAmE2tT58+fhdDqRnJyseTw5ORlHjx71+Bq73Q673a58b7PZ2nSM\
5B/2FiQi6jhYAaSgs3TpUlgsFuUrLS0t0EMiIiLqUBgAqU116dIFYWFhKC0t1TxeWlqKlJQUj69Z\
vHgxrFar8nX69On2GCoREZFuMABSmzIajcjMzERubq7ymMvlQm5uLrKysjy+xmQyIS4uTvNFRERE\
rYdrAKnNLViwAPfddx9++tOf4rrrrsMLL7yAyspKPPDAA4EeGhERkS4xAFKbu+eee3Du3Dk88cQT\
KCkpwTXXXIMtW7Y02hhCRERE7YN9ACnosS8WEekFP++ovXANIBEREZHOMAASERER6QwDIBEREZHO\
MAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBER\
EZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwD\
IBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER\
6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMAAS\
ERER6QwDIBEREZHOMAASERER6QwDIBEREZHOMABSiz3zzDO4/vrrERUVhfj4eI/XnDp1ChMmTEBU\
VBSSkpLwhz/8AXV1de07UCIiItIID/QAKHQ5HA7cddddyMrKwrp16xo973Q6MWHCBKSkpOCLL77A\
2bNnMW3aNEREROAvf/lLAEZMREREACCIoigGehAU2t544w3MmzcP5eXlmsc/+eQT/OxnP0NxcTGS\
k5MBAC+//DIWLlyIc+fOwWg0+nV/m80Gi8UCq9WKuLi41h4+EVHQ4OcdtRdOAVOb2b17NwYOHKiE\
PwAYO3YsbDYbjhw54vV1drsdNptN80VERESthwGQ2kxJSYkm/AFQvi8pKfH6uqVLl8JisShfaWlp\
bTpOIiIivWEAJI1FixZBEASfX0ePHm3TMSxevBhWq1X5On36dJu+HxERkd5wEwhpPPLII7j//vt9\
XnPllVf6da+UlBR8+eWXmsdKS0uV57wxmUwwmUx+vQcRERE1HwMgaSQmJiIxMbFV7pWVlYVnnnkG\
ZWVlSEpKAgBs27YNcXFxuPrqq1vlPYiIiKj5GACpxU6dOoULFy7g1KlTcDqd2L9/PwCgT58+iImJ\
wZgxY3D11Vfj3nvvxYoVK1BSUoLHHnsMc+bMYYWPiIgogNgGhlrs/vvvx9///vdGj3/22We46aab\
AAAnT57E7NmzsWPHDkRHR+O+++7DsmXLEB7u/88ebItARHrBzztqLwyAFPT4gUhEesHPO2ov3AVM\
REREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6\
wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgERE\
REQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMM\
gEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIRERE\
pDMMgEREREQ6wwBIREREpDMMgEREREQ6wwBIRES6d3jXGbz5p89xeNeZQA+FqF0wABIRke7t23IC\
FRfs2LflRKCHQtQuGACpRU6cOIHp06ejV69eiIyMRO/evbFkyRI4HA7NdQcPHsQNN9wAs9mMtLQ0\
rFixIkAjJiLybsi4nojtZMKQcT0DPRSidhEe6AFQaDp69ChcLhdeeeUV9OnTB4cPH8bMmTNRWVmJ\
5557DgBgs9kwZswYjB49Gi+//DIOHTqEBx98EPHx8Zg1a1aA/wRERA0GjOiGASO6BXoYRO1GEEVR\
DPQgqGN49tlnsWbNGnz33XcAgDVr1uDRRx9FSUkJjEYjAGDRokXYuHEjjh496vd9bTYbLBYLrFYr\
4uLi2mTsRKRPh3edwb4tJzBkXM+gCID8vKP2wilgajVWqxWdOnVSvt+9ezdGjBihhD8AGDt2LIqK\
inDx4sVADJGISMPftX/cJEIdDQMgtYpjx47hr3/9K379618rj5WUlCA5OVlznfx9SUmJ13vZ7XbY\
bDbNFxFRS/kKb/6u/eMmEepoGABJY9GiRRAEweeX+/TtmTNnMG7cONx1112YOXPmZY9h6dKlsFgs\
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\
hQtx+PBhPPjgg1i5ciVmzZrl93vxJ2Ki0KCuwDVVcQs2vsJrewZbft5Re2EFkFokKioK//znP7Fk\
yRJUVlaia9euGDduHB577DGlemexWLB161bMmTMHmZmZ6NKlC5544olmhT8iCh3tcUza4V1nkL/x\
OAA0avNyOXydQMLqIHVErABS0ONPxEQkU/r9wb+1fa2BFUDqiFgBJCKikDFkXE+lAthebVr8PZ+Y\
KJQwABIRUchgGCNqHewDSERERKQzDIBEREREOsMASERERKQzDIBEREREOsMASERERKQzDIBERERE\
OsMASERERKQzDIBEREREOsMASERERKQzDIBEREREOsMASERERKQzDIBEREREOsMASERERKQz4YEe\
AFFTRFEEANhstgCPhIiobcmfc/LnHlFbYQCkoFdRUQEASEtLC/BIiIjax48//giLxRLoYVAHJoj8\
MYOCnMvlQnFxMWJjYyEIQru/v81mQ1paGk6fPo24uLh2f//LFcrj59gDJ5THH8pjt1qt6N69Oy5e\
vIj4+PhAD4c6MFYAKegZDAZcccUVgR4G4uLiQu4fE7VQHj/HHjihPP5QHrvBwCX61Lb4XxgRERGR\
zjAAEhEREekMAyBRE0wmE5YsWQKTyRToobRIKI+fYw+cUB4/x07UNG4CISIiItIZVgCJiIiIdIYB\
kIiIiEhnGACJiIiIdIYBkIiIiEhnGACJvDhx4gSmT5+OXr16ITIyEr1798aSJUvgcDg01x08eBA3\
3HADzGYz0tLSsGLFigCNuLFnnnkG119/PaKioryeKnDq1ClMmDABUVFRSEpKwh/+8AfU1dW170A9\
ePHFF9GzZ0+YzWYMHToUX375ZaCH5NGuXbvw85//HKmpqRAEARs3btQ8L4oinnjiCXTt2hWRkZEY\
PXo0vv3228AM1s3SpUtx7bXXIjY2FklJSZg4cSKKioo019TU1GDOnDno3LkzYmJiMGnSJJSWlgZo\
xA3WrFmDQYMGKc2es7Ky8MknnyjPB+u4PVm2bBkEQcC8efOUx0Jp/BSaGACJvDh69ChcLhdeeeUV\
HDlyBCtXrsTLL7+MP/3pT8o1NpsNY8aMQY8ePVBQUIBnn30Wf/7zn/Hqq68GcOQNHA4H7rrrLsye\
Pdvj806nExMmTIDD4cAXX3yBv//973jjjTfwxBNPtPNItd577z0sWLAAS5Yswb59+zB48GCMHTsW\
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\
iEhn/j+T4Nec091cJAAAAABJRU5ErkJggg==\
"
  frames[1] = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAoAAAAHgCAYAAAA10dzkAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90\
bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAP\
YQAAD2EBqD+naQAAOQpJREFUeJzt3Xl4lPW9///XJGQlzCSQjSUsoo0Lm6YgAaQiKdFaKy2odFGs\
LJUiPQr1CFWx/arFAx43jgUpVvRYRfQUrBUVCgI/NYAiUUBJlbJJmCBKZiCQyTL3749hbjIkbEoy\
y+f5uK65YO65Z/K+9XJ85f1ZbodlWZYAAABgjLhwFwAAAICWRQAEAAAwDAEQAADAMARAAAAAwxAA\
AQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAE\
AAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAA\
AMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAA\
AMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAA\
DEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAw\
DAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMO0CncBwLfh9/tVXl6uNm3ayOFw\
hLscADgly7J08OBBdejQQXFx9GEQHgRARLXy8nLl5eWFuwwAOGO7d+9Wp06dwl0GDEUARFRr06aN\
pMAXqdPpDHM1AHBqXq9XeXl59vcXEA4EQES14LCv0+kkAAKIKkxbQTgx+QAAAMAwBEAAAADDEAAB\
AAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQA\
ADAMARAwwftPS4/2CPwJADAeARAwwTuPSp7dgT8BAMYjAAImGHSH5MoL/AkAMF6rcBcAoAX0HRN4\
AAAgOoAAAADGIQACAAAYhgAIxApW+gIAThMBEIgVrPQFAJwmAiAQK0610pcOIQDgKAIgECv6jpHu\
2Hzi1b6n0yEkJAKAEQiAgAnef1ryHZISUqWaQycOeAwjA4ARCICACVbcL1UfkGqPSEcOSCvvb7rT\
13AYmW4gAMQsNoIGYt37TwfCnyTJklIypFpfIAi+PiVwODhs3HDD6Ed7HOsGsok0AMQUOoBArDja\
sSv9630hz7Xi/tDzan1S3WGVuuslWdLSO5vu8nH7OACIWQ7LsqxwFwF8U16vVy6XSx6PR06nM9zl\
hNejPTRv5TbNK5UmPTBXo7+eFejghXBIkp4t9Wn2+hqNL0jU+ILEQNC7Y3OLlwyYiO8tRAI6gEA0\
azBPrzR7hOaVSkrL0ezZs/XstrZNvMGyw58kzdvoV+mhTLp8AGAYAiAQzRqs2u3z8z9o0gNzA8cr\
tmj24hI9W1oTcvqzpTV2+JOkSWN+rj4Pbwud48fiDwCIeQRAIJodN09v9OjRmtTzkFRfI1l+zV5f\
Y4fA0PDn0KSfDNToP/yl8WeyFQwAxDwCIBCt3n86ENIG3RHSwRvdK0GT+iXaz2evr9EVz1aFdv5+\
MkCju399rMvXsOvH4g9EmOfX7tTAh1bq+bU7w10KEDNYBIKoZvRk6uA2LSkZkqXA+o4r7pWW3SPV\
Hm403Bs0qV+iRvc5GhBTMqS7dhz7LBaDIAINfGil9lQeUcf0FL079Ypwl/OtGf29hYhBBxCIVsFO\
naXAPn9HDtjhT5JG90mUM8kR8hZnkuNY+JMC7wl2/VIyAncLYe4fIsyEy7urY3qKJlzePdylADGD\
AAhEq+C9f4feKyVnBG7zdjT8SYE5f15faIPf67MaLQzRyvsDn5WYFgiSzP1DBGg47PuL/l307tQr\
9Iv+XU563qk+B8AxBEAg2vUdEwiBtUfsQ8cP/zbsBDZcGCIptAvI3D9EiDmrtmlP5RHNWbXtW513\
up8DmIYACMSCdx5VYCy4ia1e+iVq5ejWjRaGhITAlfeHLihhKxiE2cmGfX/z4kZ1n/a6fvPixlMO\
DzN8DDSNRSCIakymPur9p6WV9+vZ9ZWavbZKsvySjlvwoYbh0CHFxWvSpSkafUnK0e6hdWwRCItC\
EMG6T3td9ZYU75C2zbg63OWcMb63EAnoAALRLNipk1RavESz1/tOGP4Ul6DRfRIDnUCHJH+dZq/3\
qfRAqiRLcsQfG/5lOBgR7OpeHRTvCPx5POb8AaeHDiCimvG/SR+3Fcy8kv2a9/4RTeqfotG94o+d\
12Nk4M/Nr0iSnv0kQbNLqjT+xus0/sffa3I/QSBSPL92p+as2qYJl3e3F4Icfyz4vMpXp8ojtRG9\
ZYzx31uICHQA0WzmzJmjXr16yel0yul0qrCwUG+88Yb9enV1tSZOnKh27dopLS1NI0aMUEVFRRgr\
jkLHbQUz/uJ4zf/R0fCXkBro6vUYKY18Wtq9LvAeR7xGX3+t5t/QQeMvSSD8IeIFF3Lcs2SzLrj3\
DTvsNVzcEXwuiTl/wGmgA4hm89prryk+Pl7nnXeeLMvSs88+q1mzZmnjxo266KKLNGHCBL3++uta\
sGCBXC6XbrvtNsXFxendd9897Z/Bb9JHvf+0tOJ+qd4XCIMJSYFNofuOkV4ZI21ZLLXvJR3YcWzT\
6CMHjv7FOrYhNBCBnl+7U/csOTYXNRjwHnz9E1XX+nVN78BQ8Osfl+vqXh30xE8vDlepp4XvLUQC\
AiBaVNu2bTVr1iyNHDlSWVlZeuGFFzRyZGB4cuvWrbrgggtUUlKi/v37n9bn8UV6Gv7QVrLqA93A\
JGdgr79WqVLrdlLVV1Ld4cA+gkPvpRuIiBPs9rVrnagPPtyo1u27q3VSK/22OF/3Ltms4P/AUhLi\
dKTWr/SUBC24Nlt9+vQJZ9knxfcWIgFDwGgR9fX1WrhwoaqqqlRYWKgNGzaotrZWRUVF9jnnn3++\
OnfurJKSkhN+js/nk9frDXkY7XS2a7nox4Hwd9GPAw0/KdAhvGOzVPxAYAg5GP48u9kIGhElOLS7\
5e2/qcOmZ6XPVqvySK3mrNomR4Mb3RypDSx+2vP+mxr0wxt0y9QZYaoYiA4EQDSrTZs2KS0tTUlJ\
Sbr11lu1ePFiXXjhhXK73UpMTFR6enrI+Tk5OXK73Sf8vBkzZsjlctmPvLy8Zr6CCHc6oW3k09IP\
ZgXmAHYfGgh8V9wbeC14N5G+Y1j5i4g04fLuSj+8R9an/5Qk1W9+Q/6yVdrrOSL/ceNXhzatkHfD\
a6qt92vR8wtUWlra8gUDUYIAiGaVn5+v0tJSrVu3ThMmTNDo0aP1ySeffOPPmzZtmjwej/3YvXv3\
Waw2Cp1uaAsGxd3rjgW+4zUMg0CE+EX/Lip9Yry+P3K0Pin3aq/niCrWLpH34xUh5x3atEIHP3zN\
ft6+cLgmvvk128EAJ0AARLNKTEzUueeeq4KCAs2YMUO9e/fW448/rtzcXNXU1KiysjLk/IqKCuXm\
5p7w85KSkuxVxcGH0YKhTTr5UDDdPUS5za0vVurFP7S7fgc/fE2HNgVC4PHhr80l16i2+2BuAQec\
BAEQLcrv98vn86mgoEAJCQlaseLYb/FlZWXatWuXCgsLw1hhlDrVUDDdPUS5gi4ZSus5VG0uucY+\
dvDD1+R+8XeNwl9az6FKSYhTvCPwPgCNtQp3AYhd06ZN01VXXaXOnTvr4MGDeuGFF7Rq1Sq99dZb\
crlcGjNmjCZPnqy2bdvK6XRq0qRJKiwsPO0VwGhg0B3HVvACMeb5tTv12kflkqS0nkMlyQ59Vs1h\
+7xg+JOOLQrZsPNAS5YKRA0CIJrNvn37dNNNN2nv3r1yuVzq1auX3nrrLX3/+9+XJD366KOKi4vT\
iBEj5PP5VFxcrD/96U9hrjpK9R1Ddw8xpeGdPuas2qaG6z3Seg7Voc0rQsKfIzHVDn9B6SkJbAgN\
nAD7ACKqsZ8WEJsGPrRSeyqP2Pf8/fvRDqDUeM5fUMMOoKSIvR0c31uIBMwBBABElOfX7lSVr04O\
SfVWYBi3V0eXpMbhz5GYav+94cIQifl/wMkQAAEAYff82p0a+NBKe+i38kitXCkJ9m3f/j5pkM7z\
bGi04CP3p39stDAkGALX/OvLFr8OIFoQAIFIdTp3+QBiRPCOH8F5fx3TU/Tb4ny9O/UK/aJ/F/3q\
3v9WyWt/tW9m03C4t6nVwYc2rZCvrj4MVwJEBwIgEKm4NRsMEgx9Ey7vrl/072LP3Rv40Eo9+NxS\
/e/TT6m23i9Ljef6SU2HQP+XO1rwCoDoQgAEIhWbN8MgwdD3i/5d7GPBruDS8mS1K/iBpKbDX1Ba\
z6FyXnKN0lMS1KnwGt17c+A9DYeXAQSwChhRjdV0QOxquBWMJN379Guy2nVrdJ5DkiUpIc6h+350\
kXokH9Dm6gzNWbVNBV0y9PrH5aq3ImdVMN9biATsAwgAiEi/6N/F7gg+v3an4jK7qd4K7O8nSZ4j\
tbIke49Av2UdPb+LJh7dRsbtOaJ6S4p3iD0BgQYYAgYARLyH3ypTvRXo9v22OF+l9w3T/cN7qGN6\
inp1dNn7BQYF5xRe3auDOqan6A/X9ggZXgZMRwcQiETvP33s1m7c4QOwuVIS9Iv+Xezh4YIuGdqw\
84D+cG0PSYFFI8GFJAQ+4MQIgEAkargCmAAIwwUXb6SnJOi3xfmSji0QCQ7xzlm1TZLsrWQIf8DJ\
MQQMRCJWAAO24MbQrZNa2d2/Kl+d0lMS7CHeCZd3D9lKBsDJ0QEEIlHfMXT+gKMmXN49ZDVwMBB2\
TE/REz+9OORcOn/A6SEAAgAi2vHz+Y4PhADOHPsAIqqxnxaAhvsFRkMHkO8tRALmAAIAotrDb5Vp\
T+URPfxWWbhLAaIGARAAAMAwBEAAQFT7bXG+Oqan2FvEADg15gAiqjGXBkC04XsLkYAOIAAAgGEI\
gAAAAIYhAAIAABiGAAgAAGAYAiDQDA4sXKjPrhiqAwsXntFrAAC0BAIg0Az2z/uz6srLtX/en8/o\
NQAAWgIBEGgGmePHqVWHDsocP+6MXgMAoCWwDyCiGvtpAYg2fG8hEtABBAAAMAwBEAAAwDAEQAAA\
AMMQAIFvgK1cAADRjAAIfANs5QIAiGYEQEAn7uid6HhTW7nQFQQARAu2gUFUO1vbKXx2xVDVlZer\
VYcOOm/lilMeP9VnZI4fp/3z/qzM8eOUMWrUN64LQOxhGxhEAjqAgJru6G0feZ3qysulVq0adfrK\
Lu2vskv7h3T7MsePU5zLJX9VlfY9+pjqysvlvv8BOoIAgIhDBxBRrbl+kz6wcKHcv/+D/bxhOHTf\
/4BUX28fb6pjKIcjcMCyTqt7CMAcdAARCegAAkcF5/DtmfJbue9/QJ9WV9uvBbt5+x59LBD+HA7F\
uVxKvfhivdq3n93lyxw/ToqPlyxLcU4nt3wDAEQkAiCM1NSCjeDKXu/rr2vRV19peoVbSzyeY2+q\
r5f/8GFJUqv27RXXurX+d/Fi3b1pk/7n97+XJGWMGqXce+9Rqw4dlDZoUEteEgAAp40ACCM1tY1L\
5vhxksOhT6ur9bKnUoqL118PHAgNgbW1kgIdwVc+/VTP7y2XHNIrlZUqLS0N+RmH3nmHrWIAABGJ\
AAgjNbXoI2PUKMU5nbogOVm/aN9B8W3SJKlxCJS0xOPRXw8ckCxJljTKEacuW7cG5g7e/0BgHqDE\
EDAAICKxCARR7WxNpj6wcKH2z/uzUi++WIfeeUf+qiot+eqrQMg76ucZGRruch0Lf8cdlyRHcrKs\
6urAHEGnU9l33M42MABCsAgEkYAAiKjWHPsASrI7eMeHvbT4OB2q99vPG4Y/W3y8HImJso4cYQUw\
gEYIgIgEDAGj2cyYMUN9+/ZVmzZtlJ2dreHDh6usrCzknOrqak2cOFHt2rVTWlqaRowYoYqKihav\
NTgknHrxxarbt88+Ptzl0s8zMuznpwx/klRfL0diIsO/AICIRQBEs1m9erUmTpyotWvXavny5aqt\
rdWwYcNUVVVln3PHHXfotdde08svv6zVq1ervLxcP/nJT1q81oxRo3TeyhU6vHGjVFcX8tpwl0tp\
8aH/qaTFxzUd/hSY95d9x+06b+UKZYwaxS3iAAARhyFgtJgvv/xS2dnZWr16tQYPHiyPx6OsrCy9\
8MILGjlypCRp69atuuCCC1RSUqL+/fuf8jPP5lDKgYULte/Rx+SvqpLq6xXndMrv8TQaBg6yO4AO\
R2Dvv7o6OZKTdX7pxpDzzuR2cgBiH0PAiAR0ANFiPEdX0rZt21aStGHDBtXW1qqoqMg+5/zzz1fn\
zp1VUlLS5Gf4fD55vd6Qx9myf96f5fd41Co7W7n3TW8y/DXsBNqrgy3LDoFthg5t9LlNrTgGACCc\
CIBoEX6/X7fffrsGDhyoHj16SJLcbrcSExOVnp4ecm5OTo7cbneTnzNjxgy5XC77kZeXd9ZqbBjU\
3A882ORq32fyOofMCbRDYG2tVF8v75tvNhrqDQ4vsxoYABApCIBoERMnTtTmzZu18FvOg5s2bZo8\
Ho/92L1791mq8FhQk3TCLWCk0IUhjpQU/bWywT6B9fVs/AwAiHgEQDS72267Tf/4xz/09ttvq1On\
Tvbx3Nxc1dTUqLKyMuT8iooK5ebmNvlZSUlJcjqdIY+zbc1/P9Jk+Ltg66f2NjHBEGj5qgN3DPF6\
tbtvX4Z6AQBRgQCIZmNZlm677TYtXrxYK1euVLdu3UJeLygoUEJCglasOLYwoqysTLt27VJhYWFL\
l2sbPGWybujaRfHpLv08M1PDXS4lHx22Dg4TO1JSAiHQlS7V1+uGvE4a9r/PMdQLAIgKrAJGs/n1\
r3+tF154Qa+++qry8/Pt4y6XSykpKZKkCRMmaOnSpVqwYIGcTqcmTZokSXrvvfdO62ec7TuBZI4f\
Zwe40tJStZ48pckVvMFbvqm+Xp/W1mjIgw8S/ACcFlYBIxLQAUSzmTNnjjwejy6//HK1b9/efrz0\
0kv2OY8++qh++MMfasSIERo8eLByc3P1t7/9rcVr3T/vz6orLw+Zv9enTx9ljh+nOJdL/qqqRos7\
4tLSFOdyhYQ/9vwDAEQDOoCIas3ZAQxqah+/E+3tx55/AE6FDiAiAR1AQCffqqWpffyOPxbs/KVe\
fDELQQAAEY8OIKJapPwmTecPwOmKlO8tmI0OIHAWcLcPAEA0oQOIqMZv0gCiDd9biAR0AAEAAAxD\
AAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwB\
EAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARA\
AAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQCCCLSpbpGGvDNOiskXhLgUAEEMIgEAEm79pvvZW7dX8\
TfPDXQoAIIYQAIEINrbnWLVv3V5je44NdykAgBjisCzLCncRwDfl9Xrlcrnk8XjkdDrDXQ4AnBLf\
W4gEdAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEA\
AAxDAAQAADAMARDNZs2aNbrmmmvUoUMHORwOLVmyJOR1y7I0ffp0tW/fXikpKSoqKtJnn30WnmIB\
ADAIARDNpqqqSr1799aTTz7Z5OszZ87UE088oblz52rdunVq3bq1iouLVV1d3cKVAgBgllbhLgCx\
66qrrtJVV13V5GuWZemxxx7TPffco2uvvVaS9NxzzyknJ0dLlizRqFGjWrJUAACMQgcQYbF9+3a5\
3W4VFRXZx1wuly699FKVlJSc8H0+n09erzfkAQAAzgwBEGHhdrslSTk5OSHHc3Jy7NeaMmPGDLlc\
LvuRl5fXrHUCABCLCICIKtOmTZPH47Efu3fvDndJAABEHQIgwiI3N1eSVFFREXK8oqLCfq0pSUlJ\
cjqdIQ8AAHBmCIAIi27duik3N1crVqywj3m9Xq1bt06FhYVhrAwAgNjHKmA0m0OHDunzzz+3n2/f\
vl2lpaVq27atOnfurNtvv10PPPCAzjvvPHXr1k333nuvOnTooOHDh4evaAA4gY+WL9X6Ja+o3/CR\
6v39H4S7HOBbIQCi2XzwwQcaMmSI/Xzy5MmSpNGjR2vBggX6z//8T1VVVWn8+PGqrKzUoEGD9Oab\
byo5OTlcJQPACa1f8oq8+/dp/ZJXCICIeg7LsqxwFwF8U16vVy6XSx6Ph/mAZ2hR2SLN3zRfY3uO\
1fX514e7HCDina0OIN9biAQEQEQ1vkhP7FQBb9grw7S3aq/at26vZSOXhaFCwEx8byESsAgEiFHz\
N83X3qq9euLDJzTwxYEa9OIgLSpbZL8+tudYtW/dXmN7jg1536KyRRr2yrCQc4FY8dHypfrzxFv0\
0fKlzXI+EC0IgECMujj7Yvl2+eSr98lb45WnxqP5m+Y3eW5paan992BwPNG5QDRrOI/veE2FvZOd\
D0QzFoEAMeq1v76m3ct2y/d9n5wDnUqIS1Db5Lbq+WxPSVJyfLKq66t1z2P3yL3MrVGjR2ne9Hka\
23OsPXQMxJp+w0fa8/ik0Hl9wbD3z6fnaNVzT6tVYoK69r7Efh8QS5gDiKjGXJrGFpUt0qN/f1Tb\
n96uw7WHVeevU9uitsoYlNHo3Oq11Sp/q1x+y694R7ze+ds76tOnT8sXDbSw0tJS9enTR3+eeIu8\
+/fJmZmtfsNHasVf5sry++3zPIrX/3vp1bP6s/neQiSgAwjEmPmb5utQ9iElXJagun/WyZKlr/75\
lSSFhMAD7xyQd6VXDjkkSe2L2xP+YIR58+Zp3rx5mjRpUkhHMLiy952Fz6muplbr/71T/1/Zv3Vg\
1Aj1aueyu4DsBYhYQAcQUY3fpBtbVLZID6x9QJYsHXjngB3+JKldUTtlDMqwjzvkkCVLucNy9V+T\
/4vtYBDTPlq+VP83/ym9WLJBtdXVSkhOVv8unfTdbh0lSa0SEuTKzlXFvz/X+zu+0Luf7bDfe913\
e6p7p05KTEmRd/8+OeLiNPSWW79RCOR7C5GARSBAjAiu3pUkZ2LgfyoZgzLUrqidfc5X//xK2/9r\
ux0KLVlqV9ROaQPStKFiQ8sXDbSg9UtekUv1+m6HLNXX1an60CGt2rJVJWXbVOfzqfrQoSbD38Dz\
uqpjhktyWOo3fKQccXGy/H4WhiCqEQCBGNFw9e5vLvmN2rduL4ccjUJg/ZF6++/BjqAkLd2+VHet\
uavF6wZaSof88+WIi9PVQ76nQd/pZh9/97Mden/HF5LUZPi7tHtXyeFQ196XqPf3f6Cht9xqzxkE\
ohVzAIEY0XD1bnAo94G1D0gKdAIr360MCX/xKfGNFoYs3b5UBTkFDAUjJpWXbZXl98uzz63+3zlH\
lmXZYe/dz3bogx1fyFdbZ58/8Lyu6tu1k/z1dfb7Jan393/A/D9EPTqAQJRrOPS7bOQyXZ9/ve5a\
c5fuX3u/LAWm+B5450BI+JMCncAD7xxo9HnzN81nM2jEpH7DR8qZmS1ZDtX5fOrbtZMGntfVfr2p\
8BfUKilJNUeO2HsEskE0oh2LQBDVTJ9MvahskR5c96D8lt++q8f8TfPlrnKHhL+GC0HiU+JPOAws\
BfYHTIpPkqfGw23iEJM+Wr5U/5z/J/v5nFVrQ8JfUkIrTbi8f9NvdjhUNGaC3nnxf1VddVDJrdto\
4l9ePKOfb/r3FiIDHUAgis3fNF9+y684R5wd/vZW7T1h+GtX1E7d7urWaGFIw05gdX21PDUeuRJd\
bAaNmNRw+Pb944Z9pUAnMDgnsBHLCiz+cBztnTjooSA6MQcQiGJNzfsLdgRPtAWMdGw/wODrTe0T\
6Kv32beDY04gYkHwrh8d8s+X1HjBR1JCKzsMBo83HAaWJDkcjfYDBKIRQ8CIagylNLaobJHuWXSP\
dv9lt30ssyhT6YPSQ85zyCHPux7t/+d+WZYlS5Y639JZiZ0TQ85jGBixInjXD0dcnNb/e1ej1b59\
u3ZqchVw3255Sk5NkxyWBo266VsvAOF7C5GAIWAgxlyff70euP4BZV6eKSnQ+Ts+/F3U7iK1SWwj\
50Cn2g5tqzhHnNpe3laJnROVHJ+sOEfgqyE4tAzEguAikC/iU/Tetl328YYLPhouDHHExWnt9i90\
OO88DfrpjUpMTg1H2UCzYAgYiFFth7RVUrckpXRJ0UXtLtIXB7+Qt8YrS5a+rv7avgVc+qB0tTun\
nfwd/PbcwbSENDnk0G8u+Q3Dv4gZvb//A1lZHfTU2LHK7nqO9u34twZ079xomDf4fNOBKqU4XXr1\
7TWq3bVNLtVr/ZJX2AIGMYEACMSQRWWLNH/TfB2uPSy/5Vfrrq1196V32yEu+Hqwq/fEh0/IkqX/\
+Ml/SAosKqmqrZK3xqv2rdsT/hBz+vTpo/Hjx+vxh2fpsvxzdEmn3MYnORy68ec/0yuvvqb1u936\
j9/eqUu7dWLOH2IKcwAR1ZhLE2rYK8O0t2qvnIlOtU5oHbI45HQ1DIkEQMSij5Yv1XP//V/q4GoT\
crxVYpLkkOpqatQqMVF1Pp88itf/e+nVs/rz+d5CJKADCMSQsT3H6vEPH5dDjm8c4K7Pv57gh5j2\
zsLnjoU/h0OyrMCfDqnO55MUCIHOzGwV0fFDjGIRCBBDrs+/Xq0TWstT47G3cAFwHCsw/zW5dRsV\
jZkgZ2a23fELOn/AZRr35F+Y74eYRQAEYszYnmPtu4J8U9wKDrFs0E9vlDMzW137XGzP62vV6uj2\
Rw6Hisb+Wlf/5j/DWyTQzJgDiKjGXJrmEZxLyB6AiGXBfQGdmdnqN3ykHQabu+vH9xYiAR1AAI2c\
jS4iEOmC+wIGQx9DvjAJHUBENX6TBhBt+N5CJKADCAAAYBgCIAAAgGEIgAAAAIYhAAIAABiGAAgA\
AGAYAiAAAIBhCIAAAACGIQACAAAYhgAIAABgGAIgAACAYQiAAAAAhiEAAgAAGIYACAAAYBgCIAAA\
gGEIgAAAAIYhAAIAABiGAIiwe/LJJ9W1a1clJyfr0ksv1fr168NdEgAAMY0AiLB66aWXNHnyZN13\
33368MMP1bt3bxUXF2vfvn3hLg0AgJhFAERYPfLIIxo3bpx++ctf6sILL9TcuXOVmpqqv/zlL+Eu\
DQCAmEUARNjU1NRow4YNKioqso/FxcWpqKhIJSUlYawMAIDY1ircBcBc+/fvV319vXJyckKO5+Tk\
aOvWrU2+x+fzyefz2c+9Xm+z1ggAQCyiA4ioMmPGDLlcLvuRl5cX7pIAAIg6BECETWZmpuLj41VR\
URFyvKKiQrm5uU2+Z9q0afJ4PPZj9+7dLVEqAAAxhQCIsElMTFRBQYFWrFhhH/P7/VqxYoUKCwub\
fE9SUpKcTmfIAwAAnBnmACKsJk+erNGjR+u73/2u+vXrp8cee0xVVVX65S9/Ge7SAACIWQRAhNUN\
N9ygL7/8UtOnT5fb7VafPn305ptvNloYAgAAzh6HZVlWuIsAvimv1yuXyyWPx8NwMICowPcWIgFz\
AAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMA\
BAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQ\
AADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAA\
AADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEA\
AAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwBEs3nwwQc1YMAApaamKj09vclzdu3apauvvlqp\
qanKzs7WnXfeqbq6upYtFAAAw7QKdwGIXTU1NbruuutUWFiop59+utHr9fX1uvrqq5Wbm6v33ntP\
e/fu1U033aSEhAT98Y9/DEPFAACYwWFZlhXuIhDbFixYoNtvv12VlZUhx9944w398Ic/VHl5uXJy\
ciRJc+fO1V133aUvv/xSiYmJp/xsr9crl8slj8cjp9PZHOUDwFnF9xYiAUPACJuSkhL17NnTDn+S\
VFxcLK/Xqy1btoSxMgAAYhtDwAgbt9sdEv4k2c/dbneT7/H5fPL5fPZzr9fbfAUCABCj6ADijEyd\
OlUOh+Okj61btzbbz58xY4ZcLpf9yMvLa7afBQBArKIDiDMyZcoU3XzzzSc955xzzjmtz8rNzdX6\
9etDjlVUVNivNWXatGmaPHmy/dzr9RICAQA4QwRAnJGsrCxlZWWdlc8qLCzUgw8+qH379ik7O1uS\
tHz5cjmdTl144YVNvicpKUlJSUln5ecDAGAqAiCaza5du/T1119r165dqq+vV2lpqSTp3HPPVVpa\
moYNG6YLL7xQN954o2bOnCm326177rlHEydOJOQBANCM2AYGzebmm2/Ws88+2+j422+/rcsvv1yS\
tHPnTk2YMEGrVq1S69atNXr0aD300ENq1er0fjdhOwUA0YbvLUQCAiCiGl+kAKIN31uIBKwCBgAA\
MAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADA\
MARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEAAAADD\
EAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwBEAAAwDAEQAAAAMMQAAEAAAxD\
AAQAADAMARAAAMAwBEAAAADDEAABAAAMQwAEAAAwDAEQAADAMARAAAAAwxAAAQAADEMABAAAMAwB\
EAAAwDAEQAAAAMMQAAEAAAxDAAQAADAMARAAAMAwBEA0ix07dmjMmDHq1q2bUlJS1L17d913332q\
qakJOe/jjz/WZZddpuTkZOXl5WnmzJlhqhgAAHO0CncBiE1bt26V3+/XU089pXPPPVebN2/WuHHj\
VFVVpYcffliS5PV6NWzYMBUVFWnu3LnatGmTbrnlFqWnp2v8+PFhvgIAAGKXw7IsK9xFwAyzZs3S\
nDlz9O9//1uSNGfOHN19991yu91KTEyUJE2dOlVLlizR1q1bT+szvV6vXC6XPB6PnE5ns9UOAGcL\
31uIBAwBo8V4PB61bdvWfl5SUqLBgwfb4U+SiouLVVZWpgMHDjT5GT6fT16vN+QBAADODAEQLeLz\
zz/X7Nmz9atf/co+5na7lZOTE3Je8Lnb7W7yc2bMmCGXy2U/8vLymq9oAABiFAEQZ2Tq1KlyOBwn\
fRw/fLtnzx5deeWVuu666zRu3Lhv9fOnTZsmj8djP3bv3v2tPg8AABOxCARnZMqUKbr55ptPes45\
55xj/728vFxDhgzRgAEDNG/evJDzcnNzVVFREXIs+Dw3N7fJz05KSlJSUtI3qBwAAAQRAHFGsrKy\
lJWVdVrn7tmzR0OGDFFBQYGeeeYZxcWFNpwLCwt19913q7a2VgkJCZKk5cuXKz8/XxkZGWe9dgAA\
EMAQMJrFnj17dPnll6tz5856+OGH9eWXX8rtdofM7fvZz36mxMREjRkzRlu2bNFLL72kxx9/XJMn\
Tw5j5QAAxD46gGgWy5cv1+eff67PP/9cnTp1CnktuPOQy+XSsmXLNHHiRBUUFCgzM1PTp09nD0AA\
AJoZ+wAiqrGfFoBow/cWIgFDwAAAAIYhAAIAABiGAAgAAGAYAiAAAIBhCIAAAACGIQACAAAYhgAI\
AABgGAIgAACAYQiAAAAAhiEAAgBw1OY1e/Tc797V5jV7wl0K0KwIgAAAHPXhmzt08GufPnxzR7hL\
AZoVARAAAAW6fzXV9UpKbaVLruza6DU6g4glBEAAABTo/vkO1ykxOV6SQgIfnUHEGgIgAMA4TXX0\
Lrmyq9q0TdIlV3bV2iXbdPBrn9Yu2dbotRO9H4gmrcJdAAAALS3Y0Vv9YpnWLtmm/sO7q8fgjuox\
uKMk2cEvqOFrDd//4Zs7Qo4D0YIOIAAgpp2o2yeHJEvyHa5rNLTb+aJ2kkOqr/Vr2dNbmnx/Umor\
1VTX0wVEVCIAAgBiWlPz93oM7qiklFb6Yv/nkkNKbpOoP/16pZY9vUWStGvLV5Il1dX69fmGCn36\
ry2N3p+YHN9keASiAQEQABDTjp+/F7Q7rkQL331En+xfrS93HpTllz57v0Kb1+xRra/ePm979Vot\
fPcRbat5J6SbeKLPBaKBw7IsK9xFAN+U1+uVy+WSx+OR0+kMdzkAosDmNXu0+Nnl+t8Vs+Q7UifL\
L32vx3D1zy+WJLVKiFNdrV+StPZfb+lT7wpJ0pFDtfpRr4nq1PZctWmbpJv+OPAb/Xy+txAJ6AAC\
AIzy4Zs71Dahsy7t9kNZgZyn1ZuXaG3ZW5J0LPyVvaX3/vV3fbnroPbtPKjvdrhKndqeK0ec6Poh\
6hEAAQBGueTKrnLESf3zi/W9HsPt4w1D4Nqyt7R68xLV+vyyrECHsN93hqlN2yQNHpXPyl9EPbaB\
AQAYYfOaPfb2LucW5Mi9rVLXDBspOaTVm5ZICoTA9f9apiM1h+33BYeHs7q00fXT+oajdOCsowMI\
ADBC8E4fvsN1+nxDhXK7p+vLXQfV/zuhncCmwp8kpWensvkzYgYBEABghODefXIosOL3gwrp6DLI\
/vnFSklMDTk/JTHVDn9SYIVw8O4gBEFEOwIgAMAIPQZ31NhHBut7P81Xm7ZJinM47NfWlr0V0vmT\
Ap3A4JzAhmqr6+27iBACEa0IgACAmNVw377g3yUFtnA5mv+CCz6CGnYCGy4MCfIHd0+zxCbQiFoE\
QABAzGp4F5Dj7wji91uNwt/3egzXb6757xOuDpak876bo6TUVkpKbcV2MIharAIGAMSsS67sqg/f\
3KFLruyq8s8qdaiyQsltEvXc797VJ/tXa82WJUpIilOtzx+y4CP4ZzAcBv+8ZthIDRtzkaRAdzEY\
JtkWBtGGDiAAIGb1GNxRN/1xoHoM7ij3tkpZfmn/7oP69F9btPSdl5TVuY389VZI+Avqn1+sIb1+\
bD9/Z+uriss+YA8pN3WPYSBaEAABAEYI3rv33IIcXfCdi3TTz38pSRr7y1s14IIrG7/BIV3W+wf6\
Xo/hcjikm37+Sx3e1toOfdwLGNGMewEjqnFPTQDfRmlpqfr06aP5k9fId7hOkhQX55DfbykptZX6\
D++uD9/codTuVRo5Zpjd+bvkyq7feNiX7y1EAuYAAgCM1adPn9ADDql7Qbbc2yrtkNcw6B3/HIhW\
BEAAgJEadvP6D++uNQvLZPkl97bKwDYxJzmfEIhoxxxAAICRGi7i6DG4owaPyj/pnD4WfSCW0AEE\
ABip4RYx0qmHd48/H4hmLAJBVGMyNYBow/cWIgFDwAAAAIYhAAIAIl7De/oC+PYIgACAiMcCDODs\
IgACACIed90Azi5WAQMAIh4bMANnFx1ANJsf/ehH6ty5s5KTk9W+fXvdeOONKi8vDznn448/1mWX\
Xabk5GTl5eVp5syZYaoWAABzEADRbIYMGaJFixaprKxM//d//6dt27Zp5MiR9uter1fDhg1Tly5d\
tGHDBs2aNUu///3vNW/evDBWDQBA7GMfQLSYv//97xo+fLh8Pp8SEhI0Z84c3X333XK73UpMTJQk\
TZ06VUuWLNHWrVtP6zPZTwtAtOF7C5GADiBaxNdff62//vWvGjBggBISEiRJJSUlGjx4sB3+JKm4\
uFhlZWU6cOBAk5/j8/nk9XpDHgAA4MwQANGs7rrrLrVu3Vrt2rXTrl279Oqrr9qvud1u5eTkhJwf\
fO52u5v8vBkzZsjlctmPvLy85iseAIAYRQDEGZk6daocDsdJHw2Hb++8805t3LhRy5YtU3x8vG66\
6SZ9m1kH06ZNk8fjsR+7d+8+G5cFAIBR2AYGZ2TKlCm6+eabT3rOOeecY/89MzNTmZmZ+s53vqML\
LrhAeXl5Wrt2rQoLC5Wbm6uKioqQ9waf5+bmNvnZSUlJSkpK+nYXAQCA4QiAOCNZWVnKysr6Ru/1\
+/2SAvP4JKmwsFB33323amtr7XmBy5cvV35+vjIyMs5OwQAAoBGGgNEs1q1bp//5n/9RaWmpdu7c\
qZUrV+qnP/2punfvrsLCQknSz372MyUmJmrMmDHasmWLXnrpJT3++OOaPHlymKsHACC2EQDRLFJT\
U/W3v/1NQ4cOVX5+vsaMGaNevXpp9erV9hCuy+XSsmXLtH37dhUUFGjKlCmaPn26xo8fH+bqAQCI\
bewDiKjGfloAog3fW4gEdAABAAAMQwAEAAAwDKuAEdWCMxi4IwiAaBH8vmIGFsKJAIiodvDgQUni\
jiAAos7BgwflcrnCXQYMxSIQRDW/36/y8nK1adNGDofjlOd7vV7l5eVp9+7dMTH5muuJbLF2PVLs\
XVM4rseyLB08eFAdOnRQXBwzsRAedAAR1eLi4tSpU6czfp/T6YyJ/3kFcT2RLdauR4q9a2rp66Hz\
h3DjVw8AAADDEAABAAAMQwCEUZKSknTffffZdyOJdlxPZIu165Fi75pi7XqA08UiEAAAAMPQAQQA\
ADAMARAAAMAwBEAAAADDEAABAAAMQwCEEXbs2KExY8aoW7duSklJUffu3XXfffeppqYm5LyPP/5Y\
l112mZKTk5WXl6eZM2eGqeJTe/DBBzVgwAClpqYqPT29yXN27dqlq6++WqmpqcrOztadd96purq6\
li30DDz55JPq2rWrkpOTdemll2r9+vXhLum0rFmzRtdcc406dOggh8OhJUuWhLxuWZamT5+u9u3b\
KyUlRUVFRfrss8/CU+xpmDFjhvr27as2bdooOztbw4cPV1lZWcg51dXVmjhxotq1a6e0tDSNGDFC\
FRUVYar45ObMmaNevXrZmz0XFhbqjTfesF+PpmsBzhYCIIywdetW+f1+PfXUU9qyZYseffRRzZ07\
V7/73e/sc7xer4YNG6YuXbpow4YNmjVrln7/+99r3rx5Yaz8xGpqanTddddpwoQJTb5eX1+vq6++\
WjU1NXrvvff07LPPasGCBZo+fXoLV3p6XnrpJU2ePFn33XefPvzwQ/Xu3VvFxcXat29fuEs7paqq\
KvXu3VtPPvlkk6/PnDlTTzzxhObOnat169apdevWKi4uVnV1dQtXenpWr16tiRMnau3atVq+fLlq\
a2s1bNgwVVVV2efccccdeu211/Tyyy9r9erVKi8v109+8pMwVn1inTp10kMPPaQNGzbogw8+0BVX\
XKFrr71WW7ZskRRd1wKcNRZgqJkzZ1rdunWzn//pT3+yMjIyLJ/PZx+76667rPz8/HCUd9qeeeYZ\
y+VyNTq+dOlSKy4uznK73faxOXPmWE6nM+QaI0W/fv2siRMn2s/r6+utDh06WDNmzAhjVWdOkrV4\
8WL7ud/vt3Jzc61Zs2bZxyorK62kpCTrxRdfDEOFZ27fvn2WJGv16tWWZQXqT0hIsF5++WX7nE8/\
/dSSZJWUlISrzDOSkZFhzZ8/PyauBfgm6ADCWB6PR23btrWfl5SUaPDgwUpMTLSPFRcXq6ysTAcO\
HAhHid9KSUmJevbsqZycHPtYcXGxvF6v3fmIFDU1NdqwYYOKiorsY3FxcSoqKlJJSUkYK/v2tm/f\
LrfbHXJtLpdLl156adRcm8fjkST7v5cNGzaotrY25JrOP/98de7cOeKvqb6+XgsXLlRVVZUKCwuj\
+lqAb4MACCN9/vnnmj17tn71q1/Zx9xud0hYkmQ/d7vdLVrf2RBN17N//37V19c3WW+k1XqmgvVH\
67X5/X7dfvvtGjhwoHr06CEpcE2JiYmN5p5G8jVt2rRJaWlpSkpK0q233qrFixfrwgsvjMprAc4G\
AiCi2tSpU+VwOE762Lp1a8h79uzZoyuvvFLXXXedxo0bF6bKm/ZNrgdoThMnTtTmzZu1cOHCcJfy\
reTn56u0tFTr1q3ThAkTNHr0aH3yySfhLgsIm1bhLgD4NqZMmaKbb775pOecc8459t/Ly8s1ZMgQ\
DRgwoNHijtzc3EYr/4LPc3Nzz07Bp3Cm13Myubm5jVbRtvT1nK7MzEzFx8c3+c8/0mo9U8H6Kyoq\
1L59e/t4RUWF+vTpE6aqTs9tt92mf/zjH1qzZo06depkH8/NzVVNTY0qKytDOmeR/O8rMTFR5557\
riSpoKBA77//vh5//HHdcMMNUXctwNlAAERUy8rKUlZW1mmdu2fPHg0ZMkQFBQV65plnFBcX2gAv\
LCzU3XffrdraWiUkJEiSli9frvz8fGVkZJz12ptyJtdzKoWFhXrwwQe1b98+ZWdnSwpcj9Pp1IUX\
XnhWfsbZkpiYqIKCAq1YsULDhw+XFBh6XLFihW677bbwFvctdevWTbm5uVqxYoUd+Lxer92JikSW\
ZWnSpElavHixVq1apW7duoW8XlBQoISEBK1YsUIjRoyQJJWVlWnXrl0qLCwMR8lnzO/3y+fzxcS1\
AN9IuFehAC3hiy++sM4991xr6NCh1hdffGHt3bvXfgRVVlZaOTk51o033mht3rzZWrhwoZWammo9\
9dRTYaz8xHbu3Glt3LjR+sMf/mClpaVZGzdutDZu3GgdPHjQsizLqqurs3r06GENGzbMKi0ttd58\
800rKyvLmjZtWpgrb9rChQutpKQka8GCBdYnn3xijR8/3kpPTw9ZxRypDh48aP/zl2Q98sgj1saN\
G62dO3dalmVZDz30kJWenm69+uqr1scff2xde+21Vrdu3awjR46EufKmTZgwwXK5XNaqVatC/ls5\
fPiwfc6tt95qde7c2Vq5cqX1wQcfWIWFhVZhYWEYqz6xqVOnWqtXr7a2b99uffzxx9bUqVMth8Nh\
LVu2zLKs6LoW4GwhAMIIzzzzjCWpyUdDH330kTVo0CArKSnJ6tixo/XQQw+FqeJTGz16dJPX8/bb\
b9vn7Nixw7rqqquslJQUKzMz05oyZYpVW1sbvqJPYfbs2Vbnzp2txMREq1+/ftbatWvDXdJpefvt\
t5v8dzF69GjLsgJbwdx7771WTk6OlZSUZA0dOtQqKysLb9EncaL/Vp555hn7nCNHjli//vWvrYyM\
DCs1NdX68Y9/HPILVSS55ZZbrC5duliJiYlWVlaWNXToUDv8WVZ0XQtwtjgsy7JasOEIAACAMGMV\
MAAAgGEIgAAAAIYhAAIAABiGAAgAAGAYAiAAAIBhCIAAAACGIQACAAAYhgAIAABgGAIgAACAYQiA\
AAAAhiEAAgAAGIYACAAAYBgCIAAAgGEIgAAAAIYhAAIAABiGAAgAAGAYAiAAAIBhCIAAAACGIQAC\
AAAYhgAIAABgGAIgAACAYQiAAAAAhiEAAgAAGIYACAAAYBgCIAAAgGEIgAAAAIYhAAIAABiGAAgA\
AGAYAiAAAIBhCIAAAACGIQACAAAY5v8Hf0/s1WeYjUQAAAAASUVORK5CYII=\
"
  frames[2] = "data:image/png;base64,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\
GxgYSJLMnj07SbJp06bs27cvS5cura5z9tlnZ+HChYcNwOHh4QwPD1efDw4OjnmGV8Zfksw+77wM\
nXlmkv+4QEQEAlAKHwEzrg4cOJDrr78+7373u/O2t70tSdLX15fGxsacdNJJI9adO3du+vr6Dvle\
q1evTktLS/WxYMGCMc3w6vjr7OzMHXfccchbxADAZCcAGVcrVqzIU089lQcffPANv9eqVasyMDBQ\
fWzfvv2IvzNa/B080nfwwpCDRCAApfARMOPm2muvzdq1a/P4449n/vz51eWtra3Zu3dvdu3aNeIo\
YH9/f1pbWw/5fk1NTWlqahrzv7+3t/eQ8XfQq+8TuGbNmpx55pluBg3ApOYIIMdcpVLJtddem0ce\
eSQ/+MEPsmjRohGvL1myJFOnTs369eury7Zu3Zpt27alvb39mM3R1taWZcuWJRk9/g565ZHAZcuW\
iT8AJj1XAXPMfeYzn8n999+fb3/72znrrLOqy1taWjJt2rQkyTXXXJPvfOc7ue+++9Lc3Jzrrrsu\
SfKjH/1ozP+esV5F19vbO6aoG+t6AG+Uq4CpNQHIMdfQ0DDq8nvvvTdXXXVVkpdvBH3jjTfmgQce\
yPDwcDo6OvKNb3zjsB8Bv5odKFCv7L+oNQFI3bIDBeqV/Re15hxAAIDCCEAAgMIIQACAwghAAIDC\
CEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghA\
AIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACA\
wghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMII\
QACAwghAAIDCCEAAgMIIQACAwghAAIDCCEAAgMIIQACAwghAAIDCCEDGxeOPP54PfvCDmTdvXhoa\
GvLoo4+OeL1SqeTWW2/N6aefnmnTpmXp0qX59a9/XZthAaAwApBxMTQ0lPPPPz933XXXqK/ffvvt\
+drXvpZ77rknTzzxRGbMmJGOjo7s2bNngicFgPKcUOsBmJwuvfTSXHrppaO+VqlU8tWvfjU333xz\
PvShDyVJ/vmf/zlz587No48+mr/8y7+cyFEBoDiOADLhnnnmmfT19WXp0qXVZS0tLbnwwguzcePG\
Gk4GAGVwBJAJ19fXlySZO3fuiOVz586tvjaa4eHhDA8PV58PDg6Oz4AAMMk5AkjdWL16dVpaWqqP\
BQsW1HqkCfEvW/8ll/z3S/IvW/+l1qMAMEkIQCZca2trkqS/v3/E8v7+/upro1m1alUGBgaqj+3b\
t4/rnMeLbz75zTw39Fy++eQ3az0KAJOEAGTCLVq0KK2trVm/fn112eDgYJ544om0t7cf8veamprS\
3Nw84lGCT577yZw+4/R88txP1noUACYJ5wAyLl566aX09vZWnz/zzDPZvHlzZs+enYULF+b666/P\
5z//+bz1rW/NokWLcsstt2TevHm5/PLLazf0ceovzvqL/MVZf1HrMQCYRAQg4+JnP/tZ3v/+91ef\
r1y5MkmyfPny3Hffffm7v/u7DA0N5dOf/nR27dqV97znPfne976XE088sVYjA0AxGiqVSqXWQ8DR\
GBwcTEtLSwYGBor5OBiYHOy/qDXnAAIAFEYAAgAURgACABRGAAIAFEYAQp165W12jsV6AJRDAEId\
6u7uTldXV3p6eg67Xk9PT7q6utLd3T1BkwFQDwQg1Jne3t6sXbs2SbJmzZpDRmBPT0/WrFmTJFm7\
dq0jgQBUCUCoM21tbens7Kw+Hy0CXxl/SdLZ2Zm2trYJmxEmE6dbMBkJQKhDHR0dh4zA0eKvo6Nj\
wmeEycDpFkxWvgoO6tTBqDsYewcjcGhoqLqO+IOj9+rTLZKM+t/Tq0+3OOeccxxx57jnCCDUsVce\
CXz4fz6c+/6f+/Lw/3w4ifiDN8rpFkxmvguYuuW7NP/DWZeflZ0DO6vPpzRNyQvfe6GGE8HkcajT\
Kt7I6Rb2X9Saj4ChzvX09IyIvyQ5MHwgPT09jgDCMXCo0y02fvv/rq7zX7/xf/jvjbriI2CoYweP\
QJzcdHKSl4/8JUlDGg57ixjg9Xn1hVebH1tX/edz57eKP+qOAIQ69cqPn5a+eWkeuOmBvPC9F/LA\
TQ/kyv90ZZLD3ycQeH06OjoyY8aMJMkfBgeTJI0nvClntc6p5VhwVAQg1KHDnXt0uFvEAEfvlVfZ\
T/v/z9vb+8f92dq383C/Bscl5wBCnent7T3iieejnbN05plnujoRjtKr/9L19vf/6YhbLjnnlnrj\
CCDUmba2tixbtizJ4a86fOWRwGXLlok/OEqjHXG/4447HGmnrrkNDHWr9Nso9Pb2jinqxroe8FpH\
utXL0d4KpvT9F7XnCCDUqbFGnfiDozPW0y1efSTQdwJTDwQgAIzC6RZMZj4Cpm75CAWYCONxuoX9\
F7XmCCAAHIbTLZiMBCAAQGEEIABAYQQgAEBhBCAAQGEEIABAYQQgAEBhBCAAQGEEIABAYQQgAEBh\
BCAAQGEEIABAYQQgAEBhBCAAQGEEIABAYQQgAEBhBCAAQGEEIABAYQQgAEBhBCAAQGEEIABAYQQg\
AEBhBCAAQGEEIABAYQQgAEBhBCA1ddddd+Utb3lLTjzxxFx44YX5yU9+UuuRAGDSE4DUzEMPPZSV\
K1fmtttuy89//vOcf/756ejoyPPPP1/r0QBgUhOA1Mwdd9yRT33qU/n4xz+exYsX55577sn06dPz\
T//0T7UeDQAmNQFITezduzebNm3K0qVLq8umTJmSpUuXZuPGjaP+zvDwcAYHB0c8AIDXTwBSEy+8\
8EL279+fuXPnjlg+d+7c9PX1jfo7q1evTktLS/WxYMGCiRgVACYdAUjdWLVqVQYGBqqP7du313ok\
AKhLJ9R6AMp06qmn5k1velP6+/tHLO/v709ra+uov9PU1JSmpqaJGA8AJjVHAKmJxsbGLFmyJOvX\
r68uO3DgQNavX5/29vYaTgYAk58jgNTMypUrs3z58rzjHe/IBRdckK9+9asZGhrKxz/+8VqPBgCT\
mgCkZj7ykY9k586dufXWW9PX15e3v/3t+d73vveaC0MAgGOroVKpVGo9BByNwcHBtLS0ZGBgIM3N\
zbUeB2DM7L+oNecAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYA\
AgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIA\
FEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRG\
AAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgACABRGAAIAFEYAAgAURgAC\
ABRGAAIAFEYAAgAURgByzH3hC1/Iu971rkyfPj0nnXTSqOts27Ytl112WaZPn57TTjstn/3sZ/PH\
P/5xYgcFgEKdUOsBmHz27t2bD3/4w2lvb88//uM/vub1/fv357LLLktra2t+9KMf5bnnnsvHPvax\
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\
fPLJlW9+85uTehspjyOAUEc2btyYc889N3Pnzq0u6+joyODgYPUIxfFs79692bRpU5YuXVpdNmXK\
lCxdujQbN26s4WTj55lnnklfX9+IbW5pacmFF15Y19s8MDCQJJk9e3aSZNOmTdm3b9+I7Tz77LOz\
cOHCut3O/fv358EHH8zQ0FDa29sn5TZSrhNqPQAwdn19fSPiL0n1eV9fXy1Gel1eeOGF7N+/f9Rt\
2LJlS42mGl8H/1xG2+Z6+DMbzYEDB3L99dfn3e9+d972trcleXk7GxsbX3Puaj1u55NPPpn29vbs\
2bMnM2fOzCOPPJLFixdn8+bNk2YbwRFAGGc33XRTGhoaDvuYrPHD5LRixYo89dRTefDBB2s9yrg4\
66yzsnnz5jzxxBO55pprsnz58vzyl7+s9VhwTDkCCOPsxhtvzFVXXXXYdc4444wxvVdra+trrpg9\
eAVia2vrUc03kU499dS86U1ves1Vk/39/XUx/9E4uF39/f05/fTTq8v7+/vz9re/vUZTHb1rr702\
a9euzeOPP5758+dXl7e2tmbv3r3ZtWvXiCNk9fhn29jYmLa2tiTJkiVL8tOf/jR33nlnPvKRj0ya\
bQRHAGGczZkzJ2efffZhH42NjWN6r/b29jz55JMjrphdt25dmpubs3jx4vHahGOmsbExS5Ysyfr1\
66vLDhw4kPXr16e9vb2Gk42fRYsWpbW1dcQ2Dw4O5oknnqirba5UKrn22mvzyCOP5Ac/+EEWLVo0\
4vUlS5Zk6tSpI7Zz69at2bZtW11t52gOHDiQ4eHhSb2NlMcRQDiObNu2LS+++GK2bduW/fv3Z/Pm\
zUmStra2zJw5M5dcckkWL16cj370o7n99tvT19eXm2++OStWrEhTU1Nthx+jlStXZvny5XnHO96R\
Cy64IF/96lczNDSUj3/847Ue7ai99NJL6e3trT5/5plnsnnz5syePTsLFy7M9ddfn89//vN561vf\
mkWLFuWWW27JvHnzcvnll9du6NdpxYoVuf/++/Ptb387s2bNqp7z1tLSkmnTpqWlpSVXX311Vq5c\
mdmzZ6e5uTnXXXdd2tvbc9FFF9V4+rFbtWpVLr300ixcuDC7d+/O/fffnx/+8Ifp6emZNNsISdwG\
Bo4ny5cvryR5zeOxxx6rrvOb3/ymcumll1amTZtWOfXUUys33nhjZd++fbUb+ih8/etfryxcuLDS\
2NhYueCCCyo//vGPaz3SG/LYY4+N+ue2fPnySqXy8q1gbrnllsrcuXMrTU1NlQ984AOVrVu31nbo\
12m07UtSuffee6vr/OEPf6h85jOfqZx88smV6dOnV/78z/+88txzz9Vu6KPwiU98ovLmN7+50tjY\
WJkzZ07lAx/4QOX73/9+9fXJsI1QqVQqDZVKpTLx2QkAQK04BxAAoDACEACgMAIQAKAwAhAAoDAC\
EACgMAIQAKAwAhAAoDACEACgMAIQAKAwAhAAoDACEACgMAIQAKAwAhAAoDACEACgMAIQAKAwAhAA\
oDACEACgMAIQAKAwAhAAoDACEACgMAIQAKAwAhAAoDACEACgMAIQAKAwAhAAoDACEACgMAIQAKAw\
AhAAoDACEACgMAIQAKAwAhAAoDD/H6VSUzkOMDChAAAAAElFTkSuQmCC\
"
  frames[3] = "data:image/png;base64,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\
csklcd5550Vvb++A7b29vZHNZj+y//Lly6Ovr6/y2LVr11iNCgDjjgCkKurr6yOXy8WmTZsq2/r7\
+2PTpk3R1tb2kf0bGhqisbFxwAMAODPOAaRqOjs7o729PT796U9Ha2trPPHEE3HgwIG48847qz0a\
AIxrApCq+fKXvxx79+6NFStWRKFQiJaWlvjhD3/4kQtDAICRVVcul8vVHgJOV7FYjEwmE319fX4c\
DNQkn2NUk3MAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQAS\
IwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMA\
AQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEA\
EiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIj\
AAEAEiMAAQASIwABABIjABlxjz76aHz2s5+NyZMnx7Rp0wbdZ+fOnXHDDTfE5MmTY+bMmfH1r389\
Pvzww7EdFAASdX61B2D8OXToUNx2223R1tYW//zP//yR148cORI33HBDZLPZ+MlPfhLvv/9+3H77\
7TFx4sT4+7//+ypMDABpqSuXy+VqD8H49Mwzz8SyZcti3759A7a//PLL8ad/+qexe/fuaGpqioiI\
NWvWxN/+7d/G3r17o76+/pTvXSwWI5PJRF9fXzQ2No7G+ACjyucY1eRHwIy5rq6u+NSnPlWJv4iI\
xYsXR7FYjHfeeaeKkwFAGvwImDFXKBQGxF9EVJ4XCoVBf02pVIpSqVR5XiwWR29AABjnrAAyLA8+\
+GDU1dUN+di2bduo/f4rV66MTCZTeTQ3N4/a7wUA450VQIblgQceiDvuuGPIfS6//PJhvVc2m43u\
7u4B23p7eyuvDWb58uXR2dlZeV4sFkUgAJwhAciwzJgxI2bMmDEi79XW1haPPvpo7NmzJ2bOnBkR\
ERs3bozGxsaYP3/+oL+moaEhGhoaRuT3B4DUCUBG3M6dO+ODDz6InTt3xpEjRyKfz0dExLx582LK\
lCmxaNGimD9/fnz1q1+NVatWRaFQiIceeig6OjpEHgCMAbeBYcTdcccd8eyzz35k++bNm+Paa6+N\
iIj/+q//invuuSdeffXVuPDCC6O9vT0ee+yxOP/84f2dxO0TgFrnc4xqEoDUJB+cQK3zOUY1uQoY\
ACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAg\
MQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDEC\
EAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAA\
IDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAx\
AhAAIDECkBH1y1/+MpYuXRpz586NSZMmxR/+4R/GI488EocOHRqw33/8x3/EH//xH8cFF1wQzc3N\
sWrVqipNDADpOb/aAzC+bNu2Lfr7++Mf//EfY968efH222/HXXfdFQcOHIhvfetbERFRLBZj0aJF\
sXDhwlizZk289dZb8bWvfS2mTZsWd999d5WPAADGv7pyuVyu9hCMb48//nisXr06/vM//zMiIlav\
Xh3f+MY3olAoRH19fUREPPjgg7F+/frYtm3bsN6zWCxGJpOJvr6+aGxsHLXZAUaLzzGqyY+AGXV9\
fX0xffr0yvOurq74/Oc/X4m/iIjFixfH9u3b4ze/+U01RgSApAhARtWOHTviu9/9bvzVX/1VZVuh\
UIimpqYB+x17XigUBn2fUqkUxWJxwAMAODMCkGF58MEHo66ubsjHiT++fe+99+JP/uRP4rbbbou7\
7rrrrH7/lStXRiaTqTyam5vP6v0AIGXOAWRY9u7dG//93/895D6XX3555ce6u3fvjmuvvTauueaa\
eOaZZ2LChN//XeP222+PYrEY69evr2zbvHlzXH/99fHBBx/ERRdd9JH3LpVKUSqVKs+LxWI0Nzc7\
dwaoWc4BpJpcBcywzJgxI2bMmDGsfd9777247rrrIpfLxdNPPz0g/iIi2tra4hvf+EYcPnw4Jk6c\
GBERGzdujCuuuGLQ+IuIaGhoiIaGhrM7CAAgIvwImBH23nvvxbXXXhtz5syJb33rW7F3794oFAoD\
zu37i7/4i6ivr4+lS5fGO++8Ey+88EI8+eST0dnZWcXJASAdVgAZURs3bowdO3bEjh07Yvbs2QNe\
O3a2QSaTiR/96EfR0dERuVwuLrnkklixYoV7AALAGHEOIDXJuTNArfM5RjX5ETAAQGIEIABAYgQg\
AEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABA\
YgQgAEBiBCAAQGIEIABAYgQgAEBiBCAAQGIEIABAYgQgAJyGQqEwovtBNQhAABimnp6e2LBhQ+Tz\
+SH3y+fzsWHDhujp6RmbweA0CUAAGIZCoVAJuu7u7pNGYD6fj+7u7og4GoxWAjkXCUAAGIZsNhut\
ra2V54NF4PHxFxHR2toa2Wx2rEaEYROAADBMLS0tJ43AweKvpaVljCeE4Tm/2gMAQC05FnXHYq+7\
uzvefPPNKJVKlX3EH+c6AQgAp+n4CNz8f7dVtl/3l1eKP2qCHwEDwBloaWmJhoaGAdsaGhrEHzVB\
AALAGcjn8wN+7BsRUSqVTnmLGDgX+BEwAJym4y/4uO4vr4yGhoZKDB7bbiWQc5kVQAA4DYNd7dve\
3n7KW8TAuUQAAsAwDXWrl6FuEQPnGgEIAMNQKBROeZ+/wSLQN4FwLhKAADAM2Ww2crlcRAx9n7/j\
IzCXy/kmEM5JLgIBgGHK5XJx2WWXnTLqWlpaIpvNij/OWVYAAeA0DDfqxB/nMgEIAJAYAQgAkBgB\
CACQGAEIAJAYAQgAkBgBCACQGAEIAJAYN4KmJpXL5YiIKBaLVZ4E4Mwc+/w69nkGY0kAUpP2798f\
ERHNzc1VngTg7Ozfvz8ymUy1xyAxdWV/9aAG9ff3x+7du2Pq1KlRV1dX7XFGVLFYjObm5ti1a1c0\
NjZWe5xR4zjHF8d5+srlcuzfvz9mzZoVEyY4I4uxZQWQmjRhwoSYPXt2tccYVY2NjeP6f6THOM7x\
xXGeHit/VIu/cgAAJEYAAgAkRgDCOaahoSEeeeSRaGhoqPYoo8pxji+OE2qLi0AAABJjBRAAIDEC\
EAAgMQIQACAxAhAAIDECEM4hjz76aHz2s5+NyZMnx7Rp0wbdZ+fOnXHDDTfE5MmTY+bMmfH1r389\
Pvzww7Ed9Cw99dRT8bGPfSwuuOCCuPrqq6O7u7vaI5211157Lb70pS/FrFmzoq6uLtavXz/g9XK5\
HCtWrIhLL700Jk2aFAsXLoxf/OIX1Rn2DK1cuTI+85nPxNSpU2PmzJlx0003xfbt2wfsc/Dgwejo\
6IiLL744pkyZErfcckv09vZWaeIzs3r16rjqqqsqN3tua2uLl19+ufL6eDhGEIBwDjl06FDcdttt\
cc899wz6+pEjR+KGG26IQ4cOxU9+8pN49tln45lnnokVK1aM8aRn7oUXXojOzs545JFH4qc//Wks\
WLAgFi9eHHv27Kn2aGflwIEDsWDBgnjqqacGfX3VqlXxne98J9asWRNbt26NCy+8MBYvXhwHDx4c\
40nP3JYtW6KjoyNef/312LhxYxw+fDgWLVoUBw4cqOxz//33x0svvRQvvvhibNmyJXbv3h0333xz\
Fac+fbNnz47HHnssenp64o033ojrr78+brzxxnjnnXciYnwcI0QZOOc8/fTT5Uwm85Ht//Zv/1ae\
MGFCuVAoVLatXr263NjYWC6VSmM44ZlrbW0td3R0VJ4fOXKkPGvWrPLKlSurONXIiojyunXrKs/7\
+/vL2Wy2/Pjjj1e27du3r9zQ0FB+7rnnqjDhyNizZ085Ispbtmwpl8tHj2nixInlF198sbLPz3/+\
83JElLu6uqo15oi46KKLyv/0T/80ro+RtFgBhBrS1dUVn/rUp6KpqamybfHixVEsFiurE+eyQ4cO\
RU9PTyxcuLCybcKECbFw4cLo6uqq4mSj6913341CoTDguDOZTFx99dU1fdx9fX0RETF9+vSIiOjp\
6YnDhw8POM4rr7wy5syZU7PHeeTIkXj++efjwIED0dbWNi6PkTSdX+0BgOErFAoD4i8iKs8LhUI1\
Rjotv/71r+PIkSODHsO2bduqNNXoO/ZnM9hx18Kf22D6+/tj2bJl8bnPfS4++clPRsTR46yvr//I\
+au1eJxvvfVWtLW1xcGDB2PKlCmxbt26mD9/fuTz+XFzjKTNCiCMsgcffDDq6uqGfIzn+GF86ujo\
iLfffjuef/75ao8yKq644orI5/OxdevWuOeee6K9vT1+9rOfVXssGDFWAGGUPfDAA3HHHXcMuc/l\
l18+rPfKZrMfuWL22NWH2Wz2jOYbS5dcckmcd955H7lisre3tybmP1PHjq23tzcuvfTSyvbe3t5o\
aWmp0lRn7t57740f/OAH8dprr8Xs2bMr27PZbBw6dCj27ds3YIWsFv986+vrY968eRERkcvl4t//\
/d/jySefjC9/+cvj5hhJmxVAGGUzZsyIK6+8cshHfX39sN6rra0t3nrrrQFXzG7cuDEaGxtj/vz5\
o3UII6a+vj5yuVxs2rSpsq2/vz82bdoUbW1tVZxsdM2dOzey2eyA4y4Wi7F169aaOu5yuRz33ntv\
rFu3Ln784x/H3LlzB7yey+Vi4sSJA45z+/btsXPnzpo6zsH09/dHqVQa18dIWqwAwjlk586d8cEH\
H8TOnTvjyJEjkc/nIyJi3rx5MWXKlFi0aFHMnz8/vvrVr8aqVauiUCjEQw89FB0dHdHQ0FDd4Yep\
s7Mz2tvb49Of/nS0trbGE088EQcOHIg777yz2qOdld/+9rexY8eOyvN333038vl8TJ8+PebMmRPL\
li2Lb37zm/Hxj3885s6dGw8//HDMmjUrbrrppuoNfZo6Ojpi7dq18f3vfz+mTp1aOectk8nEpEmT\
IpPJxNKlS6OzszOmT58ejY2Ncd9990VbW1tcc801VZ5++JYvXx5LliyJOXPmxP79+2Pt2rXx6quv\
xiuvvDJujhHcBgbOIe3t7eWI+Mhj8+bNlX1++ctflpcsWVKeNGlS+ZJLLik/8MAD5cOHD1dv6DPw\
3e9+tzxnzpxyfX19ubW1tfz6669Xe6Sztnnz5kH/7Nrb28vl8tFbwTz88MPlpqamckNDQ/kLX/hC\
efv27dUd+jQNdnwRUX766acr+/zud78r//Vf/3X5oosuKk+ePLn8Z3/2Z+X333+/ekOfga997Wvl\
P/iDPyjX19eXZ8yYUf7CF75Q/tGPflR5fTwcI9SVy+Xy2GcnAADV4hxAAIDECEAAgMQIQACAxAhA\
AIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACA\
xAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQIQACAxAhAAIDECEAAgMQI\
QACAxAhAAIDECEAAgMQIQACAxAhAAIDE/H9y3pGjpRPbhwAAAABJRU5ErkJggg==\
"
  frames[4] = "data:image/png;base64,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\
7Tvjnz9c/J14/uE+HSwCAUiFAGTMlUqluO+++2LTpk3xk5/8JObPnz/k8cWLF8eUKVNi69at5W0d\
HR2xd+/eaG1tHfY5GxoaIpvNDrmNpK+v77Txd8JwEeibQABIgXMAGXNtbW2xcePG+OEPfxjTp08v\
r6zlcrmYOnVq5HK5WLlyZaxevTpmzpwZ2Ww27r///mhtbR3VJ4BHI5PJRFNTU3R3d494qZeTLxbd\
1NTkm0AASILLwDDm6urqht3+7LPPxl133RURH1wI+sEHH4wf/OAH0d/fH8uWLYvvfe97o/4wxmgv\
n9DX1zeqqBvtfgBjxWVgqCQBSFXywglUO69jVJJzAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwAB\
ABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQAS\
IwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMA\
AQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEA\
EiMAAQASIwABABIjAAEAEiMAAQASIwABABIjAAEAEiMAAQASIwAZc6+//np86Utfiubm5qirq4vN\
mzcPebxUKsXatWujqakppk6dGkuWLIlf/epXlRkWABIkABlzhw8fjkWLFsUzzzwz7ONPPPFEfOc7\
34kNGzbEjh074uKLL45ly5bFkSNHJnhSAEjT5EoPQO1Zvnx5LF++fNjHSqVSPPXUU/Hwww/HTTfd\
FBER//RP/xSNjY2xefPm+LM/+7OJHBUAkmQFkAn13nvvRaFQiCVLlpS35XK5uPbaa6O9vb2CkwFA\
OqwAMqEKhUJERDQ2Ng7Z3tjYWH5sOP39/dHf31++XywWx2dAAEiAFUCqwrp16yKXy5VvLS0tlR4J\
AKqWAGRC5fP5iIjo6ekZsr2np6f82HDWrFkTvb295du+ffvGdU4AqGUCkAk1f/78yOfzsXXr1vK2\
YrEYO3bsiNbW1tP+voaGhshms0NuAMC5cQ4gY66vry/27NlTvv/ee+/Frl27YubMmTFv3rxYtWpV\
fOMb34iPfexjMX/+/HjkkUeiubk5br755soNDQAJEYCMubfeeis+//nPl++vXr06IiJWrFgRzz33\
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\
/wM/8peVg/PuJwAAAABJRU5ErkJggg==\
"


    /* set a timeout to make sure all the above elements are created before
       the object is initialized. */
    setTimeout(function() {
        animbf18fa8feeef42df9ff1917d1946c4bf = new Animation(frames, img_id, slider_id, 500.0,
                                 loop_select_id);
    }, 0);
  })()
</script>
</div>
</div>
</section>
<section id="running-the-algorithm-on-the-gpu" class="level2">
<h2 class="anchored" data-anchor-id="running-the-algorithm-on-the-gpu">Running the Algorithm on the GPU</h2>
<p>Instead of updating one data point at a time:</p>
<div class="sourceCode" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> one_update(X):</span>
<span id="cb90-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(X):</span>
<span id="cb90-3">        dist <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.sqrt(((x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb90-4">        weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gaussian(dist, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb90-5">        X[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (weight[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>weight.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span></code></pre></div>
<p>What if we updates one batch at a time on the GPU?</p>
<div id="cell-101" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4e4708eb-f6ad-4c71-9a8b-dc5ec04ab5b7" data-execution_count="74">
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1">bs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb91-2">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb91-3">x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X[:bs]</span>
<span id="cb91-4">x.shape,X.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>(torch.Size([5, 2]), torch.Size([1500, 2]))</code></pre>
</div>
</div>
<p>To calculate the distance between the two, we have to first subtract them. To do this subtraction, the current dimensions won’t work (as 1500 is not compatible with 5):</p>
<div id="cell-103" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:141}}" data-outputid="50d7fd6a-10a3-4dba-bd94-73a600ac094a" data-execution_count="75">
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1">x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X</span></code></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">RuntimeError</span>                              Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-75-d3d3295c0dec&gt;</span> in <span class="ansi-cyan-fg">&lt;cell line: 0&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>x<span class="ansi-blue-fg">-</span>X

<span class="ansi-red-fg">RuntimeError</span>: The size of tensor a (5) must match the size of tensor b (1500) at non-singleton dimension 0</pre>
</div>
</div>
</div>
<p>Let’s think about what we are trying to do here. We want to subtract from each point in the batch <code>x</code> every point in the full set <code>X</code>. So each pair of 1500 coordinates need to be subtracted from each pair of 5 coordinates.</p>
<p>I find it easier to start with “just making the dimensions work” for broadcasting.</p>
<div id="cell-106" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ebd280c5-981b-49d5-b4b1-465cf4cb2c59" data-execution_count="76">
<div class="sourceCode cell-code" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1">x[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>].shape, X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>(torch.Size([1, 5, 2]), torch.Size([1500, 1, 2]))</code></pre>
</div>
</div>
<p>Going right to left: the last dimension matches (2), 1 is compatible with 5 and 1 is compatible with 1500. We can subtract these two tensors.</p>
<div id="cell-108" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b6a5c8c5-dd00-4747-c663-f38bc965afc1" data-execution_count="77">
<div class="sourceCode cell-code" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1">(x[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>torch.Size([1500, 5, 2])</code></pre>
</div>
</div>
<p>The result is 1500 sets of 5 coordinate pairs. The 5 coordinate pairs are the difference between the coordinates in batch <code>x</code> and a coordinate in <code>X</code>.</p>
<p>Checking this manually, let’s take the first point in <code>x</code>.</p>
<div id="cell-111" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d5f5ddfb-e497-4742-c175-ebf6db35494a" data-execution_count="78">
<div class="sourceCode cell-code" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1">x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>torch.Size([2])</code></pre>
</div>
</div>
<p>The dimension of 2 is compatible with the last dimension of <code>X</code> so we can subtract these shapes directly.</p>
<div id="cell-113" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a293bd2c-da84-4dbe-868c-f2a776042d98" data-execution_count="79">
<div class="sourceCode cell-code" id="cb100" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1">(x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>torch.Size([1500, 2])</code></pre>
</div>
</div>
<p>This difference is equal to the first item of the batch in the broadcasted version.</p>
<div id="cell-115" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2effa53b-6762-4b72-9419-c7105cf63f07" data-execution_count="81">
<div class="sourceCode cell-code" id="cb102" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1">((x[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> X) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> (x[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>])[:,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>tensor(1.)</code></pre>
</div>
</div>
<p>With that under my belt, I’ll now visualize the broadcasting operation to better understand why the dimensions “just work”.</p>
<p>Adding the unit axis to <code>x</code> (our batch of 5 coordinates) as the first dimension is not as intuitive visually as it just adds a pair of brackets to the outside of the 5 coordinates. However, what this does is allow the set of 5 coordinates (as a group) to be broadcasted across another dimension of any size.</p>
<div id="cell-118" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="892f60a0-7101-4652-94b9-267b74ed5f4e" data-execution_count="82">
<div class="sourceCode cell-code" id="cb104" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1">x</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>tensor([[29.764, 26.161],
        [28.472, 30.493],
        [27.549, 23.130],
        [23.500, 26.879],
        [27.327, 28.650]])</code></pre>
</div>
</div>
<div id="cell-119" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ac571ee7-26d4-40e7-b3a8-08e0e5df58b3" data-execution_count="83">
<div class="sourceCode cell-code" id="cb106" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1">x[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>tensor([[[29.764, 26.161],
         [28.472, 30.493],
         [27.549, 23.130],
         [23.500, 26.879],
         [27.327, 28.650]]])</code></pre>
</div>
</div>
<p>Adding the unit axis as the second dimension to <code>X</code> (our full set of 1500 coordinates) is more visually intuitive—we’ve added a pair of brackets around each pair of coordinates, making them broadcastable to any other dimension.</p>
<div id="cell-121" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c12a9c8b-b0ff-41a4-9fde-23d5d1f6a456" data-execution_count="84">
<div class="sourceCode cell-code" id="cb108" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1">X</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>tensor([[29.764, 26.161],
        [28.472, 30.493],
        [27.549, 23.130],
        ...,
        [32.214,  4.997],
        [30.872,  4.339],
        [28.347,  4.248]])</code></pre>
</div>
</div>
<div id="cell-122" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e7b438ba-fae5-44fb-91bd-8cb7b9df97af" data-execution_count="86">
<div class="sourceCode cell-code" id="cb110" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1">X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>tensor([[[29.764, 26.161]],

        [[28.472, 30.493]],

        [[27.549, 23.130]],

        ...,

        [[32.214,  4.997]],

        [[30.872,  4.339]],

        [[28.347,  4.248]]])</code></pre>
</div>
</div>
<p>So our batch of 5 coordinates <code>x</code> can now be broadcasted as many times as needed, and each pair of coordinates in <code>X</code> can also be broadcasted as many times as needed.</p>
<p>The result: each pair of coordinates in <code>X</code> is broadcasted 5 times so they can be subtracted from each pair of coordinates in the batch. And the batch is broadcasted 1500 times so that each pair of coordinates in <code>X</code> can be subtracted from it.</p>
<p>Looking at each of those statements visually:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Each pair of coordinates in X is broadcasted 5 times so they can be subtracted from each pair of coordinates in the batch"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/2.png" class="img-fluid figure-img" alt="Each pair of coordinates in X is broadcasted 5 times so they can be subtracted from each pair of coordinates in the batch"></a></p>
<figcaption>Each pair of coordinates in X is broadcasted 5 times so they can be subtracted from each pair of coordinates in the batch</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="The batch x is broadcasted 1500 times so that each pair of coordinates in X can be subtracted from it."><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/3.png" class="img-fluid figure-img" alt="The batch x is broadcasted 1500 times so that each pair of coordinates in X can be subtracted from it."></a></p>
<figcaption>The batch <code>x</code> is broadcasted 1500 times so that each pair of coordinates in <code>X</code> can be subtracted from it.</figcaption>
</figure>
</div>
<p>With the understood, I can now continue with the batched implementation of the algorithm. With the correct shapes, thanks to adding unit axes, we can create a batched distance function:</p>
<div id="cell-128" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb112" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> dist_b(a,b): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> (((a[<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>b[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>])<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)).sqrt()</span></code></pre></div>
</div>
<div id="cell-129" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ce2e61e4-4895-472b-d120-d0844f6fbe51" data-execution_count="90">
<div class="sourceCode cell-code" id="cb113" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1">dist_b(x,X).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>torch.Size([1500, 5])</code></pre>
</div>
</div>
<p>We now have 5 distances for each of the 1500 items in the dataset.</p>
<div id="cell-131" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="46dc7bba-8d45-40f6-c502-90d9438dba39" data-execution_count="91">
<div class="sourceCode cell-code" id="cb115" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1">dist_b(x,X)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>tensor([[ 0.000,  4.521,  3.754,  6.305,  3.483],
        [ 4.521,  0.000,  7.421,  6.148,  2.170],
        [ 3.754,  7.421,  0.000,  5.518,  5.524],
        ...,
        [21.305, 25.769, 18.724, 23.553, 24.152],
        [21.850, 26.264, 19.083, 23.714, 24.568],
        [21.958, 26.246, 18.899, 23.144, 24.423]])</code></pre>
</div>
</div>
<p>The first row are the distances between the first coordinate pair in <code>X</code> and each of the coordinate pairs in the batch. The second row contains distances between the <em>second</em> coordinate pair in `X and each of the batch coordinate pairs. And so on an so forth for 1500 rows. Each with 5 distances representing the distances to the batch items.</p>
<p>We pass this tensor into our <code>gaussian</code> and get back our weights.</p>
<div id="cell-134" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="97cadee8-dfa3-4e93-cace-bc52cf9d31bc" data-execution_count="92">
<div class="sourceCode cell-code" id="cb117" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1">weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gaussian(dist_b(x, X), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb117-2">weight, weight.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>(tensor([[    0.160,     0.031,     0.052,     0.007,     0.060],
         [    0.031,     0.160,     0.002,     0.008,     0.109],
         [    0.052,     0.002,     0.160,     0.014,     0.014],
         ...,
         [    0.000,     0.000,     0.000,     0.000,     0.000],
         [    0.000,     0.000,     0.000,     0.000,     0.000],
         [    0.000,     0.000,     0.000,     0.000,     0.000]]),
 torch.Size([1500, 5]))</code></pre>
</div>
</div>
<div id="cell-135" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="09929ac2-c816-45e0-ea6c-fd4a2dff55d1" data-execution_count="93">
<div class="sourceCode cell-code" id="cb119" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1">weight[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>tensor([[0.160, 0.031, 0.052, 0.007, 0.060],
        [0.031, 0.160, 0.002, 0.008, 0.109],
        [0.052, 0.002, 0.160, 0.014, 0.014],
        [0.007, 0.008, 0.014, 0.160, 0.038],
        [0.060, 0.109, 0.014, 0.038, 0.160]])</code></pre>
</div>
</div>
<p>Looking at the first 5 rows of our weights we have a square matrix—the weights between the first 5 points (i.e.&nbsp;the points in our batch). From row 6 we have the weights from these 5 points to point 6.</p>
<p>Technically we could have a batch size of 1500 and the weights in full would be a square matrix.</p>
<p>Now for the fun part! Understanding broadcasting so we can perform the weighted average, which starts with an elementwise multiplication betwee the weights and the data points.</p>
<p>Conceptually we want something like this (example shown for the first two batch items’ weights)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9" title="Multiplying weights by X and summing down the columns to get a pair of coordinates"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/4.png" class="img-fluid figure-img" alt="Multiplying weights by X and summing down the columns to get a pair of coordinates"></a></p>
<figcaption>Multiplying weights by <code>X</code> and summing down the columns to get a pair of coordinates</figcaption>
</figure>
</div>
<div id="cell-141" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e2bc5d14-794d-431b-9fc9-36f9f77748ff" data-execution_count="94">
<div class="sourceCode cell-code" id="cb121" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1">weight.shape,X.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>(torch.Size([1500, 5]), torch.Size([1500, 2]))</code></pre>
</div>
</div>
<p>The last dimension of each tensor is not compatible (5 and 2). We need to introduce a unit axis so that we can broadcast the 5 batch items to each of the 1500 coordinate pairs.</p>
<p>We’ll again start by “just making the dimensions work”, adding a unit axis to the end of <code>weight</code> and the beginning of <code>X</code>. Scanning the dimensions left to right: 1 and 2 are compatible, 5 and 1 are compatible, 1500 and 1500 are compatible.</p>
<div id="cell-144" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="eb218202-3664-40fd-878b-e5edefae4afb" data-execution_count="96">
<div class="sourceCode cell-code" id="cb123" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1">weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>].shape, X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>(torch.Size([1500, 5, 1]), torch.Size([1500, 1, 2]))</code></pre>
</div>
</div>
<div id="cell-145" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="88879916-329f-4984-a4ea-b78bb04ae309" data-execution_count="98">
<div class="sourceCode cell-code" id="cb125" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1">(weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>torch.Size([1500, 5, 2])</code></pre>
</div>
</div>
<p>We’ll sum down the first dimension to get 5 pairs of coordinate.</p>
<div id="cell-147" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="799cde40-d374-42b5-90e3-71df21d6f19a" data-execution_count="100">
<div class="sourceCode cell-code" id="cb127" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1">(weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>tensor([[296.880, 291.612],
        [476.489, 514.066],
        [140.263, 134.432],
        [278.256, 307.251],
        [577.373, 615.003]])</code></pre>
</div>
</div>
<p>The first pair of coordinates <code>[296.880, 291.612]</code> are the sum of the first pair of elementwise products in each set of 5 batched items in each of the 1500 rows.</p>
<div id="cell-149" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="38638dce-e5bb-4d73-d797-f327004f65b2" data-execution_count="102">
<div class="sourceCode cell-code" id="cb129" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1">(weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>tensor([[[    4.750,     4.175],
         [    0.926,     0.814],
         [    1.539,     1.352],
         [    0.197,     0.174],
         [    1.799,     1.581]],

        [[    0.886,     0.948],
         [    4.544,     4.866],
         [    0.055,     0.059],
         [    0.221,     0.237],
         [    3.117,     3.338]],

        [[    1.424,     1.196],
         [    0.054,     0.045],
         [    4.396,     3.691],
         [    0.385,     0.323],
         [    0.383,     0.321]],

        ...,

        [[    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000]],

        [[    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000]],

        [[    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000],
         [    0.000,     0.000]]])</code></pre>
</div>
</div>
<div id="cell-150" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8b9975f5-7a26-4b50-c422-516c074f1457" data-execution_count="101">
<div class="sourceCode cell-code" id="cb131" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1">(weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>])[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>tensor([[    4.750,     4.175],
        [    0.886,     0.948],
        [    1.424,     1.196],
        ...,
        [    0.000,     0.000],
        [    0.000,     0.000],
        [    0.000,     0.000]])</code></pre>
</div>
</div>
<div id="cell-151" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e933a913-9612-43f7-b045-e1cdfa54246c" data-execution_count="103">
<div class="sourceCode cell-code" id="cb133" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1">(weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>])[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,:].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>tensor([296.880, 291.612])</code></pre>
</div>
</div>
<p>Looking at this visually:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Elementwise multiplication of weight[...,None] and X[None] followed by sum(0) down the columns"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/5.png" class="img-fluid figure-img" alt="Elementwise multiplication of weight[...,None] and X[None] followed by sum(0) down the columns"></a></p>
<figcaption>Elementwise multiplication of <code>weight[...,None]</code> and <code>X[None]</code> followed by <code>sum(0)</code> down the columns</figcaption>
</figure>
</div>
<div id="cell-154" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="24c589bb-5afd-4a22-b782-d02fda9014d0" data-execution_count="104">
<div class="sourceCode cell-code" id="cb135" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1">num <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (weight[...,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>X[:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb135-2">num.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>torch.Size([5, 2])</code></pre>
</div>
</div>
<div id="cell-155" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c2cd5385-3d97-4466-f358-1909a3052608" data-execution_count="105">
<div class="sourceCode cell-code" id="cb137" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1">num</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>tensor([[296.880, 291.612],
        [476.489, 514.066],
        [140.263, 134.432],
        [278.256, 307.251],
        [577.373, 615.003]])</code></pre>
</div>
</div>
<p>Since we are performing an elementwise multiplication follow by a sum, we can use Einstein Summation!</p>
<div id="cell-157" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="351261a0-1f6c-42c0-b9a3-59ba6a9d018b" data-execution_count="106">
<div class="sourceCode cell-code" id="cb139" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1">torch.einsum(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ij,ik-&gt;jk'</span>, weight, X)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>tensor([[296.880, 291.612],
        [476.489, 514.066],
        [140.263, 134.432],
        [278.256, 307.251],
        [577.373, 615.003]])</code></pre>
</div>
</div>
<p>Similary, we can also use matrix multiplication:</p>
<div id="cell-159" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6ac52bec-aa75-4dcf-e09a-b109ceb88075" data-execution_count="107">
<div class="sourceCode cell-code" id="cb141" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1">weight.T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>X</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>tensor([[296.880, 291.612],
        [476.489, 514.066],
        [140.263, 134.432],
        [278.256, 307.251],
        [577.373, 615.003]])</code></pre>
</div>
</div>
<p>To get our weighted average, we divide by the sum of weights.</p>
<div id="cell-161" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c26dfad0-c4fe-41b3-c3a6-90e2bd57224b" data-execution_count="108">
<div class="sourceCode cell-code" id="cb143" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1">div <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weight.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, keepdim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).T</span>
<span id="cb143-2">div.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>torch.Size([5, 1])</code></pre>
</div>
</div>
<p>We want to perform an elementwise division (each coordinate needs to be divided by the sum of weights) so we <code>keepdim</code>.</p>
<div id="cell-163" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2faf142c-34ee-4d90-9960-0e47b687e9f1" data-execution_count="109">
<div class="sourceCode cell-code" id="cb145" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb145-1">div</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>tensor([[10.558],
        [17.315],
        [ 5.167],
        [10.983],
        [21.347]])</code></pre>
</div>
</div>
<div id="cell-164" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ff53f7c2-c478-48b9-d730-25c8998caf58" data-execution_count="110">
<div class="sourceCode cell-code" id="cb147" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb147-1">num<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>div</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>tensor([[28.118, 27.619],
        [27.519, 29.689],
        [27.145, 26.016],
        [25.334, 27.974],
        [27.047, 28.810]])</code></pre>
</div>
</div>
<p>Wrapping this into a new <code>meanshift</code> function. Each step now performs batched calculations.</p>
<div id="cell-166" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb149" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> meanshift(data, bs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>):</span>
<span id="cb149-2">    n <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data)</span>
<span id="cb149-3">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb149-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> it <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb149-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n, bs):</span>
<span id="cb149-6">            s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">slice</span>(i, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span>(i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>bs,n))</span>
<span id="cb149-7">            weight <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gaussian(dist_b(X[s], X), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb149-8">            div <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weight.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, keepdim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>).T</span>
<span id="cb149-9">            X[s] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weight.T<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>X<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>div</span>
<span id="cb149-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> X</span></code></pre></div>
</div>
<p>We can now utilize the GPU (since we’re doing batched calculations)</p>
<div id="cell-168" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb150" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.cuda()</span></code></pre></div>
</div>
<div id="cell-169" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb151" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb151-1">X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> meanshift(data).cpu()</span></code></pre></div>
</div>
<div id="cell-170" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e3206486-deea-434b-f00b-1c99fa7dc777" data-execution_count="117">
<div class="sourceCode cell-code" id="cb152" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>meanshift(data, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1250</span>).cpu()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5.37 ms ± 43.1 µs per loop (mean ± std. dev. of 7 runs, 5 loops each)</code></pre>
</div>
</div>
<p>Using the GPU we cut the execution time from 1.5 seconds to 6 milliseconds to achieve the same result.</p>
<div id="cell-172" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="78b63bcb-5b59-428e-86a8-4ecb22c7b14c" data-execution_count="118">
<div class="sourceCode cell-code" id="cb154" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>250.0</code></pre>
</div>
</div>
<div id="cell-173" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:430}}" data-outputid="5e20a9d4-31f5-49c6-a56c-3789affd7708" data-execution_count="119">
<div class="sourceCode cell-code" id="cb156" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1">plot_data(centroids, X, n_samples)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-92-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/index_files/figure-html/cell-92-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
<p>If we perform the unbatched calculation using the GPU, we don’t see this speed up.</p>
<div id="cell-175" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb157" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> meanshift(data, n<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>):</span>
<span id="cb157-2">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> data.clone()</span>
<span id="cb157-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> it <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(n): one_update(X)</span>
<span id="cb157-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> X</span></code></pre></div>
</div>
<div id="cell-176" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b21cd686-b3e1-43ca-a8c3-7d419ab3633c" data-execution_count="122">
<div class="sourceCode cell-code" id="cb158" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>time X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> meanshift(data.cuda()).cpu()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 1.33 s, sys: 969 µs, total: 1.33 s
Wall time: 1.33 s</code></pre>
</div>
</div>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>Implementing mean shift clustering become an exercise in understanding broadcasting! The weighted average (elementwise multiplication followed by a summation down an axis) is well suited for broadcasting, Einstein Summation and matrix multiplication. Seeing the relationships between dimensions, and seeing how adding unit axes in a particular spot to allow for broadcasting gave me a deeper understanding of how tensor calculations work. We also saw a clear example of how the GPU only gives you a speedup if you perform batch operations on it.</p>
<p>I’m trying to grow my YouTube channel so if you’re interesting in this type of content, <a href="https://www.youtube.com/@vishal_learner">please subscribe!</a></p>


</section>

 ]]></description>
  <category>python</category>
  <category>machine learning</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-30-meanshift/</guid>
  <pubDate>Sat, 31 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Exploring Precision in ColBERT Indexing and Retrieval</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-25-Exploring-ColBERT-Precision/</link>
  <description><![CDATA[ 




<div id="16ca24cb-857d-4d7a-8b56-be00276ccd42" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Ensure faiss-gpu is correctly installed</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> faiss</span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(faiss, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StandardGpuResources"</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>True</code></pre>
</div>
</div>
<div id="0a58e29c-75e8-4ffe-b578-02c6d3dec2a1" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Show imports</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb3-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Queries</span>
<span id="cb3-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.infra <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Run, RunConfig, ColBERTConfig</span>
<span id="cb3-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Searcher</span>
<span id="cb3-7"></span>
<span id="cb3-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb3-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy</span>
<span id="cb3-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb3-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb3-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm</span>
<span id="cb3-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> glob</span>
<span id="cb3-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> re</span>
<span id="cb3-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pytrec_eval</span>
<span id="cb3-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span></code></pre></div>
</details>
</div>
<div id="91f7ad5d" class="cell">
<details class="code-fold">
<summary>Show indexing + memory profiling script</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> colbert</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Indexer, Searcher</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.infra <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Run, RunConfig, ColBERTConfig</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Queries, Collection</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb4-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> threading</span>
<span id="cb4-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb4-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> psutil</span>
<span id="cb4-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datetime <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb4-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb4-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb4-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb4-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> argparse </span>
<span id="cb4-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pynvml</span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> memory_monitor(stop_event, cpu_readings, gpu_readings):</span>
<span id="cb4-17">    pynvml.nvmlInit()</span>
<span id="cb4-18">    handle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pynvml.nvmlDeviceGetHandleByIndex(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-19">    </span>
<span id="cb4-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> stop_event.is_set():</span>
<span id="cb4-21">        mem_cpu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> psutil.Process().memory_info().rss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb4-22">        info <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pynvml.nvmlDeviceGetMemoryInfo(handle)</span>
<span id="cb4-23">        mem_gpu <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> info.used <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb4-24">        </span>
<span id="cb4-25">        cpu_readings.append((datetime.now(), mem_cpu))</span>
<span id="cb4-26">        gpu_readings.append((datetime.now(), mem_gpu))</span>
<span id="cb4-27">        time.sleep(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb4-28"></span>
<span id="cb4-29"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> log_memory(index_name, passages):</span>
<span id="cb4-30">    stop_event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> threading.Event()</span>
<span id="cb4-31">    cpu_readings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-32">    gpu_readings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb4-33">    monitor_thread <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> threading.Thread(target<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>memory_monitor, args<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(stop_event, cpu_readings, gpu_readings))</span>
<span id="cb4-34">    monitor_thread.start()</span>
<span id="cb4-35"></span>
<span id="cb4-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb4-37">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, rank<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)):</span>
<span id="cb4-38">            config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ColBERTConfig(</span>
<span id="cb4-39">                doc_maxlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">220</span>,</span>
<span id="cb4-40">                nbits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-41">                dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>,</span>
<span id="cb4-42">                kmeans_niters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-43">                index_bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb4-44">                bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,</span>
<span id="cb4-45">                checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>,</span>
<span id="cb4-46">                avoid_fork_if_possible<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb4-47">            )</span>
<span id="cb4-48">        </span>
<span id="cb4-49">            indexer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Indexer(checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>, config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config)</span>
<span id="cb4-50">            index_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> indexer.index(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index_name, collection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>], overwrite<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb4-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">finally</span>:</span>
<span id="cb4-52">        stop_event.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>()</span>
<span id="cb4-53">        monitor_thread.join()</span>
<span id="cb4-54">    </span>
<span id="cb4-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> cpu_readings, gpu_readings</span>
<span id="cb4-56"></span>
<span id="cb4-57"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main():</span>
<span id="cb4-58">    parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> argparse.ArgumentParser(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'fp'</span>)</span>
<span id="cb4-59">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--fp'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fp32"</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Floating point precision used'</span>)</span>
<span id="cb4-60">    args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parser.parse_args()</span>
<span id="cb4-61">    fp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> args.fp</span>
<span id="cb4-62">        </span>
<span id="cb4-63">    dataset_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ConditionalQA"</span></span>
<span id="cb4-64">    index_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'ColBERT_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb4-65">    passages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-corpus"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb4-66"></span>
<span id="cb4-67">    cpu_readings, gpu_readings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> log_memory(index_name, passages)</span>
<span id="cb4-68"></span>
<span id="cb4-69">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CPU RAM artifacts</span></span>
<span id="cb4-70">    start_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cpu_readings[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb4-71">    index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time).total_seconds() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t, _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cpu_readings]</span>
<span id="cb4-72">    cpu_readings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Series([mem <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _, mem <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> cpu_readings], index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mem_gb"</span> )</span>
<span id="cb4-73">    cpu_readings.index.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_secs"</span></span>
<span id="cb4-74">    cpu_readings.plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'ColBERT CPU RAM (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span>, xlabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (sec)'</span>, ylabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Memory (GB)'</span>)</span>
<span id="cb4-75">    plt.tight_layout()</span>
<span id="cb4-76">    plt.savefig(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'colbert_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_cpu_readings.png'</span>)</span>
<span id="cb4-77">    plt.close()</span>
<span id="cb4-78">    cpu_readings.to_csv(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"colbert_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_cpu_readings.csv"</span>)</span>
<span id="cb4-79"></span>
<span id="cb4-80">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GPU RAM artifacts</span></span>
<span id="cb4-81">    start_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpu_readings[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb4-82">    index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time).total_seconds() <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t, _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> gpu_readings]</span>
<span id="cb4-83">    gpu_readings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.Series([mem <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _, mem <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> gpu_readings], index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index, name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mem_gb"</span> )</span>
<span id="cb4-84">    gpu_readings.index.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time_secs"</span></span>
<span id="cb4-85">    gpu_readings.plot(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'ColBERT GPU RAM (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span>, xlabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Time (sec)'</span>, ylabel<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Memory (GB)'</span>)</span>
<span id="cb4-86">    plt.tight_layout()</span>
<span id="cb4-87">    plt.savefig(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'colbert_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_gpu_readings.png'</span>)</span>
<span id="cb4-88">    plt.close()</span>
<span id="cb4-89">    gpu_readings.to_csv(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"colbert_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>fp<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_gpu_readings.csv"</span>)</span>
<span id="cb4-90"></span>
<span id="cb4-91"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb4-92">    main()</span></code></pre></div>
</details>
</div>
<div id="7eded5f6" class="cell">
<details class="code-fold">
<summary>Show Recall calculation script</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Queries</span>
<span id="cb5-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.infra <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Run, RunConfig, ColBERTConfig</span>
<span id="cb5-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Searcher</span>
<span id="cb5-7"></span>
<span id="cb5-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb5-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy</span>
<span id="cb5-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb5-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb5-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tqdm</span>
<span id="cb5-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> glob</span>
<span id="cb5-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> re</span>
<span id="cb5-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pytrec_eval</span>
<span id="cb5-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> argparse </span>
<span id="cb5-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb5-18"></span>
<span id="cb5-19"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> get_qrels(qrels_rows):</span>
<span id="cb5-20">    qrels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb5-21">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qrel_row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> qrels_rows:</span>
<span id="cb5-22">        qid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]</span>
<span id="cb5-23">        pid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"corpus_id"</span>]</span>
<span id="cb5-24">        rel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>]</span>
<span id="cb5-25">        qrels.setdefault(qid, {})</span>
<span id="cb5-26">        qrels[qid][pid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rel</span>
<span id="cb5-27">    </span>
<span id="cb5-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> qrels</span>
<span id="cb5-29"></span>
<span id="cb5-30"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _recall(qrels, res):</span>
<span id="cb5-31">    evaluator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pytrec_eval.RelevanceEvaluator(qrels, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall.10'</span>})</span>
<span id="cb5-32">    metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> evaluator.evaluate(res)</span>
<span id="cb5-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(qrels_rows[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]))</span>
<span id="cb5-34"></span>
<span id="cb5-35">    mean_recall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(metrics[qid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall_10'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> metrics.keys()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics)</span>
<span id="cb5-36">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> mean_recall</span>
<span id="cb5-37"></span>
<span id="cb5-38"></span>
<span id="cb5-39">dataset_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ConditionalQA"</span></span>
<span id="cb5-40">queries <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-queries"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb5-41">passages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-corpus"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb5-42">qrels_rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-qrels"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb5-43">qrels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> get_qrels(qrels_rows)</span>
<span id="cb5-44"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(dataset_name)</span>
<span id="cb5-45"></span>
<span id="cb5-46">queries_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb5-47"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> item <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries: queries_dict[item[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> item[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>]</span>
<span id="cb5-48"></span>
<span id="cb5-49"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> main():</span>
<span id="cb5-50">    parser <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> argparse.ArgumentParser(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'index'</span>)</span>
<span id="cb5-51">    parser.add_argument(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'--index'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">type</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">help</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Index name'</span>)</span>
<span id="cb5-52">    args <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parser.parse_args()</span>
<span id="cb5-53">    index <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> args.index</span>
<span id="cb5-54">    </span>
<span id="cb5-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb5-56">        searcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Searcher(</span>
<span id="cb5-57">            index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index,</span>
<span id="cb5-58">            config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ColBERTConfig(</span>
<span id="cb5-59">                    ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb5-60">                    centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>,</span>
<span id="cb5-61">                    ndocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb5-62">                )</span>
<span id="cb5-63">        )</span>
<span id="cb5-64">    </span>
<span id="cb5-65">        _queries <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Queries(data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>queries_dict)</span>
<span id="cb5-66">        ranking <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> searcher.search_all(_queries, k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb5-67"></span>
<span id="cb5-68">    colbert_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb5-69"></span>
<span id="cb5-70">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> ranking.todict().keys():</span>
<span id="cb5-71">        colbert_scores <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ranking.todict()[qid]</span>
<span id="cb5-72">        colbert_results[qid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {passages[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]: score <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, _, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_scores}</span>
<span id="cb5-73"></span>
<span id="cb5-74">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"colbert_results_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>index<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_'</span>)[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.pkl"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'wb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>: pickle.dump(colbert_results, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>)</span>
<span id="cb5-75">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(_recall(qrels, colbert_results))</span>
<span id="cb5-76"></span>
<span id="cb5-77"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb5-78">    main()</span></code></pre></div>
</details>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I ran an experiment to explore the differences between FP32 full precision and mixed precision in ColBERT indexing and retrieval. This was purely a curiosity-driven exploration - not claiming this is best practice, just wanted to see if there were any differences. This notebook shares my findings. I use the <a href="https://huggingface.co/datasets/UKPLab/dapr/viewer/ConditionalQA-docs">UKPLab/DAPR ConditionalQA dataset</a> for this exercise.</p>
<p><strong>What I did:</strong></p>
<ul>
<li>Created <a href="https://github.com/vishalbakshi/ColBERT/commits/mixed_precision_false/">a fork of ColBERT</a> and turned off all mixed precision conversions</li>
<li>Used Claude and ChatGPT to help identify all the places that needed changes (including CUDA kernels)</li>
<li>Ran indexing experiments on the UKPLab’s ConditionalQA dataset (70k documents)</li>
<li>Tracked memory usage during indexing (see script above)</li>
<li>Compared recall performance and retrieved passages (see script above)</li>
<li>Analyzed the resulting index artifacts</li>
</ul>
<p><strong>Key findings:</strong></p>
<ul>
<li>Mixed precision took 2.5x longer to index (180s vs 70s) - wasn’t expecting that</li>
<li>Mixed precision used slightly more GPU memory, full precision used more CPU memory</li>
<li>Full precision gave a tiny 0.3% recall boost (basically negligible)</li>
<li>14% of retrieved passages were different between the two approaches</li>
<li>The centroids created during indexing were significantly different</li>
<li>Different mappings between passage IDs and centroids</li>
</ul>
<iframe width="560" height="315" src="https://www.youtube.com/embed/aiNQ4I8YaD0?si=OKvaUtumf7q1qGYf" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</section>
<section id="indexing-time" class="level2">
<h2 class="anchored" data-anchor-id="indexing-time">Indexing Time</h2>
<p>I was surprised to see that using mixed precision resulted in a much longer indexing time. I wonder if that would still hold over multiple iterations of indexing.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Indexing Time (seconds)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">fp32</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">amp</td>
<td style="text-align: center;">180</td>
</tr>
</tbody>
</table>
</section>
<section id="maximum-memory-usage" class="level2">
<h2 class="anchored" data-anchor-id="maximum-memory-usage">Maximum Memory Usage</h2>
<p>Another surprise—mixed precision actually uses <em>more</em> GPU memory than full precision.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Precision</th>
<th style="text-align: center;">Max GPU Mem (GB)</th>
<th style="text-align: center;">Max CPU Mem (GB)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">fp32</td>
<td style="text-align: center;">5.51</td>
<td style="text-align: center;">0.824</td>
</tr>
<tr class="even">
<td style="text-align: center;">amp</td>
<td style="text-align: center;">5.78</td>
<td style="text-align: center;">0.814</td>
</tr>
</tbody>
</table>
</section>
<section id="recall10" class="level2">
<h2 class="anchored" data-anchor-id="recall10">Recall@10</h2>
<p>The differences in Recall@10 is negligible, the full precision index has a slight advantage.</p>
<p>fp32: 0.13034885692197787</p>
<p>amp: 0.1299388528219369</p>
<div id="1b1033d1-6c8f-4a37-a7d9-7c06947d2954" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.13034885692197787</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1299388528219369</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1299388528219369</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>0.003155361857802613</code></pre>
</div>
</div>
</section>
<section id="comparing-retrieved-passages-and-scores" class="level2">
<h2 class="anchored" data-anchor-id="comparing-retrieved-passages-and-scores">Comparing Retrieved Passages and Scores</h2>
<p>Out of the 2710 total passages retrieved, 388 passages were retrieved using one index but not the other—that’s about a 14% difference in retrieved passages due to a difference in precision.</p>
<div id="7a3fc579-00a9-4fd1-9172-4b269f58bf8d" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'colbert_results_fp32.pkl'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>: colbert_results_fp32 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>)</span>
<span id="cb8-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'colbert_results_amp.pkl'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>: colbert_results_amp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">file</span>)</span></code></pre></div>
</div>
<div id="a028a070-f72f-4696-a990-9a763cdd654f" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">colbert_results_fp32.keys() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> colbert_results_amp.keys()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>True</code></pre>
</div>
</div>
<div id="cabf9a90-e647-4ff9-9ad6-2bef0649e70c" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">colbert_results_fp32[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dev-0'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>{'265-59': 29.345699310302734,
 '8-116': 29.341297149658203,
 '8-118': 29.336307525634766,
 '8-67': 29.32498550415039,
 '8-9': 29.2913875579834,
 '8-70': 29.290199279785156,
 '270-51': 29.28421401977539,
 '40-29': 29.28375244140625,
 '107-110': 29.282079696655273,
 '459-115': 29.28005599975586}</code></pre>
</div>
</div>
<div id="a3bfb4d8-a139-4a0d-8307-0b6711e9c0c6" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">n_diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb13-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid, fp32_res <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_fp32.items():</span>
<span id="cb13-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> fp32_res.keys():</span>
<span id="cb13-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> pid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_amp[qid].keys(): </span>
<span id="cb13-5">            n_diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb13-6"> </span>
<span id="cb13-7"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid, amp_res <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_amp.items():</span>
<span id="cb13-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> amp_res.keys():</span>
<span id="cb13-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> pid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_fp32[qid].keys(): </span>
<span id="cb13-10">            n_diffs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb13-11"></span>
<span id="cb13-12">n_diffs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>388</code></pre>
</div>
</div>
<div id="43aea657-c8b9-41af-a76c-7c36b7d8fe79" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">n_diffs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">271</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>0.14317343173431735</code></pre>
</div>
</div>
<div id="78a6ecc6-4888-4cc1-a7f9-05aed541e4fd" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1">colbert_results_fp32[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dev-0'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>{'265-59': 29.345699310302734,
 '8-116': 29.341297149658203,
 '8-118': 29.336307525634766,
 '8-67': 29.32498550415039,
 '8-9': 29.2913875579834,
 '8-70': 29.290199279785156,
 '270-51': 29.28421401977539,
 '40-29': 29.28375244140625,
 '107-110': 29.282079696655273,
 '459-115': 29.28005599975586}</code></pre>
</div>
</div>
<p>Overall, the full precision index results in a slightly lower retrieved passage score.</p>
<div id="53242388-3b1e-4945-a90e-d08ebbcc7977" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">total_amp_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb19-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid, amp_res <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_amp.items():</span>
<span id="cb19-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> amp_res.values(): total_amp_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> score</span>
<span id="cb19-4">total_amp_score</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>80438.375</code></pre>
</div>
</div>
<div id="dbc2a843-0030-409a-8ff6-7008dfd7a0e4" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">total_fp32_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb21-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid, fp32_res <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results_fp32.items():</span>
<span id="cb21-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> fp32_res.values(): total_fp32_score <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> score</span>
<span id="cb21-4">total_fp32_score</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>80435.61682701111</code></pre>
</div>
</div>
</section>
<section id="comparing-index-artifacts" class="level2">
<h2 class="anchored" data-anchor-id="comparing-index-artifacts">Comparing Index Artifacts</h2>
<div id="ded306cc-e4b8-4289-be81-c53265a8aa8e" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">colbert_fp32_root <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./experiments/default/indexes/ColBERT_ConditionalQA_fp32"</span></span>
<span id="cb23-2">colbert_amp_root  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"./experiments/default/indexes/ColBERT_ConditionalQA_amp"</span></span></code></pre></div>
</div>
<section id="metadata.json" class="level3">
<h3 class="anchored" data-anchor-id="metadata.json">metadata.json</h3>
<p>Both indexes (full precision and mixed precision) produce the same metadata.json.</p>
<div id="a423ba98-ad7c-4423-9527-8ed471147196" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb24-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_bsize"</span>,</span>
<span id="cb24-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbits"</span>,</span>
<span id="cb24-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kmeans_niters"</span>,</span>
<span id="cb24-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dim"</span>,</span>
<span id="cb24-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rank"</span>,</span>
<span id="cb24-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpus"</span>,</span>
<span id="cb24-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nranks"</span>,</span>
<span id="cb24-9">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_chunks"</span>,</span>
<span id="cb24-10">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_partitions"</span>,</span>
<span id="cb24-11">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_embeddings"</span>,</span>
<span id="cb24-12">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span></span>
<span id="cb24-13">    ]</span></code></pre></div>
</div>
<div id="467168b7-1129-4701-a929-a8d6bb00c3c3" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_fp32_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f: colbert_fp32_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span>
<span id="cb25-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_amp_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f: colbert_amp_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span></code></pre></div>
</div>
<div id="ff366466-afa4-499e-af7f-6dce67666fef" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> params:</span>
<span id="cb26-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_chunks"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_partitions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_embeddings"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span>]: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> colbert_fp32_metadata[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'config'</span>][p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> colbert_amp_metadata[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'config'</span>][p], p</span>
<span id="cb26-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (colbert_fp32_metadata[p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> colbert_amp_metadata[p]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span></span>
<span id="cb26-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> colbert_fp32_metadata[p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> colbert_amp_metadata[p], p</span></code></pre></div>
</div>
</section>
<section id="centroids.pt" class="level3">
<h3 class="anchored" data-anchor-id="centroids.pt">centroids.pt</h3>
<p>There is a significant difference in centroids—meaning that the sampled document token embeddings and their clusters are different based on the type of precision used.</p>
<div id="24a568ec-8c81-49fc-8339-7188e7fbd5c0" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">colbert_fp32_centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_fp32_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/centroids.pt"</span>)</span>
<span id="cb27-2">colbert_amp_centroids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_amp_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/centroids.pt"</span>)</span></code></pre></div>
</div>
<div id="6623333c-429f-4aa0-ad25-804ba63c0a5e" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">torch.allclose(colbert_fp32_centroids, colbert_amp_centroids.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>False</code></pre>
</div>
</div>
<div id="1ea3d26f-6eb3-49b8-bc10-84411548adf5" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">torch.allclose(colbert_fp32_centroids.half(), colbert_amp_centroids)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>False</code></pre>
</div>
</div>
<div id="137ce115-b1dd-43fc-aa2c-85a8328eee23" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">torch.allclose(colbert_fp32_centroids, colbert_amp_centroids.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(), atol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>True</code></pre>
</div>
</div>
<div id="b37ef31c-449b-4fee-ac32-db53e22aa2c4" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">colbert_fp32_centroids.flatten().shape, colbert_amp_centroids.flatten().shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(torch.Size([1572864]), torch.Size([1572864]))</code></pre>
</div>
</div>
<div id="ee48d045-d537-4eb8-be77-1cab42e18901" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">plt.scatter(colbert_fp32_centroids.flatten().cpu().numpy(), colbert_amp_centroids.flatten().cpu().numpy(), s<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">;</span></span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/cell-24-output-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-25-Exploring-ColBERT-Precision/index_files/figure-html/cell-24-output-1.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ivf.pid.pt" class="level3">
<h3 class="anchored" data-anchor-id="ivf.pid.pt">ivf.pid.pt</h3>
<p>Finally, there is a difference in mappings between passages IDs and centroid IDs. Interestingly, mixed precision results in more passage IDs mapped to centroids.</p>
<div id="1376756c-c23a-4c52-8781-31bde8702914" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">colbert_fp32_ivf <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_fp32_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/ivf.pid.pt"</span>)</span>
<span id="cb37-2">colbert_amp_ivf  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>colbert_amp_root<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/ivf.pid.pt"</span>)</span></code></pre></div>
</div>
<div id="8550ccb3-21e0-48e4-ab58-19a6a63b7891" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">colbert_fp32_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape, colbert_amp_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>(torch.Size([963143]), torch.Size([975457]))</code></pre>
</div>
</div>
<div id="0e13f0a8-4ec1-4dc4-a60c-56661d431875" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">colbert_amp_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>colbert_fp32_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>12314</code></pre>
</div>
</div>
<div id="96492aa3-8d5b-45ac-a978-dcbbb30083ef" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">colbert_fp32_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape, colbert_amp_ivf[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>(torch.Size([16384]), torch.Size([16384]))</code></pre>
</div>
</div>
</section>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>This is just one small dataset with short documents (avg 15 tokens). Sample size of one. I also might have missed some precision conversions in my implementation. Don’t take this as definitive - just an interesting exploration of how precision affects the ColBERT pipeline. Here’s a summary again of my key findings:</p>
<ul>
<li>Mixed precision took 2.5x longer to index (180s vs 70s) - wasn’t expecting that</li>
<li>Mixed precision used slightly more GPU memory, full precision used more CPU memory</li>
<li>Full precision gave a tiny 0.3% recall boost (basically negligible)</li>
<li>14% of retrieved passages were different between the two approaches</li>
<li>The centroids created during indexing were significantly different</li>
<li>Different mappings between passage IDs and centroids</li>
</ul>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>ColBERT</category>
  <category>information retrieval</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-25-Exploring-ColBERT-Precision/</guid>
  <pubDate>Sun, 25 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>The Evolution of Matrix Multiplication (fastai course Part 2 Lessons 11 and 12)</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/</link>
  <description><![CDATA[ 




<div id="cell-1" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="47621598-8fd6-4b6a-9893-4dc62cc9ee45" data-execution_count="2">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !conda install -y -c nvidia/label/cuda-12.8.0 cuda-toolkit</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !conda install -y numba</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !conda install -y fastcore -c fastai</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pathlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Path</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle, gzip, math, os, time, shutil</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> urllib.request <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> urlretrieve</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensor</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> numba <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> njit</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> array</span>
<span id="cb1-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastcore.test <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> numba <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cuda</span>
<span id="cb1-17"></span>
<span id="cb1-18">torch.set_printoptions(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>, sci_mode<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb1-19">np.set_printoptions(precision<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span>)</span>
<span id="cb1-20"></span>
<span id="cb1-21">MNIST_URL<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://github.com/mnielsen/neural-networks-and-deep-learning/blob/master/data/mnist.pkl.gz?raw=true'</span></span>
<span id="cb1-22">path_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'data'</span>)</span>
<span id="cb1-23">path_data.mkdir(exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb1-24">path_gz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> path_data<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mnist.pkl.gz'</span></span>
<span id="cb1-25"></span>
<span id="cb1-26"></span>
<span id="cb1-27"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> path_gz.exists(): urlretrieve(MNIST_URL, path_gz)</span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> gzip.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(path_gz, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rb'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f: ((x_train, y_train), (x_valid, y_valid), _) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pickle.load(f, encoding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'latin-1'</span>)</span>
<span id="cb1-30"></span>
<span id="cb1-31">x_train,y_train,x_valid,y_valid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(tensor, (x_train,y_train,x_valid,y_valid))</span>
<span id="cb1-32">x_train.shape</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>torch.Size([50000, 784])</code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a4f3c78a-4f61-4f8c-cf21-4c103270afd9" data-execution_count="3">
<details class="code-fold">
<summary>Show setup code</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-2">weights <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.randn(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">784</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb3-3">bias <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5">m1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_valid[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span>
<span id="cb3-6">m2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> weights</span>
<span id="cb3-7"></span>
<span id="cb3-8">m1.shape,m2.shape</span></code></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>(torch.Size([5, 784]), torch.Size([784, 10]))</code></pre>
</div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/iV63qy4ETJQ?si=RVTeCMWgSHf_IHq0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="digit-subset" class="level3">
<h3 class="anchored" data-anchor-id="digit-subset">5-digit Subset</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>@</code> Op</td>
<td style="text-align: center;">18.1 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;">Numba Broadcasting</td>
<td style="text-align: center;">69.2 μs</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Einstein Summation</td>
<td style="text-align: center;">83.1 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;">PyTorch Cuda</td>
<td style="text-align: center;">108 μs</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Cuda</td>
<td style="text-align: center;">108 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;">PyTorch Broadcasting</td>
<td style="text-align: center;">203 μs</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Dot Product</td>
<td style="text-align: center;">542 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>torch.dot</code></td>
<td style="text-align: center;">1.19 ms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Element-wise PyTorch Ops</td>
<td style="text-align: center;">1.49 ms</td>
</tr>
<tr class="even">
<td style="text-align: center;">Nested for-loops</td>
<td style="text-align: center;">604 ms</td>
</tr>
</tbody>
</table>
</section>
<section id="full-dataset-50k-images" class="level3">
<h3 class="anchored" data-anchor-id="full-dataset-50k-images">Full Dataset (50k images)</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>cuda</code></td>
<td style="text-align: center;">541 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;">Numba Cuda</td>
<td style="text-align: center;">3.91 ms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>@</code> Op</td>
<td style="text-align: center;">5.8 ms</td>
</tr>
<tr class="even">
<td style="text-align: center;">Einstein Summation</td>
<td style="text-align: center;">5.87 ms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Broadcasting</td>
<td style="text-align: center;">663 ms</td>
</tr>
<tr class="even">
<td style="text-align: center;">PyTorch Broadcasting</td>
<td style="text-align: center;">1.26 s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Dot Product</td>
<td style="text-align: center;">3.71 s</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="version-0-nested-for-loops" class="level2">
<h2 class="anchored" data-anchor-id="version-0-nested-for-loops">Version 0: Nested For-Loops</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Excalidraw diagram showing nested for-loop implementation of matrix multiplication"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/1.png" class="img-fluid figure-img" alt="Excalidraw diagram showing nested for-loop implementation of matrix multiplication"></a></p>
<figcaption>Excalidraw diagram showing nested for-loop implementation of matrix multiplication</figcaption>
</figure>
</div>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="f1b07e28-eb6a-42f0-9863-d962b0843dff" data-execution_count="70">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">ar,ac <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m1.shape <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># n_rows * n_cols</span></span>
<span id="cb5-2">br,bc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m2.shape</span>
<span id="cb5-3">(ar,ac),(br,bc)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>((5, 784), (784, 10))</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="50202d80-fbe0-4ea8-aa39-4fe0691cb4b0" data-execution_count="71">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">t1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb7-2">t1.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>torch.Size([5, 10])</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5</span></span>
<span id="cb9-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc):     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10</span></span>
<span id="cb9-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ac): <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 784</span></span>
<span id="cb9-4">            t1[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> m1[i,k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m2[k,j]</span></code></pre></div>
</div>
<div id="cell-14" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="de65336e-e04e-4d55-81aa-228a6f7bf7bf" data-execution_count="73">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">t1.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>torch.Size([5, 10])</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a46dd7f0-06d7-4d86-aa3a-577743471963" data-execution_count="74">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">t1</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>tensor([[-10.94,  -0.68,  -7.00,  -4.01,  -2.09,  -3.36,   3.91,  -3.44, -11.47,  -2.12],
        [ 14.54,   6.00,   2.89,  -4.08,   6.59, -14.74,  -9.28,   2.16, -15.28,  -2.68],
        [  2.22,  -3.22,  -4.80,  -6.05,  14.17,  -8.98,  -4.79,  -5.44, -20.68,  13.57],
        [ -6.71,   8.90,  -7.46,  -7.90,   2.70,  -4.73, -11.03, -12.98,  -6.44,   3.64],
        [ -2.44,  -6.40,  -2.40,  -9.04,  11.18,  -5.77,  -8.92,  -3.79,  -8.98,   5.28]])</code></pre>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb14-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb14-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb14-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):</span>
<span id="cb14-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc):</span>
<span id="cb14-6">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ac): c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> a[i,k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b[k,j]</span>
<span id="cb14-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="75bfe38a-2fc3-4f8d-8934-7fbd7c8036e4" data-execution_count="81">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>time _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1, m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 675 ms, sys: 0 ns, total: 675 ms
Wall time: 674 ms</code></pre>
</div>
</div>
</section>
<section id="version-1-numba-dot-product" class="level2">
<h2 class="anchored" data-anchor-id="version-1-numba-dot-product">Version 1: Numba Dot Product</h2>
<p>Replacing the inner-most for-loop with a numba dot-product implementation.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Excalidraw diagram showing dot-product implementation of matrix multiplication"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/2.png" class="img-fluid figure-img" alt="Excalidraw diagram showing dot-product implementation of matrix multiplication"></a></p>
<figcaption>Excalidraw diagram showing dot-product implementation of matrix multiplication</figcaption>
</figure>
</div>
<div id="cell-21" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@njit</span></span>
<span id="cb17-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> dot(a,b):</span>
<span id="cb17-3">    res <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.</span></span>
<span id="cb17-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(a)): res<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span>a[i]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>b[i]</span>
<span id="cb17-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> res</span></code></pre></div>
</div>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="217464df-4573-40a9-f926-37186bb47d53" data-execution_count="83">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>time dot(array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]),array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 124 ms, sys: 0 ns, total: 124 ms
Wall time: 123 ms</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>20.0</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="64bc96a7-7cc1-404a-c47b-6b8a54d5c6b6" data-execution_count="84">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>time dot(array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]),array([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 26 μs, sys: 2 μs, total: 28 μs
Wall time: 32.4 μs</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>20.0</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb24-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb24-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb24-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):</span>
<span id="cb24-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc): c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dot(a[i,:], b[:,j])</span>
<span id="cb24-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-25" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">m1a,m2a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m1.numpy(),m2.numpy()</span></code></pre></div>
</div>
<div id="cell-26" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">test_close(t1,matmul(m1a, m2a))</span></code></pre></div>
</div>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="10968392-3789-4272-b708-9a99560bad48" data-execution_count="91">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> matmul(m1a,m2a)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>495 μs ± 39.4 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-2-element-wise-operations" class="level2">
<h2 class="anchored" data-anchor-id="version-2-element-wise-operations">Version 2: Element-wise Operations</h2>
<div id="cell-29" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb29-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb29-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb29-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):</span>
<span id="cb29-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc): c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a[i,:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b[:,j]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>()</span>
<span id="cb29-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-30" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">test_close(t1,matmul(m1, m2))</span></code></pre></div>
</div>
<div id="cell-31" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="fc775c33-b82e-4076-ef1b-5eb260224b56" data-execution_count="94">
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1, m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.48 ms ± 354 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-3-torch.dot" class="level2">
<h2 class="anchored" data-anchor-id="version-3-torch.dot">Version 3: <code>torch.dot</code></h2>
<div id="cell-33" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb33-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb33-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb33-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):</span>
<span id="cb33-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc): c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.dot(a[i,:], b[:,j])</span>
<span id="cb33-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-34" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">test_close(t1,matmul(m1, m2))</span></code></pre></div>
</div>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="b97d9eea-9c0f-4ac5-9db1-c73b3661cfec" data-execution_count="97">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1, m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.23 ms ± 380 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-4-pytorch-broadcasting" class="level2">
<h2 class="anchored" data-anchor-id="version-4-pytorch-broadcasting">Version 4: PyTorch Broadcasting</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Excalidraw diagram showing broadcasting implementation of matrix multiplication"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/3.png" class="img-fluid figure-img" alt="Excalidraw diagram showing broadcasting implementation of matrix multiplication"></a></p>
<figcaption>Excalidraw diagram showing broadcasting implementation of matrix multiplication</figcaption>
</figure>
</div>
<div id="cell-38" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb37-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb37-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb37-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar): c[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a[i,:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb37-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-39" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">test_close(t1,matmul(m1, m2))</span></code></pre></div>
</div>
<div id="cell-40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2acf0524-81f2-4fab-e67d-b2354bacbf36" data-execution_count="109">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1, m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>314 μs ± 92.1 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-5-numba-broadcasting" class="level2">
<h2 class="anchored" data-anchor-id="version-5-numba-broadcasting">Version 5: Numba Broadcasting</h2>
<div id="cell-42" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@njit</span></span>
<span id="cb41-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb41-3">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb41-4">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((ar, bc))</span>
<span id="cb41-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar): c[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a[i,:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb41-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-43" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">test_close(t1,matmul(m1a, m2a))</span></code></pre></div>
</div>
<div id="cell-44" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="1d46ad9d-a40d-4643-c1cf-f535fa528a2f" data-execution_count="121">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1a, m2a)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>69 μs ± 1.96 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-6-einstein-summation" class="level2">
<h2 class="anchored" data-anchor-id="version-6-einstein-summation">Version 6: Einstein Summation</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Excalidraw diagram showing einsum implementation of matrix multiplication"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/4.png" class="img-fluid figure-img" alt="Excalidraw diagram showing einsum implementation of matrix multiplication"></a></p>
<figcaption>Excalidraw diagram showing einsum implementation of matrix multiplication</figcaption>
</figure>
</div>
<div id="cell-47" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.einsum(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ik,kj-&gt;ij'</span>, a, b)</span></code></pre></div>
</div>
<div id="cell-48" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">test_close(t1,matmul(m1, m2))</span></code></pre></div>
</div>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="65bbe1b5-0ab3-4162-ef3f-bdeaeb96f800" data-execution_count="124">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(m1, m2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>80.8 μs ± 4.18 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-7-pytorch-operator" class="level2">
<h2 class="anchored" data-anchor-id="version-7-pytorch-operator">Version 7: PyTorch <code>@</code> Operator</h2>
<div id="cell-51" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1">test_close(t1,m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>m2)</span></code></pre></div>
</div>
<div id="cell-52" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="0bdd14b8-2dbf-42d9-f565-0746be389f63" data-execution_count="126">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>m1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>m2</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>16.7 μs ± 1.96 μs per loop (mean ± std. dev. of 7 runs, 50 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-8-numba-cuda" class="level2">
<h2 class="anchored" data-anchor-id="version-8-numba-cuda">Version 8: Numba CUDA</h2>
<div id="cell-54" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@cuda.jit</span></span>
<span id="cb52-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b,c):</span>
<span id="cb52-3">    i, j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cuda.grid(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb52-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> c.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> c.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb52-5">        tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.</span></span>
<span id="cb52-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(a.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]): tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> a[i, k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b[k, j]</span>
<span id="cb52-7">        c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tmp</span></code></pre></div>
</div>
<div id="cell-55" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> launch_kernel(kernel, grid_x, grid_y, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb53-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(grid_x):</span>
<span id="cb53-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(grid_y): kernel((i,j), <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span></code></pre></div>
</div>
<div id="cell-56" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(t1.shape)</span>
<span id="cb54-2">m1g,m2g,rg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(cuda.to_device, (m1,m2,r))</span></code></pre></div>
</div>
<div id="cell-57" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2852ccb1-8bed-450f-8864-1928e10117f2" data-execution_count="130">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1">m1g.shape, m2g.shape, rg.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>((5, 784), (784, 10), (5, 10))</code></pre>
</div>
</div>
<div id="cell-58" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d4e0a549-a04f-43db-9d1f-c96e9a6026e7" data-execution_count="131">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">TPB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb57-2">rr,rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r.shape</span>
<span id="cb57-3">blockspergrid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (math.ceil(rr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> TPB), math.ceil(rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> TPB))</span>
<span id="cb57-4">blockspergrid</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>(1, 1)</code></pre>
</div>
</div>
<div id="cell-59" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:498}}" data-outputid="bf632387-a756-4efb-ec6a-ce589b1c023a" data-execution_count="132">
<div class="sourceCode cell-code" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1">matmul[blockspergrid, (TPB,TPB)](m1g,m2g,rg)</span>
<span id="cb59-2">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rg.copy_to_host()</span>
<span id="cb59-3">test_close(t1, r, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/mnt/my4tb/vishal_data/miniconda3/envs/course-numba/lib/python3.10/site-packages/numba/cuda/dispatcher.py:536: NumbaPerformanceWarning: Grid size 1 will likely result in GPU under-utilization due to low occupancy.
  warn(NumbaPerformanceWarning(msg))</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb61-2">matmul[blockspergrid, (TPB,TPB)](m1g,m2g,rg)</span>
<span id="cb61-3">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rg.copy_to_host()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>245 μs ± 47.4 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
<section id="version-9-pytorch-.cuda" class="level2">
<h2 class="anchored" data-anchor-id="version-9-pytorch-.cuda">Version 9: PyTorch <code>.cuda</code></h2>
<div id="cell-62" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1">m1c,m2c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> m1.cuda(),m2.cuda()</span></code></pre></div>
</div>
<div id="cell-63" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1">r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(m1c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>m2c).cpu()</span>
<span id="cb64-2">test_close(t1, r)</span></code></pre></div>
</div>
<div id="cell-64" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(m1c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>m2c).cpu()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>113 μs ± 26.4 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
<section id="comparing-fastest-versions-on-full-dataset" class="level2">
<h2 class="anchored" data-anchor-id="comparing-fastest-versions-on-full-dataset">Comparing Fastest Versions on Full Dataset</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>cuda</code></td>
<td style="text-align: center;">541 μs</td>
</tr>
<tr class="even">
<td style="text-align: center;">Numba Cuda</td>
<td style="text-align: center;">3.91 ms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>@</code> Op</td>
<td style="text-align: center;">5.8 ms</td>
</tr>
<tr class="even">
<td style="text-align: center;">Einstein Summation</td>
<td style="text-align: center;">5.87 ms</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Broadcasting</td>
<td style="text-align: center;">663 ms</td>
</tr>
<tr class="even">
<td style="text-align: center;">PyTorch Broadcasting</td>
<td style="text-align: center;">1.26 s</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Dot Product</td>
<td style="text-align: center;">3.71 s</td>
</tr>
</tbody>
</table>
<section id="numba-dot-product" class="level3">
<h3 class="anchored" data-anchor-id="numba-dot-product">Numba Dot Product</h3>
<div id="cell-68" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb67-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb67-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb67-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar):</span>
<span id="cb67-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(bc): c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dot(a[i,:], b[:,j])</span>
<span id="cb67-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span>
<span id="cb67-7"></span>
<span id="cb67-8">x_train_a,weights_a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_train.numpy(),weights.numpy()</span>
<span id="cb67-9"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> matmul(x_train_a, weights_a)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.71 s ± 20.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
</section>
<section id="pytorch-broadcasting" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-broadcasting">PyTorch Broadcasting</h3>
<div id="cell-70" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb69-2">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb69-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.zeros(ar, bc)</span>
<span id="cb69-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar): c[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a[i,:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb69-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span>
<span id="cb69-6"></span>
<span id="cb69-7"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> matmul(x_train, weights)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.26 s ± 1.42 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<div id="cell-71" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1">x_train.shape, weights.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>(torch.Size([50000, 784]), torch.Size([784, 10]))</code></pre>
</div>
</div>
<div id="cell-72" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> matmul(x_train.cuda(), weights.cuda())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.86 s ± 4.5 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
<p>Interestingly, putting the tensors on the GPU and then broadcasting is slower than the CPU.</p>
</section>
<section id="numba-cuda" class="level3">
<h3 class="anchored" data-anchor-id="numba-cuda">Numba Cuda</h3>
<div id="cell-75" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@cuda.jit</span></span>
<span id="cb75-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b,c):</span>
<span id="cb75-3">    i, j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cuda.grid(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb75-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> c.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> j <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> c.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb75-5">        tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.</span></span>
<span id="cb75-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(a.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]): tmp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> a[i, k] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b[k, j]</span>
<span id="cb75-7">        c[i,j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tmp</span></code></pre></div>
</div>
<div id="cell-76" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>))</span>
<span id="cb76-2">m1g,m2g,rg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">map</span>(cuda.to_device, (x_train,weights,r))</span></code></pre></div>
</div>
<div id="cell-77" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1">TPB <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb77-2">rr,rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> r.shape</span>
<span id="cb77-3">blockspergrid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (math.ceil(rr <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> TPB), math.ceil(rc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> TPB))</span>
<span id="cb77-4">blockspergrid</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>(3125, 1)</code></pre>
</div>
</div>
<div id="cell-78" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb79-2">matmul[blockspergrid, (TPB,TPB)](m1g,m2g,rg)</span>
<span id="cb79-3">r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rg.copy_to_host()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.91 ms ± 68.6 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
<section id="pytorch-cuda" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-cuda">PyTorch <code>cuda</code></h3>
<div id="cell-80" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1">m1c,m2c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x_train.cuda(),weights.cuda()</span>
<span id="cb81-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> r<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(m1c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>m2c).cpu()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>541 μs ± 6.82 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
<section id="einstein-summation" class="level3">
<h3 class="anchored" data-anchor-id="einstein-summation">Einstein Summation</h3>
<div id="cell-82" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> torch.einsum(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ik,kj-&gt;ij'</span>, a, b)</span>
<span id="cb83-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(x_train, weights)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5.87 ms ± 229 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
<section id="numba-broadcasting" class="level3">
<h3 class="anchored" data-anchor-id="numba-broadcasting">Numba Broadcasting</h3>
<div id="cell-84" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb85" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@njit</span></span>
<span id="cb85-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> matmul(a,b):</span>
<span id="cb85-3">    (ar,ac),(br,bc) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a.shape,b.shape</span>
<span id="cb85-4">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros((ar, bc))</span>
<span id="cb85-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(ar): c[i] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (a[i,:,<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(axis<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb85-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> c</span></code></pre></div>
</div>
<div id="cell-85" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1">_<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(x_train.numpy(), weights.numpy())</span></code></pre></div>
</div>
<div id="cell-86" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb87" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>matmul(x_train.numpy(), weights.numpy())</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>663 ms ± 378 μs per loop (mean ± std. dev. of 7 runs, 1 loop each)</code></pre>
</div>
</div>
</section>
<section id="pytorch-op" class="level3">
<h3 class="anchored" data-anchor-id="pytorch-op">PyTorch <code>@</code> Op</h3>
<div id="cell-88" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb89" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span>timeit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> _<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>x_train<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span>weights</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5.8 ms ± 212 μs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-5-digit-subset-to-full-dataset-times" class="level2">
<h2 class="anchored" data-anchor-id="comparing-5-digit-subset-to-full-dataset-times">Comparing 5-digit Subset to Full Dataset Times</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Full Dataset Time</th>
<th style="text-align: center;">5-digit Subset Time/Rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>cuda</code></td>
<td style="text-align: center;">541 μs</td>
<td style="text-align: center;">108 μs (4)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Numba Cuda</td>
<td style="text-align: center;">3.91 ms</td>
<td style="text-align: center;">108 μs (4)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">PyTorch <code>@</code> Op</td>
<td style="text-align: center;">5.8 ms</td>
<td style="text-align: center;">18.1 μs (1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">Einstein Summation</td>
<td style="text-align: center;">5.87 ms</td>
<td style="text-align: center;">83.1 μs (3)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Broadcasting</td>
<td style="text-align: center;">663 ms</td>
<td style="text-align: center;">69.2 μs (2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">PyTorch Broadcasting</td>
<td style="text-align: center;">1.26 s</td>
<td style="text-align: center;">203 μs (6)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Numba Dot Product</td>
<td style="text-align: center;">3.71 s</td>
<td style="text-align: center;">542 μs (7)</td>
</tr>
</tbody>
</table>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>I initially ran into some problems on Colab when implementing <code>@cuda.jit</code> (an error about compute compatibility) so I switched to an RTX 3090 machine and installed the following, which let me successfully run this notebook:</p>
<pre><code>conda install -y -c nvidia/label/cuda-12.8.0 cuda-toolkit
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128
conda install -y numba
conda install -y fastcore -c fastai</code></pre>
<p>The glaring takeaway from this exercise is that these methods all scale differently. For the 5-digit subset, PyTorch <code>cuda</code> was about 9 times slower than PyTorch CPU (when using the <code>@</code> operator). Numba cuda and PyTorch <code>cuda</code> were tied for the small subset, but PyTorch <code>cuda</code> was 8 times faster for the larger dataset. I don’t yet understand <em>why</em> these differences exist, so that’s something I’ll keep an eye out for as I learn more about how GPUs work!</p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>fastai</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-21-matmul-2/</guid>
  <pubDate>Wed, 21 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>DataInspector with BinPackCollator: Inspecting Packed Dataloader Items</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-13-DataInspector-BinPackCollator/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/DUwJ9o-Ut5g?si=G8QiwIx_Y7W_LRZF" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<p>I recently learned (via a desperation google search “llm foundry sequence packing”) that LLM-Foundry has a built-in sequence packer called <a href="https://github.com/mosaicml/llm-foundry/blob/dedcfe3b760b847091642526e9fb303f39742a51/llmfoundry/data/packing.py#L24"><code>BinPackCollator</code></a>. To use it, you simply set two values in the training YAML: <code>train_loader.name=finetuning</code> and <code>train_loader.dataset.packing_ratio</code> to <code>auto</code> or a number greater than <code>1.0</code>. I haven’t fully/thoroughly understood/traced how <code>BinPackCollator</code> is activated, but here’s what I have found:</p>
<ul>
<li><a href="https://github.com/mosaicml/llm-foundry/blob/7993aebe3207aae60aed0aab2a107e0114410e83/llmfoundry/data/finetuning/dataloader.py#L668"><code>build_collate_fn</code></a> uses the <code>packing_ratio</code> config value. If <code>packing_ratio</code> is <code>1.0</code> it returns the <code>Seq2SeqFinetuningCollator</code>. If it’s <code>auto</code>, it calls the function <a href="https://github.com/mosaicml/llm-foundry/blob/dedcfe3b760b847091642526e9fb303f39742a51/llmfoundry/data/packing.py#L364"><code>auto_packing_ratio</code></a> which profiles the dataset to determine the optimal <code>packing_ratio</code> (a <code>packing_ratio</code> with zero waste). If <code>packing_ratio</code> is greater than <code>1.0</code>, it then <a href="https://github.com/mosaicml/llm-foundry/blob/7993aebe3207aae60aed0aab2a107e0114410e83/llmfoundry/data/finetuning/dataloader.py#L705">instantiates <code>BinPackCollator</code></a> as the <code>collate_fn</code>.</li>
<li><a href="https://github.com/mosaicml/llm-foundry/blob/7993aebe3207aae60aed0aab2a107e0114410e83/llmfoundry/data/finetuning/dataloader.py#L235"><code>build_finetuning_dataloader</code></a> constructs the <code>collate_fn</code> from <code>registry.collators</code> (tbh, I haven’t yet grasped the concept of registry and how it works in LLM-Foundry, on my to-do list).</li>
<li>The main training script, command_utils/train.py <a href="https://github.com/mosaicml/llm-foundry/blob/7993aebe3207aae60aed0aab2a107e0114410e83/llmfoundry/command_utils/train.py#L461">uses <code>build_dataloader</code></a> which takes the training loader config and uses <a href="https://github.com/mosaicml/llm-foundry/blob/7993aebe3207aae60aed0aab2a107e0114410e83/llmfoundry/data/dataloader.py#L32">the <code>name</code> attribute in the config (which is <code>finetuning</code> in our case)</a> to <code>construct_from_registry</code> which I do not understand how it works yet.</li>
</ul>
<p>Here’s an example YAML snippet which shows the necessary attributes (<code>name</code> and <code>packing_ratio</code>) to utilize <code>BinPackCollator</code>:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">train_loader</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> finetuning</span></span>
<span id="cb1-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dataset</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">streams</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">my_data</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">local</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${variables.data_local}</span></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">remote</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${variables.data_remote}</span></span>
<span id="cb1-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">split</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> train</span></span>
<span id="cb1-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shuffle</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max_seq_len</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${variables.max_seq_len}</span></span>
<span id="cb1-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shuffle_seed</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${variables.global_seed}</span></span>
<span id="cb1-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">decoder_only_format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">packing_ratio</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span></span></code></pre></div>
<p>In this blog post, I’m going to share a custom Composer callback I wrote to inspect data during training and ensure that sequences are being packed!</p>
</section>
<section id="datainspector" class="level2">
<h2 class="anchored" data-anchor-id="datainspector"><code>DataInspector</code></h2>
<p>I’ll start by sharing the full code for my callback:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DataInspector(Callback):</span>
<span id="cb2-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, save_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/model-checkpoints/binpackcollator"</span>):</span>
<span id="cb2-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(save_path)</span>
<span id="cb2-4">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log'</span>: {}}</span>
<span id="cb2-5"></span>
<span id="cb2-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> after_dataloader(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb2-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._log(</span>
<span id="cb2-8">            state, </span>
<span id="cb2-9">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"after_dataloader"</span>, </span>
<span id="cb2-10">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(state.timestamp.batch.value), </span>
<span id="cb2-11">            [</span>
<span id="cb2-12">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'collate_fn'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(state.dataloader.collate_fn.base_collator)),</span>
<span id="cb2-13">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids_shape'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>].shape)), </span>
<span id="cb2-14">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'total_tokens'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>].shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])),</span>
<span id="cb2-15">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'decoded_tokens'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(state.model.tokenizer.decode(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))),</span>
<span id="cb2-16">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'padding_tokens'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([o <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> o.item() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))),</span>
<span id="cb2-17">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'non_padding_tokens'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>([o <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> o.item() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))),</span>
<span id="cb2-18">                (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids[0]'</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]))),</span>
<span id="cb2-19">                </span>
<span id="cb2-20">            ])</span>
<span id="cb2-21"></span>
<span id="cb2-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _log(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, event_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, batch_num: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, values: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb2-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> label, value <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> values: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>][<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>event_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>batch_num<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>label<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value</span>
<span id="cb2-24">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._save()</span>
<span id="cb2-25"></span>
<span id="cb2-26">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _save(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb2-27">        os.makedirs(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb2-28">        log_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"datainspector_logs.json"</span></span>
<span id="cb2-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(log_file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb2-30">            json.dump(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log, f, indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<p>I started testing the callback by writing a very basic version first:</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> DataInspector(Callback):</span>
<span id="cb3-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, save_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/model-checkpoints/binpackcollator"</span>):</span>
<span id="cb3-3">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Path(save_path)</span>
<span id="cb3-4">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'log'</span>: {}}</span>
<span id="cb3-5"></span>
<span id="cb3-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> after_dataloader(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb3-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._log(state, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"after_dataloader"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"some value"</span>)</span>
<span id="cb3-8"></span>
<span id="cb3-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _log(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, event_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, value: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb3-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"log"</span>][<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>event_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> value</span>
<span id="cb3-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._save()</span>
<span id="cb3-12"></span>
<span id="cb3-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _save(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb3-14">        os.makedirs(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path, exist_ok<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb3-15">        log_file <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.save_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"datainspector_logs.json"</span></span>
<span id="cb3-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(log_file, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb3-17">            json.dump(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.log, f, indent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<p>The <code>__init__</code> and <code>_save</code> methods are pretty straigtforward, as they instantiate the <code>save_path</code> and <code>log</code> and then save to the <code>log</code> at that <code>save_path</code>. I could have chosen any number of events to trigger logging, but I chose <code>after_loader</code> since I wanted to inspect the data after the dataloader was constructed. The <code>_log</code> basically takes in as input the strings you want to save in the <code>self.log</code> dictionary. Once this initial functionality was working, I added different items for logging one at a time, starting with <code>input_ids</code>, <code>non_padding_tokens</code> and <code>padding_tokens</code> (which are counts of tokens), inspecting the logs visually before I moved on to the next item. Along the way I learned that the dataloader’s <code>collate_fn</code> was <code>LossGeneratingTokensCollatorWrapper</code> and that its <code>base_collator</code> function was <code>BinPackCollator</code>.</p>
<p>Here’s a snippet of the log:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb4-1"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"log":</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb4-2">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"after_dataloader_0_collate_fn"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;llmfoundry.data.packing.BinPackCollator object at 0x2ad36237cc20&gt;"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb4-3">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"after_dataloader_0_input_ids_shape"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"torch.Size([4, 2048])"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb4-4">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"after_dataloader_0_total_tokens"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2048"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb4-5">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"after_dataloader_0_padding_tokens"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"102"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb4-6">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"after_dataloader_0_non_padding_tokens"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1946"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb4-7">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">...</span></span></code></pre></div>
<p>Here are screenshots of the actual log, first <strong>without</strong> using <code>BinPackCollator</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="log without using BinPackCollator. Note that the number of padding tokens represent ~90% of the max sequence length of 2048"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-13-DataInspector-BinPackCollator/1.png" class="img-fluid figure-img" alt="log without using BinPackCollator. Note that the number of padding tokens represent ~90% of the max sequence length of 2048"></a></p>
<figcaption>log without using <code>BinPackCollator</code>. Note that the number of padding tokens represent ~90% of the max sequence length of 2048</figcaption>
</figure>
</div>
<p>And with using <code>BinPackCollator</code>:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="log when using BinPackCollator. Now the non-padding token represent 90% of the sequence length"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-13-DataInspector-BinPackCollator/2.png" class="img-fluid figure-img" alt="log when using BinPackCollator. Now the non-padding token represent 90% of the sequence length"></a></p>
<figcaption>log when using <code>BinPackCollator</code>. Now the non-padding token represent 90% of the sequence length</figcaption>
</figure>
</div>
<p>Using <code>BinPackCollator</code>, we are now using more than 90% of the maximum sequence length with loss generating tokens!</p>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>This is the fourth or fifth custom Composer callback I’ve written and I am really enjoyin writing and using them! The callback system makes it so easy to “look at your data”, and visually inspect and confirm that the model and/or data artifacts are correct. Expect more blog posts around Composer callbacks.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="ChatGPT generated graphic for `DataInspector`.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="3.png"><img src="https://vishalbakshi.github.io/blog/posts/2025-05-13-DataInspector-BinPackCollator/ChatGPT generated graphic for `DataInspector`.png" class="img-fluid figure-img" alt="3.png"></a></p>
<figcaption>3.png</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>LLM-Foundry</category>
  <category>Custom Composer Callback</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-13-DataInspector-BinPackCollator/</guid>
  <pubDate>Tue, 13 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Comparing RAGatouille and ColBERT Indexes and Search Results</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-10-RAGatouille-ColBERT-Comparisons/</link>
  <description><![CDATA[ 




<div id="3522db3b-9d42-426d-9f78-36bf770e7c05" class="cell">
<details class="code-fold">
<summary>Show setup</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> faiss</span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(faiss, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"StandardGpuResources"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datasets <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dataset</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ragatouille <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RAGPretrainedModel</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pytrec_eval</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ranx <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> evaluate</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> ranx <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Qrels, Run</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pickle</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb1-12"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb1-13"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-14"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> srsly</span>
<span id="cb1-15"></span>
<span id="cb1-16"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Indexer</span>
<span id="cb1-17"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.infra <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RunConfig, ColBERTConfig</span>
<span id="cb1-18"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.infra.run <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Run</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert.data <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Queries</span>
<span id="cb1-21"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> colbert <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Searcher</span></code></pre></div>
</details>
</div>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this notebook I am trying to answer two questions:</p>
<ol type="1">
<li>For a given document collection and indexing configuration, do RAGatouille and ColBERT produce the same index?</li>
<li>For a given index and search configuration, do RAGatouille and ColBERT retrieve the same passages/Recall@10?</li>
</ol>
<p>For this exercise, I’m using the UKPLab/DAPR’s ConditionalQA document collection which is 69k rows. If this exercise is successful, I’ll scale to larger document collections.</p>
<p>Here’s my rough plan:</p>
<ol type="1">
<li>Index the ConditionalQA document collection using RAGatouille and ColBERT. Be very thorough in ensuring the same configuration values are used.</li>
<li>Compare artifacts of the index (json and pt files). Document differences.</li>
<li>If successful, I would expect both indexes to largely be identical. If not, that’s a deeper dive.</li>
<li>Assuming successful equality of indexes, I’ll then perform search on the index using each framework, and compare retrieved passages and Recall@10. Initially, I’ll use RAGatouille search on the RAGatouille index, and ColBERT search on the ColBERT index. If that goes well, I might use one framework to search on the other’s index. RAGatouille requires some additional files so I’ll likely have to create them manually from the ColBERT index artifacts.</li>
<li>If I get similar Recall@10 and retrieved passages, great! If not, that’s a deeper dive.</li>
</ol>
</section>
<section id="load-the-data" class="level2">
<h2 class="anchored" data-anchor-id="load-the-data">Load the Data</h2>
<div id="9c609912-0058-4c49-95df-2c08a29021e9" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">dataset_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ConditionalQA"</span></span>
<span id="cb2-2">dataset_name</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>'ConditionalQA'</code></pre>
</div>
</div>
<div id="6a10253a-4d87-46d8-a922-6c85ce2ee06f" class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">passages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-corpus"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb4-2">queries <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-queries"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span>
<span id="cb4-3">qrels_rows <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> load_dataset(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UKPLab/dapr"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">-qrels"</span>, split<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"test"</span>)</span></code></pre></div>
</div>
</section>
<section id="create-ragatouille-index-1k-subset" class="level2">
<h2 class="anchored" data-anchor-id="create-ragatouille-index-1k-subset">Create RAGatouille Index (1k subset)</h2>
<div id="3a2de694-4d3c-47b1-be93-96c87218c729" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">RAG <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAGPretrainedModel.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>)</span></code></pre></div>
</div>
<div id="6681a72d-48c1-460c-a654-33bb0ec20001" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">n_items <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb6-2">n_items</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>1000</code></pre>
</div>
</div>
<p>Notes about <code>RAG.model.config</code> before indexing:</p>
<ul>
<li>The following values are <code>None</code>: <code>ncells</code>, <code>centroid_score_threshold</code>, <code>ndocs</code></li>
<li><code>kmeans_niters=4</code></li>
<li><code>nbits=1</code></li>
<li><code>index_bsize=64</code></li>
<li><code>bsize=32</code></li>
<li><code>dim=96</code></li>
<li><code>doc_maxlen=300</code></li>
<li><code>rank=0</code></li>
<li><code>nranks=4</code></li>
<li><code>gpus=4</code></li>
</ul>
<div id="0169e78c-14c4-4861-9777-03e989b6a6cd" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">RAG.model.config</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>ColBERTConfig(query_token_id='[unused0]', doc_token_id='[unused1]', query_token='[Q]', doc_token='[D]', ncells=None, centroid_score_threshold=None, ndocs=None, load_index_with_mmap=False, index_path=None, index_bsize=64, nbits=1, kmeans_niters=4, resume=False, pool_factor=1, clustering_mode='hierarchical', protected_tokens=0, similarity='cosine', bsize=32, accumsteps=1, lr=1e-05, maxsteps=15626, save_every=None, warmup=781, warmup_bert=None, relu=False, nway=32, use_ib_negatives=False, reranker=False, distillation_alpha=1.0, ignore_scores=False, model_name='answerdotai/AnswerAI-ColBERTv2.5-small', query_maxlen=32, attend_to_mask_tokens=False, interaction='colbert', dim=96, doc_maxlen=300, mask_punctuation=True, checkpoint='/home/vishal/.cache/huggingface/hub/models--answerdotai--answerai-colbert-small-v1/snapshots/be1703c55532145a844da800eea4c9a692d7e267/', triples='/home/bclavie/colbertv2.5_en/data/msmarco/triplets.jsonl', collection='/home/bclavie/colbertv2.5_en/data/msmarco/collection.tsv', queries='/home/bclavie/colbertv2.5_en/data/msmarco/queries.tsv', index_name=None, overwrite=False, root='.ragatouille/', experiment='colbert', index_root=None, name='2024-08/07/08.16.20', rank=0, nranks=4, amp=True, gpus=4, avoid_fork_if_possible=False)</code></pre>
</div>
</div>
<div id="711dbfb8-0934-4693-a1c2-4aa09a7d2793" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!rm -rf .ragatouille/colbert/indexes/ConditionalQA_RAGatouille_index_1k</span></span></code></pre></div>
</div>
<div id="df9ef92a-f309-4fbf-a805-769f980db3c0" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">RAG_index_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAG.index(</span>
<span id="cb11-2">    index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_RAGatouille_index_1k"</span>,</span>
<span id="cb11-3">    collection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[:n_items][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>],</span>
<span id="cb11-4">    document_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[:n_items][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_id"</span>],</span>
<span id="cb11-5">    use_faiss<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to match ColBERT</span></span>
<span id="cb11-6">)</span></code></pre></div>
</div>
<div id="24a51af0-edd0-4094-9871-e8f54235c55b" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>du <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sh {RAG_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.2M    .ragatouille/colbert/indexes/ConditionalQA_RAGatouille_index_1k</code></pre>
</div>
</div>
<div id="e5100ce6-276e-41d7-8ff8-8c3a2017b09d" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>ls {RAG_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.codes.pt   avg_residual.pt  collection.json  metadata.json
0.metadata.json  buckets.pt   doclens.0.json   pid_docid_map.json
0.residuals.pt   centroids.pt     ivf.pid.pt       plan.json</code></pre>
</div>
</div>
<p>Notes about <code>metadata.json</code> <em>after</em> indexing:</p>
<ul>
<li>The following values are still <code>None</code>: <code>ncells</code>, <code>centroid_score_threshold</code>, <code>ndocs</code></li>
<li><code>kmeans_niters=20</code> (up from 4)</li>
<li><code>nbits=4</code> (up from 1)</li>
<li><code>index_bsize=64</code></li>
<li><code>bsize=64</code> (up from 32)</li>
<li><code>dim=96</code></li>
<li><code>doc_maxlen=256</code> (down from 300)</li>
<li><code>rank=0</code></li>
<li><code>nranks=1</code> (down from 4)</li>
<li><code>gpus=1</code> (down from 4)</li>
<li><code>'num_partitions'=1024</code> (not in original config)</li>
</ul>
<p>Inspecting the RAGatouille metadata:</p>
<div id="ffd3f36b-a608-4343-842f-7049e0bb09f8" class="cell" data-scrolled="true" data-execution_count="159">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb16-2">    RAG_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span>
<span id="cb16-3">RAG_metadata</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<pre><code>{'config': {'query_token_id': '[unused0]',
  'doc_token_id': '[unused1]',
  'query_token': '[Q]',
  'doc_token': '[D]',
  'ncells': None,
  'centroid_score_threshold': None,
  'ndocs': None,
  'load_index_with_mmap': False,
  'index_path': None,
  'index_bsize': 32,
  'nbits': 4,
  'kmeans_niters': 20,
  'resume': False,
  'pool_factor': 1,
  'clustering_mode': 'hierarchical',
  'protected_tokens': 0,
  'similarity': 'cosine',
  'bsize': 64,
  'accumsteps': 1,
  'lr': 1e-05,
  'maxsteps': 15626,
  'save_every': None,
  'warmup': 781,
  'warmup_bert': None,
  'relu': False,
  'nway': 32,
  'use_ib_negatives': False,
  'reranker': False,
  'distillation_alpha': 1.0,
  'ignore_scores': False,
  'model_name': 'answerdotai/AnswerAI-ColBERTv2.5-small',
  'query_maxlen': 32,
  'attend_to_mask_tokens': False,
  'interaction': 'colbert',
  'dim': 96,
  'doc_maxlen': 256,
  'mask_punctuation': True,
  'checkpoint': 'answerdotai/answerai-colbert-small-v1',
  'triples': '/home/bclavie/colbertv2.5_en/data/msmarco/triplets.jsonl',
  'collection': ['list with 1000 elements starting with...',
   ['Overview',
    'You can only make a claim for Child Tax Credit if you already get Working Tax Credit.',
    'If you cannot apply for Child Tax Credit, you can apply for Universal Credit instead.']],
  'queries': '/home/bclavie/colbertv2.5_en/data/msmarco/queries.tsv',
  'index_name': 'ConditionalQA_RAGatouille_index_1k',
  'overwrite': False,
  'root': '.ragatouille/',
  'experiment': 'colbert',
  'index_root': None,
  'name': '2025-05/09/10.30.23',
  'rank': 0,
  'nranks': 1,
  'amp': True,
  'gpus': 1,
  'avoid_fork_if_possible': False},
 'num_chunks': 1,
 'num_partitions': 1024,
 'num_embeddings': 15198,
 'avg_doclen': 15.198,
 'RAGatouille': {'index_config': {'index_type': 'PLAID',
   'index_name': 'ConditionalQA_RAGatouille_index_1k'}}}</code></pre>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 32%">
<col style="width: 30%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Before Indexing</th>
<th>After Indexing</th>
<th>Impact</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>kmeans_niters</code></td>
<td>4</td>
<td>20</td>
<td>5× more iterations for clustering</td>
</tr>
<tr class="even">
<td><code>nbits</code></td>
<td>1</td>
<td>4</td>
<td>4× more bits for residual compression</td>
</tr>
<tr class="odd">
<td><code>bsize</code></td>
<td>32</td>
<td>64</td>
<td>Doubled batch size</td>
</tr>
<tr class="even">
<td><code>doc_maxlen</code></td>
<td>300</td>
<td>256</td>
<td>Reduced document length limit</td>
</tr>
<tr class="odd">
<td><code>nranks</code></td>
<td>4</td>
<td>1</td>
<td>Changed to single-process execution</td>
</tr>
<tr class="even">
<td><code>gpus</code></td>
<td>4</td>
<td>1</td>
<td>Changed to single-GPU execution</td>
</tr>
<tr class="odd">
<td><code>num_partitions</code></td>
<td>(not set)</td>
<td>1024</td>
<td>New parameter added during indexing</td>
</tr>
</tbody>
</table>
<p>The following are search parameters so they are not set/used for indexing: <code>ncells</code>, <code>centroid_score_threshold</code>, <code>ndocs</code>.</p>
</section>
<section id="create-vanilla-colbert-index-1k-subset" class="level2">
<h2 class="anchored" data-anchor-id="create-vanilla-colbert-index-1k-subset">Create Vanilla ColBERT Index (1k subset)</h2>
<p>Next, I’ll index the same document collection using vanilla ColBERT (which is installed with RAGatouille).</p>
<div id="296400ca-0c19-4227-8cf3-437fbb331bfb" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">dataset_name</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>'ConditionalQA'</code></pre>
</div>
</div>
<div id="d004e602-fdd7-4e3f-9615-7be2c6260c43" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">ColBERTConfig()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>ColBERTConfig(query_token_id='[unused0]', doc_token_id='[unused1]', query_token='[Q]', doc_token='[D]', ncells=None, centroid_score_threshold=None, ndocs=None, load_index_with_mmap=False, index_path=None, index_bsize=64, nbits=1, kmeans_niters=4, resume=False, pool_factor=1, clustering_mode='hierarchical', protected_tokens=0, similarity='cosine', bsize=32, accumsteps=1, lr=3e-06, maxsteps=500000, save_every=None, warmup=None, warmup_bert=None, relu=False, nway=2, use_ib_negatives=False, reranker=False, distillation_alpha=1.0, ignore_scores=False, model_name=None, query_maxlen=32, attend_to_mask_tokens=False, interaction='colbert', dim=128, doc_maxlen=220, mask_punctuation=True, checkpoint=None, triples=None, collection=None, queries=None, index_name=None, overwrite=False, root='/mnt/my4tb/vishal_data/SuperPassage/experiments', experiment='default', index_root=None, name='2025-05/09/10.30.23', rank=0, nranks=1, amp=True, gpus=1, avoid_fork_if_possible=False)</code></pre>
</div>
</div>
<p>Key differences from this initial config and RAGatouille’s post-indexing metadata:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Parameter</th>
<th style="text-align: center;">RAGatouille value</th>
<th style="text-align: center;">ColBERT value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><code>kmeans_iter</code></td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>nbits</code></td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>dim</code></td>
<td style="text-align: center;">96</td>
<td style="text-align: center;">128</td>
</tr>
<tr class="even">
<td style="text-align: center;"><code>doc_maxlen</code></td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">220</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><code>index_bsize</code></td>
<td style="text-align: center;">32</td>
<td style="text-align: center;">64</td>
</tr>
</tbody>
</table>
<p>I will set these explicitly in the ColBERTConfig before indexing.</p>
<div id="5d882d9f-6153-42ea-bb58-834830079f55" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">n_items</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<pre><code>1000</code></pre>
</div>
</div>
<p>The following environmental variable needs to be set otherwise the script won’t run.</p>
<div id="2e43ce9d-9990-47fd-a56d-8d9a8501fa96" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MKL_SERVICE_FORCE_INTEL"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span></span></code></pre></div>
</div>
<div id="ec8269b2-1777-4a18-83b7-df9491ac94db" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!rm -rf /mnt/my4tb/vishal_data/SuperPassage/.ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_1k</span></span></code></pre></div>
</div>
<div id="feea96b5-ff50-46ea-be80-141b76536c77" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb26-2">    config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ColBERTConfig(</span>
<span id="cb26-3">        doc_maxlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,      </span>
<span id="cb26-4">        nbits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,             </span>
<span id="cb26-5">        dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>,             </span>
<span id="cb26-6">        kmeans_niters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>,</span>
<span id="cb26-7">        index_bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb26-8">        bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,</span>
<span id="cb26-9">        checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>,</span>
<span id="cb26-10">    )</span>
<span id="cb26-11">    </span>
<span id="cb26-12">    indexer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Indexer(checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>, config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config)</span>
<span id="cb26-13">    indexer.index(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_ColBERT_index_1k"</span>, collection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[:n_items][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>])</span></code></pre></div>
</div>
<div id="077cda6a-2093-4c3a-8083-471eb47eebf3" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">ColBERT_index_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_1k"</span></span></code></pre></div>
</div>
<p>The ColBERT index is a tiny bit smaller than RAGatouille, likely because it doesn’t store the collection as a JSON file and doesn’t store pid to docid map as a JSON file (which RAGatouille does—something we’ll encounter later on during search).</p>
<div id="2316914c-3da7-42a3-9a69-4369aae484df" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>du <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sh {ColBERT_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.1M    .ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_1k</code></pre>
</div>
</div>
<div id="7d95b7ff-1c24-439e-83ce-e281ea34f102" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>ls {ColBERT_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.codes.pt   0.residuals.pt   buckets.pt    doclens.0.json  metadata.json
0.metadata.json  avg_residual.pt  centroids.pt  ivf.pid.pt  plan.json</code></pre>
</div>
</div>
<div id="2bcf5fc6-f471-4c6f-a6b3-36b10ae2e973" class="cell" data-scrolled="true" data-execution_count="170">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb32-2">    ColBERT_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span>
<span id="cb32-3">ColBERT_metadata</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>{'config': {'query_token_id': '[unused0]',
  'doc_token_id': '[unused1]',
  'query_token': '[Q]',
  'doc_token': '[D]',
  'ncells': None,
  'centroid_score_threshold': None,
  'ndocs': None,
  'load_index_with_mmap': False,
  'index_path': None,
  'index_bsize': 32,
  'nbits': 4,
  'kmeans_niters': 20,
  'resume': False,
  'pool_factor': 1,
  'clustering_mode': 'hierarchical',
  'protected_tokens': 0,
  'similarity': 'cosine',
  'bsize': 64,
  'accumsteps': 1,
  'lr': 1e-05,
  'maxsteps': 15626,
  'save_every': None,
  'warmup': 781,
  'warmup_bert': None,
  'relu': False,
  'nway': 32,
  'use_ib_negatives': False,
  'reranker': False,
  'distillation_alpha': 1.0,
  'ignore_scores': False,
  'model_name': 'answerdotai/AnswerAI-ColBERTv2.5-small',
  'query_maxlen': 32,
  'attend_to_mask_tokens': False,
  'interaction': 'colbert',
  'dim': 96,
  'doc_maxlen': 256,
  'mask_punctuation': True,
  'checkpoint': 'answerdotai/answerai-colbert-small-v1',
  'triples': '/home/bclavie/colbertv2.5_en/data/msmarco/triplets.jsonl',
  'collection': ['list with 1000 elements starting with...',
   ['Overview',
    'You can only make a claim for Child Tax Credit if you already get Working Tax Credit.',
    'If you cannot apply for Child Tax Credit, you can apply for Universal Credit instead.']],
  'queries': '/home/bclavie/colbertv2.5_en/data/msmarco/queries.tsv',
  'index_name': 'ConditionalQA_ColBERT_index_1k',
  'overwrite': False,
  'root': '.ragatouille/',
  'experiment': 'colbert',
  'index_root': None,
  'name': '2025-05/09/10.30.23',
  'rank': 0,
  'nranks': 1,
  'amp': True,
  'gpus': 1,
  'avoid_fork_if_possible': False},
 'num_chunks': 1,
 'num_partitions': 1024,
 'num_embeddings': 15198,
 'avg_doclen': 15.198}</code></pre>
</div>
</div>
</section>
<section id="comparing-1k-subset-index-artifacts" class="level2">
<h2 class="anchored" data-anchor-id="comparing-1k-subset-index-artifacts">Comparing 1k subset Index Artifacts</h2>
<p>RAGatouille files:</p>
<ul>
<li>0.codes.pt<br>
</li>
<li>0.residuals.pt</li>
<li>buckets.pt<br>
</li>
<li>doclens.0.json</li>
<li>metadata.json</li>
<li>0.metadata.json</li>
<li>avg_residual.pt</li>
<li>centroids.pt</li>
<li>ivf.pid.pt</li>
<li>plan.json</li>
<li>collection.json (unique to RAGatouille)</li>
<li>pid_docid_map.json (unique to RAGatouille)</li>
</ul>
<p>ColBERT files:</p>
<ul>
<li>0.codes.pt</li>
<li>0.residuals.pt</li>
<li>buckets.pt</li>
<li>doclens.0.json</li>
<li>metadata.json</li>
<li>0.metadata.json</li>
<li>avg_residual.pt</li>
<li>centroids.pt<br>
</li>
<li>ivf.pid.pt<br>
</li>
<li>plan.json</li>
</ul>
<p>All parameters relevant to indexing are matching in the corresponding metadata.json files:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Parameter</th>
<th style="text-align: left;">Value</th>
<th style="text-align: center;">Status</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>index_bsize</code></td>
<td style="text-align: left;">32</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>nbits</code></td>
<td style="text-align: left;">4</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>kmeans_niters</code></td>
<td style="text-align: left;">20</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>dim</code></td>
<td style="text-align: left;">96</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>doc_maxlen</code></td>
<td style="text-align: left;">256</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>num_partitions</code></td>
<td style="text-align: left;">1024</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>num_embeddings</code></td>
<td style="text-align: left;">15198</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>avg_doclen</code></td>
<td style="text-align: left;">15.198</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>checkpoint</code></td>
<td style="text-align: left;">‘answerdotai/answerai-colbert-small-v1’</td>
<td style="text-align: center;">✅ Matches</td>
</tr>
</tbody>
</table>
<p>Walking through each file and comparing contents:</p>
<div id="5d14b941-de6f-4326-b610-89796907e18a" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _compare_pt(r_path, c_path):</span>
<span id="cb34-2">    r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(r_path)</span>
<span id="cb34-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(c_path)</span>
<span id="cb34-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(r,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>):</span>
<span id="cb34-5">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 shape:"</span>, r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape, c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape)</span>
<span id="cb34-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb34-7">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb34-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 match: "</span>, (r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean())</span>
<span id="cb34-10">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-11">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#'</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb34-12">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-13">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 shape:"</span>, r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape, c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].shape)</span>
<span id="cb34-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb34-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb34-16">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-17">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1 match: "</span>, (r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean())</span>
<span id="cb34-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb34-19">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(r)</span>
<span id="cb34-20">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-21">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(c)</span>
<span id="cb34-22">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-23">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(r.shape, c.shape)</span>
<span id="cb34-24">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb34-25">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"match: "</span>,(r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean())</span></code></pre></div>
</div>
<section id="codes.pt" class="level3">
<h3 class="anchored" data-anchor-id="codes.pt">0.codes.pt</h3>
<div id="d43ca0a1-a161-4be2-94fb-9de4cedf59fd" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/0.codes.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/0.codes.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([345, 288, 647,  ..., 232, 767,  29], dtype=torch.int32)


tensor([345, 288, 647,  ..., 232, 767,  29], dtype=torch.int32)


torch.Size([15198]) torch.Size([15198])


match:  tensor(1.)</code></pre>
</div>
</div>
</section>
<section id="residuals.pt" class="level3">
<h3 class="anchored" data-anchor-id="residuals.pt">0.residuals.pt</h3>
<div id="296fb874-a6be-4bb1-87ec-fc34cc0a2bc5" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/0.residuals.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/0.residuals.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[ 30, 225, 225,  ..., 238, 238,  30],
        [238, 238, 238,  ..., 238, 238, 238],
        [240, 254, 253,  ..., 175, 240, 128],
        ...,
        [ 99, 105, 231,  ...,  40,  95,  48],
        [ 85, 241,  87,  ..., 128,   8, 179],
        [ 89, 106, 150,  ..., 162, 238,  22]], dtype=torch.uint8)


tensor([[ 30, 225, 225,  ..., 238, 238,  30],
        [238, 238, 238,  ..., 238, 238, 238],
        [240, 254, 253,  ..., 175, 240, 128],
        ...,
        [ 99, 105, 231,  ...,  40,  95,  48],
        [ 85, 241,  87,  ..., 128,   8, 179],
        [ 89, 106, 150,  ..., 162, 238,  22]], dtype=torch.uint8)


torch.Size([15198, 48]) torch.Size([15198, 48])


match:  tensor(1.)</code></pre>
</div>
</div>
</section>
<section id="centroids.pt" class="level3">
<h3 class="anchored" data-anchor-id="centroids.pt">centroids.pt</h3>
<div id="8726c303-0691-4bc2-92b9-7bc391129273" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/centroids.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/centroids.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor([[-0.0701,  0.0035, -0.0785,  ...,  0.1628,  0.0201, -0.0419],
        [-0.0350, -0.0082, -0.0715,  ...,  0.1119, -0.0159, -0.1164],
        [-0.0753,  0.0172, -0.0513,  ...,  0.1070,  0.1476, -0.0699],
        ...,
        [-0.1425,  0.1393, -0.2316,  ...,  0.0169,  0.0897, -0.0431],
        [-0.0690,  0.0513, -0.0935,  ...,  0.1311,  0.0324, -0.0705],
        [-0.0812,  0.0511, -0.0482,  ...,  0.1010,  0.0365, -0.0582]],
       device='cuda:0', dtype=torch.float16)


tensor([[-0.0701,  0.0035, -0.0785,  ...,  0.1628,  0.0201, -0.0419],
        [-0.0350, -0.0082, -0.0715,  ...,  0.1119, -0.0159, -0.1164],
        [-0.0753,  0.0172, -0.0513,  ...,  0.1070,  0.1476, -0.0699],
        ...,
        [-0.1425,  0.1393, -0.2316,  ...,  0.0169,  0.0897, -0.0431],
        [-0.0690,  0.0513, -0.0935,  ...,  0.1311,  0.0324, -0.0705],
        [-0.0812,  0.0511, -0.0482,  ...,  0.1010,  0.0365, -0.0582]],
       device='cuda:0', dtype=torch.float16)


torch.Size([1024, 96]) torch.Size([1024, 96])


match:  tensor(1., device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="ivf.pid.pt" class="level3">
<h3 class="anchored" data-anchor-id="ivf.pid.pt">ivf.pid.pt</h3>
<div id="d67ac41f-cbd5-42f1-a6cf-5fdad9c84381" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/ivf.pid.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/ivf.pid.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 shape: torch.Size([11696]) torch.Size([11696])
tensor([889, 894, 916,  ...,   0,   0,   0], dtype=torch.int32)
tensor([889, 894, 916,  ...,   0,   0,   0], dtype=torch.int32)


0 match:  tensor(1.)


##############################


1 shape: torch.Size([1024]) torch.Size([1024])
tensor([ 5, 46, 16,  ...,  7, 11,  3])
tensor([ 5, 46, 16,  ...,  7, 11,  3])


1 match:  tensor(1.)</code></pre>
</div>
</div>
</section>
<section id="buckets.pt" class="level3">
<h3 class="anchored" data-anchor-id="buckets.pt">buckets.pt</h3>
<div id="c324e81e-d261-40c9-87aa-acc68ba64f5d" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/buckets.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/buckets.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 shape: torch.Size([15]) torch.Size([15])
tensor([-0.0310, -0.0208, -0.0148, -0.0101, -0.0065, -0.0037, -0.0015,  0.0000,
         0.0016,  0.0037,  0.0067,  0.0103,  0.0150,  0.0210,  0.0312],
       device='cuda:0')
tensor([-0.0310, -0.0208, -0.0148, -0.0101, -0.0065, -0.0037, -0.0015,  0.0000,
         0.0016,  0.0037,  0.0067,  0.0103,  0.0150,  0.0210,  0.0312],
       device='cuda:0')


0 match:  tensor(1., device='cuda:0')


##############################


1 shape: torch.Size([16]) torch.Size([16])
tensor([-0.0417, -0.0248, -0.0175, -0.0123, -0.0082, -0.0050, -0.0025, -0.0006,
         0.0007,  0.0026,  0.0051,  0.0084,  0.0125,  0.0178,  0.0251,  0.0417],
       device='cuda:0', dtype=torch.float16)
tensor([-0.0417, -0.0248, -0.0175, -0.0123, -0.0082, -0.0050, -0.0025, -0.0006,
         0.0007,  0.0026,  0.0051,  0.0084,  0.0125,  0.0178,  0.0251,  0.0417],
       device='cuda:0', dtype=torch.float16)


1 match:  tensor(1., device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="avg_residual.pt" class="level3">
<h3 class="anchored" data-anchor-id="avg_residual.pt">avg_residual.pt</h3>
<div id="cd32d8f9-e2bf-4fa7-8950-9082666ccf65" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1">_compare_pt(r_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/avg_residual.pt"</span>, c_path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/avg_residual.pt"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tensor(0.0150, device='cuda:0', dtype=torch.float16)


tensor(0.0150, device='cuda:0', dtype=torch.float16)


torch.Size([]) torch.Size([])


match:  tensor(1., device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="doclens.0.json" class="level3">
<h3 class="anchored" data-anchor-id="doclens.0.json">doclens.0.json</h3>
<div id="c6eabd97-125b-4502-b30a-42d4b7099fbe" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/doclens.0.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb47-2">    RAGatouille_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span>
<span id="cb47-3">RAGatouille_doclens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">
<pre><code>[4, 20, 18, 23, 8]</code></pre>
</div>
</div>
<div id="1e491dce-39c9-4a5b-85f3-32ed4c422cbc" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/doclens.0.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb49-2">    ColBERT_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span>
<span id="cb49-3">ColBERT_doclens[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">
<pre><code>[4, 20, 18, 23, 8]</code></pre>
</div>
</div>
<div id="26d9b761-9880-4a0d-a47b-125b8c3b70b7" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1">RAGatouille_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ColBERT_doclens</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre><code>True</code></pre>
</div>
</div>
<p>Based on these comparisons, I can conclude that ColBERT and RAGatouille do indeed produce identical index artifacts given the same configuration and document collection!</p>
</section>
</section>
<section id="indexing-full-conditionalqa-comparing-artifacts" class="level2">
<h2 class="anchored" data-anchor-id="indexing-full-conditionalqa-comparing-artifacts">Indexing Full ConditionalQA + Comparing Artifacts</h2>
<p>With a 1k subset confirmed, I’ll now index the full ConditionalQA document collection, which contains ~70k rows.</p>
<div id="4dc307f2-934b-48ee-aaf7-6fb84a82519f" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb53" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1">dataset_name</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="183">
<pre><code>'ConditionalQA'</code></pre>
</div>
</div>
<div id="3d60f235-9a3f-416d-b076-2931efe2797d" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(passages)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>69199</code></pre>
</div>
</div>
<div id="99595696-05bf-43df-a9b4-8e25f97a8c75" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1">RAG <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAGPretrainedModel.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>)</span>
<span id="cb57-2">RAG_index_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAG.index(</span>
<span id="cb57-3">    index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_RAGatouille_index_full"</span>,</span>
<span id="cb57-4">    collection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>],</span>
<span id="cb57-5">    document_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_id"</span>],</span>
<span id="cb57-6">    use_faiss<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to match ColBERT</span></span>
<span id="cb57-7">)</span></code></pre></div>
</div>
<div id="a57481c3-aca3-4dff-ae93-a4e701bc40d7" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>du <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sh {RAG_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>45M .ragatouille/colbert/indexes/ConditionalQA_RAGatouille_index_full</code></pre>
</div>
</div>
<div id="c4d11b3b-616b-4cba-bfab-2bf744265c45" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>ls {RAG_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.codes.pt   1.residuals.pt   buckets.pt       doclens.2.json
0.metadata.json  2.codes.pt   centroids.pt     ivf.pid.pt
0.residuals.pt   2.metadata.json  collection.json  metadata.json
1.codes.pt   2.residuals.pt   doclens.0.json   pid_docid_map.json
1.metadata.json  avg_residual.pt  doclens.1.json   plan.json</code></pre>
</div>
</div>
<div id="4f5385d8-c03e-4ad2-8a00-3508ad730564" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#!rm -rf .ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_full</span></span></code></pre></div>
</div>
<div id="cfbe7e0c-c4b4-4651-a1ea-28aa9fe7e23d" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1">os.environ[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MKL_SERVICE_FORCE_INTEL"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span></span>
<span id="cb63-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb63-3">    config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ColBERTConfig(</span>
<span id="cb63-4">        doc_maxlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,      </span>
<span id="cb63-5">        nbits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to match RAGatouille           </span></span>
<span id="cb63-6">        dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">96</span>,             </span>
<span id="cb63-7">        kmeans_niters<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># to match RAGatouille</span></span>
<span id="cb63-8">        index_bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>,</span>
<span id="cb63-9">        bsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,</span>
<span id="cb63-10">        checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>,</span>
<span id="cb63-11">    )</span>
<span id="cb63-12">    </span>
<span id="cb63-13">    indexer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Indexer(checkpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answerdotai/answerai-colbert-small-v1"</span>, config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>config)</span>
<span id="cb63-14">    indexer.index(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>dataset_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">_ColBERT_index_full"</span>, collection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>passages[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>])</span></code></pre></div>
</div>
<div id="a79f8069-0215-4b0b-a7f4-a27e6ae63416" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1">ColBERT_index_path <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_full"</span></span></code></pre></div>
</div>
<div id="4cc1acdd-2a9d-464f-afea-c457f000142f" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>du <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>sh {ColBERT_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>38M .ragatouille/colbert/indexes/ConditionalQA_ColBERT_index_full</code></pre>
</div>
</div>
<div id="3a19a735-3308-464c-bdb2-eeccce195c08" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb67" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>ls {ColBERT_index_path}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.codes.pt   1.residuals.pt   buckets.pt      ivf.pid.pt
0.metadata.json  2.codes.pt   centroids.pt    metadata.json
0.residuals.pt   2.metadata.json  doclens.0.json  plan.json
1.codes.pt   2.residuals.pt   doclens.1.json
1.metadata.json  avg_residual.pt  doclens.2.json</code></pre>
</div>
</div>
<section id="comparing-metadata" class="level3">
<h3 class="anchored" data-anchor-id="comparing-metadata">Comparing Metadata</h3>
<p>All key metadata parameters are equivalent between the RAGatouille and ColBERT indexes.</p>
<div id="fcb215de-50c1-48a6-b8a5-4018a15ea098" class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1">params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"index_bsize"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nbits"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kmeans_niters"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bsize"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dim"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rank"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpus"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nranks"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_chunks"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_partitions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_embeddings"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span>]</span></code></pre></div>
</div>
<div id="837e2100-78f5-4d18-920b-34029fa491c2" class="cell" data-scrolled="true" data-execution_count="222">
<div class="sourceCode cell-code" id="cb70" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb70-2">    RAG_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span></code></pre></div>
</div>
<div id="04f07e6a-f065-4237-8e01-f73be27cca39" class="cell" data-scrolled="true" data-execution_count="223">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/metadata.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb71-2">    ColBERT_metadata <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span></code></pre></div>
</div>
<div id="c0a7cb0b-891a-453d-ab06-411a7e32c4d0" class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb72" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> params: </span>
<span id="cb72-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_chunks"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_partitions"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"num_embeddings"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span>]: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> RAG_metadata[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'config'</span>][p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ColBERT_metadata[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'config'</span>][p], p</span>
<span id="cb72-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_doclen"</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (RAG_metadata[p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ColBERT_metadata[p]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span></span>
<span id="cb72-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>: <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> RAG_metadata[p] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ColBERT_metadata[p], p</span></code></pre></div>
</div>
</section>
<section id="comparing-index-artifacts" class="level3">
<h3 class="anchored" data-anchor-id="comparing-index-artifacts">Comparing Index Artifacts</h3>
<div id="731a8a9f-5450-4e9a-a862-0a9465d11318" class="cell" data-execution_count="236">
<div class="sourceCode cell-code" id="cb73" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _compare_pt(r_path, c_path):</span>
<span id="cb73-2">    r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(r_path)</span>
<span id="cb73-3">    c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.load(c_path)</span>
<span id="cb73-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">isinstance</span>(r,<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>):</span>
<span id="cb73-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape</span>
<span id="cb73-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb73-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb73-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb73-9">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> r.shape <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c.shape</span>
<span id="cb73-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> (r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> c).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
</div>
<div id="7646a39f-af14-4621-a219-2c295215a2ef" class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb74" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1">files <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb74-2">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.codes.pt"</span>,</span>
<span id="cb74-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.residuals.pt"</span>,</span>
<span id="cb74-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"centroids.pt"</span>,</span>
<span id="cb74-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ivf.pid.pt"</span>,</span>
<span id="cb74-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"buckets.pt"</span>,</span>
<span id="cb74-7">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"avg_residual.pt"</span>,</span>
<span id="cb74-8">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"doclens.0.json"</span></span>
<span id="cb74-9">]</span></code></pre></div>
</div>
<div id="cf2cd589-f586-4e51-8cba-39bba101858d" class="cell" data-execution_count="241">
<div class="sourceCode cell-code" id="cb75" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> f <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> files:</span>
<span id="cb75-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> f <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"doclens.0.json"</span>: </span>
<span id="cb75-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> _f: RAG_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(_f)</span>
<span id="cb75-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> _f: ColBERT_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(_f)</span>
<span id="cb75-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> RAG_doclens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> ColBERT_doclens</span>
<span id="cb75-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>: _compare_pt(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>f<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</div>
<p>All index artifacts are equivalent! This further confirms the equivalency of the indexes created by RAGatouille and ColBERT.</p>
</section>
</section>
<section id="comparing-search-results" class="level2">
<h2 class="anchored" data-anchor-id="comparing-search-results">Comparing Search Results</h2>
<p>To reset, I had started this exploration with two questions:</p>
<ol type="1">
<li>For a given document collection and indexing configuration, do RAGatouille and ColBERT produce the same index?</li>
<li>For a given index and search configuration, do RAGatouille and ColBERT retrieve the same passages/Recall@10?</li>
</ol>
<p>The answer to the first question is YES. Let’s move on to answering the second question, starting by searching the RAGatouille index with RAGatouille.</p>
<section id="searching-ragatouille-index-with-ragatouille" class="level3">
<h3 class="anchored" data-anchor-id="searching-ragatouille-index-with-ragatouille">Searching RAGatouille Index with RAGatouille</h3>
<p>I will explicitly set search parameters for RAGatouille, even though they get set based on document collection size in <a href="https://github.com/AnswerDotAI/RAGatouille/blob/2bd4d2ed01c847854be78704a012f9ab35d679b2/ragatouille/models/index.py#L266"><code>PLAIDModelIndex._load_searcher</code></a>:</p>
<div class="sourceCode" id="cb76" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> force_fast:</span>
<span id="cb76-2">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ndocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>)</span>
<span id="cb76-3">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>)</span>
<span id="cb76-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.collection) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>:</span>
<span id="cb76-5">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb76-6">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>)</span>
<span id="cb76-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.collection) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>:</span>
<span id="cb76-8">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)</span>
<span id="cb76-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>)</span>
<span id="cb76-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Otherwise, use defaults for k</span></span>
<span id="cb76-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb76-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use fast settingss</span></span>
<span id="cb76-13">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb76-14">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb76-15">    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.searcher.configure(ndocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>)</span></code></pre></div>
<div id="d22e109f-942a-4e54-94f2-dadd431d976b" class="cell" data-execution_count="244">
<div class="sourceCode cell-code" id="cb77" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1">RAG.model.config.ncells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb77-2">RAG.model.config.centroid_score_threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span></span>
<span id="cb77-3">RAG.model.config.ndocs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb77-4">RAG.model.config</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="244">
<pre><code>ColBERTConfig(query_token_id='[unused0]', doc_token_id='[unused1]', query_token='[Q]', doc_token='[D]', ncells=4, centroid_score_threshold=0.45, ndocs=1024, load_index_with_mmap=False, index_path=None, index_bsize=32, nbits=2, kmeans_niters=10, resume=False, pool_factor=1, clustering_mode='hierarchical', protected_tokens=0, similarity='cosine', bsize=32, accumsteps=1, lr=1e-05, maxsteps=15626, save_every=None, warmup=781, warmup_bert=None, relu=False, nway=32, use_ib_negatives=False, reranker=False, distillation_alpha=1.0, ignore_scores=False, model_name='answerdotai/AnswerAI-ColBERTv2.5-small', query_maxlen=32, attend_to_mask_tokens=False, interaction='colbert', dim=96, doc_maxlen=256, mask_punctuation=True, checkpoint='/home/vishal/.cache/huggingface/hub/models--answerdotai--answerai-colbert-small-v1/snapshots/be1703c55532145a844da800eea4c9a692d7e267/', triples='/home/bclavie/colbertv2.5_en/data/msmarco/triplets.jsonl', collection='/home/bclavie/colbertv2.5_en/data/msmarco/collection.tsv', queries='/home/bclavie/colbertv2.5_en/data/msmarco/queries.tsv', index_name=None, overwrite=False, root='.ragatouille/colbert/indexes', experiment='colbert', index_root=None, name='2024-08/07/08.16.20', rank=0, nranks=4, amp=True, gpus=4, avoid_fork_if_possible=True)</code></pre>
</div>
</div>
<div id="bc3ddcbb-d5e5-4d49-b77f-44698d2c5d8d" class="cell" data-execution_count="422">
<div class="sourceCode cell-code" id="cb79" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1">ragatouille_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span></code></pre></div>
</div>
<div id="df4f1f89-68b6-46e9-857b-b305f83a1eeb" class="cell" data-scrolled="true" data-execution_count="423">
<div class="sourceCode cell-code" id="cb80" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries:</span>
<span id="cb80-2">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAG.search(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>], k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb80-3">    ragatouille_results[q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'document_id'</span>]: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'score'</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> result <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> results}</span></code></pre></div>
</div>
<div id="1497a78d-aeb9-4945-9383-3c70166317c4" class="cell" data-execution_count="424">
<div class="sourceCode cell-code" id="cb81" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1">ragatouille_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dev-0'</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="424">
<pre><code>{'107-242': 69.9375,
 '496-116': 69.9375,
 '86-28': 69.875,
 '254-4': 69.875,
 '107-103': 69.875,
 '8-67': 69.8125,
 '98-46': 69.8125,
 '8-80': 69.8125,
 '8-116': 69.8125,
 '107-43': 69.8125}</code></pre>
</div>
</div>
<p>The mean Recall@10 for all 271 queries is 0.29.</p>
<div id="8d1c4e70-fe30-4dc3-8781-cb82ecc398a2" class="cell" data-execution_count="429">
<div class="sourceCode cell-code" id="cb83" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1">qrels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb83-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qrel_row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> qrels_rows:</span>
<span id="cb83-3">    qid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]</span>
<span id="cb83-4">    pid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"corpus_id"</span>]</span>
<span id="cb83-5">    rel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> qrel_row[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"score"</span>]</span>
<span id="cb83-6">    qrels.setdefault(qid, {})</span>
<span id="cb83-7">    qrels[qid][pid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rel</span></code></pre></div>
</div>
<div id="6c4c4442-843d-4d71-90a1-9e61c689a6bc" class="cell" data-execution_count="430">
<div class="sourceCode cell-code" id="cb84" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1">evaluator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pytrec_eval.RelevanceEvaluator(qrels, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall.10'</span>})</span>
<span id="cb84-2">metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> evaluator.evaluate(ragatouille_results)</span>
<span id="cb84-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(qrels_rows[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]))</span>
<span id="cb84-4"></span>
<span id="cb84-5">mean_recall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(metrics[qid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall_10'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> metrics.keys()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics)</span>
<span id="cb84-6">mean_recall</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="430">
<pre><code>0.2855810510889169</code></pre>
</div>
</div>
</section>
<section id="searching-the-colbert-index-with-colbert" class="level3">
<h3 class="anchored" data-anchor-id="searching-the-colbert-index-with-colbert">Searching the ColBERT Index with ColBERT</h3>
<p>Next, I’ll search the ColBERT index with ColBERT, setting the same configuration values as RAGatouille.</p>
<div id="fc99ef77-2343-4799-bdd7-02d3e33cbf4b" class="cell" data-execution_count="297">
<div class="sourceCode cell-code" id="cb86" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1">RAG.model.config.ncells, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb86-2">RAG.model.config.centroid_score_threshold, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb86-3">RAG.model.config.ndocs</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="297">
<pre><code>(4, 0.45, 1024)</code></pre>
</div>
</div>
<p>ColBERT expects the queries to be structured as a dictionary, so I’ll prepare that accordingly:</p>
<div id="2542ecd0-31d4-41c2-8e66-b8ea11e70327" class="cell" data-execution_count="425">
<div class="sourceCode cell-code" id="cb88" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1">queries_dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb88-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> item <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries:</span>
<span id="cb88-3">    queries_dict[item[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> item[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>]</span>
<span id="cb88-4"></span>
<span id="cb88-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(queries_dict)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="425">
<pre><code>271</code></pre>
</div>
</div>
<p>I was posting on Twitter about how I wasn’t getting the same search results when using RAGatouille and vanilla ColBERT given the same index. <a href="https://ben.clavie.eu/">Benjamin Clavie</a>, the author of RAGatouille, kindly took some time to explain a core difference in how RAGatouille and ColBERT process queries:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
Oh that'll be because ragatouille has a policy to never truncate queries so it updates the querylen to be <em>at least</em> the actual query length (further tests show it should be querylen + 8 at least, to get better augmentation). Your colbert (stanford) config is truncating to 32…
</p>
— Ben Clavié (<span class="citation" data-cites="bclavie">@bclavie</span>) <a href="https://twitter.com/bclavie/status/1921056639739678751?ref_src=twsrc%5Etfw">May 10, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>As was shared in his tweet, <a href="https://github.com/AnswerDotAI/RAGatouille/blob/2bd4d2ed01c847854be78704a012f9ab35d679b2/ragatouille/models/index.py#L298">RAGatouille uses a larger maximum query length than ColBERT</a>. ColBERT uses a default of 32. So to replicate the same scores (and therefore the same top-k retrieved passages) I needed to mimic RAGatouille’s query length maximum.</p>
<p>Note that ColBERT doesn’t store original passage <code>_id</code>s like RAGatouille does, so I have to extract it from the original <code>passages</code> with <code>passages[idx]['_id']</code>.</p>
<div id="20797fcf-3979-4b77-ab09-cf0f63a949fc" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb90" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1">current_dir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.abspath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>)</span>
<span id="cb90-2">index_root <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(current_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".ragatouille"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"colbert"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indexes"</span>)</span>
<span id="cb90-3">colbert_results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb90-4"></span>
<span id="cb90-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries:</span>
<span id="cb90-6">    query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>].split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.35</span>) <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># this lines comes from RAGatouille</span></span>
<span id="cb90-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb90-8">        searcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Searcher(</span>
<span id="cb90-9">            index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ConditionalQA_ColBERT_index_full"</span>,</span>
<span id="cb90-10">            index_root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index_root,  </span>
<span id="cb90-11">            config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ColBERTConfig(</span>
<span id="cb90-12">                ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb90-13">                centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>,</span>
<span id="cb90-14">                ndocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,</span>
<span id="cb90-15">                query_maxlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>query_length</span>
<span id="cb90-16">            )</span>
<span id="cb90-17">        )</span>
<span id="cb90-18">    </span>
<span id="cb90-19">        ranking <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> searcher.search(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>], k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb90-20">        colbert_results[q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {passages[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]: score <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ranking[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], ranking[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))}</span></code></pre></div>
</div>
<div id="0c4c0a50-30c7-474d-8f89-c166c8908512" class="cell" data-execution_count="427">
<div class="sourceCode cell-code" id="cb91" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1">evaluator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pytrec_eval.RelevanceEvaluator(qrels, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall.10'</span>})</span>
<span id="cb91-2">metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> evaluator.evaluate(colbert_results)</span>
<span id="cb91-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(qrels_rows[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]))</span>
<span id="cb91-4"></span>
<span id="cb91-5">mean_recall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(metrics[qid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall_10'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> metrics.keys()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics)</span>
<span id="cb91-6">mean_recall</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="427">
<pre><code>0.2855810510889169</code></pre>
</div>
</div>
<p>With the maximum query length adjusted, ColBERT yields the same Recall@10 as RAGatouille! This makes sense because as Benjamin said in another tweet reply:</p>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
It's most likely down to the default search settings in ragatouille being a bit more aggressive, so you end up with better results. If you change ncells/score_thresh/ndocs to more aggressive values I reckon the colbert library would match it? All ragatouille does under the hood is wrap things with strong defaults/abstractions 😄
</p>
— Ben Clavié (<span class="citation" data-cites="bclavie">@bclavie</span>) <a href="https://twitter.com/bclavie/status/1921052397314732447?ref_src=twsrc%5Etfw">May 10, 2025</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>While the exact same recall is a good check, I’ll double check that for each query, the retrieved passage IDs and scores are identical between RAGatouille and ColBERT.</p>
<div id="e3ea66a7-7c8a-4b39-b199-e8a9412484e3" class="cell" data-execution_count="428">
<div class="sourceCode cell-code" id="cb93" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results.keys():</span>
<span id="cb93-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pid, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results[i].items():</span>
<span id="cb93-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> ragatouille_results[i][pid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> score</span></code></pre></div>
</div>
</section>
<section id="searching-ragatouille-index-with-colbert-and-vice-versa" class="level3">
<h3 class="anchored" data-anchor-id="searching-ragatouille-index-with-colbert-and-vice-versa">Searching RAGatouille Index with ColBERT (and vice versa)</h3>
<p>As a final check of consistency, I’ll search the RAGatouille index with ColBERT and search the ColBERT index with RAGatouille and confirm that they yield the same retrieved passages and Recall@10.</p>
<div id="29b4c47d-7f20-405b-a974-34d4830a74f9" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb94" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1">current_dir <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.abspath(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"."</span>)</span>
<span id="cb94-2">index_root <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.path.join(current_dir, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".ragatouille"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"colbert"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"indexes"</span>)</span>
<span id="cb94-3">colbert_results2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb94-4"></span>
<span id="cb94-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries:</span>
<span id="cb94-6">    query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>].split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.35</span>)</span>
<span id="cb94-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> Run().context(RunConfig(nranks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb94-8">        searcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Searcher(</span>
<span id="cb94-9">            index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ConditionalQA_RAGatouille_index_full"</span>,</span>
<span id="cb94-10">            index_root<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>index_root,  </span>
<span id="cb94-11">            config<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ColBERTConfig(</span>
<span id="cb94-12">                ncells<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb94-13">                centroid_score_threshold<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span>,</span>
<span id="cb94-14">                ndocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,</span>
<span id="cb94-15">                query_maxlen<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>query_length</span>
<span id="cb94-16">            )</span>
<span id="cb94-17">        )</span>
<span id="cb94-18">    </span>
<span id="cb94-19">        ranking <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> searcher.search(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>], k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb94-20">        colbert_results2[q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {passages[idx][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]: score <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> idx, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(ranking[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], ranking[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]))}</span></code></pre></div>
</div>
<p>We get the same results as searching the ColBERT index with ColBERT! This again further proves that these two frameworks produce the same indexes (which is to be expected).</p>
<div id="6863e54c-d5aa-41c2-82c9-9686a3d4f187" class="cell" data-execution_count="432">
<div class="sourceCode cell-code" id="cb95" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results.keys():</span>
<span id="cb95-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pid, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results[i].items():</span>
<span id="cb95-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> colbert_results2[i][pid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> score</span></code></pre></div>
</div>
<div id="23ccaf41-c28a-437b-98f0-4154e95770fb" class="cell" data-execution_count="433">
<div class="sourceCode cell-code" id="cb96" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1">evaluator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pytrec_eval.RelevanceEvaluator(qrels, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall.10'</span>})</span>
<span id="cb96-2">metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> evaluator.evaluate(colbert_results2)</span>
<span id="cb96-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(qrels_rows[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]))</span>
<span id="cb96-4"></span>
<span id="cb96-5">mean_recall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(metrics[qid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall_10'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> metrics.keys()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics)</span>
<span id="cb96-6">mean_recall</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="433">
<pre><code>0.2855810510889169</code></pre>
</div>
</div>
<p>Finally, as the last piece of this exercise, I’ll search the ColBERT index with RAGatouille and see if I get the same result. I certainly expect to!</p>
</section>
<section id="searching-colbert-index-with-ragatouille" class="level3">
<h3 class="anchored" data-anchor-id="searching-colbert-index-with-ragatouille">Searching ColBERT Index with RAGatouille</h3>
<p>RAGatouille creates two files (collection.json and pid_docid_map.json) which ColBERT does not, so we have to create them manually for RAGatouille to search the ColBERT Index.</p>
<p>collection.json is just a list of the document collection text.</p>
<div id="e9fc9172-88ba-4aaf-95dc-88a6929f7d41" class="cell" data-execution_count="434">
<div class="sourceCode cell-code" id="cb98" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/collection.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb98-2">    RAG_collection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span></code></pre></div>
</div>
<div id="61b48a62-9c52-40db-bb39-2e058d4c953f" class="cell" data-execution_count="435">
<div class="sourceCode cell-code" id="cb99" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(RAG_collection)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="435">
<pre><code>69199</code></pre>
</div>
</div>
<div id="90c05267-ea50-4264-8c08-12d904edfd97" class="cell" data-execution_count="436">
<div class="sourceCode cell-code" id="cb101" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1">RAG_collection[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="436">
<pre><code>['Overview',
 'You can only make a claim for Child Tax Credit if you already get Working Tax Credit.',
 'If you cannot apply for Child Tax Credit, you can apply for Universal Credit instead.',
 'You might be able to apply for Pension Credit if you and your partner are State Pension age or over.',
 'What you’ll get']</code></pre>
</div>
</div>
<p>pid_docid_map.json is a dictionary where the keys are the index in the collection and the values are the dataset’s defined <code>_id</code> string.</p>
<div id="8ff4615a-29c5-41c6-b32f-7263666c8b10" class="cell" data-execution_count="437">
<div class="sourceCode cell-code" id="cb103" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">open</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>RAG_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/pid_docid_map.json"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'r'</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> f:</span>
<span id="cb103-2">    RAG_pid_docid_map <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.load(f)</span></code></pre></div>
</div>
<div id="1d4c11a1-281f-45b5-803d-ef270f410cb9" class="cell" data-execution_count="438">
<div class="sourceCode cell-code" id="cb104" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(RAG_pid_docid_map.items())[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(RAG_pid_docid_map.items())[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="438">
<pre><code>(('0', '0-0'), ('69198', '651-91'))</code></pre>
</div>
</div>
<div id="1b2b52c8-f593-4f20-be7e-0c43c4e49407" class="cell" data-execution_count="439">
<div class="sourceCode cell-code" id="cb106" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1">passages[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="439">
<pre><code>{'_id': '651-91',
 'text': 'Trade union reps can be on picket lines at different workplaces if they’re responsible for organising workers in those workplaces.',
 'title': 'Taking part in industrial action and strikes',
 'doc_id': '651',
 'paragraph_no': 91,
 'total_paragraphs': 92,
 'is_candidate': True}</code></pre>
</div>
</div>
<p>Saving the collection as a JSON is simple enough, I just dump <code>passages['text']</code> into a JSON file.</p>
<div id="c9d2fd17-5017-49a3-9970-4fc87ae3f583" class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb108" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1">srsly.write_json(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/collection.json"</span>, passages[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>])</span></code></pre></div>
</div>
<p>Creating pid_docid_map.json is also quite straightforward. I map from the index of the passage item to its <code>_id</code>.</p>
<div id="0a9d228b-4dbd-4484-a7ea-4396afcc9f40" class="cell" data-execution_count="440">
<div class="sourceCode cell-code" id="cb109" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1">pid_docid_map <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(i): p[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i,p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(passages)}</span></code></pre></div>
</div>
<div id="175333e7-23ff-48f7-917e-9a31fba3e120" class="cell" data-execution_count="441">
<div class="sourceCode cell-code" id="cb110" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(pid_docid_map.items())[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(pid_docid_map.items())[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="441">
<pre><code>(('0', '0-0'), ('69198', '651-91'))</code></pre>
</div>
</div>
<div id="5622a5ba-554b-4229-b8c2-e1e9c46aca22" class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb112" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1">srsly.write_json(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>ColBERT_index_path<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">/pid_docid_map.json"</span>, pid_docid_map)</span></code></pre></div>
</div>
<p>Let’s make sure these match the RAGatouille-built artifacts:</p>
<div id="e55e05e7-e3ae-44a8-b2e4-b9d71008064d" class="cell" data-execution_count="442">
<div class="sourceCode cell-code" id="cb113" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, _id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> RAG_pid_docid_map.items(): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> _id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> pid_docid_map[i]</span>
<span id="cb113-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, _id <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> pid_docid_map.items(): <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> _id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> RAG_pid_docid_map[i]</span></code></pre></div>
</div>
<p>With those two files created, I can now create a <code>RAGPretrainedModel</code> object <code>from_index</code> using the ColBERT index.</p>
<div id="058cbd58-2dfb-4e6b-b002-f4160596dcd0" class="cell" data-execution_count="443">
<div class="sourceCode cell-code" id="cb114" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1">RAG2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAGPretrainedModel.from_index(ColBERT_index_path)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Constructing default index configuration for index `None` as it does not contain RAGatouille specific metadata.</code></pre>
</div>
</div>
<div id="e575a2b9-9cf8-4573-bbd8-221b71ffd29d" class="cell" data-scrolled="true">
<div class="sourceCode cell-code" id="cb116" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1">RAG2.model.config.ncells <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span>
<span id="cb116-2">RAG2.model.config.centroid_score_threshold <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.45</span></span>
<span id="cb116-3">RAG2.model.config.ndocs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span></span>
<span id="cb116-4"></span>
<span id="cb116-5">ragatouille_results2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb116-6"></span>
<span id="cb116-7"></span>
<span id="cb116-8"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> queries:</span>
<span id="cb116-9">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAG2.search(q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'text'</span>], k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb116-10">    ragatouille_results2[q[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'_id'</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'document_id'</span>]: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'score'</span>]) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> result <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> results}</span></code></pre></div>
</div>
<p>We get the same results as searching the RAGatouille index with RAGatouille, searching the ColBERT index with ColBERT and searching the RAGatouille index with ColBERT!</p>
<div id="72f2902c-47ff-477f-a12b-08c3aff19422" class="cell" data-execution_count="445">
<div class="sourceCode cell-code" id="cb117" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results.keys():</span>
<span id="cb117-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pid, score <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> colbert_results[i].items():</span>
<span id="cb117-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> ragatouille_results2[i][pid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> score</span></code></pre></div>
</div>
<div id="2cafc7e9-57d7-4158-9808-8405871d0225" class="cell" data-execution_count="446">
<div class="sourceCode cell-code" id="cb118" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1">evaluator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pytrec_eval.RelevanceEvaluator(qrels, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall.10'</span>})</span>
<span id="cb118-2">metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> evaluator.evaluate(ragatouille_results2)</span>
<span id="cb118-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>(qrels_rows[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"query_id"</span>]))</span>
<span id="cb118-4"></span>
<span id="cb118-5">mean_recall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(metrics[qid][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'recall_10'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> qid <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> metrics.keys()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(metrics)</span>
<span id="cb118-6">mean_recall</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="446">
<pre><code>0.2855810510889169</code></pre>
</div>
</div>
</section>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>Every interaction I’ve had with RAGatouille and ColBERT has been an awesome learning experience. I feel like inspecting their behavior and artifacts as left me with a better understanding of information retrieval in general. One small learning that I left out: ColBERT uses FAISS for k-means clustering while for small document collections (such as my initial 1k subset) RAGatouille uses a PyTorch implementation. This difference, even though all relevant configuration parameters were equal, resulted in different index artifacts. There was only about a 15% overlap between the <code>centroids.pt</code> tensors of the resulting RAGatouille and ColBERT indexes.</p>
<p>Another piece of motivation for me is that I needed to use both RAGatouille and ColBERT for indexing the full set of UKPLab/DAPR document collections, as ColBERT was able to index the larger collections (6M+) without crashing the kernel, while RAGatouille was not. In some initial experiments I was getting different mean Recall@10 values when using RAGatouille versus when using ColBERT (because I hadn’t incorporated the max query length code and probably had different configs). So I felt like this was a good opportunity, once and for all, to answer the two questions I listed at the start of this notebook:</p>
<ol type="1">
<li>For a given document collection and indexing configuration, do RAGatouille and ColBERT produce the same index?</li>
<li>For a given index and search configuration, do RAGatouille and ColBERT retrieve the same passages/Recall@10?</li>
</ol>
<p>The answer for both, is a resounding yes! With this knowledge in my belt, I can now move forward with indexing and searching with either library as I please.</p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>information retrieval</category>
  <category>RAGatouille</category>
  <category>ColBERT</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-10-RAGatouille-ColBERT-Comparisons/</guid>
  <pubDate>Sat, 10 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>TIL: Resolving RAGatouille OOM Error and faiss-gpu Warning</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-08-TIL-RAGatouille/</link>
  <description><![CDATA[ 




<p>I’m in the process of indexing the UKPLab/DAPR datasets, which span in size from ~70k to ~32M documents. Using a RTX3090, I ran into an OOM error (during search) and a warning stating that faiss-cpu was being used instead of faiss-gpu, causing the indexing process to take longer.</p>
<p>I found <a href="https://github.com/AnswerDotAI/RAGatouille/issues/177">this RAGatouille GitHub issue</a> which recommended lowering the <code>batch_size</code> in ColBERT’s <a href="https://github.com/stanford-futuredata/ColBERT/blob/8627585ad290c21720eaa54e325e7c8c301d15f6/colbert/search/index_storage.py#L121"><code>IndexScorer.score_pids</code> method</a>. I made that change (from 2^20 to 2^16) and that resolved the OOM error, at least for the 2.68M document collection (NaturalQuestions).</p>
<p>When I was using Google Colab GPUs, the following install commands correctly installed faiss-gpu after installing RAGatouille:</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">pip uninstall <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y faiss<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>cpu</span>
<span id="cb1-2">pip install faiss<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>gpu<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>cu12</span></code></pre></div>
<p>Using an RTX3090 (not on Colab), this was not correctly installing faiss-gpu, leading to the following RAGatouille warning during indexing, and as a result, using the CPU for indexing (which eventually crashed the kernel):</p>
<pre><code>________________________________________________________________________________
WARNING! You have a GPU available, but only `faiss-cpu` is currently installed.
This means that indexing will be slow. To make use of your GPU
Please install `faiss-gpu` by running:
pip uninstall --y faiss-cpu &amp; pip install faiss-gpu
________________________________________________________________________________</code></pre>
<p>This warning is thrown in RAGatouille’s <a href="https://github.com/AnswerDotAI/RAGatouille/blob/2bd4d2ed01c847854be78704a012f9ab35d679b2/ragatouille/models/index.py#L226"><code>PLAIDModelIndex.build</code></a> if <code>hasattr(faiss, "StandardGpuResources")</code> is <code>False</code>.</p>
<p>Looking at the <a href="https://github.com/facebookresearch/faiss/tree/main#:~:text=faiss%2Dcpu%2C-,faiss%2Dgpu,-and%20faiss%2Dgpu">faiss repo</a>, they recommend using conda for installation. I ran <code>conda install pytorch::faiss-gpu</code>, restarted the kernel, confirmed that <code>hasattr(faiss, "StandardGpuResources")</code> returns <code>True</code> and was successfully able to circumvent that warning. As a result, RAGatouille was able to use faiss-gpu and it was able to index 2M document.</p>
<p>It’s still TBD if this allows me to finish indexing all of my datasets (especially the 13M and 32M ones).</p>
<p>In a conversation with Claude, I outlined a few different scenarios that I may have to (get to) pursue:</p>
<blockquote class="blockquote">
<p>Since both repos are open sourced, I can fork them (which I have) and add print statements/modify code to debug as needed.</p>
<p>I am running into a couple issues that I’m trying to resolve. I don’t want you to suggest any code yet, let’s think this through.</p>
<ol type="1">
<li>When performing retrieval on a 2.6M document collection on an RTX3090, RAGatouille.search throws an OOM error.</li>
<li>So I chose to run retrieval on the RAGatouille index using vanilla ColBERT and it did not run out of memory.</li>
<li>However, the retrieval results are <em>significantly</em> different between ColBERT and RAGatouille.</li>
</ol>
<p>Each of these gives me a uniquely interesting direction to pursue:</p>
<ol type="1">
<li>Why does RAGatouille throw the OOM error? 2.6M documents (index with 8.5GB disk space) is not small, but not terribly large. There’s an issue open in RAGatouille where they note that changing batch_size in score_pids in IndexScorer resolves an OOM error during search. I want to give this a try!</li>
<li>Why does ColBERT not run out of memory? But RAGatouille does?</li>
<li>Why are the retrieval results between RAGatouille and ColBERT different? The RAGatouille documentation says the following, which leads me to believe they should yield the same results:</li>
</ol>
<p>If you’d like to use more than RAGatouille, ColBERT has a growing number of integrations, and they all fully support models trained or fine-tuned with RAGatouille! The official ColBERT implementation has a built-in query server (using Flask), which you can easily query via API requests and does support indexes generated with RAGatouille! This should be enough for most small applications, so long as you can persist the index on disk.</p>
<p>Each of these explorations are fascinating, and I think I’m going to pursue each one.</p>
<ol type="1">
<li>resolving the RAGatouille OOM error would solve my immediate problem. ideally I tackle this first.</li>
<li>Understanding memory usage between RAGatouille and ColBERT has been an ongoing interest of mine. I have memory profiled both before during indexing, but not during search. This would be a very interesting research task.</li>
<li>Debugging the searching/scoring difference would be probably the hardest task. I would likely have to trace down all function calls, checking intermedite values, comparing them between the two frameworks. Absolutely fascinating and would learn a ton. Would also be a significant achievement to resolve the discrepancy (maybe something in the Config? Maybe something more fundamental?)</li>
</ol>
</blockquote>
<p>TBD on whether I pursue points 2 and 3.</p>



 ]]></description>
  <category>information retrieval</category>
  <category>deep learning</category>
  <category>RAGatouille</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-08-TIL-RAGatouille/</guid>
  <pubDate>Thu, 08 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>DataInspector: Inspecting input_ids Token Statistics in LLM-Foundry with packing_ratio=5.0</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-08-DataInspector/</link>
  <description><![CDATA[ 







 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-08-DataInspector/</guid>
  <pubDate>Thu, 08 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Understanding Sequence Packing - Initial Musings</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-04-Understanding-Sequence-Packing/</link>
  <description><![CDATA[ 




<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div id="cell-2" class="cell">
<details class="code-fold">
<summary>Show pip installs and imports</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U flash<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>attn <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--</span>no<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>build<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>isolation</span>
<span id="cb1-2"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip uninstall transformers <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y</span>
<span id="cb1-3"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>pip install git<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>https:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>github.com<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>vishalbakshi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>transformers.git <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>qq</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoModelForCausalLM, AutoTokenizer</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> inspect</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch.nn.functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> F</span>
<span id="cb1-9"></span>
<span id="cb1-10">model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span></span>
<span id="cb1-11"></span>
<span id="cb1-12">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(</span>
<span id="cb1-13">    model_name,</span>
<span id="cb1-14">    attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>,</span>
<span id="cb1-15">    torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.bfloat16,</span>
<span id="cb1-16">    device_map<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auto"</span>)</span>
<span id="cb1-17"></span>
<span id="cb1-18">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(model_name)</span></code></pre></div>
</details>
</div>
</section>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this blog post, I’m walking through <code>transformers</code> code to start exploring functionality between sequence packing and Flash Attention. I’m new to both concepts, so this is purely an exploratory exercise.</p>
<p>To assist my exploration, I’ve forked the Transformers library and added print statements at key junctures related to sequence packing and FA2. Referencing the original repo here’s where I’ve inserted print statements:</p>
<ul>
<li>Right after the function signature for <code>flash_attention_forward</code> in <a href="https://github.com/huggingface/transformers/blob/2932f318a20d9e54cc7aea052e040164d85de7d6/src/transformers/integrations/flash_attention.py#L22">src/transformers/integrations/flash_attention.py</a> (which is called from inside <code>model.model.layers[0].self_attn.forward</code>).</li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== FLASH_ATTENTION_FORWARD ENTRY ==="</span>)</span>
<span id="cb2-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"kwargs received: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(kwargs.keys())<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
<ul>
<li>Right after the function signature/docstring for <code>_flash_attention_forward</code> in <a href="https://github.com/huggingface/transformers/blob/2932f318a20d9e54cc7aea052e040164d85de7d6/src/transformers/modeling_flash_attention_utils.py#L324">src/transformers/modeling_flash_attention_utils.py</a>:</li>
</ul>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== _FLASH_ATTENTION_FORWARD ENTRY ==="</span>)</span>
<span id="cb3-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"kwargs received: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(kwargs.keys())<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> attention_mask"</span>)</span>
<span id="cb3-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(attention_mask)</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> position_ids"</span>)</span>
<span id="cb3-8"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(position_ids)</span></code></pre></div>
<p>In the same file, later on:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Contains at least one padding token in the sequence</span></span>
<span id="cb4-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> attention_mask <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb4-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"attention_mask is not None"</span>)</span>
<span id="cb4-4">    ...</span></code></pre></div>
<p>and later on further in the <code>_flash_attention_forward</code> function definition:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> position_ids <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (</span>
<span id="cb5-2">    max_length_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> (query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> (torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>())</span>
<span id="cb5-3">):</span>
<span id="cb5-4">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"position_ids is not None and max_length_q check"</span>)</span>
<span id="cb5-5">    batch_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> query_states.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-6"></span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> cu_seq_lens_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> cu_seq_lens_k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb5-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"cu_seq_lens_q is None: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cu_seq_lens_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"cu_seq_lens_k is None: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>cu_seq_lens_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-10">        query_states, key_states, value_states, indices_q, cu_seq_lens, max_seq_lens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb5-11">            prepare_fa2_from_position_ids(query_states, key_states, value_states, position_ids)</span>
<span id="cb5-12">        )</span>
<span id="cb5-13"></span>
<span id="cb5-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> cu_seq_lens"</span>)</span>
<span id="cb5-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(cu_seq_lens)</span>
<span id="cb5-16">        cu_seq_lens_q, cu_seq_lens_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cu_seq_lens</span>
<span id="cb5-17">        max_length_q, max_length_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> max_seq_lens</span>
<span id="cb5-18"></span>
<span id="cb5-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb5-20">        ...</span></code></pre></div>
<p>I originally identified these functions by using the <code>inspect</code> library, e.g.:</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(inspect.getsource(model.model.layers[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].self_attn.forward))</span></code></pre></div>
<p>The goal of these print functions initially was to understand how <code>cu_seqlens</code> is utilized (if at all) and then after realizing it wasn’t being used, my goal became to understand which function form <code>flash_attn</code> is being used: <code>flash_attn_func</code> or <code>flash_attn_varlen_func</code>?</p>
</section>
<section id="initial-example-passing-in-input_ids-cu_seqlens-and-max_seqlen-to-the-smollm2-135m-forward-pass" class="level2">
<h2 class="anchored" data-anchor-id="initial-example-passing-in-input_ids-cu_seqlens-and-max_seqlen-to-the-smollm2-135m-forward-pass">Initial Example: Passing in <code>input_ids</code>, <code>cu_seqlens</code> and <code>max_seqlen</code> to the SmolLM2-135M Forward Pass</h2>
<p>At first, based on a Claude-generated example, I passed in the following fake input data.</p>
<div id="cell-10" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6bc4c7d5-d953-4f4b-911c-b1b2936fbb5c" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb7-2">test_params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb7-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>: torch.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>),</span>
<span id="cb7-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cu_seqlens'</span>: [torch.tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)],</span>
<span id="cb7-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_seqlen'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span>
<span id="cb7-6">}</span>
<span id="cb7-7">test_params</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>{'input_ids': tensor([[7, 6, 8, 5, 1, 3, 8, 6, 5, 3]], device='cuda:0'),
 'cu_seqlens': [tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32)],
 'max_seqlen': [10]}</code></pre>
</div>
</div>
<div id="cell-11" class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb9-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad(): output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>test_params)</span></code></pre></div>
</div>
<p>The following was printed out for each attention mechanism call in each of the model’s 30 layers:</p>
<pre><code>=== FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['position_ids', 'output_attentions', 'use_cache', 'cu_seqlens', 'max_seqlen']

=== _FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['output_attentions', 'use_cache', 'cu_seqlens', 'max_seqlen']

 attention_mask
None

 position_ids
tensor([[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]], device='cuda:0')
flash_attn_func is called
flash_kwargs received: ['deterministic']</code></pre>
<p>I was surprised to see that <code>flash_attn_func</code> was called, because IIUC that doesn’t handle sequence packed inputs. Looking at <a href="https://github.com/Dao-AILab/flash-attention/blob/fd2fc9d85c8e54e5c20436465bca709bc1a6c5a1/hopper/flash_attn_interface.py#L501">its function signature</a>, there’s no <code>cu_seqlens</code> or similar parameter:</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> flash_attn_func(</span>
<span id="cb11-2">    q,</span>
<span id="cb11-3">    k,</span>
<span id="cb11-4">    v,</span>
<span id="cb11-5">    softmax_scale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb11-6">    causal<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb11-7">    qv<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb11-8">    q_descale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, k_descale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, v_descale<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb11-9">    window_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb11-10">    attention_chunk<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb11-11">    softcap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span>,</span>
<span id="cb11-12">    num_splits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-13">    pack_gqa<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb11-14">    deterministic<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb11-15">    sm_margin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb11-16">)</span></code></pre></div>
<p>Additionally, <code>position_ids</code> is defined even though I didn’t pass it in. IIUC, that’s done in the model’s forward pass with the line:</p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> position_ids <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb12-2">    position_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cache_position.unsqueeze(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<p>Where <code>cache_position</code> is defined earlier in that forward pass. This can be observed by running:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1">forward_method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inspect.getsource(model.model.forward)</span>
<span id="cb13-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(forward_method)</span></code></pre></div>
</section>
<section id="second-attempt-passing-in-position_ids-to-the-forward-pass-as-well" class="level2">
<h2 class="anchored" data-anchor-id="second-attempt-passing-in-position_ids-to-the-forward-pass-as-well">Second Attempt: Passing in <code>position_ids</code> to the Forward Pass as Well</h2>
<p>Claude helped me understand that what triggers the function call of <code>flash_attn_varlen_func</code> is the following conditional in <a href="https://github.com/huggingface/transformers/blob/2932f318a20d9e54cc7aea052e040164d85de7d6/src/transformers/modeling_flash_attention_utils.py#L378"><code>_flash_attention_forward</code></a>:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> position_ids <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (</span>
<span id="cb14-2">        max_length_q <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> (query_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> (torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>())</span>
<span id="cb14-3">    )</span></code></pre></div>
<p>In particular, this line was of interest: <code>torch.diff(position_ids, dim=-1) &gt;= 0</code></p>
<p>In the following contrived example, <code>position_ids</code> is not a list of consecutive numbers (which seems to be the default value constructed is no <code>position_ids</code> value is passed to the model’s forward pass).</p>
<div id="cell-18" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1">input_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>]]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb15-2">position_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb15-3">cu_seqlens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [torch.tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)]</span></code></pre></div>
</div>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="46c76718-2cd2-411b-eb4e-5822cb0d73d7" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">(torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>tensor(False, device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5bed5591-9d67-4d15-cb42-8b1ab15f3089" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1">torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>tensor([[ True,  True, False,  True,  True,  True,  True,  True,  True]],
       device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d15b4b7a-5cee-4651-e5b3-861f7c4d03b6" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1">torch.diff(position_ids, dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>tensor([[ 1,  1, -2,  1,  1,  1,  1,  1,  1]], device='cuda:0')</code></pre>
</div>
</div>
<p>Some diffs between consecutive elements in <code>position_ids</code> are negative (because we are defining two sequences’ position ids).</p>
<p>I would now expect <code>flash_attn_varlen_func</code> to be called.</p>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="bbd565ce-415c-4756-98f0-364a438ed5ed" data-execution_count="43">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb22-2">test_params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb22-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>: torch.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>),</span>
<span id="cb22-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'position_ids'</span>: torch.tensor([[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>]]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>),</span>
<span id="cb22-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cu_seqlens'</span>: [torch.tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)],</span>
<span id="cb22-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_seqlen'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>]</span>
<span id="cb22-7">}</span>
<span id="cb22-8">test_params</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>{'input_ids': tensor([[7, 6, 8, 5, 1, 3, 8, 6, 5, 3]], device='cuda:0'),
 'position_ids': tensor([[0, 1, 2, 0, 1, 2, 3, 4, 5, 6]], device='cuda:0'),
 'cu_seqlens': [tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32)],
 'max_seqlen': [7]}</code></pre>
</div>
</div>
<div id="cell-25" class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb24-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad(): output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>test_params)</span></code></pre></div>
</div>
<p>Passing <code>test_params</code> through the model’s forward pass yields:</p>
<pre><code>=== FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['position_ids', 'output_attentions', 'use_cache', 'cu_seqlens', 'max_seqlen']

=== _FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['output_attentions', 'use_cache', 'cu_seqlens', 'max_seqlen']

 attention_mask
None

 position_ids
tensor([[0, 1, 2, 0, 1, 2, 3, 4, 5, 6]], device='cuda:0')
position_ids is not None and max_length_q check
cu_seq_lens_q is None: True
cu_seq_lens_k is None: True

 cu_seq_lens
(tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32), tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32))</code></pre>
<p>The <code>position_ids</code> are as passed in. However, it does not use <code>cu_seqlens</code> directly from <code>kwargs</code>. Instead it builds it <a href="https://github.com/huggingface/transformers/blob/2932f318a20d9e54cc7aea052e040164d85de7d6/src/transformers/modeling_flash_attention_utils.py#L383">in the following line</a>:</p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">query_states, key_states, value_states, indices_q, cu_seq_lens, max_seq_lens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb26-2">    prepare_fa2_from_position_ids(query_states, key_states, value_states, position_ids)</span>
<span id="cb26-3">)</span></code></pre></div>
<p>The value of <code>cu_seqlens</code> is the tuple:</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">(tensor([ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda:0'</span>, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32), tensor([ <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], device<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cuda:0'</span>, dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32))</span></code></pre></div>
<p>Which is deconstructed into <code>cu_seq_lens_q</code> and <code>cu_seql_lens_k</code> which are then passed as arguments to <code>flash_attn_varlen_func</code>.</p>
<p>The main takeaway from this: Flash Attention will not handle sequence packing correctly unless you pass in <code>position_ids</code>.</p>
</section>
<section id="packed-sequence-loss" class="level2">
<h2 class="anchored" data-anchor-id="packed-sequence-loss">Packed Sequence Loss</h2>
<p>In the remaining sections of this blog post, I’ll explore how to correctly handle calculating loss for a packed sequence.</p>
<div id="cell-33" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="05592fff-ecf2-4adf-e347-a4526778898f" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">output.logits.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>torch.Size([1, 10, 49152])</code></pre>
</div>
</div>
<p>Following how labels are constructed in HuggingFace’s <a href="https://github.com/RhuiDih/transformers/blob/90305596c1f14376bb2049f408a4c53e024b2450/src/transformers/data/data_collator.py#L1643"><code>DataCollatorWithFlattening</code></a>, the first token in each sequence is replaced with <code>-100</code>. This is because the HuggingFace CausalLM loss function handles the shifting of labels to allow next-token prediction.</p>
<div id="cell-35" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="0df22f75-897e-4207-8285-5b4edffc30c7" data-execution_count="19">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb30-2">labels</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>tensor([-100,    6,    8, -100,    1,    3,    8,    6,    5,    3],
       device='cuda:0')</code></pre>
</div>
</div>
<p>The following two lines are taken from the model’s loss function which can be inspected with <code>print(inspect.getsource(model.loss_function))</code>:</p>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="19309094-2315-487f-badc-574c5b8fab60" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.nn.functional.pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb32-2">shift_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _labels[..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:].contiguous()</span>
<span id="cb32-3">shift_labels</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>tensor([   6,    8, -100,    1,    3,    8,    6,    5,    3, -100],
       device='cuda:0')</code></pre>
</div>
</div>
<p>We can see that the labels have been shifted to the left by 1 element, and a <code>-100</code> ignore index has been added to the right, which is needed because the last token in the input doesn’t predict anything.</p>
<p>Calculating the loss using <code>F.cross_entropy</code> directly and the model’s <code>loss_function</code> (providing it unshifted <code>labels</code>):</p>
<div id="cell-40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d77b6fcb-8635-4fc2-dc2b-e767fd428d7c" data-execution_count="21">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> F.cross_entropy(</span>
<span id="cb34-2">    output.logits.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, output.logits.size(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>(),</span>
<span id="cb34-3">    shift_labels.reshape(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb34-4">)</span>
<span id="cb34-5">loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>tensor(20.2832, device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="91c2e8da-2901-44a0-e234-5dbe77787361" data-execution_count="22">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">model.loss_function(output.logits, labels, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">49152</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>tensor(20.2832, device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="padded-batch-loss" class="level2">
<h2 class="anchored" data-anchor-id="padded-batch-loss">Padded Batch Loss</h2>
<p>Sequence packing shouldn’t change the loss value of a given input batch. To test this, I’ll construct a padded batch from our fake data and calculate its outputs, labels and loss.</p>
<div id="cell-44" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e7066f5a-18f6-43b6-a247-bf162df07b79" data-execution_count="23">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">input_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_params[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb38-2">input_ids</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>tensor([7, 6, 8, 5, 1, 3, 8, 6, 5, 3], device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-45" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8c2cc60a-1319-480c-e975-b60ea1e94a7a" data-execution_count="24">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1">cu_seqlens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> test_params[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cu_seqlens'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb40-2">cu_seqlens</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32)</code></pre>
</div>
</div>
<div id="cell-46" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="bbb44c85-d6d9-4d4a-d91d-7ced9a893f42" data-execution_count="25">
<div class="sourceCode cell-code" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1">seq_boundaries <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(cu_seqlens[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], cu_seqlens[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]))</span>
<span id="cb42-2">seq_boundaries</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>[(tensor(0, device='cuda:0', dtype=torch.int32),
  tensor(3, device='cuda:0', dtype=torch.int32)),
 (tensor(3, device='cuda:0', dtype=torch.int32),
  tensor(10, device='cuda:0', dtype=torch.int32))]</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="eca4d729-ec35-4d60-b6d3-0504fd4cda7a" data-execution_count="26">
<div class="sourceCode cell-code" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1">seq1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> input_ids[seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]: seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb44-2">seq2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> input_ids[seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]: seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb44-3">seq1, seq2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>(tensor([7, 6, 8], device='cuda:0'),
 tensor([5, 1, 3, 8, 6, 5, 3], device='cuda:0'))</code></pre>
</div>
</div>
<p>The first item in the batch has 3 elements, and the second item in the batch has 7 elements. We need to pad the first item so it’s 7 elements long.</p>
<div id="cell-49" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="2260cb77-daca-41dc-9d40-5fce0bf2d638" data-execution_count="27">
<div class="sourceCode cell-code" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1">seq1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([seq1, torch.tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)])</span>
<span id="cb46-2">seq1</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>tensor([7, 6, 8, 0, 0, 0, 0], device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-50" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="99b50860-f6ea-472e-b244-0424fa99d756" data-execution_count="28">
<div class="sourceCode cell-code" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1">padded_batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([seq1, seq2], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb48-2">padded_batch, padded_batch.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>(tensor([[7, 6, 8, 0, 0, 0, 0],
         [5, 1, 3, 8, 6, 5, 3]], device='cuda:0'),
 torch.Size([2, 7]))</code></pre>
</div>
</div>
<p>Similarly, we need to construct <code>labels</code> such that the last four elements in the first batch item are ignored.</p>
<div id="cell-52" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="79c4035c-71f7-4d78-f722-05623c1f5c7f" data-execution_count="29">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1">seq1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> input_ids[seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]: seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb50-2">seq2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> input_ids[seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]: seq_boundaries[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb50-3">seq1, seq2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>(tensor([7, 6, 8], device='cuda:0'),
 tensor([5, 1, 3, 8, 6, 5, 3], device='cuda:0'))</code></pre>
</div>
</div>
<div id="cell-53" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="ea05103b-0a1e-4a5d-89ca-a7e243c5f66a" data-execution_count="30">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1">seq1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.cat([seq1, torch.tensor([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)])</span>
<span id="cb52-2">seq1</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>tensor([   7,    6,    8, -100, -100, -100, -100], device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-54" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="bf8a766d-0c21-4ce8-c288-7d654906f228" data-execution_count="31">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1">padded_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.stack([seq1, seq2], dim<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb54-2">padded_labels</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>tensor([[   7,    6,    8, -100, -100, -100, -100],
        [   5,    1,    3,    8,    6,    5,    3]], device='cuda:0')</code></pre>
</div>
</div>
<p>Calculating the logits:</p>
<div id="cell-56" class="cell">
<div class="sourceCode cell-code" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb56-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad(): padded_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(input_ids<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>padded_batch)</span></code></pre></div>
</div>
<p>Noting that I haven’t pass any <code>position_ids</code> and the printed output shows us that <code>flash_attn_func</code> is indeed the “vanilla” implementation of Flash Attention for padded batches:</p>
<pre><code>=== FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['position_ids', 'output_attentions', 'use_cache']

=== _FLASH_ATTENTION_FORWARD ENTRY ===
kwargs received: ['output_attentions', 'use_cache']

 attention_mask
None

 position_ids
tensor([[0, 1, 2, 3, 4, 5, 6]], device='cuda:0')
flash_attn_func is called
flash_kwargs received: ['deterministic']</code></pre>
<p>Comparing the packed output logits with the padded output logits. The shapes are different but the values are the same.</p>
<div id="cell-59" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="3aadf767-b684-4d5a-b77d-c61d133baa74" data-execution_count="33">
<div class="sourceCode cell-code" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1">output.logits.shape, padded_output.logits.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>(torch.Size([1, 10, 49152]), torch.Size([2, 7, 49152]))</code></pre>
</div>
</div>
<div id="cell-60" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="070e6ffd-013f-4ecd-befc-9ac8dae7cc91" data-execution_count="34">
<div class="sourceCode cell-code" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1">(output.logits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, :] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> padded_output.logits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, :]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>tensor(1., device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-61" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8598f24d-6e50-4bc8-ce46-e04918d5afc2" data-execution_count="35">
<div class="sourceCode cell-code" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1">(output.logits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>:, :] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> padded_output.logits[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, :, :]).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>tensor(1., device='cuda:0')</code></pre>
</div>
</div>
<p>Finally, calculating the padded batch’s loss gives us the same value as the sequence packed loss:</p>
<div id="cell-63" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d4daac3a-2429-438a-deb4-c09d5bca924c" data-execution_count="36">
<div class="sourceCode cell-code" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1">padded_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.loss_function(padded_output.logits, padded_labels, vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">49152</span>)</span>
<span id="cb64-2">padded_loss</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>tensor(20.2832, device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="not-passing-in-position_ids-with-packed-sequence" class="level2">
<h2 class="anchored" data-anchor-id="not-passing-in-position_ids-with-packed-sequence">Not Passing in <code>position_ids</code> With Packed Sequence</h2>
<p>To confirm that not passing in position_ids does in indeed make HuggingFace use the wrong Flash Attention implementation for a packed sequence, I’ll compare the logits and loss:</p>
<div id="cell-66" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="990a6acb-870f-46fd-e6e1-8e9c49adde95" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1">torch.manual_seed(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42</span>)</span>
<span id="cb66-2">test_params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb66-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>: torch.randint(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>),</span>
<span id="cb66-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cu_seqlens'</span>: [torch.tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>torch.int32).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)],</span>
<span id="cb66-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'max_seqlen'</span>: [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>]</span>
<span id="cb66-6">}</span>
<span id="cb66-7">test_params</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>{'input_ids': tensor([[7, 6, 8, 5, 1, 3, 8, 6, 5, 3]], device='cuda:0'),
 'cu_seqlens': [tensor([ 0,  3, 10], device='cuda:0', dtype=torch.int32)],
 'max_seqlen': [10]}</code></pre>
</div>
</div>
<div id="cell-67" class="cell">
<div class="sourceCode cell-code" id="cb68" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1">model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb68-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad(): output2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>test_params)</span></code></pre></div>
</div>
<p>The logits are not the same as when <code>flash_attn_varlen_func</code> is used.</p>
<div id="cell-69" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="91d780a7-01bb-4650-e622-6901fc72cc7b" data-execution_count="52">
<div class="sourceCode cell-code" id="cb69" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1">(output.logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> output2.logits).<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>().mean()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>tensor(0.3012, device='cuda:0')</code></pre>
</div>
</div>
<p>It follows that the loss value is not the same either.</p>
<div id="cell-71" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6ec37ab6-7dac-4d44-f171-901f927ad8b0" data-execution_count="40">
<div class="sourceCode cell-code" id="cb71" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> torch.tensor([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb71-2">model.loss_function(output.logits, labels, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">49152</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>tensor(17.4632, device='cuda:0')</code></pre>
</div>
</div>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>I’ll reiterate that I’m not familiar with how sequence packing is implemented (in HuggingFace or ModernBERT) and even less familiar with how Flash Attention is implemented. That being said, this cursory investigation allowed me to understand high-level concepts of how these two interact. My key takeaway is that the correct <code>position_ids</code> need to be passed to the model otherwise HuggingFace will not use the correct <code>flash_attn_varlen_func</code> for sequence packed inputs and that will result in incorrect logits and loss values.</p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>LLM</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-04-Understanding-Sequence-Packing/</guid>
  <pubDate>Sun, 04 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Initial Manual Scoring Results for TinyStories Models</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-05-01-TSL-Initial-Scoring-Results/</link>
  <description><![CDATA[ 




<section id="recap" class="level2">
<h2 class="anchored" data-anchor-id="recap">Recap</h2>
<p>In this post, I’m going to analyze the initial manual scoring results for my baseline models’ text generations given my 150 evaluation prompts across six scoring categories and 18 criteria. A quick recap of what I’ve done so far:</p>
<ul>
<li>Defined scoring criteria</li>
<li>Curated a set of eval prompts based on each scoring category</li>
<li>Created a fast HTML app where I can perform my scoring activities</li>
</ul>
<p>The raw scores analyzed in this blog post can be found in <a href="https://github.com/vishalbakshi/TinyScaleLab">my TinyScaleLab repo</a>.</p>
</section>
<section id="evaluation-categories" class="level2">
<h2 class="anchored" data-anchor-id="evaluation-categories">Evaluation Categories</h2>
<p>I have six scoring categories that I’m evaluating my models on:</p>
<section id="foundational-language-capabilities" class="level3">
<h3 class="anchored" data-anchor-id="foundational-language-capabilities">Foundational language capabilities</h3>
<ul>
<li>Grammar</li>
<li>Context-Tracking (Consistency)</li>
</ul>
</section>
<section id="emergent-capabilities" class="level3">
<h3 class="anchored" data-anchor-id="emergent-capabilities">Emergent capabilities</h3>
<ul>
<li>Factual Knowledge</li>
<li>Reasoning</li>
<li>Creativity</li>
</ul>
</section>
<section id="story-related-capabilities" class="level3">
<h3 class="anchored" data-anchor-id="story-related-capabilities">Story-related capabilities</h3>
<ul>
<li>Plot</li>
</ul>
<p>My goal was to generate prompts that either isolate (Factual Knowledge, Reasoning, Context-Tracking) or elicit opportunities to exhibit (Plot, Creativity) scoring categories. I wanted to make the job easier first for myself, and then use that as a proxy of making the job of the LLM judge easier to evaluate scoring categories in a focused way.</p>
</section>
</section>
<section id="baseline-models" class="level2">
<h2 class="anchored" data-anchor-id="baseline-models">Baseline Models</h2>
<p>I’ve chosen three models as my baseline because they’re similar in size to the models that I’m going to be training in this project:</p>
<ul>
<li>TinyStories-1M (~3.7 million parameters)</li>
<li>TinyStories-8M (~20 million parameters)</li>
<li>TinyStories-28M (~60 million parameters)</li>
</ul>
</section>
<section id="generation-script" class="level2">
<h2 class="anchored" data-anchor-id="generation-script">Generation Script</h2>
<p>I’m using a pretty standard generation script. Things I want to highlight:</p>
<ul>
<li>Making sure the padding side is left so that we’re not generating tokens based on padding tokens</li>
<li><code>model.eval()</code> and <code>torch.no_grad()</code> are things that I always make sure to do so that it’s somewhat deterministic when it’s expected to be deterministic</li>
<li>I’m doing <code>do_sample=False</code> and <code>num_beams=5</code> because that was published by the authors as their parameters for generation</li>
<li>I have a minimum and maximum length, which I’ll talk about at the end about how I think that might change moving forward</li>
</ul>
</section>
<section id="eval-prompts" class="level2">
<h2 class="anchored" data-anchor-id="eval-prompts">Eval Prompts</h2>
<p>My current eval prompts set includes:</p>
<ul>
<li>25 unique prompts for Reasoning</li>
<li>25 unique prompts for Factual Knowledge</li>
<li>25 prompts each for Context-Tracking, Plot and Creativity (with some overlap)</li>
<li>25 prompts for Grammar (5 prompts sampled from the other 5 categories)</li>
</ul>
<p>That’s 150 total prompts.</p>
</section>
<section id="scoring-methodology" class="level2">
<h2 class="anchored" data-anchor-id="scoring-methodology">Scoring Methodology</h2>
<p>I have six categories across 18 criteria, evaluating generations from three models on 150 prompts each. The scores that I’m providing for each criteria are either 0, 0.5, and 1.0, taken from the Tiny Stories paper (though they didn’t quite use it the same way I’m using it), in Section 4.2 (Figures 9/10/11) where they use scoring levels success (green), failure (red), and partial success (yellow).</p>
</section>
<section id="overall-results" class="level2">
<h2 class="anchored" data-anchor-id="overall-results">Overall Results</h2>
<p>First, let’s look at the average value across all categories and criteria for each model:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>model_name</th>
<th>score_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>roneneneldan/TinyStories-1M</td>
<td>0.25</td>
</tr>
<tr class="even">
<td>roneneneldan/TinyStories-8M</td>
<td>0.49</td>
</tr>
<tr class="odd">
<td>roneneneldan/TinyStories-28M</td>
<td>0.61</td>
</tr>
</tbody>
</table>
<p>As I would expect, as model size increases, the average score value increases. The 1M parameter model (which actually has 3.7M parameters) has an average score of 0.25. The 8M parameter model (which is closer to 20M parameters) has an average score of about 0.5. And the 28M parameter model (which has about 60M parameters) has an average score of 0.61.</p>
<p>A parameter count <em>increase</em> of 4x (16.3M increase from 3.7M to 20M) yields an overall mean score <em>increase</em> of 1x (0.25 to 0.50). A parameter count <em>increase</em> of 2x (40M increase from 20M to 60M) yields an overall mean score <em>increase</em> of 25% (0.49 to 0.61). There are decreasing gains overall when increasing parameter count. For a 125M parameter model (that I’m planning to train), I would expect &lt;10% increase from a mean overall score of 0.61.</p>
</section>
<section id="scores-by-category" class="level2">
<h2 class="anchored" data-anchor-id="scores-by-category">Scores by Category</h2>
<p>Next, let’s look at how these models are doing for each of the categories overall:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Context-Tracking</td>
<td>0.14</td>
<td>0.51</td>
<td>0.63</td>
</tr>
<tr class="even">
<td>Creativity</td>
<td>0.12</td>
<td>0.16</td>
<td>0.32</td>
</tr>
<tr class="odd">
<td>Factual Knowledge</td>
<td>0.08</td>
<td>0.32</td>
<td>0.40</td>
</tr>
<tr class="even">
<td>Grammar</td>
<td>0.59</td>
<td>0.82</td>
<td>0.86</td>
</tr>
<tr class="odd">
<td>Plot</td>
<td>0.10</td>
<td>0.42</td>
<td>0.60</td>
</tr>
<tr class="even">
<td>Reasoning</td>
<td>0.20</td>
<td>0.44</td>
<td>0.70</td>
</tr>
</tbody>
</table>
<p>Some interesting things to point out:</p>
<p>The highest category by score for my 1M parameter model is grammar, by farL 0.59. That’s about three times as large as any other category. This is in line with what I read in the TinyStories paper, that grammar appears first as a capability.</p>
<p>The worst categories, even for the largest model that I tested, were Creativity and Factual Knowledge. Creativity in particular was the lowest scoring, and this also tracks with the TinyStories paper, because they had shown that creativity only really appears at large hidden dimension sizes. And even then, the maximum value of creativity (8s and 9s out of 10) was only available for models like GPT-4.</p>
<p>Factual Knowledge was also significantly lower than the other four categories.</p>
<p>The other category I want to highlight is Reasoning. The Reasoning score for the smallest model is 0.2, it doubles to 0.44 at 8M, and then it goes up by another 60 percent to 0.7 for the 28M model. That’s pretty solid! 70%, 7 out of 10. So, if we were talking about school grades, a 70 percent is passing. Very cool to see reasoning potential, even for the tiniest model evaluated.</p>
<p>In every case, there is an increase as we go from 1M to 8M to 28M model name. In some cases, the jump comes later, such as for Creativity. In most cases, the jump happens between the 1M and 8M models.</p>
</section>
<section id="scoring-by-criteria" class="level2">
<h2 class="anchored" data-anchor-id="scoring-by-criteria">Scoring by Criteria</h2>
<p>Now let’s look at each criteria for each category:</p>
<section id="emergent-capabilities-creativity-factual-knowledge-and-reasoning" class="level3">
<h3 class="anchored" data-anchor-id="emergent-capabilities-creativity-factual-knowledge-and-reasoning">Emergent Capabilities: Creativity, Factual Knowledge and Reasoning</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 78%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th>Factual Knowledge</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Completion contains only correct factual information relevant to the prompt</td>
<td>0.08</td>
<td>0.32</td>
<td>0.4</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 79%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Reasoning</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Completion demonstrates correct logical reasoning relevant to the prompt</td>
<td>0.2</td>
<td>0.44</td>
<td>0.7</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 73%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>Creativity</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Character behavioral and emotional responses are innovative</td>
<td>0.00</td>
<td>0.04</td>
<td>0.22</td>
</tr>
<tr class="even">
<td>The completion contains unique details to the story world</td>
<td>0.02</td>
<td>0.12</td>
<td>0.34</td>
</tr>
<tr class="odd">
<td>The completion creates fresh situations</td>
<td>0.00</td>
<td>0.08</td>
<td>0.20</td>
</tr>
<tr class="even">
<td>The completion offers unexpected or novel elements</td>
<td>0.48</td>
<td>0.42</td>
<td>0.50</td>
</tr>
</tbody>
</table>
<p>Factual Knowledge and Reasoning only had one criteria each. For Factual Knowledge, I was assessing if the completion contains only correct factual information relevant to the prompt. For Reasoning, I was assessing if the completion demonstrates correct logical reasoning relevant to the prompt.</p>
<p>For Creativity, note that the smallest model performs well for the criteria “The completion offers unexpected or novel elements.” Since I was isolating Grammar, Plot and Context-Tracking from Creativity, the tiniest model could deviate from Plot/Context and still get a high score for this criterion, making it the lowest bar to cross. For the other three Creativity criteria, the 1M model has negligible skill.</p>
</section>
<section id="foundational-language-capabilities-grammar-and-context-tracking" class="level3">
<h3 class="anchored" data-anchor-id="foundational-language-capabilities-grammar-and-context-tracking">Foundational Language Capabilities: Grammar and Context-Tracking</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 73%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>Grammar</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Age-appropriate vocabulary usage</td>
<td>1.00</td>
<td>1.00</td>
<td>0.98</td>
</tr>
<tr class="even">
<td>Dialogue formatting and punctuation</td>
<td>1.00</td>
<td>0.96</td>
<td>0.98</td>
</tr>
<tr class="odd">
<td>Proper use of pronouns and referents</td>
<td>0.56</td>
<td>0.88</td>
<td>0.90</td>
</tr>
<tr class="even">
<td>Sentence structure logic, clarity and completion</td>
<td>0.14</td>
<td>0.62</td>
<td>0.70</td>
</tr>
<tr class="odd">
<td>Tense consistency throughout the completion</td>
<td>0.26</td>
<td>0.66</td>
<td>0.74</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 79%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Context-Tracking</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Completion maintains complete coherence with prompt</td>
<td>0.20</td>
<td>0.62</td>
<td>0.64</td>
</tr>
<tr class="even">
<td>Correctly references/tracks all objects, characters, and their attributes</td>
<td>0.20</td>
<td>0.52</td>
<td>0.68</td>
</tr>
<tr class="odd">
<td>Maintains consistent narrative flow</td>
<td>0.02</td>
<td>0.40</td>
<td>0.56</td>
</tr>
</tbody>
</table>
<p>For Grammar, the age-appropriate vocabulary usage was the easiest to score. These models don’t really generate anything that’s not within the TinyStories dataset.</p>
<p>Sentence structure, logic, clarity, and completion had the biggest jump from 1M to 8M, going from 0.14 to 0.62. That matches my experiencing scoring: the small model had terrible structure, logic, clarity, and completion in its completions.</p>
<p>For context tracking, I was looking at three criteria. The biggest jump is from 2% to 40% for maintaining a consistent narrative flow. The medium-sized models were definitely not perfect, but was much better at following the narrative flow of the story.</p>
</section>
<section id="story-related-capabilities-plot" class="level3">
<h3 class="anchored" data-anchor-id="story-related-capabilities-plot">Story-Related Capabilities: Plot</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 81%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th>Plot</th>
<th>1M</th>
<th>8M</th>
<th>28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Conflicts are addressed rather than abandoned</td>
<td>0.00</td>
<td>0.42</td>
<td>0.60</td>
</tr>
<tr class="even">
<td>The pacing is appropriate (not too rushed or dragging)</td>
<td>0.00</td>
<td>0.14</td>
<td>0.24</td>
</tr>
<tr class="odd">
<td>The story has a clear beginning, middle, and end appropriate to age level</td>
<td>0.26</td>
<td>0.50</td>
<td>0.72</td>
</tr>
<tr class="even">
<td>The story maintains focus on the central conflict/theme without random diversions</td>
<td>0.12</td>
<td>0.64</td>
<td>0.84</td>
</tr>
</tbody>
</table>
<p>For Plot, I found the pacing to be the worst category across all models. This checks out with my experience as I was grading these stories - I didn’t really get a sense that there was a well-paced story. Either it was dragging and repeating itself slightly, or it was just one or two sentences and insufficient.</p>
<p>For “conflicts are addressed” we go from 0% to 42% from 1M to 8M. The smallest model simply ignored or abandoned conflicts that were in the premise and the prompt. The other big jump is for “focusing on the central theme” - the smallest to medium model had almost a 3x jump, and then there was still a considerable 30% jump from the medium to large model.</p>
</section>
</section>
<section id="comparison-to-tinystories-paper" class="level2">
<h2 class="anchored" data-anchor-id="comparison-to-tinystories-paper">Comparison to TinyStories Paper</h2>
<p>I’m going to revisit the targets that I established from Figure 4 of the TinyStories paper, where they showed the different scores based on hidden dimension and number of layers. I matched that up with the three models that I’m testing:</p>
<section id="creativity" class="level3">
<h3 class="anchored" data-anchor-id="creativity">Creativity</h3>
<p>The TinyStories paper reported:</p>
<ul>
<li>1M: 0.47</li>
<li>8M: 0.65</li>
<li>28M: 0.69</li>
</ul>
<p>My scores:</p>
<ul>
<li>1M: 0.12</li>
<li>8M: 0.16</li>
<li>28M: 0.32</li>
</ul>
<p>This was really interesting - I was expecting my assessment to be maybe a little lenient, but it turns out that’s not the case. My scores were significantly lower. The 28M parameter model (which is actually 60M) got 70% for creativity in the paper, while mine was at 30%. I might have to change that criteria over the course of this project, or it might turn out that for creativity, I have a stricter judge.</p>
</section>
<section id="grammar" class="level3">
<h3 class="anchored" data-anchor-id="grammar">Grammar</h3>
<p>TinyStories:</p>
<ul>
<li>1M: 0.61</li>
<li>8M: 0.77</li>
<li>28M: 0.83</li>
</ul>
<p>My scores:</p>
<ul>
<li>1M: 0.59</li>
<li>8M: 0.82</li>
<li>28M: 0.86</li>
</ul>
<p>This matched out pretty well! 61%/59%, 77%/82%, and 83%/86%. The most common baseline capability matches between the targets and my relatively rough evaluation, so thumbs up!</p>
</section>
<section id="context-tracking-consistency" class="level3">
<h3 class="anchored" data-anchor-id="context-tracking-consistency">Context-Tracking (Consistency)</h3>
<p>TinyStories:</p>
<ul>
<li>1M: 0.45</li>
<li>8M: 0.80</li>
<li>28M: 0.90</li>
</ul>
<p>My scores:</p>
<ul>
<li>1M: 0.14</li>
<li>8M: 0.51</li>
<li>28M: 0.63</li>
</ul>
<p>Similar to creativity, it turns out that my criteria or my judging is a lot stricter than the GPT-4 evaluator used in the paper. The highest score in the paper was 90%, whereas mine was 63%. I’m not too worried about this - I would much rather be stricter than not. However, I’ll be open to changing my approach later on if that turns out to be a problem.</p>
</section>
<section id="plot" class="level3">
<h3 class="anchored" data-anchor-id="plot">Plot</h3>
<p>TinyStories: - 1M: 0.44 - 8M: 0.72 - 28M: 0.73</p>
<p>My scores: - 1M: 0.10 - 8M: 0.42 - 28M: 0.60</p>
<p>The 28M scores for Plot are in the same range but medium-sized and small model scores are significantly different.</p>
<p>Factual Knowledge and Reasoning were not quantitatively assessed in the TinyStories paper in the way that these other scores were listed, so I don’t have those reference points for my evaluation.</p>
</section>
</section>
<section id="observations-from-manual-scoring" class="level2">
<h2 class="anchored" data-anchor-id="observations-from-manual-scoring">Observations From Manual Scoring</h2>
<p>After manually scoring 450 stories, I have some observations:</p>
<ol type="1">
<li><p>Judging quality improves (and changes) over time</p>
<ul>
<li>Implicit judging criteria surfaces over time.</li>
<li>By the time I was doing the last hundred, I realized that I was a lot more definitive in giving 0s, 0.5s, and 1s.</li>
<li>Thee largest model likely has the strictest scores (it was graded last).</li>
</ul></li>
<li><p>Phrasing of scoring criteria improved</p>
<ul>
<li>I wanted to be able to answer the question as fast as I could (450 stories to get through!) with a quick yes, no, maybe (1, 0, 0.5).</li>
<li>Initially, some of the criteria were phrased as questions, requiring more cognitive work. I expect that rephrasing the criteria as statements will also ease the “cognitive load” for my LLM judge.</li>
</ul></li>
<li><p>I identified one duplicate prompt and replaced it</p></li>
<li><p>Pros and cons of isolating scoring categories</p>
<ul>
<li>I scored each category in isolation.</li>
<li>More times than not, I found this very liberating—I could assess Creativity without worrying about Context-Tracking or Plot.</li>
<li>However, language is very difficult to compartmentalize. If something’s not factually correct, it will be a distraction when assessing Reasoning. If the context is not being tracked, it makes it harder to assess plot.</li>
<li>Regardless, I thought this isolation of scoring categories overall benefited my approach</li>
</ul></li>
</ol>
</section>
<section id="exciting-discoveries" class="level2">
<h2 class="anchored" data-anchor-id="exciting-discoveries">Exciting Discoveries</h2>
<p>The main takeaway for me, which was very cool to see, is that Reasoning and Factual Knowledge capabilities exists even for the smallest model. The 1M model scored 20% on Reasoning - that’s not nothing!</p>
<p>The fact that there are non-zero values for these tiny models is really mind-blowing to me. It’s really exciting because there’s potential. We can do something with this, especially as these are just pre-trained models—we haven’t fine-tuned them yet. What can we do with this Reasoning and Factual Knowledge capability? That’s what really excites me moving forward.</p>
</section>
<section id="process-improvements" class="level2">
<h2 class="anchored" data-anchor-id="process-improvements">Process Improvements</h2>
<p>When generating completions for my Reasoning and Factual Knowledge, I want to remove the <code>min_length</code> parameter for <code>model.generate()</code> because I don’t want there to be a minimum generation length when the answer can be a few tokens, forcing the model to uneccesarily elongate the story. However, I won’t make this change for my LLM judge as I want to compare its scores with mine for the same prompt/completion pairs.</p>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>With a full eval set scored, I can now move on to prompt engineering an LLM judge (I’ll be using Gemini 2.5 Flash and Claude Haiku 3.5). My goal is for a 90%+ alignment between my scores and the LLM judge before I choose to use it for future experiments.</p>
<p>Follow along this project (and others) in my <a href="https://www.youtube.com/@vishal_learner">YouTube channel!</a>.</p>


</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-05-01-TSL-Initial-Scoring-Results/</guid>
  <pubDate>Thu, 01 May 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>Curating Evaluation Prompts, Defining Scoring Criteria, and Designing an LLM Judge Prompt Template</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/</link>
  <description><![CDATA[ 




<section id="recap-and-initial-approach" class="level2">
<h2 class="anchored" data-anchor-id="recap-and-initial-approach">Recap and Initial Approach</h2>
<p>Initially, I planned to use the 44 evaluation prompts from the Tiny Stories dataset HuggingFace repo. These were the same prompts used in the paper to evaluate various model sizes.</p>
<p>I also documented the target scores for evaluation based on the TinyStories’ 10-point scoring rubric for my TinyScaleLab architectures:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Similar to</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Num Layers</th>
<th style="text-align: center;">Eval Loss</th>
<th style="text-align: center;">Creativity</th>
<th style="text-align: center;">Grammar</th>
<th style="text-align: center;">Consistency</th>
<th style="text-align: center;">Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">TSL-5M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">2.02</td>
<td style="text-align: center;">4.84</td>
<td style="text-align: center;">6.19</td>
<td style="text-align: center;">4.75</td>
<td style="text-align: center;">4.39</td>
</tr>
<tr class="even">
<td style="text-align: center;">TSL-25M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.38</td>
<td style="text-align: center;">6.54</td>
<td style="text-align: center;">7.72</td>
<td style="text-align: center;">8.02</td>
<td style="text-align: center;">7.23</td>
</tr>
<tr class="odd">
<td style="text-align: center;">TSL-60M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">Average of 4 and 8 scores</td>
<td style="text-align: center;">1.23</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">8.35</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">7.31</td>
</tr>
<tr class="even">
<td style="text-align: center;">TSL-125M</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.18</td>
<td style="text-align: center;">7.02</td>
<td style="text-align: center;">8.62</td>
<td style="text-align: center;">9.34</td>
<td style="text-align: center;">7.34</td>
</tr>
</tbody>
</table>
<p>I am particularly interested in matching the scores shown in the table above, which presents results from GPT-4 evaluations of models with different hidden dimensions and layer counts.</p>
</section>
<section id="one-prompt-to-score-them-all" class="level2">
<h2 class="anchored" data-anchor-id="one-prompt-to-score-them-all">One Prompt to Score them All?</h2>
<p>The Tiny Stories paper used distinct approaches for different capabilities in Section 4.2 (“Knowledge, reasoning and context-tracking”):</p>
<ul>
<li><strong>Factual prompts</strong> - testing models’ knowledge of common sense facts</li>
<li><strong>Reasoning prompts</strong> - testing basic reasoning abilities</li>
<li><strong>Consistency (context-tracking) prompts</strong> - testing models’ ability to maintain coherence</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Knowledge, Reasoning and Context-Tracking Section"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/1.png" class="img-fluid figure-img" alt="Knowledge, Reasoning and Context-Tracking Section"></a></p>
<figcaption>Knowledge, Reasoning and Context-Tracking Section</figcaption>
</figure>
</div>
<p>What caught my attention was how they assessed these differently, using qualitative measures (success, failure, or partial success) rather than the numerical scores used for other categories.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Performance Table Example"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/2.png" class="img-fluid figure-img" alt="Performance Table Example"></a></p>
<figcaption>Performance Table Example</figcaption>
</figure>
</div>
</section>
<section id="analyzing-the-44-prompts" class="level2">
<h2 class="anchored" data-anchor-id="analyzing-the-44-prompts">Analyzing the 44 Prompts</h2>
<p>I asked Claude to analyze the 44 prompts from the dataset repository to identify which ones were good evaluators for factual knowledge, reasoning, and context-tracking capabilities.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Claude Prompt Analysis"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/3.png" class="img-fluid figure-img" alt="Claude Prompt Analysis"></a></p>
<figcaption>Claude Prompt Analysis</figcaption>
</figure>
</div>
<p>When Claude assessed the prompts, I noticed:</p>
<ol type="1">
<li>Factual knowledge prompts were the most specific/easiest to isolate.</li>
<li>Context-tracking prompts were dime a dozen (found everywhere).</li>
<li>Reasoning was hard to isolate from context-tracking.</li>
</ol>
<p>This led me to an important realization: <strong>I needed to curate specific prompts for each scoring category rather than using one set for all</strong>.</p>
</section>
<section id="prompts-for-creativity-and-plot" class="level2">
<h2 class="anchored" data-anchor-id="prompts-for-creativity-and-plot">Prompts for Creativity and Plot</h2>
<p>For creativity and plot, the challenge was different. Here, I needed prompts that <strong>provided opportunities</strong> for models to exhibit these capabilities.</p>
<p>When flagging good candidates for creativity, I looked for prompts that allowed creative responses <strong>without sacrificing consistency or plot</strong>. Not all prompts are equal in this regard.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="4.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Creativity Example"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/4.png" class="img-fluid figure-img" alt="Creativity Example"></a></p>
<figcaption>Creativity Example</figcaption>
</figure>
</div>
<p>For plot, I sought prompts that provided strong opportunities to resolve conflict or pursue adventure—elements that test a model’s ability to construct a coherent narrative arc.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="5.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Plot Example"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/5.png" class="img-fluid figure-img" alt="Plot Example"></a></p>
<figcaption>Plot Example</figcaption>
</figure>
</div>
</section>
<section id="curating-category-specific-prompts" class="level2">
<h2 class="anchored" data-anchor-id="curating-category-specific-prompts">Curating Category-Specific Prompts</h2>
<p>Using the factual and reasoning prompts from the paper as a foundation, I worked with Claude to generate additional prompts for each category. Here are examples for factual knowledge:</p>
<ul>
<li>Alice was so tired when she got back home so she went</li>
<li>Jack and Lily saw a rain- bow after a rainy day. They were amazed by the colors. Jack said, “Look, Lily. A rainbow has</li>
<li>Jack and Lily liked to watch the moon at night. They noticed that the moon changed its shape every night. Sometimes the moon was big and round, and sometimes it was</li>
<li>Jack wanted to read a book, so he went to</li>
</ul>
<p>And reasoning prompts:</p>
<ul>
<li>Lily likes cats and dogs. She asked her mom for a dog and her mom said no, so instead she asked</li>
<li>Jack told Mary, ‘If you give me your banana, I’ll give you my apple’. Mary gave Jack her banana so</li>
<li>On weekends Jack went to visit his grandmother whereas on weekdays he would go to school. Last weekend, when Jack was on his way to</li>
<li>Lily and Ben were having an argument. Ben said that cake is much better than ice cream and Lily said that</li>
<li>Lily and Ben are having an argument. They are trying to decide between the park and the swimming pool. Ben says, ‘I want to go to the park’. Lily says</li>
</ul>
<p>I followed a similar process for plot prompts:</p>
<ul>
<li>Once upon a time, there lived a bunny in a field. Her name was Lucy. Lucy loved to have feasts and parties with her bunny friends. One day, when Lucy was about to leave for a feast at a friend’s house, she realized she’s starting to feel sick. She was so weak she could</li>
<li>One day a girl walked into the living room and noticed something very strange. There was a huge cabinet standing in the corner. It looked very old and heavy. She walked over and tried to open it, when suddenly</li>
<li>Once upon a time, there lived a hamster in the forest. Every day, he would walked around the forest looking for adventures. One day, he heard someone calling out from behind the bushes. The hamster listened carefully. He realised that it was a small mouse calling out for help. It got stuck under a heavy log and couldn’t get out. The hamster immediately realized that</li>
<li>Alice walked into the kitchen and saw Ben who was looking for something but looked frustrated. She said, “Ben, why are you</li>
</ul>
<p>And creativity:</p>
<ul>
<li>One day a girl walked into the living room and noticed something very strange. There was a huge cabinet standing in the corner. It looked very old and heavy. She walked over and tried to open it, when suddenly</li>
<li>Once upon a time, there was tiger who liked to play the guitar. One day, a bunny heard the guitar from a distance and</li>
<li>One day, a bird was flying high over the sea. At some point the bird noticed small boat with a boy sitting inside. The boy looked lost so</li>
</ul>
<p>I used most of the original 44 prompts for context-tracking, and sampled 5 from each of the non-Grammar categories for Grammar.</p>
</section>
<section id="current-evaluation-prompt-set" class="level2">
<h2 class="anchored" data-anchor-id="current-evaluation-prompt-set">Current Evaluation Prompt Set</h2>
<p>My final evaluation set includes: - 25 unique prompts for Reasoning - 25 unique prompts for Factual Knowledge - 25 prompts each for Context-Tracking, Plot, and Creativity (with some overlap) - 25 prompts for Grammar (5 prompts sampled from the other 5 categories)</p>
<p>This gives me a total of 150 prompts—significantly more than the original 44, but with targeted coverage of each capability.</p>
</section>
<section id="scoring-category-rubrics" class="level2">
<h2 class="anchored" data-anchor-id="scoring-category-rubrics">Scoring Category Rubrics</h2>
<p>For each scoring category, I developed specific rubrics, taking many of them wholesale from the TinyHackathon competition I recently participated in:</p>
<section id="grammar" class="level3">
<h3 class="anchored" data-anchor-id="grammar">Grammar</h3>
<ul>
<li>Dialogue formatting and punctuation</li>
<li>Tense consistency throughout the narrative</li>
<li>Sentence structure logic, clarity and completion</li>
<li>Age-appropriate vocabulary usage</li>
<li>Proper use of pronouns and referents</li>
</ul>
</section>
<section id="creativity" class="level3">
<h3 class="anchored" data-anchor-id="creativity">Creativity</h3>
<ul>
<li>Does the completion offer unexpected or novel elements?</li>
<li>Are character behavioral and emotional responses predictable or innovative?</li>
<li>Does the story rely on cliches or create fresh situations?</li>
<li>Does the writer add unique details to the story world?</li>
</ul>
</section>
<section id="plot" class="level3">
<h3 class="anchored" data-anchor-id="plot">Plot</h3>
<ul>
<li>Is there a clear beginning, middle, and end appropriate to age level?</li>
<li>Are conflicts addressed rather than abandoned?</li>
<li>Is the pacing appropriate (not too rushed or dragging)?</li>
<li>Does the story maintain focus on the central conflict/theme without random diversions?</li>
</ul>
</section>
<section id="factual-knowledge" class="level3">
<h3 class="anchored" data-anchor-id="factual-knowledge">Factual Knowledge</h3>
<ul>
<li>Completion contains only correct factual information relevant to the prompt</li>
</ul>
</section>
</section>
<section id="reasoning" class="level2">
<h2 class="anchored" data-anchor-id="reasoning">Reasoning</h2>
<ul>
<li>Completion demonstrates correct logical reasoning relevant to the prompt</li>
</ul>
<section id="context-tracking" class="level3">
<h3 class="anchored" data-anchor-id="context-tracking">Context-Tracking</h3>
<ul>
<li>Competion maintains complete coherence with prompt</li>
<li>Correctly references/tracks all objects, characters, and their attributes</li>
<li>Maintains consistent narrative flow</li>
</ul>
<p>Notice that different categories have different numbers of criteria:</p>
<ul>
<li>Grammar: 5 criteria</li>
<li>Creativity: 4 criteria</li>
<li>Plot: 4 criteria</li>
<li>Context-tracking: 3 criteria</li>
<li>Factual knowledge: 1 criterion</li>
<li>Reasoning: 1 criterion</li>
</ul>
<p>This means raw scores aren’t directly comparable across categories, which will require normalization during analysis.</p>
</section>
</section>
<section id="llm-judge-prompt-template" class="level2">
<h2 class="anchored" data-anchor-id="llm-judge-prompt-template">LLM Judge Prompt Template</h2>
<p>Instead of using one prompt for all categories, I created a specific judge prompt template for each category:</p>
<pre><code>&lt;instruction-prompt id="Evaluation"&gt;
&lt;instruction&gt;
You are an expert evaluator for tiny language models trained on children's stories. Your task is to score the given model completion (generated using the provided prompt) using the rubric below. Provide a detailed assessment followed by a final total score.
&lt;/instruction&gt;

&lt;rubric&gt;
&lt;criteria&gt;
&lt;criterion id="A"&gt;&lt;/criterion&gt;
&lt;criterion id="B"&gt;&lt;/criterion&gt;
&lt;criterion id="C"&gt;&lt;/criterion&gt;
&lt;criterion id="D"&gt;&lt;/criterion&gt;
&lt;criterion id="E"&gt;&lt;/criterion&gt;
&lt;/criteria&gt;

&lt;scoring-scale&gt;
&lt;level value="1.0"&gt;Criterion is fully satisfied&lt;/level&gt;
&lt;level value="0.5"&gt;Criterion is partially satisfied&lt;/level&gt;
&lt;level value="0.0"&gt;Criterion is not satisfied&lt;/level&gt;
&lt;/scoring-scale&gt;

&lt;scoring-instructions&gt;
For each criterion A-E, assign a score of 1.0, 0.5, or 0.0 based on how well the completion satisfies that criterion. The final score is the sum of all criterion scores.
&lt;/scoring-instructions&gt;
&lt;/rubric&gt;

&lt;generation-prompt&gt;
{prompt}
&lt;/generation-prompt&gt;

&lt;completion&gt;
{completion}
&lt;/completion&gt;

&lt;response-format&gt;
Provide your assessment of each criterion with specific examples from the text, then calculate the final score (sum of all criterion scores).

Format your response as:
&lt;evaluation&gt;
&lt;criterion-A-score&gt;[0.0, 0.5, or 1.0]&lt;/criterion-A-score&gt;
&lt;criterion-A-explanation&gt;Your explanation here&lt;/criterion-A-explanation&gt;

&lt;criterion-B-score&gt;[0.0, 0.5, or 1.0]&lt;/criterion-B-score&gt;
&lt;criterion-B-explanation&gt;Your explanation here&lt;/criterion-B-explanation&gt;

&lt;criterion-C-score&gt;[0.0, 0.5, or 1.0]&lt;/criterion-C-score&gt;
&lt;criterion-C-explanation&gt;Your explanation here&lt;/criterion-C-explanation&gt;

&lt;criterion-D-score&gt;[0.0, 0.5, or 1.0]&lt;/criterion-D-score&gt;
&lt;criterion-D-explanation&gt;Your explanation here&lt;/criterion-D-explanation&gt;

&lt;criterion-E-score&gt;[0.0, 0.5, or 1.0]&lt;/criterion-E-score&gt;
&lt;criterion-E-explanation&gt;Your explanation here&lt;/criterion-E-explanation&gt;

&lt;final-score&gt;[Sum of all criterion scores, between #.# and #.#]&lt;/final-score&gt;
&lt;/evaluation&gt;
&lt;/response-format&gt;
&lt;/instruction-prompt&gt;</code></pre>
<p>The template includes:</p>
<ul>
<li>Instructions for the judge</li>
<li>Criteria specific to the category being evaluated</li>
<li>Scoring scale (0, 0.5, 1.0)</li>
<li>Scoring instructions</li>
<li>Response format</li>
</ul>
</section>
<section id="initial-testing" class="level2">
<h2 class="anchored" data-anchor-id="initial-testing">Initial Testing</h2>
<p>I tested the approach with Claude Haiku 3.5, and the results were promising. When evaluating grammar, it gave a weaker model a score of 3.5/5. When I gave it a larger model’s completion, it scored it 5/5. This suggests the approach can successfully differentiate between model capabilities.</p>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next Steps</h2>
<p>My immediate next steps are:</p>
<ol type="1">
<li>Generate 150 completions, one for each the 150 prompts, per TinyStories model (1M, 8M, 28M).</li>
<li>Build an evaluation interface to help grade model responses using FastHTML.</li>
<li>Score all completions using the 0/0.5/1.0 methodology.</li>
<li>Compare results with the targets from the Tiny Stories paper.</li>
<li>Refine scoring rubric if needed.</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="6.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Evaluation Interface Mockup"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/6.png" class="img-fluid figure-img" alt="Evaluation Interface Mockup"></a></p>
<figcaption>Evaluation Interface Mockup</figcaption>
</figure>
</div>
<p>I expect this to take several days as generating completions, building the interface, and evaluating 450 prompts (150 for each of three models) is no small task! Thankfully, it’s terribly large either.</p>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The journey from a simple plan to use 44 prompts to a comprehensive evaluation approach with 150 category-specific prompts shows how even “squishy” concepts like language can be systematically evaluated with the right structure.</p>
<p>By distinguishing between capabilities that need to be isolated (factual knowledge, reasoning, context-tracking) and those that need opportunities to be exhibited (creativity and plot), I’ve created what I believe is a robust evaluation methodology. Obviously, time, very quickly and definitely, will tell.</p>
<p>I’m excited to see if this approach gives me scores comparable to those in the Tiny Stories paper. Stay tuned for the results!</p>


</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-04-28-TSL-Curating-Eval-Prompts/</guid>
  <pubDate>Mon, 28 Apr 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>TinyScaleLab Update: Training Cost Analysis and Evaluation Infrastructure Plans</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-04-27-TSL-Initial-Training-Runs/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this notebook I’ll share results from some quick and dirty training runs executed so I get a rough but reasonable estimate of training time and costs using L4 and A100 GPUs on Google Colab Pro.</p>
</section>
<section id="model-sizes" class="level2">
<h2 class="anchored" data-anchor-id="model-sizes">Model Sizes</h2>
<p>In these experiments, I’m training four model sizes: 5M, 25M, 60M and 125M. I’ve chosen to roughly follow the TinyStories models, using the hidden dimension and intermediate dimension for the TinyStories-1M, -8M, -28M and -33M models, in each case there is a 4x increase from hidden to intermediate dimension in the MLP layers. These are just initial architectural choices which might change over the course of the project as I learn more about what results in a better performing model.</p>
<p>For now, I’m using 8 attention heads (for all models) and the Llama-2 tokenizer with a 32000 vocab size.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model Name</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Intermediate Dim</th>
<th style="text-align: center;">Number of Layers</th>
<th style="text-align: center;">Number of Params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">5M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">4_949_696</td>
</tr>
<tr class="even">
<td style="text-align: center;">25M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">1024</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">24_776_960</td>
</tr>
<tr class="odd">
<td style="text-align: center;">60M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2048</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">57_940_480</td>
</tr>
<tr class="even">
<td style="text-align: center;">125M</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">3072</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">124_662_528</td>
</tr>
</tbody>
</table>
</section>
<section id="training-dataset" class="level2">
<h2 class="anchored" data-anchor-id="training-dataset">Training Dataset</h2>
<p>I’ve tokenized the <a href="https://huggingface.co/datasets/roneneldan/TinyStories/blob/main/TinyStories_all_data.tar.gz">TinyStories_all_data.tar.gz</a> dataset which contains 4.9M stories generated by GPT3.5 and GPT4, using the <code>meta-llama/Llama-2-7b-hf</code> tokenizer. I haven’t performed any data cleaning (yet). The total number of tokens in this dataset is little over 1B: <strong>1_028_013_532</strong>.</p>
</section>
<section id="training-duration" class="level2">
<h2 class="anchored" data-anchor-id="training-duration">Training Duration</h2>
<p>I’m training all initial runs for 1 epoch.</p>
</section>
<section id="training-gpus" class="level2">
<h2 class="anchored" data-anchor-id="training-gpus">Training GPUs</h2>
<p>I trained the 5M and 25M models on both L4 (22.5 GB VRAM) and A100 (40GB VRAM) GPUs. I trained the 60M and 125M models on the A100 GPU.</p>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<p>All models are trained for 1 epoch (1.03 tokens):</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Hardware</th>
<th style="text-align: center;">Model Size</th>
<th style="text-align: center;">Time (hr)</th>
<th style="text-align: center;">Batch Size</th>
<th style="text-align: center;">Max Memory</th>
<th style="text-align: center;">Cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">L4</td>
<td style="text-align: center;">5M</td>
<td style="text-align: center;">0.87</td>
<td style="text-align: center;">384</td>
<td style="text-align: center;">20%</td>
<td style="text-align: center;">$0.18</td>
</tr>
<tr class="even">
<td style="text-align: center;">L4</td>
<td style="text-align: center;">25M</td>
<td style="text-align: center;">1.45</td>
<td style="text-align: center;">288</td>
<td style="text-align: center;">65%</td>
<td style="text-align: center;">$0.30</td>
</tr>
<tr class="odd">
<td style="text-align: center;">A100-40GB</td>
<td style="text-align: center;">5M</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">2048</td>
<td style="text-align: center;">78%</td>
<td style="text-align: center;">$0.25</td>
</tr>
<tr class="even">
<td style="text-align: center;">A100-40GB</td>
<td style="text-align: center;">25M</td>
<td style="text-align: center;">0.35</td>
<td style="text-align: center;">1536</td>
<td style="text-align: center;">98%</td>
<td style="text-align: center;">$0.27</td>
</tr>
<tr class="odd">
<td style="text-align: center;">A100-40GB</td>
<td style="text-align: center;">60M</td>
<td style="text-align: center;">0.54</td>
<td style="text-align: center;">1152</td>
<td style="text-align: center;">86%</td>
<td style="text-align: center;">$0.41</td>
</tr>
<tr class="even">
<td style="text-align: center;">A100-40GB</td>
<td style="text-align: center;">125M</td>
<td style="text-align: center;">1.10</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">99%</td>
<td style="text-align: center;">$0.84</td>
</tr>
</tbody>
</table>
</section>
<section id="takeaways" class="level2">
<h2 class="anchored" data-anchor-id="takeaways">Takeaways</h2>
<p>From this analysis, only the 5M model makes sense to train on the L4. It’s 3 cents cheaper per hour to train the 25M model on the A100, though I’m flirting with OOM so I should reduce the batch size.</p>
<p>I’ll need to perform longer trainings to get a sense of how many full epochs I need to produce coherent language-generating models, but from my TinyHackathon experience, it took 20 epochs for the 60M model to perform decently (3/5 LLM Judge overall score). I would expect the 125M model to require less epochs, and the smaller models more epochs, to achieve comparable performance. But we’ll see!</p>
</section>
<section id="appendix" class="level2">
<h2 class="anchored" data-anchor-id="appendix">Appendix</h2>
<p>Here are the <code>LlamaConfig</code> objects for each model:</p>
<section id="m" class="level3">
<h3 class="anchored" data-anchor-id="m">5M</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LlamaConfig(</span>
<span id="cb1-2">    vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32000</span>,</span>
<span id="cb1-3">    hidden_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span>,</span>
<span id="cb1-4">    intermediate_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,</span>
<span id="cb1-5">    num_hidden_layers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>,</span>
<span id="cb1-6">    num_attention_heads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb1-7">    max_position_embeddings<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,</span>
<span id="cb1-8">    rope_theta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000.0</span>,</span>
<span id="cb1-9">    attention_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb1-10">    mlp_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb1-11">    attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>,</span>
<span id="cb1-12">    torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bfloat16"</span></span>
<span id="cb1-13">)</span></code></pre></div>
</section>
<section id="m-1" class="level3">
<h3 class="anchored" data-anchor-id="m-1">25M</h3>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LlamaConfig(</span>
<span id="cb2-2">    vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32000</span>,</span>
<span id="cb2-3">    hidden_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">256</span>,</span>
<span id="cb2-4">    intermediate_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1024</span>,</span>
<span id="cb2-5">    num_hidden_layers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb2-6">    num_attention_heads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb2-7">    max_position_embeddings<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,</span>
<span id="cb2-8">    rope_theta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000.0</span>,</span>
<span id="cb2-9">    attention_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb2-10">    mlp_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb2-11">    attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>,</span>
<span id="cb2-12">    torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bfloat16"</span></span>
<span id="cb2-13">)</span></code></pre></div>
</section>
<section id="m-2" class="level3">
<h3 class="anchored" data-anchor-id="m-2">60M</h3>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LlamaConfig(</span>
<span id="cb3-2">    vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32000</span>,</span>
<span id="cb3-3">    hidden_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,</span>
<span id="cb3-4">    intermediate_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2048</span>,</span>
<span id="cb3-5">    num_hidden_layers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb3-6">    num_attention_heads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb3-7">    max_position_embeddings<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,</span>
<span id="cb3-8">    rope_theta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000.0</span>,</span>
<span id="cb3-9">    attention_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb3-10">    mlp_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb3-11">    attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>,</span>
<span id="cb3-12">    torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bfloat16"</span></span>
<span id="cb3-13">)</span></code></pre></div>
</section>
<section id="m-3" class="level3">
<h3 class="anchored" data-anchor-id="m-3">125M</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> LlamaConfig(</span>
<span id="cb4-2">    vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32000</span>,</span>
<span id="cb4-3">    hidden_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">768</span>,</span>
<span id="cb4-4">    intermediate_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3072</span>,</span>
<span id="cb4-5">    num_hidden_layers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-6">    num_attention_heads<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb4-7">    max_position_embeddings<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">512</span>,</span>
<span id="cb4-8">    rope_theta<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000.0</span>,</span>
<span id="cb4-9">    attention_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb4-10">    mlp_bias<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb4-11">    attn_implementation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"flash_attention_2"</span>,</span>
<span id="cb4-12">    torch_dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bfloat16"</span></span>
<span id="cb4-13">)</span></code></pre></div>


</section>
</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-04-27-TSL-Initial-Training-Runs/</guid>
  <pubDate>Sun, 27 Apr 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>TinyScale Lab Update: Setting Eval Targets and Generating Completions for LLM Judge Development</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-04-27-TSL-Setting-Eval-Targets/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>In this notebook I’m going to generate story completions using the TinyStories 1M, 8M, 28M models. The actual HF model size for these models is 3.7M, 19.7M and 52M, respectively. Since I’m training 5M, 25M, 60M and 125M models, these three TinyStories models will serve as proxies for my first three sizes, and I will expect my 125M model to generate stories that receive higher scores than my 60M (by how much higher is TBD).</p>
<p>Ronen Eldan, the TinyStories paper author, has listed on <a href="https://huggingface.co/roneneldan/TinyStories-33M/discussions/9#64f94b050a2884a831b29eb6">this HF model card discussion forum</a>:</p>
<blockquote class="blockquote">
<p>we used temp=0, beams=5</p>
</blockquote>
<p>So I’ll be using those two settings during inference.</p>
<p>Here are some key architectural details for my initial quick-and-dirty models:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model Name</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Intermediate Dim</th>
<th style="text-align: center;">Number of Layers</th>
<th style="text-align: center;">Number of Params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">5M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">4_949_696</td>
</tr>
<tr class="even">
<td style="text-align: center;">25M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">1024</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">24_776_960</td>
</tr>
<tr class="odd">
<td style="text-align: center;">60M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2048</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">57_940_480</td>
</tr>
<tr class="even">
<td style="text-align: center;">125M</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">3072</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">124_662_528</td>
</tr>
</tbody>
</table>
<p>Here are my initial scoring categories, based on type of language model capability:</p>
<ul>
<li><strong>Foundational language capabilities</strong>: Grammar and Context-Tracking (Consistency)</li>
<li><strong>Emergent capabilities</strong>: Factual Knowledge, Reasoning, Creativity</li>
<li><strong>Story-related capabilities</strong>: Plot</li>
</ul>
<p>Referencing Figure 4 in the <a href="https://arxiv.org/abs/2305.07759">TinyStories paper</a> I would expect to achieve LLM Judge for these models close to the following (TSL = TinyScale Lab):</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Similar to</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Num Layers</th>
<th style="text-align: center;">Eval Loss</th>
<th style="text-align: center;">Creativity</th>
<th style="text-align: center;">Grammar</th>
<th style="text-align: center;">Consistency</th>
<th style="text-align: center;">Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">TSL-5M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">12</td>
<td style="text-align: center;">2.02</td>
<td style="text-align: center;">4.84</td>
<td style="text-align: center;">6.19</td>
<td style="text-align: center;">4.75</td>
<td style="text-align: center;">4.39</td>
</tr>
<tr class="even">
<td style="text-align: center;">TSL-25M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.38</td>
<td style="text-align: center;">6.54</td>
<td style="text-align: center;">7.72</td>
<td style="text-align: center;">8.02</td>
<td style="text-align: center;">7.23</td>
</tr>
<tr class="odd">
<td style="text-align: center;">TSL-60M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">Average of 4 and 8 scores</td>
<td style="text-align: center;">1.23</td>
<td style="text-align: center;">6.8</td>
<td style="text-align: center;">8.35</td>
<td style="text-align: center;">8.7</td>
<td style="text-align: center;">7.31</td>
</tr>
<tr class="even">
<td style="text-align: center;">TSL-125M</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.18</td>
<td style="text-align: center;">7.02</td>
<td style="text-align: center;">8.62</td>
<td style="text-align: center;">9.34</td>
<td style="text-align: center;">7.34</td>
</tr>
</tbody>
</table>
<p>Mapping the Figure 4 scores to the official 1M, 8M and 28M models directly:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">TinyStories</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Num Layers</th>
<th style="text-align: center;">Eval Loss</th>
<th style="text-align: center;">Creativity</th>
<th style="text-align: center;">Grammar</th>
<th style="text-align: center;">Consistency</th>
<th style="text-align: center;">Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2.08</td>
<td style="text-align: center;">4.68</td>
<td style="text-align: center;">6.14</td>
<td style="text-align: center;">4.45</td>
<td style="text-align: center;">4.40</td>
</tr>
<tr class="even">
<td style="text-align: center;">8M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.38</td>
<td style="text-align: center;">6.54</td>
<td style="text-align: center;">7.72</td>
<td style="text-align: center;">8.02</td>
<td style="text-align: center;">7.23</td>
</tr>
<tr class="odd">
<td style="text-align: center;">28M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.20</td>
<td style="text-align: center;">6.85</td>
<td style="text-align: center;">8.34</td>
<td style="text-align: center;">8.95</td>
<td style="text-align: center;">7.26</td>
</tr>
</tbody>
</table>
<p>The two scoring categories I’m using that are not assessed quantitatively in the TinyStories paper: Factual Knowledge and Reasoning. If my LLM Judge scores match Figure 4 for the other four categories and match my manual evaluations for all six categories, I should expect the LLM Judge to assess these two categories correctly.</p>
</section>
<section id="evaluation-prompts" class="level2">
<h2 class="anchored" data-anchor-id="evaluation-prompts">Evaluation Prompts</h2>
<p>Lucky for me, the TinyStories authors have published their <a href="https://huggingface.co/datasets/roneneldan/TinyStories/blob/main/Evaluation%20prompts.yaml">evaluation prompts</a>.</p>
<div id="cell-11" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="6457a149-b8a1-44fe-9171-592115dbf3af" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> yaml</span>
<span id="cb1-3">url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://huggingface.co/datasets/roneneldan/TinyStories/raw/main/Evaluation%20prompts.yaml"</span></span>
<span id="cb1-4">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.get(url)</span>
<span id="cb1-5">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> yaml.safe_load(response.text)</span>
<span id="cb1-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>44</code></pre>
</div>
</div>
<div id="cell-12" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:53}}" data-outputid="c65bbed1-af12-43b2-98a4-a8a702fa16e4" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1">data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>"Once upon a time, there lived a bunny in a field. Her name was Lucy. Lucy loved to have feasts and parties with her bunny friends. One day, when Lucy was about to leave for a feast at a friend's house, she realized she's starting to feel sick. She was so weak she could"</code></pre>
</div>
</div>
</section>
<section id="generating-story-completions" class="level2">
<h2 class="anchored" data-anchor-id="generating-story-completions">Generating Story Completions</h2>
<p>I’ll walk through some basic generation code to make sure it works before I apply it to the full dataset.</p>
<div id="cell-15" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoTokenizer, AutoModelForCausalLM</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span></code></pre></div>
</div>
<div id="cell-16" class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roneneldan/TinyStories-1M"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb6-2">tokz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roneneldan/TinyStories-1M"</span>)</span>
<span id="cb6-3">tokz.pad_token_id</span></code></pre></div>
</div>
<div id="cell-17" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1">tokz.pad_token <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz.eos_token</span></code></pre></div>
</div>
<p>To my knowledge, you want tokz.padding_side to be “left” during batched inference, and the default here is “right”. Examples of difference shown for batched prompts. Padding right starts the next token prediction with the pad token, padding left with the last tok in prompt.</p>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="91b9d304-8ca3-4080-a601-60ec83e1e0a6" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">tokz.bos_token_id, tokz.eos_token_id, tokz.pad_token_id, tokz.padding_side</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(50256, 50256, 50256, 'right')</code></pre>
</div>
</div>
<div id="cell-20" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:105}}" data-outputid="cf22cd11-a1b7-4458-e2f4-a8fc94b411b1" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz(data, padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, truncation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, return_tensors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb10-2">tokz.decode(inputs.input_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>"Once upon a time, there lived a bunny in a field. Her name was Lucy. Lucy loved to have feasts and parties with her bunny friends. One day, when Lucy was about to leave for a feast at a friend's house, she realized she's starting to feel sick. She was so weak she could&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;"</code></pre>
</div>
</div>
<div id="cell-21" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:105}}" data-outputid="bb4b5968-acbe-43dc-a4dc-952fad6e2b5c" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1">tokz.padding_side <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span></span>
<span id="cb12-2">inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz(data, padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, truncation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, return_tensors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb12-3">tokz.decode(inputs.input_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>"&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;&lt;|endoftext|&gt;Once upon a time, there lived a bunny in a field. Her name was Lucy. Lucy loved to have feasts and parties with her bunny friends. One day, when Lucy was about to leave for a feast at a friend's house, she realized she's starting to feel sick. She was so weak she could"</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="8cab2d05-e8e7-4b77-e76c-5b1df238f698" data-execution_count="15">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1">inputs.input_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>tensor([50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256,
        50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256,
        50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256,
        50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256,
        50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256, 50256,
        50256, 50256, 50256, 50256, 50256,  7454,  2402,   257,   640,    11,
          612,  5615,   257, 44915,   287,   257,  2214,    13,  2332,  1438,
          373, 22162,    13, 22162,  6151,   284,   423,   730,  5773,   290,
         4671,   351,   607, 44915,  2460,    13,  1881,  1110,    11,   618,
        22162,   373,   546,   284,  2666,   329,   257, 26951,   379,   257,
         1545,   338,  2156,    11,   673,  6939,   673,   338,  3599,   284,
         1254,  6639,    13,  1375,   373,   523,  4939,   673,   714],
       device='cuda:0')</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="947c8522-53fd-489f-e333-d53212214fb0" data-execution_count="16">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1">inputs.attention_mask[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>torch.Size([119])</code></pre>
</div>
</div>
<p>Reusing the generation code I used for the TinyHackthon competition, but setting <code>do_sample=False</code> and <code>num_beams=5</code>:</p>
<div id="cell-25" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> _generate(model, prompts, max_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">384</span>, min_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">120</span>):</span>
<span id="cb18-2">    tokz.padding_side <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span></span>
<span id="cb18-3">    inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz(prompts, padding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, truncation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>, return_tensors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pt"</span>).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb18-4"></span>
<span id="cb18-5">    model.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span>()</span>
<span id="cb18-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">with</span> torch.no_grad():</span>
<span id="cb18-7">        outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.generate(</span>
<span id="cb18-8">            inputs.input_ids,</span>
<span id="cb18-9">            attention_mask<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inputs.attention_mask,</span>
<span id="cb18-10">            max_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_length,</span>
<span id="cb18-11">            min_length<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>min_length,</span>
<span id="cb18-12">            num_beams<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb18-13">            do_sample<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb18-14">            pad_token_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>tokz.eos_token_id</span>
<span id="cb18-15">        )</span>
<span id="cb18-16"></span>
<span id="cb18-17">        input_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs.input_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb18-18">        completion_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> outputs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>][input_length:]</span>
<span id="cb18-19">        completion_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz.decode(completion_tokens, skip_special_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb18-20"></span>
<span id="cb18-21">        completions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb18-22"></span>
<span id="cb18-23">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j, output <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(outputs):</span>
<span id="cb18-24">            input_length <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inputs.input_ids[j].size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb18-25">            completion_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> output[input_length:]</span>
<span id="cb18-26">            completion_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz.decode(completion_tokens, skip_special_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>)</span>
<span id="cb18-27">            completions.append(completion_text)</span>
<span id="cb18-28"></span>
<span id="cb18-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> outputs.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(prompts)</span>
<span id="cb18-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> outputs.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> max_length</span>
<span id="cb18-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(completions) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(prompts)</span>
<span id="cb18-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> completions</span>
<span id="cb18-33"></span>
<span id="cb18-34">completions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _generate(model, data)</span></code></pre></div>
</div>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5bb67862-93ee-47f1-ff95-0996af4f1843" data-execution_count="41">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(completions[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> not sleep.

Lucy asked her mom, "What's wrong, Mommy?" Her mom replied, "It's okay, sweetie. I'll help you."

Lucy smiled and said, "I'm sorry, Mommy. I'll help you." Her mom smiled and said, "It's okay, Lucy. I'm glad you're safe."

Lucy smiled and said, "Thank you, Mommy. I love you." Her mom smiled and said, "I love you too, Lucy."
</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="c303089b-c591-4950-c77a-9f0b9ba2a294" data-execution_count="42">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(completions[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> go to the hospital. The little boy was very sad and he didn't want to go to the hospital. 

His mom said, "Don't worry, I'll help you." But the little boy didn't listen. He said, "I'm sorry, mom. I won't do it again." 

His mom smiled and said, "It's okay, I'll help you." 

The little boy was so happy and thanked his mom. From that day on, he always made sure to always be careful when playing outside.
</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="1e8db0c5-13bc-4dee-b57e-1f6088dee7e6" data-execution_count="43">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(completions[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> room. 

The little girl asked her daddy, "Daddy, can you help me?" 

Daddy said, "Yes, I can help you." 

The little girl was so happy. She said, "Thank you, Daddy!" 

Daddy smiled and said, "You're welcome, sweetheart. I'm glad you're safe." 

The little girl smiled and said, "Thank you, Daddy!"

Daddy smiled and said, "You're welcome, sweetheart. I'm glad you're safe." 

The little girl smiled and said, "I'm glad you're safe."
</code></pre>
</div>
</div>
<p>I’ll now iterate through a list of all three models, generate story completions, and save it to CSV for evaluation.</p>
<div id="cell-30" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">model_names <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roneneldan/TinyStories-1M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roneneldan/TinyStories-8M"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roneneldan/TinyStories-28M"</span>]</span></code></pre></div>
</div>
<div id="cell-31" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="856cc1fd-21ca-4452-a8d1-afd4664a0f18" data-execution_count="52">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1">df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prompt"</span>: data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1M"</span>: [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8M"</span>: [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"28M"</span>: [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(data)})</span>
<span id="cb26-2">df.head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div id="df-d3226fdd-e225-4ef3-a087-845fa3564beb" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prompt</th>
<th data-quarto-table-cell-role="th">1M</th>
<th data-quarto-table-cell-role="th">8M</th>
<th data-quarto-table-cell-role="th">28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Once upon a time, there lived a bunny in a fie...</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>One day a girl walked into the living room and...</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Once upon a time, there lived a hamster in the...</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Jack asked his mom if he could ride the bike a...</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Alice was bored and wanted to find some advent...</td>
<td>None</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d3226fdd-e225-4ef3-a087-845fa3564beb')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d3226fdd-e225-4ef3-a087-845fa3564beb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d3226fdd-e225-4ef3-a087-845fa3564beb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-1cd2bf3d-8fce-4357-9c1a-a3becd941453">
      <button class="colab-df-quickchart" onclick="quickchart('df-1cd2bf3d-8fce-4357-9c1a-a3becd941453')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-1cd2bf3d-8fce-4357-9c1a-a3becd941453 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<div id="cell-32" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> name <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> model_names:</span>
<span id="cb27-2">    model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(name).to(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cuda"</span>)</span>
<span id="cb27-3">    tokz <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(name)</span>
<span id="cb27-4">    tokz.pad_token <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tokz.eos_token</span>
<span id="cb27-5">    completions <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> _generate(model, data)</span>
<span id="cb27-6">    df[name.split(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-"</span>)[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> completions</span></code></pre></div>
</div>
<div id="cell-33" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:206}}" data-outputid="7a079003-5f3c-4bda-f762-87b14b3f333a" data-execution_count="55">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1">df.head()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div id="df-46266037-47c6-4550-91a9-93f2cb686066" class="colab-df-container">
    <div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">prompt</th>
<th data-quarto-table-cell-role="th">1M</th>
<th data-quarto-table-cell-role="th">8M</th>
<th data-quarto-table-cell-role="th">28M</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Once upon a time, there lived a bunny in a fie...</td>
<td>not sleep.\n\nLucy asked her mom, "What's wro...</td>
<td>hardly move.\n\nLucy's friend, a wise old owl...</td>
<td>barely move. \n\nLucy's bunny friends noticed...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>One day a girl walked into the living room and...</td>
<td>, she heard a voice.\n\n"What are you doing he...</td>
<td>she heard a voice.\n\n"Who are you?" the voic...</td>
<td>a voice came from behind her.\n\n"What do you...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Once upon a time, there lived a hamster in the...</td>
<td>it was too late.\n\nThe next day, the hamster...</td>
<td>the mouse was trying to help him.\n\nThe hams...</td>
<td>he had to help the mouse.\n\nHe used all his ...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Jack asked his mom if he could ride the bike a...</td>
<td>thank you" to his daughter.\n\nThe next day, J...</td>
<td>no" and he knew that he had to be careful.\n\n...</td>
<td>Don't ride too fast, be careful!"\n\nSo Jack s...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Alice was bored and wanted to find some advent...</td>
<td>go to the park?"\n\nTom said, "I don't want t...</td>
<td>go on an adventure together?"\n\nBen smiled a...</td>
<td>go on an adventure?"\n\nBen thought for a mom...</td>
</tr>
</tbody>
</table>

</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-46266037-47c6-4550-91a9-93f2cb686066')" title="Convert this dataframe to an interactive table." style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"></path>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-46266037-47c6-4550-91a9-93f2cb686066 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-46266037-47c6-4550-91a9-93f2cb686066');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-de0c88ef-903d-4b9a-9c0a-53db68fe08e1">
      <button class="colab-df-quickchart" onclick="quickchart('df-de0c88ef-903d-4b9a-9c0a-53db68fe08e1')" title="Suggest charts" style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px" viewbox="0 0 24 24" width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"></path>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-de0c88ef-903d-4b9a-9c0a-53db68fe08e1 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
</div>
<div id="cell-34" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1">df.to_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2025-04-27-evals.csv"</span>, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span></code></pre></div>
</div>
<p>While we’re, I’ll calculat the average prompt and completion length in tokens.</p>
<div id="cell-36" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="223dae72-f5c1-45a8-f350-e998d5714008" data-execution_count="57">
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1">tokz(data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>{'input_ids': [7454, 2402, 257, 640, 11, 612, 5615, 257, 44915, 287, 257, 2214, 13, 2332, 1438, 373, 22162, 13, 22162, 6151, 284, 423, 730, 5773, 290, 4671, 351, 607, 44915, 2460, 13, 1881, 1110, 11, 618, 22162, 373, 546, 284, 2666, 329, 257, 26951, 379, 257, 1545, 338, 2156, 11, 673, 6939, 673, 338, 3599, 284, 1254, 6639, 13, 1375, 373, 523, 4939, 673, 714], 'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]}</code></pre>
</div>
</div>
<div id="cell-37" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="e14c1c7a-3e2e-4a00-91b6-66ab4f19762d" data-execution_count="61">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1">toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb32-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> data: toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tokz(p).input_ids)</span>
<span id="cb32-3">toks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>62</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a64f24ca-762c-4043-a601-d3b5949cc900" data-execution_count="62">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1">toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb34-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1M"</span>]: toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tokz(p).input_ids)</span>
<span id="cb34-3">toks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>164</code></pre>
</div>
</div>
<div id="cell-39" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="eeef388e-08ab-436e-c300-a30cc625ec66" data-execution_count="63">
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1">toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb36-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8M"</span>]: toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tokz(p).input_ids)</span>
<span id="cb36-3">toks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>153</code></pre>
</div>
</div>
<div id="cell-40" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="057638d1-c550-43af-ef0c-afd026dd85cc" data-execution_count="64">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1">toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb38-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> df[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"28M"</span>]: toks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tokz(p).input_ids)</span>
<span id="cb38-3">toks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">44</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>140</code></pre>
</div>
</div>
<div id="cell-41" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="a85210bb-79b9-45c3-fb4a-b1ee8c4a7ca6" data-execution_count="65">
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">62</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">164</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">153</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">64</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">140</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>(226, 217, 204)</code></pre>
</div>
</div>
<p>The prompt (62) and completions (140, 153, 164) average about 200 tokens in length. This is a different tokenizer than I’m using so results will vary for my trained models</p>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>I have established two key elements for my evals:</p>
<ul>
<li>Targets based on the literature (for my reference models and experiment models)</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">TinyStories</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Num Layers</th>
<th style="text-align: center;">Eval Loss</th>
<th style="text-align: center;">Creativity</th>
<th style="text-align: center;">Grammar</th>
<th style="text-align: center;">Consistency</th>
<th style="text-align: center;">Plot</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">2.08</td>
<td style="text-align: center;">4.68</td>
<td style="text-align: center;">6.14</td>
<td style="text-align: center;">4.45</td>
<td style="text-align: center;">4.40</td>
</tr>
<tr class="even">
<td style="text-align: center;">8M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.38</td>
<td style="text-align: center;">6.54</td>
<td style="text-align: center;">7.72</td>
<td style="text-align: center;">8.02</td>
<td style="text-align: center;">7.23</td>
</tr>
<tr class="odd">
<td style="text-align: center;">28M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">1.20</td>
<td style="text-align: center;">6.85</td>
<td style="text-align: center;">8.34</td>
<td style="text-align: center;">8.95</td>
<td style="text-align: center;">7.26</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Model Name</th>
<th style="text-align: center;">Hidden Dim</th>
<th style="text-align: center;">Intermediate Dim</th>
<th style="text-align: center;">Number of Layers</th>
<th style="text-align: center;">Number of Params</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">5M</td>
<td style="text-align: center;">64</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">13</td>
<td style="text-align: center;">4_949_696</td>
</tr>
<tr class="even">
<td style="text-align: center;">25M</td>
<td style="text-align: center;">256</td>
<td style="text-align: center;">1024</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">24_776_960</td>
</tr>
<tr class="odd">
<td style="text-align: center;">60M</td>
<td style="text-align: center;">512</td>
<td style="text-align: center;">2048</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">57_940_480</td>
</tr>
<tr class="even">
<td style="text-align: center;">125M</td>
<td style="text-align: center;">768</td>
<td style="text-align: center;">3072</td>
<td style="text-align: center;">8</td>
<td style="text-align: center;">124_662_528</td>
</tr>
</tbody>
</table>
<ul>
<li>Generations using reference models for evaluation prompts from literature
<ul>
<li>44 prompts (62 tokens on average)</li>
</ul></li>
</ul>
<p>My next steps:</p>
<ul>
<li>Evaluate a sample of prompts from each model by hand for my six scoring categories:
<ul>
<li><strong>Foundational language capabilities</strong>: Grammar and Context-Tracking (Consistency)</li>
<li><strong>Emergent capabilities</strong>: Factual Knowledge, Reasoning, Creativity</li>
<li><strong>Story-related capabilities</strong>: Plot</li>
</ul></li>
<li>Prompt different LLMs, iterating on prompts until LLM Judge scores match mine 90%+ of the time.</li>
</ul>
<p>Both steps will take considerable, so I’ll break them down to smaller steps and publish blog posts and videos along the way. Make sure to subscribe to my YouTube channel or check the <a href="https://www.youtube.com/playlist?list=PLVaenshL7UUD8iFmDDUpLCcuB-K_72mwI">TinyScale Lab playlist</a> for latest content!</p>


</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-04-27-TSL-Setting-Eval-Targets/</guid>
  <pubDate>Sun, 27 Apr 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>TinyScaleLab: Bridging Training Dynamics and Model Capabilities</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/</link>
  <description><![CDATA[ 




<iframe width="560" height="315" src="https://www.youtube.com/embed/82mE39Ef5eY?si=5h9fdvnAF0071VcA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>I’m excited to announce the kickoff of TinyScale Lab, a research project focused on exploring the connection between training dynamics and model capabilities. This research is motivated by two papers that I’ve studied in detail: <a href="https://arxiv.org/abs/2305.07759">“TinyStories: How Small Can Language Models Be and Still Speak Coherent English?” by Ronen Eldan and Yuanzhi Li</a>, and <a href="https://arxiv.org/abs/2309.14322">“Small-scale proxies for Large-scale Transformer Training Instabilities” by Wortsman, et al</a>.</p>
<p>Most LLM training-related research requires computational resources that are financially out of reach for individual researchers or small teams. At the same time, recent work has shown that tiny models exhibit emergent capabilities (as demonstrated in the TinyStories paper) and exhibit large-scale training dynamics (as shown in the Small-scale proxies paper).</p>
<p>While I don’t claim to be creating a definitive blueprint, I believe this approach—using tiny models as proxies to study phenomena relevant to models of all sizes—represents an underexplored path that could benefit other resource-constrained researchers.</p>
<p>I think this is how most of the world’s potential researchers would need to work. Making ML research accessible to resource-constrained environments isn’t trivial - it’s essential for the field’s diversity and progress.</p>
</section>
<section id="research-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="research-hypotheses">Research Hypotheses</h2>
<p>I’ve developed four main hypotheses that will guide my research:</p>
<ol type="1">
<li><strong>H1</strong>: Training stability directly affects specific model capabilities in predictable ways.</li>
<li><strong>H2</strong>: Different model capabilities (like grammar or consistency) respond differently to training adjustments.</li>
<li><strong>H3</strong>: Early training signals can predict which capabilities a model will or won’t develop before training is complete.</li>
<li><strong>H4</strong>: Techniques that stabilize training will have varying effects on different types of model capabilities.</li>
</ol>
<p>I’ve kept these hypotheses general at a high level because I really don’t know what I’m going to learn, but I do have a sense based on the TinyStories and Small-scale proxies papers that there is something around these four elements that I’m going to experience, and I expect to see some relationships.</p>
<p>I want to bridge the TinyStories paper analysis on emergent capabilities (grammar, consistency, factual knowledge, reasoning, etc.) with the Small-scale proxies paper training dynamics analysis (attention logits, training instabilities, learning rates, etc.).</p>
</section>
<section id="experimental-design" class="level2">
<h2 class="anchored" data-anchor-id="experimental-design">Experimental Design</h2>
<p>For my experimental design, I’ve decided to focus on four model sizes:</p>
<ul>
<li>~3M parameters</li>
<li>~20M parameters</li>
<li>~60M parameters</li>
<li>~120M parameters</li>
</ul>
<p>This follows the TinyStories paper closely, with the addition of a 120M parameter model.</p>
<p>I’ll use the same learning rates as the Small-scale proxies paper, ranging from 3e-4 to 3e-1 with seven learning rates in total: <code>{3e-4, 1e-3, 3e-3, 1e-2, 3e-2, 1e-1, 3e-1}</code></p>
<p>I’ll implement two stability techniques from the Small-scale proxies paper:</p>
<ul>
<li>QK layer norm (to mitigate attention logit growth)</li>
<li>Z loss (to mitigate output logit divergence)</li>
</ul>
<p>What will remain fixed across all training runs are the datasets, the number of training steps, and other hyperparameters like weight decay and warm-up steps.</p>
<p>The training dynamics I’ll log throughout training include:</p>
<ul>
<li>Logits</li>
<li>Gradients</li>
<li>Parameters</li>
<li>Loss</li>
</ul>
<p>For each of these, I’ll capture norms, means, maximum values, and RMS values.</p>
<p>The capabilities I want to evaluate are split into three categories:</p>
<ol type="1">
<li><strong>Foundational language</strong>: Grammar and context-tracking (consistency)</li>
<li><strong>Emergent capabilities</strong>: Factual knowledge, reasoning, and creativity</li>
<li><strong>Story-related</strong>: Plot</li>
</ol>
<p>The relationship between these training dynamics and capabilities is what I want to explore.</p>
</section>
<section id="success-criteria" class="level2">
<h2 class="anchored" data-anchor-id="success-criteria">Success Criteria</h2>
<p>My success criteria are simple but not easy: establishing clear connections between training dynamics and tiny model capabilities. This work is exploratory, and I’m open to discovering that the relationships might be more complex or different than initially hypothesized.</p>
</section>
<section id="risk-assessment" class="level2">
<h2 class="anchored" data-anchor-id="risk-assessment">Risk Assessment</h2>
<p>I’ve identified several risks that could impact this project:</p>
<ol type="1">
<li>Lack of connection between training dynamics and tiny model capabilities</li>
<li>Technical challenges in monitoring complex training dynamics</li>
<li>Sub-optimal parameter usage</li>
<li>Compute and inference costs ballooning beyond budget</li>
</ol>
</section>
<section id="risk-mitigation" class="level2">
<h2 class="anchored" data-anchor-id="risk-mitigation">Risk Mitigation</h2>
<p>To mitigate these risks, I plan to:</p>
<ol type="1">
<li>Shorten the iteration loop</li>
<li>Ensure evaluations are robust from the start</li>
<li>Start at the tiniest scale and progressively increase model size</li>
<li>Implement early stopping to avoid wasting compute</li>
</ol>
<p>I learned from the fastAI course and community that you want to shorten the iteration loop and ensure that evals are robust from the start. This gives you quick, immediate, robust, clear signal when you get feedback on how your model is performing.</p>
</section>
<section id="deliverables" class="level2">
<h2 class="anchored" data-anchor-id="deliverables">Deliverables</h2>
<p>My commitment is to produce:</p>
<ol type="1">
<li>Comprehensive research repositories including code, trained models, and detailed datasets (training dynamics and LLM Judge scores)</li>
<li>Weekly video content and blog posts</li>
<li>Technical report</li>
<li>Interactive visualizations</li>
</ol>
<p>The main thing I want to emphasize is that I’ll be doing this publicly and open-source. All models, code, and findings will be freely available to enable broader participation in ML research.</p>
</section>
<section id="timeline-and-budget" class="level2">
<h2 class="anchored" data-anchor-id="timeline-and-budget">Timeline and Budget</h2>
<p>I’ve broken the project into four phases:</p>
<ol type="1">
<li><strong>Phase 1</strong>: Eval/Logging Setup, Initial Training Runs (2-3 months)</li>
<li><strong>Phase 2</strong>: Experimental Implementation (3-4 months)</li>
<li><strong>Phase 3</strong>: Analysis &amp; Synthesis (2-3 months)</li>
<li><strong>Phase 4</strong>: Documentation &amp; Finalization (1 month)</li>
</ol>
<p>At minimum, I think this work will take eight months, and it could go well past a year.</p>
<p>For the budget, I’m estimating: - <strong>Training</strong>: $1700 (approximately 100 training runs on 25B tokens) - <strong>Inference</strong>: $200 (using Gemini 2.5 Flash for LLM Judge scoring) - <strong>Total</strong>: $2000</p>
<p>At this point, I’m considering whether it makes sense to buy my own GPU rig. If this is going to cost $2,000, why not spend a little more or twice as much and get a GPU rig that I can own? There are a lot of variables when it comes to budget and timeline, so I’m going to take it one week at a time and make adjustments as necessary.</p>
</section>
<section id="closing-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="closing-thoughts">Closing Thoughts</h2>
<p>To recap, TinyScale Lab aims to:</p>
<ol type="1">
<li>Bridge training dynamics and model capabilities to understand what makes tiny models effective</li>
<li>Create a systematic framework for understanding how training choices affect specific model capabilities</li>
<li>Demonstrate that meaningful ML research is accessible with modest computational resources</li>
<li>Open-source all models, code, and findings to enable broader participation in ML research</li>
</ol>
<p>As Nick Sirianni (championship winning coach of the Philadelphia Eagles) said, “You cannot be great without the greatness of others.” I truly stand on the shoulders of giants, especially the authors of the TinyStories and Small-scale proxies papers. Without their work and contributions in the open source space, I would not be able to even approach this kind of research.</p>
<p>If someone with similar interests sees this work and it inspires them, or they can use something I built that saves them time, saves them money, or gives them insight–that would be the best reward that comes out of this work.</p>
<p>I hope you’ll follow along with this journey. I’ll be keeping everything in the <a href="https://www.youtube.com/playlist?list=PLVaenshL7UUD8iFmDDUpLCcuB-K_72mwI">TinyScale Lab playlist on my YouTube</a> and will tag related posts on my blog.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="TinyScale-Lab bridges the gap between tiny model capabilities and training dynamics"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/1.png" class="img-fluid figure-img" alt="TinyScale-Lab bridges the gap between tiny model capabilities and training dynamics"></a></p>
<figcaption>TinyScale-Lab bridges the gap between tiny model capabilities and training dynamics</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>LLM</category>
  <category>deep learning</category>
  <category>TinyScaleLab</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-04-26-TinyScale-Lab-Kickoff/</guid>
  <pubDate>Sat, 26 Apr 2025 07:00:00 GMT</pubDate>
</item>
<item>
  <title>LossInspector: A Deep Dive Into LLM-Foundry’s Next-Token Prediction with a Custom Composer Callback</title>
  <dc:creator>Vishal Bakshi</dc:creator>
  <link>https://vishalbakshi.github.io/blog/posts/2025-04-22-LossInspector/</link>
  <description><![CDATA[ 




<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>I’m working on a research project where we’ll be fine-tuning small models with various techniques and datasets using LLM-Foundry. As part of our infrastructure setup, we wanted to make sure that we thoroughly understood how a batch of data is prepared by LLM-Foundry, and how the outputs of a model, along with the labels, are passed to the loss function to calculate the loss. To do so, with the help of Claude, I wrote up a custom Composer Callback. This is the third custom callback I’ve written for Composer/LLM-Foundry, you can read more about <a href="https://vishalbakshi.github.io/blog/posts/2025-03-30-Composer-Callback/">my first</a> and <a href="https://vishalbakshi.github.io/blog/posts/2025-04-02-Composer-Callback-Logging-dtypes/">second</a> callbacks.</p>
<p>I was initially going to have two or three callbacks: one to inspect inputs/outputs to the embedding, one to inspect the input/outputs to the model’s forward pass, and one to inspect the loss function. 27 commits later, I had a relatively lean single callback that gave me all the information I needed.</p>
<p>I focused on three events during Composer’s <a href="https://docs.mosaicml.com/projects/composer/en/stable/trainer/events.html">training loop</a>:</p>
<ul>
<li><code>before_loss</code>: to store the “untouched” batch from Composer’s <code>state</code>.</li>
<li><code>before_forward</code>: to store the untouched <code>input_ids</code> and <code>labels</code> from the state’s batch.</li>
<li><code>after_loss</code>: to both capture the calculated loss and “manually” calculate the loss using the model’s loss function.</li>
</ul>
<p>Before we go further into detail, here’s the callback code (and necessary imports):</p>
<p>Here’s my video walkthrough of the code in this notebook:</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/9ffnmeiDF_M?si=DVAZhHFDfxkuzG6n" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen="">
</iframe>
</section>
<section id="lossinspector-callback" class="level2">
<h2 class="anchored" data-anchor-id="lossinspector-callback"><code>LossInspector</code> Callback</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> composer.core.callback <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Callback</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> composer.core <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> State</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> composer.loggers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Logger</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> torch</span>
<span id="cb1-5"></span>
<span id="cb1-6"></span>
<span id="cb1-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> LossInspector(Callback):       </span>
<span id="cb1-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb1-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb1-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inspected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb1-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.input_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb1-13">    </span>
<span id="cb1-14">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> before_loss(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inspected:</span>
<span id="cb1-16">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span></span>
<span id="cb1-17">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.outputs</span>
<span id="cb1-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.batch</span>
<span id="cb1-19">        </span>
<span id="cb1-20"></span>
<span id="cb1-21">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> before_forward(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-22">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check that input_ids and labels are the same as after loss</span></span>
<span id="cb1-23">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.input_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].detach().cpu()</span>
<span id="cb1-24">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'labels'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].detach().cpu()</span>
<span id="cb1-25">    </span>
<span id="cb1-26">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> after_loss(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb1-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inspected:</span>
<span id="cb1-28">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span></span>
<span id="cb1-29">            </span>
<span id="cb1-30">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">=== LOSS CALCULATION INSPECTION ==="</span>)</span>
<span id="cb1-31">        </span>
<span id="cb1-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get the framework loss from state</span></span>
<span id="cb1-33">        framework_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.loss.item()</span>
<span id="cb1-34">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Framework loss: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>framework_loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-35">        </span>
<span id="cb1-36">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Access model's loss_function directly</span></span>
<span id="cb1-37">        logits <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'logits'</span>]</span>
<span id="cb1-38">        labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'labels'</span>]</span>
<span id="cb1-39">        vocab_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.model.model.config.vocab_size</span>
<span id="cb1-40">        </span>
<span id="cb1-41">        direct_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.model.model.loss_function(</span>
<span id="cb1-42">            logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>logits,</span>
<span id="cb1-43">            labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels,</span>
<span id="cb1-44">            vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>vocab_size</span>
<span id="cb1-45">        )</span>
<span id="cb1-46">        </span>
<span id="cb1-47">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Direct call to model.loss_function: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>direct_loss<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>item()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.6f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-48">        </span>
<span id="cb1-49">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-------- input_ids --------"</span>)</span>
<span id="cb1-50">        input_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'input_ids'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].detach().cpu()</span>
<span id="cb1-51">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(input_ids.tolist())</span>
<span id="cb1-52">        decoded_input <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.model.tokenizer.decode(input_ids)</span>
<span id="cb1-53">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(decoded_input[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>])</span>
<span id="cb1-54">        </span>
<span id="cb1-55">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-------- labels --------"</span>)</span>
<span id="cb1-56">        labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state_batch[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'labels'</span>][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].detach().cpu()</span>
<span id="cb1-57">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(labels.tolist())</span>
<span id="cb1-58">        valid_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels[labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>]</span>
<span id="cb1-59">        decoded_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.model.tokenizer.decode(valid_labels)</span>
<span id="cb1-60">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(decoded_labels)</span>
<span id="cb1-61"></span>
<span id="cb1-62">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-------- matches before_forward values? --------"</span>)</span>
<span id="cb1-63">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"input_ids: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>torch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>allclose(input_ids, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.input_ids)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-64">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"labels: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>torch<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>allclose(labels, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.labels)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb1-65">        </span>
<span id="cb1-66">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.inspected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span></code></pre></div>
<p>The callback is then appended to the <code>callbacks</code> list before passed to the Composer trainer.</p>
</section>
<section id="smollm2-135m-loss-function" class="level2">
<h2 class="anchored" data-anchor-id="smollm2-135m-loss-function">SmolLM2-135M Loss Function</h2>
<p>It was surprisingly difficult to inspect the loss function. Or rather my lack of Composer/HuggingFace internals knowledge immediately surfaced with this task! Looking through the Composer GitHub repo and documentation, I found the following references to the model’s loss function—all quite helpful but too general:</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.loss(outputs, targets)</span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> epoch <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(NUM_EPOCHS):</span>
<span id="cb3-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> inputs, targets <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> dataloader:</span>
<span id="cb3-3">        outputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.forward(inputs)</span>
<span id="cb3-4">        loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> model.loss(outputs, targets)</span>
<span id="cb3-5">        loss.backward()</span>
<span id="cb3-6">        optimizer.step()</span>
<span id="cb3-7">        optimizer.zero_grad()</span></code></pre></div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> loss(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, outputs, batch):</span>
<span id="cb4-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pass batches and `forward` outputs to the loss</span></span>
<span id="cb4-3">    _, targets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> batch</span>
<span id="cb4-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> F.cross_entropy(outputs, targets)</span></code></pre></div>
<p>I looked at their MixUp algorithm’s source code in hopes for more detail but found none—though it did help me confirm how batches are handled:</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> MixUp(Algorithm):</span>
<span id="cb5-2">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> match(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, event: Event, state: State) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>:</span>
<span id="cb5-3">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Determines whether the algorithm should run on a given event."""</span></span>
<span id="cb5-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> event <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> [Event.AFTER_DATALOADER, Event.AFTER_LOSS]</span>
<span id="cb5-5"></span>
<span id="cb5-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">apply</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, event: Event, state: State, logger: Logger) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb5-7">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Run the algorithm by modifying the State."""</span></span>
<span id="cb5-8">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>, target <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.batch</span>
<span id="cb5-9"></span>
<span id="cb5-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> Event.AFTER_DATALOADER:</span>
<span id="cb5-11">            new_input, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.permuted_target, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mixing <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mixup_batch(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>, target, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>)</span>
<span id="cb5-12">            state.batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (new_input, target)</span>
<span id="cb5-13"></span>
<span id="cb5-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> event <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> Event.AFTER_LOSS:</span>
<span id="cb5-15">            modified_batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.permuted_target)</span>
<span id="cb5-16">            new_loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.model.loss(state.outputs, modified_batch)</span>
<span id="cb5-17">            state.loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*=</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mixing)</span>
<span id="cb5-18">            state.loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mixing <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_loss</span></code></pre></div>
<p>Looking at Composer’s <code>HuggingFaceModel</code> did not give me the necessary detail, but provided the key for the next step: the loss was stored in <code>outputs</code>.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> loss(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, outputs, batch):</span>
<span id="cb6-2">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config.use_return_dict:</span>
<span id="cb6-3">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> outputs[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss'</span>]</span>
<span id="cb6-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-5">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># loss is at index 0 in the output tuple</span></span>
<span id="cb6-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> outputs[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span></code></pre></div>
<p>Did this mean that the loss function was tucked away in the forward pass? Let’s take a look.</p>
<div id="cell-12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> transformers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AutoModelForCausalLM, AutoTokenizer</span></code></pre></div>
</div>
<div id="cell-13" class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1">model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HuggingFaceTB/SmolLM2-135M"</span></span>
<span id="cb8-2">tokenizer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoTokenizer.from_pretrained(model_name)</span>
<span id="cb8-3">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AutoModelForCausalLM.from_pretrained(model_name)</span></code></pre></div>
</div>
<div id="cell-14" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> inspect</span></code></pre></div>
</div>
<div id="cell-15" class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1">forward_method <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inspect.getsource(model.forward)</span>
<span id="cb10-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(forward_method)</span></code></pre></div>
</div>
<p>I won’t print out the whole forward method, but will highlight that tucked away in there was the loss function call!</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1">loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb11-2"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> labels <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb11-3">    loss <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.loss_function(logits<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>logits, labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>labels, vocab_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.config.vocab_size, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span></code></pre></div>
<p>Aha! The function in question is <code>loss_function</code>. Inspecting that in more detail:</p>
<div id="cell-17" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="d9ba0d35-319f-444b-e060-7842ce9c6ebf" data-execution_count="6">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">hasattr</span>(model, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'loss_function'</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
<p>This was a great opportunity for a refresher on the next-token objective and auto-regressive nature of this model.</p>
<div id="cell-19" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="be12edc7-9551-4d19-99f6-16d6af06abe1" data-execution_count="16">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(inspect.getsource(model.loss_function))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>def ForCausalLMLoss(
    logits,
    labels,
    vocab_size: int,
    num_items_in_batch: Optional[int] = None,
    ignore_index: int = -100,
    shift_labels: Optional[torch.Tensor] = None,
    **kwargs,
) -&gt; torch.Tensor:
    # Upcast to float if we need to compute the loss to avoid potential precision issues
    logits = logits.float()

    if shift_labels is None:
        # Shift so that tokens &lt; n predict n
        labels = nn.functional.pad(labels, (0, 1), value=ignore_index)
        shift_labels = labels[..., 1:].contiguous()

    # Flatten the tokens
    logits = logits.view(-1, vocab_size)
    shift_labels = shift_labels.view(-1)
    # Enable model parallelism
    shift_labels = shift_labels.to(logits.device)
    loss = fixed_cross_entropy(logits, shift_labels, num_items_in_batch, ignore_index, **kwargs)
    return loss
</code></pre>
</div>
</div>
<p>The key for understanding next-token prediction are the following lines:</p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> shift_labels <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb16-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Shift so that tokens &lt; n predict n</span></span>
<span id="cb16-3">    labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> nn.functional.pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>ignore_index)</span>
<span id="cb16-4">    shift_labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> labels[..., <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:].contiguous()</span></code></pre></div>
<p><code>nn.functional.pad</code> adds padding tokens to <code>labels</code>, specifically <code>0</code> to the left-most end of the last dimension and <code>1</code> padding token to the right-most end. The token it uses as padding is <code>ignore_index</code>, which is <code>-100</code>.</p>
<p>Next, it <em>shifts</em> the labels by 1 element to the left with <code>labels[..., 1:]</code>. I took a moment to realize what this meant: the <code>input_ids</code> and <code>labels</code>, in terms of position, are the same! To align the <code>labels</code> with the <code>logits</code> (which are already “shifted” in the sense that the first position in <code>logits</code> corresponds to the first predicted token: the second token in the context) we have to shift the <code>labels</code> by 1. To ensure that the final token in <code>input_ids</code> doesn’t predict anything, we pad <code>labels</code> with <code>-100</code>, the value ignored in the loss calculation.</p>
<p>As a reminder, if the context we’re training our model on is “the cat sat on the table”, each next token is predicted based on all previous tokens:</p>
<pre><code>the --&gt; cat
the cat --&gt; sat
the cat sat --&gt; on
the cat sat on --&gt; the
the cat sat on the --&gt; table</code></pre>
<p>This is a good time to return to our callback and analyze its output, but before I do, here’s a quick demo of the label shifting operation:</p>
<div id="cell-21" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch.nn.functional <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pad</span>
<span id="cb18-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> torch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tensor</span></code></pre></div>
</div>
<div id="cell-22" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="71616038-3f2d-43e5-85f2-adcc9b90a766" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1">labels <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tensor([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb19-2">labels</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>tensor([3, 6, 4, 2])</code></pre>
</div>
</div>
<div id="cell-23" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="72be094b-fdd3-4317-fea6-53ce914d3b3d" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1">pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>tensor([   3,    6,    4,    2, -100])</code></pre>
</div>
</div>
<div id="cell-24" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="1184fe03-3d4d-41db-e07f-3d0cf1de0823" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1">pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>tensor([-100,    3,    6,    4,    2])</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="5893adca-e559-46bd-c16c-c02c7a876779" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1">pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>tensor([-100,    3,    6,    4,    2, -100])</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-quarto-private-1="{&quot;key&quot;:&quot;colab&quot;,&quot;value&quot;:{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}}" data-outputid="4d957eab-06ec-4c64-9c1e-54b4a13e8a59" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1">pad(labels, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), value<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)[...,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>tensor([   6,    4,    2, -100])</code></pre>
</div>
</div>
</section>
<section id="callback-logs" class="level2">
<h2 class="anchored" data-anchor-id="callback-logs">Callback Logs</h2>
<p>There were four key print statements of interest in my callback. I’ll display each and show their printed value:</p>
<ol type="1">
<li><code>print(f"Framework loss: {framework_loss:.6f}")</code></li>
</ol>
<pre><code>Framework loss: 1.067513</code></pre>
<ol start="2" type="1">
<li><code>print(f"Direct call to model.loss_function: {direct_loss.item():.6f}")</code></li>
</ol>
<pre><code>Direct call to model.loss_function: 1.067513</code></pre>
<ol start="3" type="1">
<li><code>print(input_ids.tolist())</code></li>
<li><code>print(labels.tolist())</code></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="input_ids (top) and labels (bottom) with the response highlighted in yellow"><img src="https://vishalbakshi.github.io/blog/posts/2025-04-22-LossInspector/1.png" class="img-fluid figure-img" alt="input_ids (top) and labels (bottom) with the response highlighted in yellow"></a></p>
<figcaption><code>input_ids</code> (top) and <code>labels</code> (bottom) with the response highlighted in yellow</figcaption>
</figure>
</div>
<p>The first two print statements confirmed that I was calling <code>state.model.loss_function</code> correctly. It also confirmed that the loss function doesn’t take in the <code>input_ids</code>.</p>
<p>The last two print statements confirmed my understanding: positionally speaking, the <code>input_ids</code> and <code>labels</code> are the same. In <code>labels</code> the positions of <code>input_ids</code> tokens that contain the prompt (and EOS tokens) are replaced with <code>-100</code> and the tokens that represent the response are kept as is. For reference, here’s what <code>input_ids</code> looks like (both the prompt and the response) coming from an item of the MetaMathQA dataset (I have ommitted the hundreds of padding EOS tokens and formatted the text for clearer presentation):</p>
<pre><code>A box with a volume of 16 $\text{cm}^3$ can hold X paperclips.
How many paperclips could a box with a volume of 48 $\text{cm}^3$ hold?
If we know the answer to the above question is 150, what is the value of unknown variable X?

We are given that a box with a volume of 16 $\text{cm}^3$ can hold $X$ paperclips.
To find out how many paperclips a box with a volume of 48 $\text{cm}^3$ can hold, we can set up a proportion using the given information.
We can write the proportion as:
16 $\text{cm}^3$ / $X$ paperclips = 48 $\text{cm}^3$ / 150 paperclips
We can cross-multiply and solve for $X$:
16 * 150 = 48 * $X$
2400 = 48 * $X$
Dividing both sides by 48, we get:
$X$ = 50
The value of $X$ is 50.
The answer is: 50&lt;|endoftext|&gt;</code></pre>
<p><code>labels</code> has the prompt replaced with <code>-100</code>s, and the loss function then left-shifts the <code>labels</code> tokens by 1 spot to align with the logits for next-token prediction comparison.</p>
<p>Unsurprisingly, the <code>input_ids</code> and <code>labels</code> before the forward pass and after the loss calculation are the same:</p>
<pre><code>print("\n-------- matches before_forward values? --------")
print(f"input_ids: {torch.allclose(input_ids, self.input_ids)}")
print(f"labels: {torch.allclose(labels, self.labels)}")</code></pre>
<pre><code>-------- matches before_forward values? --------
input_ids: True
labels: True</code></pre>
</section>
<section id="final-thoughts" class="level2">
<h2 class="anchored" data-anchor-id="final-thoughts">Final Thoughts</h2>
<p>With this baseline established, I can use this callback everytime we have processed a new dataset for training, inspecting the tokens, decoded text and loss values to ensure that the training loop will run properly for next-token prediction, whether it’s a continued pretraining or instruction fine-tuning dataset! Working with LLM-Foundry is a steep learning curve but I am learning a TON.</p>


</section>

 ]]></description>
  <category>python</category>
  <category>deep learning</category>
  <category>LLM</category>
  <guid>https://vishalbakshi.github.io/blog/posts/2025-04-22-LossInspector/</guid>
  <pubDate>Tue, 22 Apr 2025 07:00:00 GMT</pubDate>
</item>
</channel>
</rss>
