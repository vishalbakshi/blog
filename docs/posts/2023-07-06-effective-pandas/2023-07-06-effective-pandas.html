<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vishal Bakshi">
<meta name="dcterms.date" content="2023-07-06">
<meta name="description" content="An update on my progress in the book “Effective Pandas” by Matt Harrison.">

<title>vishal bakshi - Effective Pandas - Notes and Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vishal bakshi</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#chapter-4-series-introduction" id="toc-chapter-4-series-introduction" class="nav-link active" data-scroll-target="#chapter-4-series-introduction">Chapter 4: Series Introduction</a>
  <ul class="collapse">
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-5-series-deep-dive" id="toc-chapter-5-series-deep-dive" class="nav-link" data-scroll-target="#chapter-5-series-deep-dive">Chapter 5: Series Deep Dive</a>
  <ul class="collapse">
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-6-operators-dunder-methods" id="toc-chapter-6-operators-dunder-methods" class="nav-link" data-scroll-target="#chapter-6-operators-dunder-methods">Chapter 6: Operators (&amp; Dunder Methods)</a>
  <ul class="collapse">
  <li><a href="#exercises-2" id="toc-exercises-2" class="nav-link" data-scroll-target="#exercises-2">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-7-aggregate-methods" id="toc-chapter-7-aggregate-methods" class="nav-link" data-scroll-target="#chapter-7-aggregate-methods">Chapter 7: Aggregate Methods</a>
  <ul class="collapse">
  <li><a href="#exercises-3" id="toc-exercises-3" class="nav-link" data-scroll-target="#exercises-3">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-8-conversion-methods" id="toc-chapter-8-conversion-methods" class="nav-link" data-scroll-target="#chapter-8-conversion-methods">Chapter 8: Conversion Methods</a>
  <ul class="collapse">
  <li><a href="#automatic-conversion" id="toc-automatic-conversion" class="nav-link" data-scroll-target="#automatic-conversion">8.1 Automatic Conversion</a></li>
  <li><a href="#memory-usage" id="toc-memory-usage" class="nav-link" data-scroll-target="#memory-usage">8.2 Memory Usage</a></li>
  <li><a href="#string-and-category-types" id="toc-string-and-category-types" class="nav-link" data-scroll-target="#string-and-category-types">8.3 String and Category Types</a></li>
  <li><a href="#ordered-categories" id="toc-ordered-categories" class="nav-link" data-scroll-target="#ordered-categories">8.4 Ordered Categories</a></li>
  <li><a href="#converting-to-other-types" id="toc-converting-to-other-types" class="nav-link" data-scroll-target="#converting-to-other-types">8.5 Converting to Other Types</a></li>
  <li><a href="#exercises-4" id="toc-exercises-4" class="nav-link" data-scroll-target="#exercises-4">8.7 Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-9-manipulation-methods" id="toc-chapter-9-manipulation-methods" class="nav-link" data-scroll-target="#chapter-9-manipulation-methods">Chapter 9: Manipulation Methods</a>
  <ul class="collapse">
  <li><a href="#if-else-with-pandas" id="toc-if-else-with-pandas" class="nav-link" data-scroll-target="#if-else-with-pandas">9.2 If Else with Pandas</a></li>
  <li><a href="#missing-data" id="toc-missing-data" class="nav-link" data-scroll-target="#missing-data">9.3 Missing Data</a></li>
  <li><a href="#filling-in-missing-data" id="toc-filling-in-missing-data" class="nav-link" data-scroll-target="#filling-in-missing-data">9.4 Filling in Missing Data</a></li>
  <li><a href="#interpolating-data" id="toc-interpolating-data" class="nav-link" data-scroll-target="#interpolating-data">9.5 Interpolating Data</a></li>
  <li><a href="#clipping-data" id="toc-clipping-data" class="nav-link" data-scroll-target="#clipping-data">9.6 Clipping Data</a></li>
  <li><a href="#sorting-values" id="toc-sorting-values" class="nav-link" data-scroll-target="#sorting-values">9.7 Sorting Values</a></li>
  <li><a href="#sorting-the-index" id="toc-sorting-the-index" class="nav-link" data-scroll-target="#sorting-the-index">9.8 Sorting the Index</a></li>
  <li><a href="#dropping-duplicates" id="toc-dropping-duplicates" class="nav-link" data-scroll-target="#dropping-duplicates">9.9 Dropping Duplicates</a></li>
  <li><a href="#ranking-data" id="toc-ranking-data" class="nav-link" data-scroll-target="#ranking-data">9.10 Ranking Data</a></li>
  <li><a href="#replacing-data" id="toc-replacing-data" class="nav-link" data-scroll-target="#replacing-data">9.11 Replacing Data</a></li>
  <li><a href="#binning-data" id="toc-binning-data" class="nav-link" data-scroll-target="#binning-data">9.12 Binning Data</a></li>
  <li><a href="#exercises-5" id="toc-exercises-5" class="nav-link" data-scroll-target="#exercises-5">9.14 Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-10-indexing-operations" id="toc-chapter-10-indexing-operations" class="nav-link" data-scroll-target="#chapter-10-indexing-operations">Chapter 10: Indexing Operations</a>
  <ul class="collapse">
  <li><a href="#prepping-the-data-and-renaming-the-index" id="toc-prepping-the-data-and-renaming-the-index" class="nav-link" data-scroll-target="#prepping-the-data-and-renaming-the-index">10.1 Prepping the Data and Renaming the Index</a></li>
  <li><a href="#resetting-the-index" id="toc-resetting-the-index" class="nav-link" data-scroll-target="#resetting-the-index">10.2 Resetting the Index</a></li>
  <li><a href="#the-.loc-attribute" id="toc-the-.loc-attribute" class="nav-link" data-scroll-target="#the-.loc-attribute">10.3 The <code>.loc</code> Attribute</a></li>
  <li><a href="#the-.iloc-attribute" id="toc-the-.iloc-attribute" class="nav-link" data-scroll-target="#the-.iloc-attribute">10.4 The <code>.iloc</code> Attribute</a></li>
  <li><a href="#heads-and-tails" id="toc-heads-and-tails" class="nav-link" data-scroll-target="#heads-and-tails">10.5 Heads and Tails</a></li>
  <li><a href="#sampling" id="toc-sampling" class="nav-link" data-scroll-target="#sampling">10.6 Sampling</a></li>
  <li><a href="#filtering-index-values" id="toc-filtering-index-values" class="nav-link" data-scroll-target="#filtering-index-values">10.7 Filtering Index Values</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Effective Pandas - Notes and Exercises</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data analysis</div>
    <div class="quarto-category">python</div>
  </div>
  </div>

<div>
  <div class="description">
    An update on my progress in the book “Effective Pandas” by Matt Harrison.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vishal Bakshi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">July 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>In this blog post, I work through the book <a href="https://www.amazon.com/Effective-Pandas-Patterns-Manipulation-Treading/dp/B09MYXXSFM/ref=sr_1_1?crid=1ZS9KD8F19ZMT&amp;keywords=effective+pandas&amp;qid=1688689886&amp;sprefix=effective+pa%2Caps%2C518&amp;sr=8-1">Effective Pandas by Matt Harrison</a>. I’ll take notes, work through examples and end-of-chapter exercises.</p>
<section id="chapter-4-series-introduction" class="level2">
<h2 class="anchored" data-anchor-id="chapter-4-series-introduction">Chapter 4: Series Introduction</h2>
<p>Represent the following data in pure python:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Artist</th>
<th style="text-align: left;">Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">13</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>series <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'data'</span>: [<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'songs'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>{'index': [0, 1, 2, 3], 'data': [145, 142, 38, 13], 'name': 'songs'}</code></pre>
</div>
</div>
<p>The <code>get</code> function below can pull items out of this data structure based on the index:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get(series, idx):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    value_idx <span class="op">=</span> series[<span class="st">'index'</span>].index(idx)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> series[<span class="st">'data'</span>][value_idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>get(series, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>142</code></pre>
</div>
</div>
<p>The <code>index</code> method on the list returns the list element at the provided index value.</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>].index(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>1</code></pre>
</div>
</div>
<p>Below is an example that has string values for the index:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: [<span class="st">'Paul'</span>, <span class="st">'John'</span>, <span class="st">'George'</span>, <span class="st">'Ringo'</span>],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'data'</span>: [<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'songs'</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>get(songs, <span class="st">'John'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>142</code></pre>
</div>
</div>
<p>Create a <code>Series</code> object from a list:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>songs2 <span class="op">=</span> pd.Series([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>], name <span class="op">=</span> <span class="st">'counts'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>songs2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0    145
1    142
2     38
3     13
Name: counts, dtype: int64</code></pre>
</div>
</div>
<p>The series is one-dimensional. The leftmost column is the <em>index</em>, also called the <em>axis</em>. The data (145, 142, 38, 13) is also called the <em>values</em> of the series. A <code>DataFrame</code> has two axes, one for the rows and another for the columns.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>songs2.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>RangeIndex(start=0, stop=4, step=1)</code></pre>
</div>
</div>
<p>The default values for an index are monotonically increasing integers. The index can be string-based as well (datatype for the index is <code>object</code>).</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>songs3 <span class="op">=</span> pd.Series([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                   name <span class="op">=</span> <span class="st">'counts'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                   index <span class="op">=</span> [<span class="st">'Paul'</span>, <span class="st">'John'</span>, <span class="st">'George'</span>, <span class="st">'Ringo'</span>])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>songs3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>Paul      145
John      142
George     38
Ringo      13
Name: counts, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>songs3.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Index(['Paul', 'John', 'George', 'Ringo'], dtype='object')</code></pre>
</div>
</div>
<p>We can insert Python objects into a series:</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ringo <span class="op">=</span> pd.Series(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Richard'</span>, <span class="st">'Starkey'</span>, <span class="dv">13</span>, Foo()],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">'ringo'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ringo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>0                                 Richard
1                                 Starkey
2                                      13
3    &lt;__main__.Foo object at 0x135016ce0&gt;
Name: ringo, dtype: object</code></pre>
</div>
</div>
<p>The <code>object</code> data type is also used for a series with string values and values that have heterogeneous or mixed types.</p>
<p>Here is a series that has <code>NaN</code> in it:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nan_series <span class="op">=</span> pd.Series([<span class="dv">2</span>, np.nan],</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       index <span class="op">=</span> [<span class="st">'Ono'</span>, <span class="st">'Clapton'</span>])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>nan_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>Ono        2.0
Clapton    NaN
dtype: float64</code></pre>
</div>
</div>
<p><code>float64</code> supports <code>NaN</code> while <code>int64</code> does not. As of pandas 0.24, <code>Int64</code> (nullable integer type) supports <code>NaN</code>.</p>
<p><code>count</code> ignores <code>NaN</code>s, <code>.size</code> does not.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nan_series.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>nan_series.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nan_series2 <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="va">None</span>],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> [<span class="st">'Ono'</span>, <span class="st">'Clapton'</span>],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        dtype <span class="op">=</span> <span class="st">'Int64'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>nan_series2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>Ono           2
Clapton    &lt;NA&gt;
dtype: Int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nan_series2.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert data type</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>nan_series.astype(<span class="st">'Int64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Ono           2
Clapton    &lt;NA&gt;
dtype: Int64</code></pre>
</div>
</div>
<p>The <code>Series</code> object behaves similarly to a NumPy array.</p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>numpy_ser <span class="op">=</span> np.array([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>songs3[<span class="dv">1</span>], numpy_ser[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>(142, 142)</code></pre>
</div>
</div>
<p>They both have methods in common</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>songs3.mean(), numpy_ser.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(84.5, 84.5)</code></pre>
</div>
</div>
<p>They both have a notion of a <em>boolean array</em>.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> songs3 <span class="op">&gt;</span> songs3.median()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Paul       True
John       True
George    False
Ringo     False
Name: counts, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use mask as a filter</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>songs3[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Paul    145
John    142
Name: counts, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NumPy equivalent</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>numpy_ser[numpy_ser <span class="op">&gt;</span> np.median(numpy_ser)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([145, 142])</code></pre>
</div>
</div>
<p>If can indicate that data is categorical.</p>
<p>Categorical values:</p>
<ul>
<li>Use less memory than strings</li>
<li>Impove performance</li>
<li>Can have an ordering</li>
<li>Can perform operations on categories</li>
<li>Enforce membership on values</li>
</ul>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'xl'</span>], dtype <span class="op">=</span> <span class="st">'category'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>0     m
1     l
2    xs
3     s
4    xl
dtype: category
Categories (5, object): ['l', 'm', 's', 'xl', 'xs']</code></pre>
</div>
</div>
<p>By default categories don’t have an ordering.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>s.cat.ordered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>False</code></pre>
</div>
</div>
<p>Convert non-categorical series to an ordered category:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'xl'</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>size_type <span class="op">=</span> pd.api.types.CategoricalDtype(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>[<span class="st">'s'</span>, <span class="st">'m'</span>, <span class="st">'l'</span>], ordered <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> s2.astype(size_type)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0      m
1      l
2    NaN
3      s
4    NaN
dtype: category
Categories (3, object): ['s' &lt; 'm' &lt; 'l']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can perform comparisons on ordered categories</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">&gt;</span> <span class="st">'s'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0     True
1     True
2    False
3    False
4    False
dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add ordering information to categorical data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>s.cat.reorder_categories([<span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xl'</span>], ordered<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0     m
1     l
2    xs
3     s
4    xl
dtype: category
Categories (5, object): ['xs' &lt; 's' &lt; 'm' &lt; 'l' &lt; 'xl']</code></pre>
</div>
</div>
<p>For strings and dates converted to categorical types, we can still use the <code>str</code> or <code>dt</code> attributes on them:</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>s3.<span class="bu">str</span>.upper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0      M
1      L
2    NaN
3      S
4    NaN
dtype: object</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pd.Series(data=None, index=None, dtype=None, name=None, copy=False)</code></td>
<td style="text-align: left;">Create a series from data (sequence, dictionary or scalar)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.index</code></td>
<td style="text-align: left;">Access index of series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.astype(dtype, errors='raise')</code></td>
<td style="text-align: left;">Cast a series to <code>dtype</code>. To ignore errors (and return original object) use <code>errors='ignore'</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s[boolean_array]</code></td>
<td style="text-align: left;">Return values from <code>s</code> where <code>boolean_array</code> is <code>True</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.cat.ordered</code></td>
<td style="text-align: left;">Determine if a categorical series is ordered</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.cat.reorder_categories(new_categories, ordered=False)</code></td>
<td style="text-align: left;">Add categories (potentially ordered) to the series. <code>new_categories</code> must include all categories.</td>
</tr>
</tbody>
</table>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<ol type="1">
<li>Using Jupyter, create a series with the temperature values for the last seven days. Filter out the vaues below the mean.</li>
<li>Using Jupyter, create a series with your favorite colors. Use a categorical type.</li>
</ol>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature series</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>temps <span class="op">=</span> pd.Series([<span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">88</span>, <span class="dv">95</span>, <span class="dv">97</span> ,<span class="dv">88</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>temps[temps <span class="op">&gt;=</span> temps.mean()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>5    95
6    97
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># favorite colors</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>colors_series <span class="op">=</span> pd.Series([<span class="st">'orange'</span>, <span class="st">'coral'</span>, <span class="st">'midnight green'</span>], dtype <span class="op">=</span> <span class="st">'category'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>colors_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>0            orange
1             coral
2    midnight green
dtype: category
Categories (3, object): ['coral', 'midnight green', 'orange']</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-5-series-deep-dive" class="level2">
<h2 class="anchored" data-anchor-id="chapter-5-series-deep-dive">Chapter 5: Series Deep Dive</h2>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyze the US Fuel Economy data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://github.com/mattharrison/datasets/raw/master/data/vehicles.csv.zip'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">=</span> df.city08</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>highway_mpg <span class="op">=</span> df.highway08</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/5q/_bn7l90s177_2gq7rnhssjxm0000gn/T/ipykernel_52057/221626492.py:4: DtypeWarning: Columns (68,70,71,72,73,74,76,79) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(url)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>highway_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0        25
1        14
2        33
3        12
4        23
         ..
41139    26
41140    28
41141    24
41142    24
41143    21
Name: highway08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>Because the type is <code>int64</code> we know that none of the values are missing.</p>
<p>The <code>dir</code> function lists the attributes of an object. A series has 400+ attributes:</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(city_mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>412</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(highway_mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>412</code></pre>
</div>
</div>
<p>Functionality of series attributes:</p>
<ul>
<li>Dunder methods provide many numeric operations, looping, attribute access, and index access. For the numeric operations, these return <code>Series</code>.</li>
<li>Corresponding operator methods for many of the numeric operations allow us to tweak the behavior.</li>
<li>Aggregate methods and properties which reduce or aggregate the values in a series down to a single scalar value.</li>
<li>Conversion methods. Some of these start with <code>.to_</code> and export the data to other formats.</li>
<li>Manipulation methods that return <code>Series</code> objects with the same index.</li>
<li>Indexing and accessor methods and attributes that return <code>Series</code> or scalars.</li>
<li>String manipulation methods using <code>.str</code>.</li>
<li>Date manipulation methods using <code>.dt</code>.</li>
<li>Plotting methods using <code>.plot</code>.</li>
<li>Categorical manipulation methods using <code>.cat</code>.</li>
<li>Transformation methods.</li>
<li>Attributes such as <code>.index</code> and <code>.dtype</code>.</li>
<li>A bunch of private attributes (130 of them) that we’ll ignore.</li>
</ul>
<section id="exercises-1" class="level3">
<h3 class="anchored" data-anchor-id="exercises-1">Exercises</h3>
<ol type="1">
<li>Explore the documentation for five attributes of a series from Jupyter.</li>
<li>How many attributes are found on the <code>.str</code> attribute? Look at the documentation for three of them.</li>
<li>How many attributes are found on the <code>.dt</code> attribute? Look at the documentation for three of them.</li>
</ol>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>city_mpg.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([19,  9, 23, ..., 18, 18, 16])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>city_mpg.axes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>[RangeIndex(start=0, stop=41144, step=1)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>city_mpg.empty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>city_mpg.at[<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>17</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>city_mpg.loc[<span class="dv">1</span>:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>1     9
2    23
3    10
4    17
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 98 string attributes</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(s2.<span class="bu">str</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>98</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.cat(sep <span class="op">=</span> <span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>'m.l.xs.s.xl'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.capitalize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>0     M
1     L
2    Xs
3     S
4    Xl
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.endswith(<span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>0    False
1     True
2    False
3    False
4     True
dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dt_series <span class="op">=</span> pd.Series([<span class="st">'2023-01-01'</span>, <span class="st">'2023-04-05'</span>, <span class="st">'2023-07-06'</span>])</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>dt_series <span class="op">=</span> pd.to_datetime(dt_series)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>dt_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>0   2023-01-01
1   2023-04-05
2   2023-07-06
dtype: datetime64[ns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(dt_series.dt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>83</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>0    1
1    5
2    6
dtype: int32</code></pre>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.day_of_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>0      1
1     95
2    187
dtype: int32</code></pre>
</div>
</div>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.daysinmonth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>0    31
1    30
2    31
dtype: int32</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-6-operators-dunder-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-6-operators-dunder-methods">Chapter 6: Operators (&amp; Dunder Methods)</h2>
<p>These are the protocols that determine how the Python language reacts to operations.</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># under the cover is</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>).<span class="fu">__add__</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(city_mpg <span class="op">+</span> highway_mpg) <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>0        22.0
1        11.5
2        28.0
3        11.0
4        20.0
         ... 
41139    22.5
41140    24.0
41141    21.0
41142    21.0
41143    18.5
Length: 41144, dtype: float64</code></pre>
</div>
</div>
<p>When you operate with two series, pandas will <em>align</em> the index before performing the operation. Because of index alignment, you will want to make sure that the indexes: - are unique - are common to both series</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example of series with repeated and non-common indexes</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> pd.Series([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>], index<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="dv">35</span>, <span class="dv">44</span>, <span class="dv">53</span>], index<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>], name <span class="op">=</span> <span class="st">'s2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>s1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>1    10
2    20
2    30
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>2    35
2    44
4    53
Name: s2, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index 1 and 4 have NaN</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># index 2 has four results</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">+</span> s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>1     NaN
2    55.0
2    64.0
2    65.0
2    74.0
4     NaN
dtype: float64</code></pre>
</div>
</div>
<p>When you perform math operations with a scalar, pandas <em>broadcasts</em> the operation to all values. A numeric pandas series is a block of memory, and modern CPUs leverage a technology called Single Instruction/Multiple Data (SIMD) to apply a math operation to the block of memory.</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use `fill_value` parameter to replace missing operands</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>s1.add(s2, fill_value <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>1    10.0
2    55.0
2    64.0
2    65.0
2    74.0
4    53.0
dtype: float64</code></pre>
</div>
</div>
<p>Chaining makes the code easy to read and understand</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    .add(highway_mpg)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    .div(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>0        22.0
1        11.5
2        28.0
3        11.0
4        20.0
         ... 
41139    22.5
41140    24.0
41141    21.0
41142    21.0
41143    18.5
Length: 41144, dtype: float64</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.add(s2)</code></td>
<td style="text-align: left;"><code>s + s2</code></td>
<td style="text-align: left;">Adds series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.radd(s2)</code></td>
<td style="text-align: left;"><code>s2 + s</code></td>
<td style="text-align: left;">Adds series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.sub(s2)</code></td>
<td style="text-align: left;"><code>s - s2</code></td>
<td style="text-align: left;">Subtracts series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.rsub(s2)</code></td>
<td style="text-align: left;"><code>s2 - s</code></td>
<td style="text-align: left;">Subtracts series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.mul(s2)</code></td>
<td style="text-align: left;"><code>s * s2</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.multiply(s2)</code></td>
<td style="text-align: left;"><code>s * s2</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rmul(s2)</code></td>
<td style="text-align: left;"><code>s2 * s</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.div(s2)</code></td>
<td style="text-align: left;"><code>s / s2</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.truediv(s2)</code></td>
<td style="text-align: left;"><code>s / s2</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.rdiv(s2)</code></td>
<td style="text-align: left;"><code>s2 / s</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rtruediv(s2)</code></td>
<td style="text-align: left;"><code>s2 / s</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.mod(s2)</code></td>
<td style="text-align: left;"><code>s % s2</code></td>
<td style="text-align: left;">Modulo of series division</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rmod(s2)</code></td>
<td style="text-align: left;"><code>s2 % s</code></td>
<td style="text-align: left;">Modulo of series division</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.floordiv(s2)</code></td>
<td style="text-align: left;"><code>s // s2</code></td>
<td style="text-align: left;">Floor divide series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rfloordiv(s2)</code></td>
<td style="text-align: left;"><code>s2 // s</code></td>
<td style="text-align: left;">Floor divide series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.pow(s2)</code></td>
<td style="text-align: left;"><code>s ** s2</code></td>
<td style="text-align: left;">Exponential power of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rpow(s2)</code></td>
<td style="text-align: left;"><code>s2 ** s</code></td>
<td style="text-align: left;">Exponential power of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.eq(s2)</code></td>
<td style="text-align: left;"><code>s2 == s</code></td>
<td style="text-align: left;">Elementwise equals of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.ne(s2)</code></td>
<td style="text-align: left;"><code>s2 != s</code></td>
<td style="text-align: left;">Elementwise not equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.gt(s2)</code></td>
<td style="text-align: left;"><code>s &gt; s2</code></td>
<td style="text-align: left;">Elementwise greater than of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.ge(s2)</code></td>
<td style="text-align: left;"><code>s &gt;= s2</code></td>
<td style="text-align: left;">Elementwise greater than or equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.lt(s2)</code></td>
<td style="text-align: left;"><code>s &lt; s2</code></td>
<td style="text-align: left;">Elementwise less than of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.le(s2)</code></td>
<td style="text-align: left;"><code>s &lt;= s2</code></td>
<td style="text-align: left;">Elementwise less than or equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>np.invert(s)</code></td>
<td style="text-align: left;"><code>~s</code></td>
<td style="text-align: left;">Elementwise inversion of boolean series (no pandas method)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>np.logical_and(s, s2)</code></td>
<td style="text-align: left;"><code>s &amp; s2</code></td>
<td style="text-align: left;">Elementwise logical and of boolean series (no pandas method)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>np.logical_or(s, s2)</code></td>
<td style="text-align: left;"><code>s \| s2</code></td>
<td style="text-align: left;">Elementwise logical or of boolean series (no pandas method)</td>
</tr>
</tbody>
</table>
<section id="exercises-2" class="level3">
<h3 class="anchored" data-anchor-id="exercises-2">Exercises</h3>
<p>With a dataset of your choice:</p>
<ol type="1">
<li>Add a numeric series to itself.</li>
<li>Add 10 to a numeric series.</li>
<li>Add a numeric series to itself using the <code>.add</code> method.</li>
<li>Read the documentation for the <code>.add</code> method.</li>
</ol>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">+</span> city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>0        38
1        18
2        46
3        20
4        34
         ..
41139    38
41140    40
41141    36
41142    36
41143    32
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">+</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>0        29
1        19
2        33
3        20
4        27
         ..
41139    29
41140    30
41141    28
41142    28
41143    26
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>city_mpg.add(city_mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0        38
1        18
2        46
3        20
4        34
         ..
41139    38
41140    40
41141    36
41142    36
41143    32
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experimenting with fill_value parameter</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>nan_series3 <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="va">None</span>])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>nan_series4 <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="va">None</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>nan_series3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>0    2.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>nan_series4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>0    3.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two corresponding NaN values stay NaN</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># even with fill_value = 0</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>nan_series3.add(nan_series4, fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>0    5.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-7-aggregate-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-7-aggregate-methods">Chapter 7: Aggregate Methods</h2>
<p>Aggregate methods collapse the values of a series down to a scalar.</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the mean</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>city_mpg.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>city_mpg.is_unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).is_unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>city_mpg.is_monotonic_increasing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).is_monotonic_increasing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default is median (50% quantile)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>17.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile(<span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>24.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple quantiles returns a Series</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile([<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>0.1    13.0
0.5    17.0
0.9    24.0
Name: city08, dtype: float64</code></pre>
</div>
</div>
<p>If you want the count of values that meet some criteria, you can use the <code>.sum</code> method:</p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count of cars with mileage greater than 20</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">20</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>()</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>10272</code></pre>
</div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage of cars with mileage greater than 20</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">20</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>     .mul(<span class="dv">100</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>     .mean()</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>24.965973167412017</code></pre>
</div>
</div>
<p>Observe the <code>.mul(100).mean()</code> calculation on a simpler <code>Series</code>:</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    .gt(<span class="dv">2</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>0      0
1      0
2    100
3    100
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">2</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>     .mul(<span class="dv">100</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>     .mean()   </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>50.0</code></pre>
</div>
</div>
<p>If you sum up a series of boolean values, the result is the count of <code>True</code> values. If you take the mean of a series of boolean values, the result is the fraction of values that are <code>True</code>.</p>
<p><code>.agg</code> can perform multiple operations.</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>city_mpg.agg(<span class="st">'mean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> second_to_last(s):</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s.iloc[<span class="op">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>city_mpg.agg([<span class="st">'mean'</span>, np.var, <span class="bu">max</span>, second_to_last])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>mean               18.369045
var                62.503036
max               150.000000
second_to_last     18.000000
Name: city08, dtype: float64</code></pre>
</div>
</div>
<p>Aggregation strings and descriptions:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>'all'</code></td>
<td style="text-align: left;">Returns <code>True</code> if every value is truthy.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'any'</code></td>
<td style="text-align: left;">Returns <code>True</code> if any value is truthy.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'autocorr'</code></td>
<td style="text-align: left;">Returns Pearson correlation of series with shifted self. Can override <code>lag</code> as keyword argument (default is 1).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'corr'</code></td>
<td style="text-align: left;">Returns Pearson correlation of series with other series. Need to specify <code>other</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'count'</code></td>
<td style="text-align: left;">Returns count of non-missing values.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'cov'</code></td>
<td style="text-align: left;">Returns covariance of series with other series. Need to specify <code>other</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'dtype'</code></td>
<td style="text-align: left;">Type of the series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'dtypes'</code></td>
<td style="text-align: left;">Type of the series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'empty'</code></td>
<td style="text-align: left;"><code>True</code> is no values in series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'hasnans'</code></td>
<td style="text-align: left;"><code>True</code> if missing values in series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'idxmax'</code></td>
<td style="text-align: left;">Returns index value of maximum value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'idxmin'</code></td>
<td style="text-align: left;">Returns index value of minimum value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'is_monotonic'</code></td>
<td style="text-align: left;"><code>True</code> if values always increase.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'is_monotonic_decreasing'</code></td>
<td style="text-align: left;"><code>True</code> if values always decrease.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'is_monotonic_increasing'</code></td>
<td style="text-align: left;"><code>True</code> if values always increase.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'kurt'</code></td>
<td style="text-align: left;">Returns “excess” kurtosis (0 is normal distribution). Values greater than 0 have more outliers than normal.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'mad'</code></td>
<td style="text-align: left;">Returns the mean absolute deviation.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'max'</code></td>
<td style="text-align: left;">Returns the maximum value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'mean'</code></td>
<td style="text-align: left;">Returns the mean value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'median'</code></td>
<td style="text-align: left;">Returns the median value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'min'</code></td>
<td style="text-align: left;">Returns the minimum value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'nbytes'</code></td>
<td style="text-align: left;">Returns the number of bytes of the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'ndim'</code></td>
<td style="text-align: left;">Return the number of dimensions (1) of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'nunique'</code></td>
<td style="text-align: left;">Returns the count of unique values.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'quantile'</code></td>
<td style="text-align: left;">Returns the median value. Can override <code>q</code> to specify other quantile.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'sem'</code></td>
<td style="text-align: left;">Returns the unbiarsed standard error.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'size'</code></td>
<td style="text-align: left;">Returns the size of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'skew'</code></td>
<td style="text-align: left;">Returns the unbiased skew of the data. Negative indicates tail is on the left side.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'std'</code></td>
<td style="text-align: left;">Returns the standard deviation of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'sum'</code></td>
<td style="text-align: left;">Returns the sum of the series.</td>
</tr>
</tbody>
</table>
<p>Aggregation methods and properties:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.agg(func=None, axis=0, *args, **kwargs)</code></td>
<td style="text-align: left;">Returns a scalar if <code>func</code> is a single aggregation function. Returns a series if a list of aggregations are passed to <code>func</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.all(axis=0, bool_only=None, skipna=True, level=None)</code></td>
<td style="text-align: left;">Returns <code>True</code> if every value is truthy. Otherwise <code>False</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.any(axis=0, bool_only=None, skipna=True, level=None)</code></td>
<td style="text-align: left;">Returns <code>True</code> if at least one value is truthy. Otherwise <code>False</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.autocorr(lag=1)</code></td>
<td style="text-align: left;">Returns Pearson correlation between <code>s</code> and shifted <code>s</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.corr(other, method='pearson')</code></td>
<td style="text-align: left;">Returns correlation coefficient for <code>'pearson'</code>, <code>'spearman'</code>, <code>'kendall'</code>, or a callable.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.cov(other, min_periods=None)</code></td>
<td style="text-align: left;">Returns covariance.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.max(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns maximum value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.min(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns minimum value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.mean(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns mean value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.median(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns median value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.prod(axis=None, skipna=None, level=None, numeric_only=None, min_count=0)</code></td>
<td style="text-align: left;">Returns product of <code>s</code> values.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.quantile(q=0.5, interpolation='linear')</code></td>
<td style="text-align: left;">Returns 50% quantile by default. Returns <code>Series</code> if <code>q</code> is a list.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.sem(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;">Returns unbiased standard error of mean.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.std(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;">Returns sample standard deviation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.var(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;">Returns unbiased variance.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.skew(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns unbiased skew.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.kurtosis(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;">Returns unbiased kurtosis.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.nunique(dropna=True)</code></td>
<td style="text-align: left;">Returns count of unique items.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.count(level=None)</code></td>
<td style="text-align: left;">Returns count of non-missing items.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.size</code></td>
<td style="text-align: left;">Number of items in series. (Property)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.is_unique</code></td>
<td style="text-align: left;"><code>True</code> if all values are unique.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.is_monotonic</code></td>
<td style="text-align: left;"><code>True</code> if all values are increasing.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.is_monotonic_increasing</code></td>
<td style="text-align: left;"><code>True</code> if all values are increasing.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.is_monotonic_decreasing</code></td>
<td style="text-align: left;"><code>True</code> if all values are decreasing.</td>
</tr>
</tbody>
</table>
<section id="exercises-3" class="level3">
<h3 class="anchored" data-anchor-id="exercises-3">Exercises</h3>
<p>With a dataset of your choice:</p>
<ol type="1">
<li>Find the count of non-missing values of a series.</li>
<li>Find the number of entries of a series.</li>
<li>Find the number of unique entries of a series.</li>
<li>Find the mean value of a series.</li>
<li>Find the maximum value of a series.</li>
<li>Use the <code>.agg</code> method to find all of the above.</li>
</ol>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>city_mpg.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>41144</code></pre>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>city_mpg.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>41144</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>city_mpg.nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>105</code></pre>
</div>
</div>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>city_mpg.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>city_mpg.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>150</code></pre>
</div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>city_mpg.agg([<span class="st">'count'</span>, <span class="st">'size'</span>, <span class="st">'nunique'</span>, <span class="st">'mean'</span>, <span class="st">'max'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>count      41144.000000
size       41144.000000
nunique      105.000000
mean          18.369045
max          150.000000
Name: city08, dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-8-conversion-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-8-conversion-methods">Chapter 8: Conversion Methods</h2>
<section id="automatic-conversion" class="level3">
<h3 class="anchored" data-anchor-id="automatic-conversion">8.1 Automatic Conversion</h3>
<p><code>.convert_dtypes</code> tries to convert a <code>Series</code> to a type that supports <code>pd.NA</code>. In the case of our <code>city_mpg</code> series it will change the type from <code>int64</code> to <code>Int64</code>.</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>city_mpg.convert_dtypes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: Int64</code></pre>
</div>
</div>
<p><code>.astype</code> works more explicitly. The maximumm 8-bit integer is 127, so we need 16-bit integer for <code>city_mpg</code> since it’s max is 150.</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>city_mpg.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>150</code></pre>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(<span class="st">'Int16'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: Int16</code></pre>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(<span class="st">'Int8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: cannot safely cast non-equivalent int64 to int8</code></pre>
</div>
</div>
<p>If you can use a narrower type, you can cut back on memory usage, giving you memory to process more data.</p>
<p>Use NumPy to inspect limits on integer and float types:</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>np.iinfo(<span class="st">'int64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>iinfo(min=-9223372036854775808, max=9223372036854775807, dtype=int64)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>np.iinfo(<span class="st">'uint8'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>iinfo(min=0, max=255, dtype=uint8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>np.finfo(<span class="st">'float16'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>finfo(resolution=0.001, min=-6.55040e+04, max=6.55040e+04, dtype=float16)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>np.finfo(<span class="st">'float64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>finfo(resolution=1e-15, min=-1.7976931348623157e+308, max=1.7976931348623157e+308, dtype=float64)</code></pre>
</div>
</div>
</section>
<section id="memory-usage" class="level3">
<h3 class="anchored" data-anchor-id="memory-usage">8.2 Memory Usage</h3>
<p>Use the <code>.nbytes</code> property or the <code>.memory_usage</code> method to calculate memory usage of the <code>Series</code>.</p>
<p>Pass <code>deep=True</code> to <code>.memory_usage</code> when dealing with <code>object</code> types in the <code>Series</code>.</p>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>city_mpg.nbytes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>329152</code></pre>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(<span class="st">'Int16'</span>).nbytes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>123432</code></pre>
</div>
</div>
<p>To get the amount of memory that includes strings in the <code>Series</code> (like the <code>make</code> column), we need to use the <code>.memory_usage</code> method:</p>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>df.make</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>0        Alfa Romeo
1           Ferrari
2             Dodge
3             Dodge
4            Subaru
            ...    
41139        Subaru
41140        Subaru
41141        Subaru
41142        Subaru
41143        Subaru
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>df.make.nbytes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>329152</code></pre>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>df.make.memory_usage()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>329280</code></pre>
</div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>df.make.memory_usage(deep<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>2606395</code></pre>
</div>
</div>
<p><code>.memory_usage</code> includes the index memory and can include the contribution from <code>object</code> types. <code>.nbytes</code> is just the memory that the data is using and not the ancillary parts of the <code>Series</code>.</p>
<p>Converting to categorical will save a lot of memory for the <code>make</code> data:</p>
<div class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>(df.make</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a> .astype(<span class="st">'category'</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a> .memory_usage(deep<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>95888</code></pre>
</div>
</div>
</section>
<section id="string-and-category-types" class="level3">
<h3 class="anchored" data-anchor-id="string-and-category-types">8.3 String and Category Types</h3>
<div class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(<span class="bu">str</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(<span class="st">'category'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: category
Categories (105, int64): [6, 7, 8, 9, ..., 137, 138, 140, 150]</code></pre>
</div>
</div>
<p>When you convert to categorical data, pandas no longer uses Python strings for each value but optimizes it. Potentially large memory savings if you have many duplicate values.</p>
</section>
<section id="ordered-categories" class="level3">
<h3 class="anchored" data-anchor-id="ordered-categories">8.4 Ordered Categories</h3>
<p>To cretae ordered categories you need to define your own <code>CategoricalDtype</code>:</p>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> pd.Series(<span class="bu">sorted</span>(<span class="bu">set</span>(city_mpg)))</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>city_type <span class="op">=</span> pd.CategoricalDtype(categories<span class="op">=</span>values, ordered<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>city_mpg.astype(city_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: category
Categories (105, int64): [6 &lt; 7 &lt; 8 &lt; 9 ... 137 &lt; 138 &lt; 140 &lt; 150]</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">String or Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>str 'str' 'string'</code></td>
<td style="text-align: left;">Convert to Python string.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'string'</code></td>
<td style="text-align: left;">Convert type to pandas string (supports <code>pd.NA</code>).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>int 'int' 'int64'|Convert type to NumPy int64.| |'int32' 'uint32'|Convert type to 32 signed or unsigned NumPy integer (can also use 16 and 8).| |</code>‘Int64’<code>|Convert type to pandas Int64 (supports</code>pd.NA<code>). Might complain when you convert floats or strings.| |</code>float ‘float’ ‘float64’<code>|Convert type to NumPy float64 (can also support 32 or 16)| |</code>‘category’<code>|Convert type to categorical (supports</code>pd.NA<code>). Can also use instance of</code>CategoricalDtype<code>| |dates|Don't use this for data conversion, use</code>pd.to_datetime`.</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</section>
<section id="converting-to-other-types" class="level3">
<h3 class="anchored" data-anchor-id="converting-to-other-types">8.5 Converting to Other Types</h3>
<p>Using Python lists will slow down your code significantly.</p>
<p>You can convert a <code>Series</code> into a <code>DataFrame</code>:</p>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>city_mpg.to_frame()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>city08</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>23</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>41139</th>
      <td>19</td>
    </tr>
    <tr>
      <th>41140</th>
      <td>20</td>
    </tr>
    <tr>
      <th>41141</th>
      <td>18</td>
    </tr>
    <tr>
      <th>41142</th>
      <td>18</td>
    </tr>
    <tr>
      <th>41143</th>
      <td>16</td>
    </tr>
  </tbody>
</table>
<p>41144 rows × 1 columns</p>
</div>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.convert_dtypes(infer_objects=True, convert_string=True, convert_integer=True, convert_boolean=True, convert_floating=True)</code></td>
<td style="text-align: left;">Convert types to appropriate pandas 1 types (that support <code>NA</code>). Doesn’t try to reduce size of integer or float types</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.astype(dtype, copy=True, errors='raise')</code></td>
<td style="text-align: left;">Cast series into particular type. If <code>errors='ignore'</code> then return original series on error.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pd.to_datetime(arg, errors='raise', dayfirst=False, yearfirst=False, utc=None, format=None, exact=True, unit=None, infer_datetime_format=False, origin='unix', cache=True)</code></td>
<td style="text-align: left;">Convert <code>arg</code> (a series) into datetime. Use <code>format</code> to specify strftime string.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.to_numpy(dtype=None, copy=False, na_value=object, **kwargs)</code></td>
<td style="text-align: left;">Convert the series to a NumPy array.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.values</code></td>
<td style="text-align: left;">Convert the series to a NumPy array.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.to_frame(name=None)</code></td>
<td style="text-align: left;">Return a dataframe representation of the series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pd.CategoricalDtype(categories=None, ordered=False)</code></td>
<td style="text-align: left;">Create a type for categorical data.</td>
</tr>
</tbody>
</table>
</section>
<section id="exercises-4" class="level3">
<h3 class="anchored" data-anchor-id="exercises-4">8.7 Exercises</h3>
<p>With a dataset of your choice:</p>
<p><strong>1. Convert a numeric column to a smaller type.</strong></p>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># currently a float64 type</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>df.barrels08</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>0        15.695714
1        29.964545
2        12.207778
3        29.964545
4        17.347895
           ...    
41139    14.982273
41140    14.330870
41141    15.695714
41142    15.695714
41143    18.311667
Name: barrels08, Length: 41144, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to float16</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>df.barrels08.astype(<span class="st">'float16'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>0        15.695312
1        29.968750
2        12.210938
3        29.968750
4        17.343750
           ...    
41139    14.984375
41140    14.328125
41141    15.695312
41142    15.695312
41143    18.312500
Name: barrels08, Length: 41144, dtype: float16</code></pre>
</div>
</div>
<p><strong>2. Calculate the memory savings by converting to smaller numeric types.</strong></p>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>df.barrels08.memory_usage() <span class="op">-</span> df.barrels08.astype(<span class="st">'float16'</span>).memory_usage()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>246864</code></pre>
</div>
</div>
<p><strong>3. Convert a string column into a categorical type.</strong></p>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>df.make</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>0        Alfa Romeo
1           Ferrari
2             Dodge
3             Dodge
4            Subaru
            ...    
41139        Subaru
41140        Subaru
41141        Subaru
41142        Subaru
41143        Subaru
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>values <span class="op">=</span> pd.Series(<span class="bu">sorted</span>(<span class="bu">set</span>(df.make)))</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>make_type <span class="op">=</span> pd.CategoricalDtype(categories<span class="op">=</span>values, ordered<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>df.make.astype(make_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>0        Alfa Romeo
1           Ferrari
2             Dodge
3             Dodge
4            Subaru
            ...    
41139        Subaru
41140        Subaru
41141        Subaru
41142        Subaru
41143        Subaru
Name: make, Length: 41144, dtype: category
Categories (136, object): ['AM General', 'ASC Incorporated', 'Acura', 'Alfa Romeo', ..., 'Volvo', 'Wallace Environmental', 'Yugo', 'smart']</code></pre>
</div>
</div>
<p><strong>4. Calculate the memory savings by converting to a categorical type.</strong></p>
<div class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>df.make.memory_usage(deep<span class="op">=</span><span class="va">True</span>) <span class="op">-</span> df.make.astype(make_type).memory_usage(deep<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>2510507</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-9-manipulation-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-9-manipulation-methods">Chapter 9: Manipulation Methods</h2>
<p>Comparing non-broadcasted <code>.apply</code> method with vectorized code:</p>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># non-vectorized function to check if value is greater than 20</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gt20(val): </span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> val <span class="op">&gt;</span> <span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>city_mpg.<span class="bu">apply</span>(gt20)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>7.08 ms ± 161 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>city_mpg.gt(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>174 µs ± 44 µs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)</code></pre>
</div>
</div>
<p>The broadcasted <code>.gt</code> method is 40 times faster than non-broadcasted <code>.apply</code> function.</p>
<p>Show the top 5 makes and label everything else as <em>Other</em>:</p>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># top 5 makes</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>top5 <span class="op">=</span> df.make.value_counts().index[:<span class="dv">5</span>]</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="co"># function to use in apply</span></span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generalize_top5(val):</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="kw">in</span> top5:</span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val</span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Other'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>df.make.<span class="bu">apply</span>(generalize_top5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>48.2 ms ± 4.64 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
<p>A (10 times) faster and more idiomatic manner of doing this uses the <code>.where</code> method, which keeps values from the series it is called on where the boolean array is true. If the boolean array is false, it uses the value of the second parameter, <code>other</code>:</p>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>df.make.where(df.make.isin(top5), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.68 ms ± 693 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>df.make.where(df.make.isin(top5), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>0        Other
1        Other
2        Dodge
3        Dodge
4        Other
         ...  
41139    Other
41140    Other
41141    Other
41142    Other
41143    Other
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<p>The complement of <code>.where</code> is <code>.mask</code>—wherever the condition if <code>False</code> it keeps the original values; if it is <code>True</code> it replaces the value with the <code>other</code> parameter.</p>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>df.make.mask(<span class="op">~</span>df.make.isin(top5), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>0        Other
1        Other
2        Dodge
3        Dodge
4        Other
         ...  
41139    Other
41140    Other
41141    Other
41142    Other
41143    Other
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>df.make.mask(<span class="op">~</span>df.make.isin(top5), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>3.36 ms ± 241 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<p>The tilde <code>~</code> performs an inversion of the boolean array, switching all true values to false and vice versa.</p>
<section id="if-else-with-pandas" class="level3">
<h3 class="anchored" data-anchor-id="if-else-with-pandas">9.2 If Else with Pandas</h3>
<p>There is no way to do the following: if I wanted to keep the top five makes and use <em>Top10</em> for the remainder of the top ten makes, with <em>Other</em> for the rest.</p>
<div class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>vc <span class="op">=</span> df.make.value_counts()</span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>top5 <span class="op">=</span> vc.index[:<span class="dv">5</span>]</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>top10 <span class="op">=</span> vc.index[:<span class="dv">10</span>]</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generalize(val):</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> val <span class="kw">in</span> top5:</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> val</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> val <span class="kw">in</span> top10:</span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Top10'</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Other'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>df.make.<span class="bu">apply</span>(generalize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>0        Other
1        Other
2        Dodge
3        Dodge
4        Other
         ...  
41139    Other
41140    Other
41141    Other
41142    Other
41143    Other
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>df.make.<span class="bu">apply</span>(generalize)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>76.4 ms ± 2.37 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
<p>To replicate in pandas, chain calls to <code>.where</code>:</p>
<div class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>(df.make</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a> .where(df.make.isin(top5), <span class="st">'Top10'</span>)</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a> .where(df.make.isin(top10), <span class="st">'Other'</span>)</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre><code>0        Other
1        Other
2        Dodge
3        Dodge
4        Other
         ...  
41139    Other
41140    Other
41141    Other
41142    Other
41143    Other
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>(df.make</span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a> .where(df.make.isin(top5), <span class="st">'Top10'</span>)</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a> .where(df.make.isin(top10), <span class="st">'Other'</span>)</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6.05 ms ± 391 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<p>The pandas approach is still about 13 times faster.</p>
<p>The <code>select</code> function in NumPy works with pandas series. The interface takes a list of boolean arrays and a list with corresponding replacement values.</p>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>np.select([df.make.isin(top5), df.make.isin(top10)], [df.make, <span class="st">'Top10'</span>], <span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>array(['Other', 'Other', 'Dodge', ..., 'Other', 'Other', 'Other'],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>np.select([df.make.isin(top5), df.make.isin(top10)], [df.make, <span class="st">'Top10'</span>], <span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>19.8 ms ± 2.85 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
<p>You can wrap it in a <code>Series</code>. I like this syntax for longer if statements than chaining <code>.where</code> calls because I think it is easier to understand.</p>
<div class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>pd.Series(np.select([df.make.isin(top5), df.make.isin(top10)], [df.make, <span class="st">'Top10'</span>], <span class="st">'Other'</span>), index<span class="op">=</span>df.make.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>0        Other
1        Other
2        Dodge
3        Dodge
4        Other
         ...  
41139    Other
41140    Other
41141    Other
41142    Other
41143    Other
Length: 41144, dtype: object</code></pre>
</div>
</div>
</section>
<section id="missing-data" class="level3">
<h3 class="anchored" data-anchor-id="missing-data">9.3 Missing Data</h3>
<p>Count the number of missing items with <code>.isna().sum()</code>:</p>
<div class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>(df.cylinders</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a> .isna()</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a> .<span class="bu">sum</span>()</span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<pre><code>206</code></pre>
</div>
</div>
<p>Let’s index where the values are missing in the <em>cylinders</em> column and then show what those makes are:</p>
<div class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>missing <span class="op">=</span> df.cylinders.isna()</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>df.make.loc[missing]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>7138     Nissan
7139     Toyota
8143     Toyota
8144       Ford
8146       Ford
          ...  
34563     Tesla
34564     Tesla
34565     Tesla
34566     Tesla
34567     Tesla
Name: make, Length: 206, dtype: object</code></pre>
</div>
</div>
</section>
<section id="filling-in-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="filling-in-missing-data">9.4 Filling in Missing Data</h3>
<p>It seems like cylinders are missing for cars that are electric (they have zero cylinders).</p>
<div class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>df.cylinders[df.cylinders.isna()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>7138    NaN
7139    NaN
8143    NaN
8144    NaN
8146    NaN
         ..
34563   NaN
34564   NaN
34565   NaN
34566   NaN
34567   NaN
Name: cylinders, Length: 206, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>df.cylinders.fillna(<span class="dv">0</span>).loc[<span class="dv">7136</span>:<span class="dv">7141</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">
<pre><code>7136    6.0
7137    6.0
7138    0.0
7139    0.0
7140    6.0
7141    6.0
Name: cylinders, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="interpolating-data" class="level3">
<h3 class="anchored" data-anchor-id="interpolating-data">9.5 Interpolating Data</h3>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>temp <span class="op">=</span> pd.Series([<span class="dv">32</span>, <span class="dv">40</span>, <span class="va">None</span>, <span class="dv">42</span>, <span class="dv">39</span>, <span class="dv">32</span>])</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>temp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>0    32.0
1    40.0
2     NaN
3    42.0
4    39.0
5    32.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>temp.interpolate()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>0    32.0
1    40.0
2    41.0
3    42.0
4    39.0
5    32.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="clipping-data" class="level3">
<h3 class="anchored" data-anchor-id="clipping-data">9.6 Clipping Data</h3>
<div class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>city_mpg.loc[:<span class="dv">446</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>0      19
1       9
2      23
3      10
4      17
       ..
442    15
443    15
444    15
445    15
446    31
Name: city08, Length: 447, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>     .loc[:<span class="dv">446</span>]</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a>     .clip(lower<span class="op">=</span>city_mpg.quantile(<span class="fl">0.05</span>),</span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>           upper<span class="op">=</span>city_mpg.quantile(<span class="fl">0.95</span>))</span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>0      19
1      11
2      23
3      11
4      17
       ..
442    15
443    15
444    15
445    15
446    27
Name: city08, Length: 447, dtype: int64</code></pre>
</div>
</div>
<p><code>.clip</code> uses <code>.where</code> under the hood.</p>
</section>
<section id="sorting-values" class="level3">
<h3 class="anchored" data-anchor-id="sorting-values">9.7 Sorting Values</h3>
<p>The <code>.sort_values</code> method will sort the values in ascending order and also rearrange the index accordingly.</p>
<div class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>city_mpg.sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<pre><code>7901       6
34557      6
37161      6
21060      6
35887      6
        ... 
34563    138
34564    140
32599    150
31256    150
33423    150
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>Because of index alignment, you can still do math operations on a sorted series:</p>
<div class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>(city_mpg.sort_values() <span class="op">+</span> highway_mpg) <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<pre><code>0        22.0
1        11.5
2        28.0
3        11.0
4        20.0
         ... 
41139    22.5
41140    24.0
41141    21.0
41142    21.0
41143    18.5
Length: 41144, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="sorting-the-index" class="level3">
<h3 class="anchored" data-anchor-id="sorting-the-index">9.8 Sorting the Index</h3>
<p>Below we unsort the index by sorting the values, then essentially revert that:</p>
<div class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>city_mpg.sort_values().sort_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="dropping-duplicates" class="level3">
<h3 class="anchored" data-anchor-id="dropping-duplicates">9.9 Dropping Duplicates</h3>
<p><code>keep='first'</code> is the default value and keeps the first duplicate value found.</p>
<p><code>keep='last'</code> keeps the last duplicate value found.</p>
<p><code>keep=False</code> will remove any duplicated values (including the initial value).</p>
<p><code>drop_duplicates</code> keep the original index.</p>
<div class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>city_mpg.drop_duplicates()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>0         19
1          9
2         23
3         10
4         17
        ... 
34364    127
34409    114
34564    140
34565    115
34566    104
Name: city08, Length: 105, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="ranking-data" class="level3">
<h3 class="anchored" data-anchor-id="ranking-data">9.10 Ranking Data</h3>
<p>The <code>.rank</code> method will return a series that keeps the original index but uses the ranks of values from the original series. By default, if two values are the same, their rank will be the average of the positions they take. You can specify <code>method='min'</code> to put equal values in the same rank and <code>method='dense'</code> to not skip any positions:</p>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>city_mpg.rank()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>0        27060.5
1          235.5
2        35830.0
3          607.5
4        19484.0
          ...   
41139    27060.5
41140    29719.5
41141    23528.0
41142    23528.0
41143    15479.0
Name: city08, Length: 41144, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>city_mpg.rank(method<span class="op">=</span><span class="st">'min'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>0        25555.0
1          136.0
2        35119.0
3          336.0
4        17467.0
          ...   
41139    25555.0
41140    28567.0
41141    21502.0
41142    21502.0
41143    13492.0
Name: city08, Length: 41144, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>city_mpg.rank(method<span class="op">=</span><span class="st">'dense'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>0        14.0
1         4.0
2        18.0
3         5.0
4        12.0
         ... 
41139    14.0
41140    15.0
41141    13.0
41142    13.0
41143    11.0
Name: city08, Length: 41144, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a simpler example</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).rank()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>0    1.5
1    1.5
2    3.0
3    4.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).rank(method<span class="op">=</span><span class="st">'min'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>0    1.0
1    1.0
2    3.0
3    4.0
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).rank(method<span class="op">=</span><span class="st">'dense'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>0    1.0
1    1.0
2    2.0
3    3.0
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="replacing-data" class="level3">
<h3 class="anchored" data-anchor-id="replacing-data">9.11 Replacing Data</h3>
<p>The <code>.replace</code> method allows you to map values to new values.</p>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>df.make.replace(<span class="st">'Subaru'</span>, <span class="st">'SUBARU'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>0        Alfa Romeo
1           Ferrari
2             Dodge
3             Dodge
4            SUBARU
            ...    
41139        SUBARU
41140        SUBARU
41141        SUBARU
41142        SUBARU
41143        SUBARU
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># you can also use regex</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>df.make.replace(<span class="vs">r'(Fer)ra(r.*)'</span>, value<span class="op">=</span><span class="vs">r'\2-other-\1'</span>, regex<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<pre><code>0          Alfa Romeo
1        ri-other-Fer
2               Dodge
3               Dodge
4              Subaru
             ...     
41139          Subaru
41140          Subaru
41141          Subaru
41142          Subaru
41143          Subaru
Name: make, Length: 41144, dtype: object</code></pre>
</div>
</div>
</section>
<section id="binning-data" class="level3">
<h3 class="anchored" data-anchor-id="binning-data">9.12 Binning Data</h3>
<p>Using the <code>cut</code> function, you can create bins of equal width:</p>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>pd.cut(city_mpg, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>0        (5.856, 20.4]
1        (5.856, 20.4]
2         (20.4, 34.8]
3        (5.856, 20.4]
4        (5.856, 20.4]
             ...      
41139    (5.856, 20.4]
41140    (5.856, 20.4]
41141    (5.856, 20.4]
41142    (5.856, 20.4]
41143    (5.856, 20.4]
Name: city08, Length: 41144, dtype: category
Categories (10, interval[float64, right]): [(5.856, 20.4] &lt; (20.4, 34.8] &lt; (34.8, 49.2] &lt; (49.2, 63.6] ... (92.4, 106.8] &lt; (106.8, 121.2] &lt; (121.2, 135.6] &lt; (135.6, 150.0]]</code></pre>
</div>
</div>
<p>You can specify sizes for bin edges. In the following, 5 bins are created (so you need to provide 6 edges):</p>
<div class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>pd.cut(city_mpg, [<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">70</span>, <span class="dv">150</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre><code>0        (10, 20]
1         (0, 10]
2        (20, 40]
3         (0, 10]
4        (10, 20]
           ...   
41139    (10, 20]
41140    (10, 20]
41141    (10, 20]
41142    (10, 20]
41143    (10, 20]
Name: city08, Length: 41144, dtype: category
Categories (5, interval[int64, right]): [(0, 10] &lt; (10, 20] &lt; (20, 40] &lt; (40, 70] &lt; (70, 150]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>Note the bins have a half-open interval. They do not have the start value but do include the end value. If the <code>city_mpg</code> series had values with 0 or values above 150, they would be missing after binning the series.</p>
<p>If you wanted 10 bins that had approximately the same number of entries in each bin (rather than each bin width being the same) use the <code>qcut</code> function:</p>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(city_mpg, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>0         (18.0, 20.0]
1        (5.999, 13.0]
2         (21.0, 24.0]
3        (5.999, 13.0]
4         (16.0, 17.0]
             ...      
41139     (18.0, 20.0]
41140     (18.0, 20.0]
41141     (17.0, 18.0]
41142     (17.0, 18.0]
41143     (15.0, 16.0]
Name: city08, Length: 41144, dtype: category
Categories (10, interval[float64, right]): [(5.999, 13.0] &lt; (13.0, 14.0] &lt; (14.0, 15.0] &lt; (15.0, 16.0] ... (18.0, 20.0] &lt; (20.0, 21.0] &lt; (21.0, 24.0] &lt; (24.0, 150.0]]</code></pre>
</div>
</div>
<p>Both allow you to set the labels to use instead of the categorical intervals they generate:</p>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(city_mpg, <span class="dv">10</span>, labels<span class="op">=</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">11</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>0        7
1        1
2        9
3        1
4        5
        ..
41139    7
41140    7
41141    6
41142    6
41143    4
Name: city08, Length: 41144, dtype: category
Categories (10, int64): [1 &lt; 2 &lt; 3 &lt; 4 ... 7 &lt; 8 &lt; 9 &lt; 10]</code></pre>
</div>
</div>
<p>Manipulation methods and properties:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.apply(func, convert_dtype=True, args=(), **kwds)</code></td>
<td style="text-align: left;">Pass in a NumPy function that works on the series, or a Python function that works on a single value. <code>args</code> and <code>kwds</code> are arguments for <code>func</code>. Returns a series, or dataframe if <code>func</code> returns a series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.where(cond, other=nan, inplace=False, axis=None, level=None, errors='raise', try_cast=False)</code></td>
<td style="text-align: left;">Pass in a boolean series/dataframe, list, or callable as <code>cond</code>. If the value is <code>True</code>, keep it, otherwise use <code>other</code> value. If it is a function, it takes a series and should return a boolean sequence.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>np.select(condlist, choicelist, default=0)</code></td>
<td style="text-align: left;">Pass in a list of boolean arrays for <code>condlist</code>. If the value is true use the corresponding value from <code>choicelist</code>. If multiple conditions are True, only use the first. Returns a NumPy array.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.fillna(value=None, method=None, axis=None, inplace=False, limit=None, downcast=None)</code></td>
<td style="text-align: left;">Pass in a scalar, dict, series or dataframe for <code>value</code>. If it is a scalar, use that value, otherwise use the index from the old value to the new value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.interpolate(method='linear', axis=0, limit=None, inplace=False, limit_direction=None, limit_area=None, downcast=None, **kwargs)</code></td>
<td style="text-align: left;">Perform interpolation with missing values. <code>method</code> may be <code>linear</code>, <code>time</code> among others.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.clip(lower=None, upper=None, axis=None, inplace=False, *args, **kwargs)</code></td>
<td style="text-align: left;">Return a new series with values clipped to <code>lower</code> and <code>upper</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.sort_values(axis=0, ascending=True, inplace=False, kind='quicksort', na_position='last', ignore_index=False, key=None)</code></td>
<td style="text-align: left;">Return a series with values sorted. The <code>kind</code> option may be <code>'quicksort'</code>, <code>'mergesort'</code> (stable), or <code>'heapsort'</code>. <code>na_position</code> indicates location of NaNs and may be <code>'first'</code> or <code>'last'</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.sort_index(axis=0, level=None, ascending=True, inplace=False, kind='quicksort', na_position='last', sort_remaining=True, ignore_index=False, key=None)</code></td>
<td style="text-align: left;">Return a series with index sorted. The <code>kind</code> option may be <code>'quicksort'</code>, <code>'mergesort'</code> (stable), or <code>'heapsort'</code>. <code>na_position</code> indicates location of NaNs and may be <code>'first'</code> or <code>'last'</code>.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.drop_duplicates(keep='first', inplace=False)</code></td>
<td style="text-align: left;">Drop duplicates. <code>keep</code> may be <code>'first'</code>, <code>'last'</code>, or False. (If <code>False</code>, it removes all values that were duplicated).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.rank(axis=0, method='average', numeric_only=None, na_option='keep', ascending=True, pct=False)</code></td>
<td style="text-align: left;">Return a series with numerical ranks. <code>method</code> allows you to specify tie handling. <code>'average'</code>, <code>'min'</code>, <code>'max'</code>, <code>'first'</code> (usses order they appear in series), <code>'dense'</code> (like <code>'min'</code>, but rank only increases by one after tie). <code>na_option</code> allows you to specify <code>NaN</code> handling. <code>'keep'</code> (stay at <code>NaN</code>), <code>'top'</code> (move to smallest), <code>'bottom'</code> (move to largest).</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.replace(to_replace=None, value=None, inplace=False, limit=None, regex=False, method='pad')</code></td>
<td style="text-align: left;">Return a series with new values. <code>to_replace</code> can be many things. If it is a string, number or regular expression, you can replace it with a scalar <code>value</code>. It can also be a list of those things which requires <code>value</code> to be a list of the same size. Finally, it can be a dictionary mapping old values to new values.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pd.cut(x, bins, right=True, labels=None, retbins=False, precision=3, include_lowest=False, duplicates='raise', ordered=True)</code></td>
<td style="text-align: left;">Bin values from <code>x</code> (a series). If <code>bins</code> is an integer, use equal-width bins. If <code>bins</code> is a list of numbers (defining minimum and maximum positions) use those for the edges. <code>right</code> defines whether the right edge is open or closed. <code>labels</code> allows you to specify the bin names. Out of bounds values will be missing.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>pd.qcut(x, q, labels=None, retbins=False, precision=3, duplicates='raise')</code></td>
<td style="text-align: left;">Bin values from <code>x</code> (a series) into <code>q</code> equal sized bins. Alternatively, can pass in a list of quantile edges. Out of bounds values will be missing.</td>
</tr>
</tbody>
</table>
</section>
<section id="exercises-5" class="level3">
<h3 class="anchored" data-anchor-id="exercises-5">9.14 Exercises</h3>
<p><strong>1. Create a series from a numeric column that has the value of <code>'high'</code> if it is equal to or above the mean and <code>'low'</code> if it is below the mean using <code>.apply</code>.</strong></p>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>city_mpg.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generalize_mean(x, mean_val):</span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">&gt;=</span> mean_val:</span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'high'</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'low'</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a>city_mpg.<span class="bu">apply</span>(generalize_mean, mean_val<span class="op">=</span>city_mpg.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>0        high
1         low
2        high
3         low
4         low
         ... 
41139    high
41140    high
41141     low
41142     low
41143     low
Name: city08, Length: 41144, dtype: object</code></pre>
</div>
</div>
<p><strong>2. Create a series from a numeric column that has the value of <code>'high'</code> if it is equal to or above the mean and <code>'low'</code> if it is below the mean using <code>np.select</code>.</strong></p>
<div class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>pd.Series(np.select([city_mpg.gt(city_mpg.mean())], [<span class="st">'high'</span>], <span class="st">'low'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>0        high
1         low
2        high
3         low
4         low
         ... 
41139    high
41140    high
41141     low
41142     low
41143     low
Length: 41144, dtype: object</code></pre>
</div>
</div>
<p><strong>3. Time the differences between the previous two solutions to see which is faster.</strong></p>
<div class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>city_mpg.<span class="bu">apply</span>(generalize_mean, mean_val<span class="op">=</span>city_mpg.mean())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>22.3 ms ± 5.26 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>pd.Series(np.select([city_mpg.gt(city_mpg.mean())], [<span class="st">'high'</span>], <span class="st">'low'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>4.45 ms ± 108 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</code></pre>
</div>
</div>
<p><code>np.select</code> is around 5 times as fast as <code>.apply</code> in this exercise.</p>
<p><strong>4. Replace the missing values of a numeric series with the median value.</strong></p>
<div class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a>df.cylinders.isna()[<span class="dv">7136</span>:<span class="dv">7141</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>7136    False
7137    False
7138     True
7139     True
7140    False
Name: cylinders, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>df.cylinders.fillna(df.cylinders.median())[<span class="dv">7136</span>:<span class="dv">7141</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>7136    6.0
7137    6.0
7138    6.0
7139    6.0
7140    6.0
Name: cylinders, dtype: float64</code></pre>
</div>
</div>
<p><strong>5.Clip the values of a numeric series to between the 10th and 90th percentiles.</strong></p>
<div class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>clip_s <span class="op">=</span> pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>])</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>(clip_s</span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>     .clip(lower<span class="op">=</span>clip_s.quantile(<span class="fl">0.1</span>),</span>
<span id="cb315-4"><a href="#cb315-4" aria-hidden="true" tabindex="-1"></a>           upper<span class="op">=</span>clip_s.quantile(<span class="fl">0.9</span>))</span>
<span id="cb315-5"><a href="#cb315-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="202">
<pre><code>0    1.9
1    2.0
2    3.0
3    4.0
4    5.0
5    6.0
6    7.0
7    8.0
8    9.0
9    9.1
dtype: float64</code></pre>
</div>
</div>
<p><strong>6. Using a categorical column, replace any value that is not in the top 5 most frequent values with <code>'Other'</code>.</strong></p>
<div class="cell" data-execution_count="229">
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>df.fuelType.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="229">
<pre><code>array(['Regular', 'Premium', 'Diesel', 'CNG', 'Gasoline or natural gas',
       'Gasoline or E85', 'Electricity', 'Gasoline or propane',
       'Premium or E85', 'Midgrade', 'Premium Gas or Electricity',
       'Regular Gas and Electricity', 'Premium and Electricity',
       'Regular Gas or Electricity'], dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>top5 <span class="op">=</span> df.fuelType.value_counts().index[:<span class="dv">5</span>]</span>
<span id="cb319-2"><a href="#cb319-2" aria-hidden="true" tabindex="-1"></a>top5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="230">
<pre><code>Index(['Regular', 'Premium', 'Gasoline or E85', 'Diesel', 'Electricity'], dtype='object', name='fuelType')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="231">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>df.fuelType.where(df.fuelType.isin(top5), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="231">
<pre><code>0        Regular
1        Regular
2        Regular
3        Regular
4        Premium
          ...   
41139    Regular
41140    Regular
41141    Regular
41142    Regular
41143    Premium
Name: fuelType, Length: 41144, dtype: object</code></pre>
</div>
</div>
<p><strong>7. Using a categorical column, replace any value that is not in the top 10 most frequent values with <code>'Other'</code>.</strong></p>
<div class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>top10 <span class="op">=</span> df.fuelType.value_counts().index[:<span class="dv">10</span>]</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>top10</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="232">
<pre><code>Index(['Regular', 'Premium', 'Gasoline or E85', 'Diesel', 'Electricity',
       'Premium or E85', 'Midgrade', 'CNG', 'Premium and Electricity',
       'Regular Gas and Electricity'],
      dtype='object', name='fuelType')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>df.fuelType.where(df.fuelType.isin(top10), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre><code>0        Regular
1        Regular
2        Regular
3        Regular
4        Premium
          ...   
41139    Regular
41140    Regular
41141    Regular
41142    Regular
41143    Premium
Name: fuelType, Length: 41144, dtype: object</code></pre>
</div>
</div>
<p><strong>8. Make a function that takes a categorical series and a number (<code>n</code>) and returns a replace series that replaces any value that is not in the top <code>n</code> most frequent values with <code>'Other'</code>.</strong></p>
<div class="cell" data-execution_count="234">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> top_n_categorical(s, n):</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a>    top_n <span class="op">=</span> s.value_counts().index[:n]</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s.where(s.isin(top_n), other<span class="op">=</span><span class="st">'Other'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="237">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> top_n_categorical(df.fuelType, <span class="dv">10</span>)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a>s.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="237">
<pre><code>array(['Regular', 'Premium', 'Diesel', 'CNG', 'Other', 'Gasoline or E85',
       'Electricity', 'Premium or E85', 'Midgrade',
       'Regular Gas and Electricity', 'Premium and Electricity'],
      dtype=object)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="238">
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> top_n_categorical(df.fuelType, <span class="dv">5</span>)</span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>s.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="238">
<pre><code>array(['Regular', 'Premium', 'Diesel', 'Other', 'Gasoline or E85',
       'Electricity'], dtype=object)</code></pre>
</div>
</div>
<p><strong>9. Using a numeric column, bin it into 10 groups that have the same width.</strong></p>
<div class="cell" data-execution_count="246">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>pd.cut(city_mpg, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="246">
<pre><code>0        (5.856, 20.4]
1        (5.856, 20.4]
2         (20.4, 34.8]
3        (5.856, 20.4]
4        (5.856, 20.4]
             ...      
41139    (5.856, 20.4]
41140    (5.856, 20.4]
41141    (5.856, 20.4]
41142    (5.856, 20.4]
41143    (5.856, 20.4]
Name: city08, Length: 41144, dtype: category
Categories (10, interval[float64, right]): [(5.856, 20.4] &lt; (20.4, 34.8] &lt; (34.8, 49.2] &lt; (49.2, 63.6] ... (92.4, 106.8] &lt; (106.8, 121.2] &lt; (121.2, 135.6] &lt; (135.6, 150.0]]</code></pre>
</div>
</div>
<p><strong>10. Using a numeric column, bin it into 10 groups that have equal sized bins.</strong></p>
<div class="cell" data-execution_count="245">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(city_mpg, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="245">
<pre><code>0         (18.0, 20.0]
1        (5.999, 13.0]
2         (21.0, 24.0]
3        (5.999, 13.0]
4         (16.0, 17.0]
             ...      
41139     (18.0, 20.0]
41140     (18.0, 20.0]
41141     (17.0, 18.0]
41142     (17.0, 18.0]
41143     (15.0, 16.0]
Name: city08, Length: 41144, dtype: category
Categories (10, interval[float64, right]): [(5.999, 13.0] &lt; (13.0, 14.0] &lt; (14.0, 15.0] &lt; (15.0, 16.0] ... (18.0, 20.0] &lt; (20.0, 21.0] &lt; (21.0, 24.0] &lt; (24.0, 150.0]]</code></pre>
</div>
</div>
<p><a href="https://stackoverflow.com/questions/20158597/how-to-qcut-with-non-unique-bin-edges">This</a> Stack Overflow response addresses the below error:</p>
<div class="cell" data-execution_count="249">
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(df.cylinders, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: Bin edges must be unique: array([ 2.,  4.,  4.,  4.,  5.,  6.,  6.,  6.,  8.,  8., 16.]).
You can drop duplicate edges by setting the 'duplicates' kwarg</code></pre>
</div>
</div>
<p>If I decrease the number of bins to 5, the error is not raised:</p>
<div class="cell" data-execution_count="255">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>pd.qcut(df.cylinders, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="255">
<pre><code>0        (1.999, 4.0]
1         (8.0, 16.0]
2        (1.999, 4.0]
3          (6.0, 8.0]
4        (1.999, 4.0]
             ...     
41139    (1.999, 4.0]
41140    (1.999, 4.0]
41141    (1.999, 4.0]
41142    (1.999, 4.0]
41143    (1.999, 4.0]
Name: cylinders, Length: 41144, dtype: category
Categories (5, interval[float64, right]): [(1.999, 4.0] &lt; (4.0, 5.0] &lt; (5.0, 6.0] &lt; (6.0, 8.0] &lt; (8.0, 16.0]]</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-10-indexing-operations" class="level2">
<h2 class="anchored" data-anchor-id="chapter-10-indexing-operations">Chapter 10: Indexing Operations</h2>
<p>Both a series and a dataframe have an index. Both types support the Python indexing operator (<code>[]</code>). Both have attributes <code>.loc</code> and <code>.iloc</code> that you can index against.</p>
<section id="prepping-the-data-and-renaming-the-index" class="level3">
<h3 class="anchored" data-anchor-id="prepping-the-data-and-renaming-the-index">10.1 Prepping the Data and Renaming the Index</h3>
<p>Use <code>.rename</code> method to hange the index labels. We can pass in a dictionary to map the previous index label to the new label:</p>
<div class="cell" data-execution_count="259">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="bu">dict</span>(itertools.islice(df.make.to_dict().items(), <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="259">
<pre><code>{0: 'Alfa Romeo',
 1: 'Ferrari',
 2: 'Dodge',
 3: 'Dodge',
 4: 'Subaru',
 5: 'Subaru',
 6: 'Subaru',
 7: 'Toyota',
 8: 'Toyota',
 9: 'Toyota'}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="260">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>city2 <span class="op">=</span> city_mpg.rename(df.make.to_dict())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="261">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>city2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="261">
<pre><code>Alfa Romeo    19
Ferrari        9
Dodge         23
Dodge         10
Subaru        17
              ..
Subaru        19
Subaru        20
Subaru        18
Subaru        18
Subaru        16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="262">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># view the index</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>city2.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="262">
<pre><code>Index(['Alfa Romeo', 'Ferrari', 'Dodge', 'Dodge', 'Subaru', 'Subaru', 'Subaru',
       'Toyota', 'Toyota', 'Toyota',
       ...
       'Saab', 'Saturn', 'Saturn', 'Saturn', 'Saturn', 'Subaru', 'Subaru',
       'Subaru', 'Subaru', 'Subaru'],
      dtype='object', length=41144)</code></pre>
</div>
</div>
<p>The <code>.rename</code> method also accepts a series, a scalar, a function that takes an old label and returns a new lable or a sequence. When we pass in a series and the index values are the same, the values from the series that we passed in are used as the index.</p>
<div class="cell" data-execution_count="263">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>city2 <span class="op">=</span> city_mpg.rename(df.make)</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>city2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="263">
<pre><code>Alfa Romeo    19
Ferrari        9
Dodge         23
Dodge         10
Subaru        17
              ..
Subaru        19
Subaru        20
Subaru        18
Subaru        18
Subaru        16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>If you pass a scalar value (a single string) into <code>.rename</code> the index will stay the same but the <code>.name</code> attribute of the series will update:</p>
<div class="cell" data-execution_count="264">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>city2.rename(<span class="st">'citympg'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="264">
<pre><code>Alfa Romeo    19
Ferrari        9
Dodge         23
Dodge         10
Subaru        17
              ..
Subaru        19
Subaru        20
Subaru        18
Subaru        18
Subaru        16
Name: citympg, Length: 41144, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="resetting-the-index" class="level3">
<h3 class="anchored" data-anchor-id="resetting-the-index">10.2 Resetting the Index</h3>
<p><code>.reset_index</code> by default will return a dataframe, moving the current index into a new column:</p>
<div class="cell" data-execution_count="265">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>city2.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="265">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>index</th>
      <th>city08</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alfa Romeo</td>
      <td>19</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ferrari</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Dodge</td>
      <td>23</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dodge</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Subaru</td>
      <td>17</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>41139</th>
      <td>Subaru</td>
      <td>19</td>
    </tr>
    <tr>
      <th>41140</th>
      <td>Subaru</td>
      <td>20</td>
    </tr>
    <tr>
      <th>41141</th>
      <td>Subaru</td>
      <td>18</td>
    </tr>
    <tr>
      <th>41142</th>
      <td>Subaru</td>
      <td>18</td>
    </tr>
    <tr>
      <th>41143</th>
      <td>Subaru</td>
      <td>16</td>
    </tr>
  </tbody>
</table>
<p>41144 rows × 2 columns</p>
</div>
</div>
</div>
<p><code>drop=True</code> drops the current index and returns a Series.</p>
<div class="cell" data-execution_count="266">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>city2.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="266">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>Note that <code>.sort_values</code> and <code>.sort_index</code> keep the same index but just rearrange the order so they do not impact operations that align on the index.</p>
</section>
<section id="the-.loc-attribute" class="level3">
<h3 class="anchored" data-anchor-id="the-.loc-attribute">10.3 The <code>.loc</code> Attribute</h3>
<p>The <code>.loc</code> attribute deals with index <em>labels</em>. You can pass the following into an index operation on <code>.loc</code>:</p>
<ul>
<li>A scalar value of one of the index labels.</li>
<li>A list of index labels.</li>
<li>A slice of labels (closed interval so it includes the stop value).</li>
<li>An index.</li>
<li>A boolean array (same index labels as the series, but with True and False values).</li>
<li>A function that accepts a series and returns one of the above.</li>
</ul>
<p>If there are duplicate labels in the index, and you pass in a scalar with the label of an index, it will return a series. If there is only one value for that label it will return a scalar.</p>
<div class="cell" data-execution_count="267">
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>city2.loc[<span class="st">'Subaru'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="267">
<pre><code>Subaru    17
Subaru    21
Subaru    22
Subaru    19
Subaru    20
          ..
Subaru    19
Subaru    20
Subaru    18
Subaru    18
Subaru    16
Name: city08, Length: 885, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="268">
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>city2.loc[<span class="st">'Fisker'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="268">
<pre><code>20</code></pre>
</div>
</div>
<p>If you want to guarantee that a series is returned, pass in a list rather than passing in a scalar value:</p>
<div class="cell" data-execution_count="269">
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>city2.loc[[<span class="st">'Fisker'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="269">
<pre><code>Fisker    20
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="270">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>city2.loc[[<span class="st">'Ferrari'</span>, <span class="st">'Lamborghini'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="270">
<pre><code>Ferrari         9
Ferrari        12
Ferrari        11
Ferrari        10
Ferrari        11
               ..
Lamborghini     6
Lamborghini     8
Lamborghini     8
Lamborghini     8
Lamborghini     8
Name: city08, Length: 357, dtype: int64</code></pre>
</div>
</div>
<p>Sort the index if you are slicing with duplicate index labels:</p>
<div class="cell" data-execution_count="271">
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>city2.loc[<span class="st">'Ferrari'</span>:<span class="st">'Lamborghini'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>KeyError: "Cannot get left slice bound for non-unique label: 'Ferrari'"</code></pre>
</div>
</div>
<div class="cell" data-execution_count="272">
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a>city2.sort_index().loc[<span class="st">'Ferrari'</span>:<span class="st">'Lamborghini'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="272">
<pre><code>Ferrari        10
Ferrari        13
Ferrari        13
Ferrari         9
Ferrari        10
               ..
Lamborghini    12
Lamborghini     9
Lamborghini     8
Lamborghini    13
Lamborghini     8
Name: city08, Length: 11210, dtype: int64</code></pre>
</div>
</div>
<p>Slicing with <code>.loc</code> follows the closed interval, includes both the start index and the final index.</p>
<p>If you have a sorted index, you can slice with strings that are not actual labels.</p>
<div class="cell" data-execution_count="273">
<div class="sourceCode cell-code" id="cb366"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>city2.sort_index().loc[<span class="st">"F"</span>:<span class="st">"J"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="273">
<pre><code>Federal Coach    15
Federal Coach    13
Federal Coach    13
Federal Coach    14
Federal Coach    13
                 ..
Isuzu            15
Isuzu            15
Isuzu            15
Isuzu            27
Isuzu            18
Name: city08, Length: 9040, dtype: int64</code></pre>
</div>
</div>
<p>You can also pass an <code>Index</code> to <code>.loc</code>:</p>
<div class="cell" data-execution_count="274">
<div class="sourceCode cell-code" id="cb368"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> pd.Index([<span class="st">'Dodge'</span>])</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>city2.loc[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="274">
<pre><code>Dodge    23
Dodge    10
Dodge    12
Dodge    11
Dodge    11
         ..
Dodge    18
Dodge    17
Dodge    14
Dodge    14
Dodge    11
Name: city08, Length: 2583, dtype: int64</code></pre>
</div>
</div>
<p>If we duplicate <code>'Dodge'</code> in the <code>Index</code>, the previous operation has twice as many values, a combinatoric explosion:</p>
<div class="cell" data-execution_count="275">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>idx <span class="op">=</span> pd.Index([<span class="st">'Dodge'</span>, <span class="st">'Dodge'</span>])</span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>city2.loc[idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="275">
<pre><code>Dodge    23
Dodge    10
Dodge    12
Dodge    11
Dodge    11
         ..
Dodge    18
Dodge    17
Dodge    14
Dodge    14
Dodge    11
Name: city08, Length: 5166, dtype: int64</code></pre>
</div>
</div>
<p>You can also pass a boolean array to <code>.loc</code>:</p>
<div class="cell" data-execution_count="276">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> city2 <span class="op">&gt;</span> <span class="dv">50</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="276">
<pre><code>Alfa Romeo    False
Ferrari       False
Dodge         False
Dodge         False
Subaru        False
              ...  
Subaru        False
Subaru        False
Subaru        False
Subaru        False
Subaru        False
Name: city08, Length: 41144, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="278">
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>city2.loc[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="278">
<pre><code>Nissan     81
Toyota     81
Toyota     81
Ford       74
Nissan     84
         ... 
Tesla     140
Tesla     115
Tesla     104
Tesla      98
Toyota     55
Name: city08, Length: 236, dtype: int64</code></pre>
</div>
</div>
<p>You can use a function with <code>.loc</code>. If I calculate the boolean array before taking into account the inflation, I get the wrong answer:</p>
<div class="cell" data-execution_count="279">
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>cost <span class="op">=</span> pd.Series([<span class="fl">1.00</span>, <span class="fl">2.25</span>, <span class="fl">3.99</span>, <span class="fl">.99</span>, <span class="fl">2.79</span>],</span>
<span id="cb376-2"><a href="#cb376-2" aria-hidden="true" tabindex="-1"></a>                 index<span class="op">=</span>[<span class="st">'Gum'</span>, <span class="st">'Cookie'</span>, <span class="st">'Melon'</span>, <span class="st">'Roll'</span>, <span class="st">'Carrots'</span>])</span>
<span id="cb376-3"><a href="#cb376-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-4"><a href="#cb376-4" aria-hidden="true" tabindex="-1"></a>inflation <span class="op">=</span> <span class="fl">1.10</span></span>
<span id="cb376-5"><a href="#cb376-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb376-6"><a href="#cb376-6" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> cost <span class="op">&gt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="281">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrong answer</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a>(cost</span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>     .mul(inflation)</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>     .loc[mask]</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="281">
<pre><code>Melon    4.389
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="282">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a><span class="co"># right answer</span></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a>(cost</span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a>     .mul(inflation)</span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>     .loc[<span class="kw">lambda</span> s_: s_ <span class="op">&gt;</span> <span class="dv">3</span>]</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="282">
<pre><code>Melon      4.389
Carrots    3.069
dtype: float64</code></pre>
</div>
</div>
<p>There is an implicit return statement in the lambda function. You can only put an expression in it, you can have a statement. It is limited to a single line of code.</p>
</section>
<section id="the-.iloc-attribute" class="level3">
<h3 class="anchored" data-anchor-id="the-.iloc-attribute">10.4 The <code>.iloc</code> Attribute</h3>
<p>The <code>.iloc</code> attribute supports indexing with the following:</p>
<ul>
<li>A scalar index position (an integer).</li>
<li>A list of index positions.</li>
<li>A slice of positions (half-open interval so it does not include stop value).</li>
<li>A NumPy array (or Python list) of boolean values.</li>
<li>A function that accepts a series and returns one of the above.</li>
</ul>
<p>Because index positions are unique, we will always get the scalar value when indexing with <code>.iloc</code> at a position:</p>
<div class="cell" data-execution_count="283">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">
<pre><code>19</code></pre>
</div>
</div>
<div class="cell" data-execution_count="284">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">
<pre><code>16</code></pre>
</div>
</div>
<p>If we want to return a series object, we can index it with a list of positions:</p>
<div class="cell" data-execution_count="285">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="285">
<pre><code>Alfa Romeo    19
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="286">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="286">
<pre><code>Alfa Romeo    19
Ferrari        9
Subaru        16
Name: city08, dtype: int64</code></pre>
</div>
</div>
<p>We can also use slices with <code>.iloc</code> (they follow the half-open interval):</p>
<div class="cell" data-execution_count="287">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[<span class="dv">0</span>:<span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="287">
<pre><code>Alfa Romeo    19
Ferrari        9
Dodge         23
Dodge         10
Subaru        17
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="288">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[<span class="op">-</span><span class="dv">8</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="288">
<pre><code>Saturn    21
Saturn    24
Saturn    21
Subaru    19
Subaru    20
Subaru    18
Subaru    18
Subaru    16
Name: city08, dtype: int64</code></pre>
</div>
</div>
<p>You can use a NumPy array of booleans (or a Python list) but if you use what we call a boolean array (a pandas series with booleans), this will fail:</p>
<div class="cell" data-execution_count="289">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> city2 <span class="op">&gt;</span> <span class="dv">50</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>city2.iloc[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: iLocation based boolean indexing cannot use an indexable as a mask</code></pre>
</div>
</div>
<div class="cell" data-execution_count="290">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>city2.iloc[mask.to_numpy()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="290">
<pre><code>Nissan     81
Toyota     81
Toyota     81
Ford       74
Nissan     84
         ... 
Tesla     140
Tesla     115
Tesla     104
Tesla      98
Toyota     55
Name: city08, Length: 236, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="heads-and-tails" class="level3">
<h3 class="anchored" data-anchor-id="heads-and-tails">10.5 Heads and Tails</h3>
<div class="cell" data-execution_count="291">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>city2.head(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="291">
<pre><code>Alfa Romeo    19
Ferrari        9
Dodge         23
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="292">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>city2.tail(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">
<pre><code>Subaru    18
Subaru    18
Subaru    16
Name: city08, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="sampling" class="level3">
<h3 class="anchored" data-anchor-id="sampling">10.6 Sampling</h3>
<p>The code below randomly pulls out six values:</p>
<div class="cell" data-execution_count="293">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>city2.sample(<span class="dv">6</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="293">
<pre><code>Volvo         16
Mitsubishi    19
Buick         27
Jeep          15
Land Rover    13
Saab          17
Name: city08, dtype: int64</code></pre>
</div>
</div>
</section>
<section id="filtering-index-values" class="level3">
<h3 class="anchored" data-anchor-id="filtering-index-values">10.7 Filtering Index Values</h3>
<p>The <code>filter</code> method will filter index labels by exact match (<code>items</code>), substring (<code>like</code>), or regex (<code>regex</code>).</p>
<div class="cell" data-execution_count="294">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exact match fails with duplicate index labels</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>city2.<span class="bu">filter</span>(items<span class="op">=</span>[<span class="st">'Ford'</span>, <span class="st">'Subaru'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: cannot reindex on an axis with duplicate labels</code></pre>
</div>
</div>
<div class="cell" data-execution_count="295">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>city2.<span class="bu">filter</span>(like<span class="op">=</span><span class="st">'rd'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="295">
<pre><code>Ford    18
Ford    16
Ford    17
Ford    17
Ford    15
        ..
Ford    26
Ford    19
Ford    21
Ford    18
Ford    19
Name: city08, Length: 3371, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="296">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>city2.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">'(Ford)|(Subaru)'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="296">
<pre><code>Subaru    17
Subaru    21
Subaru    22
Ford      18
Ford      16
          ..
Subaru    19
Subaru    20
Subaru    18
Subaru    18
Subaru    16
Name: city08, Length: 4256, dtype: int64</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>