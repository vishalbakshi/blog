<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vishal Bakshi">
<meta name="description" content="An update on my progress in the book “Effective Pandas” by Matt Harrison.">

<title>vishal bakshi - Effective Pandas - Notes and Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vishal bakshi</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#chapter-4-series-introduction" id="toc-chapter-4-series-introduction" class="nav-link active" data-scroll-target="#chapter-4-series-introduction">Chapter 4: Series Introduction</a>
  <ul class="collapse">
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-5-series-deep-dive" id="toc-chapter-5-series-deep-dive" class="nav-link" data-scroll-target="#chapter-5-series-deep-dive">Chapter 5: Series Deep Dive</a>
  <ul class="collapse">
  <li><a href="#exercises-1" id="toc-exercises-1" class="nav-link" data-scroll-target="#exercises-1">Exercises</a></li>
  </ul></li>
  <li><a href="#chapter-6-operators-dunder-methods" id="toc-chapter-6-operators-dunder-methods" class="nav-link" data-scroll-target="#chapter-6-operators-dunder-methods">Chapter 6: Operators (&amp; Dunder Methods)</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise">Exercise</a></li>
  <li><a href="#chapter-7-aggregate-methods" id="toc-chapter-7-aggregate-methods" class="nav-link" data-scroll-target="#chapter-7-aggregate-methods">Chapter 7: Aggregate Methods</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Effective Pandas - Notes and Exercises</h1>
  <div class="quarto-categories">
    <div class="quarto-category">data analysis</div>
    <div class="quarto-category">python</div>
  </div>
  </div>

<div>
  <div class="description">
    An update on my progress in the book “Effective Pandas” by Matt Harrison.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vishal Bakshi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>In this blog post, I work through the book <a href="https://www.amazon.com/Effective-Pandas-Patterns-Manipulation-Treading/dp/B09MYXXSFM/ref=sr_1_1?crid=1ZS9KD8F19ZMT&amp;keywords=effective+pandas&amp;qid=1688689886&amp;sprefix=effective+pa%2Caps%2C518&amp;sr=8-1">Effective Pandas by Matt Harrison</a>. I’ll take notes, work through examples and end-of-chapter exercises.</p>
<section id="chapter-4-series-introduction" class="level2">
<h2 class="anchored" data-anchor-id="chapter-4-series-introduction">Chapter 4: Series Introduction</h2>
<p>Represent the following data in pure python:</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: left;">Artist</th>
<th style="text-align: left;">Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: left;">145</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">13</td>
</tr>
</tbody>
</table>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>series <span class="op">=</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'data'</span>: [<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'songs'</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>{'index': [0, 1, 2, 3], 'data': [145, 142, 38, 13], 'name': 'songs'}</code></pre>
</div>
</div>
<p>The <code>get</code> function below can pull items out of this data structure based on the index:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get(series, idx):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    value_idx <span class="op">=</span> series[<span class="st">'index'</span>].index(idx)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> series[<span class="st">'data'</span>][value_idx]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>get(series, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>142</code></pre>
</div>
</div>
<p>The <code>index</code> method on the list returns the list element at the provided index value.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>].index(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>1</code></pre>
</div>
</div>
<p>Below is an example that has string values for the index:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>songs <span class="op">=</span> {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'index'</span>: [<span class="st">'Paul'</span>, <span class="st">'John'</span>, <span class="st">'George'</span>, <span class="st">'Ringo'</span>],</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'data'</span>: [<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'name'</span>: <span class="st">'songs'</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>get(songs, <span class="st">'John'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>142</code></pre>
</div>
</div>
<p>Create a <code>Series</code> object from a list:</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>songs2 <span class="op">=</span> pd.Series([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>], name <span class="op">=</span> <span class="st">'counts'</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>songs2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0    145
1    142
2     38
3     13
Name: counts, dtype: int64</code></pre>
</div>
</div>
<p>The series is one-dimensional. The leftmost column is the <em>index</em>, also called the <em>axis</em>. The data (145, 142, 38, 13) is also called the <em>values</em> of the series. A <code>DataFrame</code> has two axes, one for the rows and another for the columns.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>songs2.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>RangeIndex(start=0, stop=4, step=1)</code></pre>
</div>
</div>
<p>The default values for an index are monotonically increasing integers. The index can be string-based as well (datatype for the index is <code>object</code>).</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>songs3 <span class="op">=</span> pd.Series([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>],</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                   name <span class="op">=</span> <span class="st">'counts'</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                   index <span class="op">=</span> [<span class="st">'Paul'</span>, <span class="st">'John'</span>, <span class="st">'George'</span>, <span class="st">'Ringo'</span>])</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>songs3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>Paul      145
John      142
George     38
Ringo      13
Name: counts, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>songs3.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>Index(['Paul', 'John', 'George', 'Ringo'], dtype='object')</code></pre>
</div>
</div>
<p>We can insert Python objects into a series:</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Foo:</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ringo <span class="op">=</span> pd.Series(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">'Richard'</span>, <span class="st">'Starkey'</span>, <span class="dv">13</span>, Foo()],</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">'ringo'</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>ringo</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>0                                 Richard
1                                 Starkey
2                                      13
3    &lt;__main__.Foo object at 0x10847d960&gt;
Name: ringo, dtype: object</code></pre>
</div>
</div>
<p>The <code>object</code> data type is also used for a series with string values and values that have heterogeneous or mixed types.</p>
<p>Here is a series that has <code>NaN</code> in it:</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>nan_series <span class="op">=</span> pd.Series([<span class="dv">2</span>, np.nan],</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                       index <span class="op">=</span> [<span class="st">'Ono'</span>, <span class="st">'Clapton'</span>])</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>nan_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Ono        2.0
Clapton    NaN
dtype: float64</code></pre>
</div>
</div>
<p><code>float64</code> supports <code>NaN</code> while <code>int64</code> does not. As of pandas 0.24, <code>Int64</code> (nullable integer type) supports <code>NaN</code>.</p>
<p><code>count</code> ignores <code>NaN</code>s, <code>.size</code> does not.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>nan_series.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>nan_series.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>2</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nan_series2 <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="va">None</span>],</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                        index <span class="op">=</span> [<span class="st">'Ono'</span>, <span class="st">'Clapton'</span>],</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                        dtype <span class="op">=</span> <span class="st">'Int64'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>nan_series2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>Ono           2
Clapton    &lt;NA&gt;
dtype: Int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>nan_series2.count()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert data type</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>nan_series.astype(<span class="st">'Int64'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>Ono           2
Clapton    &lt;NA&gt;
dtype: Int64</code></pre>
</div>
</div>
<p>The <code>Series</code> object behaves similarly to a NumPy array.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>numpy_ser <span class="op">=</span> np.array([<span class="dv">145</span>, <span class="dv">142</span>, <span class="dv">38</span>, <span class="dv">13</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>songs3[<span class="dv">1</span>], numpy_ser[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(142, 142)</code></pre>
</div>
</div>
<p>They both have methods in common</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>songs3.mean(), numpy_ser.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>(84.5, 84.5)</code></pre>
</div>
</div>
<p>They both have a notion of a <em>boolean array</em>.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> songs3 <span class="op">&gt;</span> songs3.median()</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Paul       True
John       True
George    False
Ringo     False
Name: counts, dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use mask as a filter</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>songs3[mask]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Paul    145
John    142
Name: counts, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NumPy equivalent</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>numpy_ser[numpy_ser <span class="op">&gt;</span> np.median(numpy_ser)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([145, 142])</code></pre>
</div>
</div>
<p>If can indicate that data is categorical.</p>
<p>Categorical values:</p>
<ul>
<li>Use less memory than strings</li>
<li>Impove performance</li>
<li>Can have an ordering</li>
<li>Can perform operations on categories</li>
<li>Enforce membership on values</li>
</ul>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'xl'</span>], dtype <span class="op">=</span> <span class="st">'category'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0     m
1     l
2    xs
3     s
4    xl
dtype: category
Categories (5, object): ['l', 'm', 's', 'xl', 'xs']</code></pre>
</div>
</div>
<p>By default categories don’t have an ordering.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>s.cat.ordered</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>False</code></pre>
</div>
</div>
<p>Convert non-categorical series to an ordered category:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'xl'</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>size_type <span class="op">=</span> pd.api.types.CategoricalDtype(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    categories<span class="op">=</span>[<span class="st">'s'</span>, <span class="st">'m'</span>, <span class="st">'l'</span>], ordered <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">=</span> s2.astype(size_type)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>s3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>0      m
1      l
2    NaN
3      s
4    NaN
dtype: category
Categories (3, object): ['s' &lt; 'm' &lt; 'l']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># can perform comparisons on ordered categories</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>s3 <span class="op">&gt;</span> <span class="st">'s'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0     True
1     True
2    False
3    False
4    False
dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add ordering information to categorical data</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>s.cat.reorder_categories([<span class="st">'xs'</span>, <span class="st">'s'</span>, <span class="st">'m'</span>, <span class="st">'l'</span>, <span class="st">'xl'</span>], ordered<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0     m
1     l
2    xs
3     s
4    xl
dtype: category
Categories (5, object): ['xs' &lt; 's' &lt; 'm' &lt; 'l' &lt; 'xl']</code></pre>
</div>
</div>
<p>For strings and dates converted to categorical types, we can still use the <code>str</code> or <code>dt</code> attributes on them:</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>s3.<span class="bu">str</span>.upper()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>0      M
1      L
2    NaN
3      S
4    NaN
dtype: object</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>pd.Series(data=None, index=None, dtype=None, name=None, copy=False)</code></td>
<td style="text-align: left;">Create a series from data (sequence, dictionary or scalar)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.index</code></td>
<td style="text-align: left;">Access index of series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.astype(dtype, errors='raise')</code></td>
<td style="text-align: left;">Cast a series to <code>dtype</code>. To ignore errors (and return original object) use <code>errors='ignore'</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s[boolean_array]</code></td>
<td style="text-align: left;">Return values from <code>s</code> where <code>boolean_array</code> is <code>True</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.cat.ordered</code></td>
<td style="text-align: left;">Determine if a categorical series is ordered</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.cat.reorder_categories(new_categories, ordered=False)</code></td>
<td style="text-align: left;">Add categories (potentially ordered) to the series. <code>new_categories</code> must include all categories.</td>
</tr>
</tbody>
</table>
<section id="exercises" class="level3">
<h3 class="anchored" data-anchor-id="exercises">Exercises</h3>
<ol type="1">
<li>Using Jupyter, create a series with the temperature values for the last seven days. Filter out the vaues below the mean.</li>
<li>Using Jupyter, create a series with your favorite colors. Use a categorical type.</li>
</ol>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># temperature series</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>temps <span class="op">=</span> pd.Series([<span class="dv">88</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">84</span>, <span class="dv">88</span>, <span class="dv">95</span>, <span class="dv">97</span> ,<span class="dv">88</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>temps[temps <span class="op">&gt;=</span> temps.mean()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>5    95
6    97
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># favorite colors</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>colors_series <span class="op">=</span> pd.Series([<span class="st">'orange'</span>, <span class="st">'coral'</span>, <span class="st">'midnight green'</span>], dtype <span class="op">=</span> <span class="st">'category'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>colors_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0            orange
1             coral
2    midnight green
dtype: category
Categories (3, object): ['coral', 'midnight green', 'orange']</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-5-series-deep-dive" class="level2">
<h2 class="anchored" data-anchor-id="chapter-5-series-deep-dive">Chapter 5: Series Deep Dive</h2>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># analyze the US Fuel Economy data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://github.com/mattharrison/datasets/raw/master/data/vehicles.csv.zip'</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">=</span> df.city08</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>highway_mpg <span class="op">=</span> df.highway08</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/5q/_bn7l90s177_2gq7rnhssjxm0000gn/T/ipykernel_76817/221626492.py:4: DtypeWarning: Columns (68,70,71,72,73,74,76,79) have mixed types. Specify dtype option on import or set low_memory=False.
  df = pd.read_csv(url)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>0        19
1         9
2        23
3        10
4        17
         ..
41139    19
41140    20
41141    18
41142    18
41143    16
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>highway_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>0        25
1        14
2        33
3        12
4        23
         ..
41139    26
41140    28
41141    24
41142    24
41143    21
Name: highway08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<p>Because the type is <code>int64</code> we know that none of the values are missing.</p>
<p>The <code>dir</code> function lists the attributes of an object. A series has 400+ attributes:</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(city_mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>412</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(highway_mpg))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>412</code></pre>
</div>
</div>
<p>Functionality of series attributes:</p>
<ul>
<li>Dunder methods provide many numeric operations, looping, attribute access, and index access. For the numeric operations, these return <code>Series</code>.</li>
<li>Corresponding operator methods for many of the numeric operations allow us to tweak the behavior.</li>
<li>Aggregate methods and properties which reduce or aggregate the values in a series down to a single scalar value.</li>
<li>Conversion methods. Some of these start with <code>.to_</code> and export the data to other formats.</li>
<li>Manipulation methods that return <code>Series</code> objects with the same index.</li>
<li>Indexing and accessor methods and attributes that return <code>Series</code> or scalars.</li>
<li>String manipulation methods using <code>.str</code>.</li>
<li>Date manipulation methods using <code>.dt</code>.</li>
<li>Plotting methods using <code>.plot</code>.</li>
<li>Categorical manipulation methods using <code>.cat</code>.</li>
<li>Transformation methods.</li>
<li>Attributes such as <code>.index</code> and <code>.dtype</code>.</li>
<li>A bunch of private attributes (130 of them) that we’ll ignore.</li>
</ul>
<section id="exercises-1" class="level3">
<h3 class="anchored" data-anchor-id="exercises-1">Exercises</h3>
<ol type="1">
<li>Explore the documentation for five attributes of a series from Jupyter.</li>
<li>How many attributes are found on the <code>.str</code> attribute? Look at the documentation for three of them.</li>
<li>How many attributes are found on the <code>.dt</code> attribute? Look at the documentation for three of them.</li>
</ol>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>city_mpg.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>array([19,  9, 23, ..., 18, 18, 16])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>city_mpg.axes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>[RangeIndex(start=0, stop=41144, step=1)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>city_mpg.empty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>city_mpg.at[<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>17</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>city_mpg.loc[<span class="dv">1</span>:<span class="dv">4</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>1     9
2    23
3    10
4    17
Name: city08, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 98 string attributes</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(s2.<span class="bu">str</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>98</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.cat(sep <span class="op">=</span> <span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>'m.l.xs.s.xl'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.capitalize()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>0     M
1     L
2    Xs
3     S
4    Xl
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>s2.<span class="bu">str</span>.endswith(<span class="st">'l'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>0    False
1     True
2    False
3    False
4     True
dtype: bool</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>dt_series <span class="op">=</span> pd.Series([<span class="st">'2023-01-01'</span>, <span class="st">'2023-04-05'</span>, <span class="st">'2023-07-06'</span>])</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>dt_series <span class="op">=</span> pd.to_datetime(dt_series)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>dt_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>0   2023-01-01
1   2023-04-05
2   2023-07-06
dtype: datetime64[ns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(<span class="bu">dir</span>(dt_series.dt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>83</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>0    1
1    5
2    6
dtype: int32</code></pre>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.day_of_year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>0      1
1     95
2    187
dtype: int32</code></pre>
</div>
</div>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>dt_series.dt.daysinmonth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>0    31
1    30
2    31
dtype: int32</code></pre>
</div>
</div>
</section>
</section>
<section id="chapter-6-operators-dunder-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-6-operators-dunder-methods">Chapter 6: Operators (&amp; Dunder Methods)</h2>
<p>These are the protocols that determine how the Python language reacts to operations.</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">+</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># under the cover is</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>).<span class="fu">__add__</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>6</code></pre>
</div>
</div>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(city_mpg <span class="op">+</span> highway_mpg) <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>0        22.0
1        11.5
2        28.0
3        11.0
4        20.0
         ... 
41139    22.5
41140    24.0
41141    21.0
41142    21.0
41143    18.5
Length: 41144, dtype: float64</code></pre>
</div>
</div>
<p>When you operate with two series, pandas will <em>align</em> the index before performing the operation. Because of index alignment, you will want to make sure that the indexes: - are unique - are common to both series</p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># example of series with repeated and non-common indexes</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">=</span> pd.Series([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>], index<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="dv">35</span>, <span class="dv">44</span>, <span class="dv">53</span>], index<span class="op">=</span>[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">4</span>], name <span class="op">=</span> <span class="st">'s2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>s1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>1    10
2    20
2    30
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>2    35
2    44
4    53
Name: s2, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index 1 and 4 have NaN</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># index 2 has four results</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>s1 <span class="op">+</span> s2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>1     NaN
2    55.0
2    64.0
2    65.0
2    74.0
4     NaN
dtype: float64</code></pre>
</div>
</div>
<p>When you perform math operations with a scalar, pandas <em>broadcasts</em> the operation to all values. A numeric pandas series is a block of memory, and modern CPUs leverage a technology called Single Instruction/Multiple Data (SIMD) to apply a math operation to the block of memory.</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use `fill_value` parameter to replace missing operands</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>s1.add(s2, fill_value <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>1    10.0
2    55.0
2    64.0
2    65.0
2    74.0
4    53.0
dtype: float64</code></pre>
</div>
</div>
<p>Chaining makes the code easy to read and understand</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    .add(highway_mpg)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>    .div(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>0        22.0
1        11.5
2        28.0
3        11.0
4        20.0
         ... 
41139    22.5
41140    24.0
41141    21.0
41142    21.0
41143    18.5
Length: 41144, dtype: float64</code></pre>
</div>
</div>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Operator</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.add(s2)</code></td>
<td style="text-align: left;"><code>s + s2</code></td>
<td style="text-align: left;">Adds series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.radd(s2)</code></td>
<td style="text-align: left;"><code>s2 + s</code></td>
<td style="text-align: left;">Adds series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.sub(s2)</code></td>
<td style="text-align: left;"><code>s - s2</code></td>
<td style="text-align: left;">Subtracts series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.rsub(s2)</code></td>
<td style="text-align: left;"><code>s2 - s</code></td>
<td style="text-align: left;">Subtracts series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.mul(s2)</code></td>
<td style="text-align: left;"><code>s * s2</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.multiply(s2)</code></td>
<td style="text-align: left;"><code>s * s2</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rmul(s2)</code></td>
<td style="text-align: left;"><code>s2 * s</code></td>
<td style="text-align: left;">Multiplies series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.div(s2)</code></td>
<td style="text-align: left;"><code>s / s2</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.truediv(s2)</code></td>
<td style="text-align: left;"><code>s / s2</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.rdiv(s2)</code></td>
<td style="text-align: left;"><code>s2 / s</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rtruediv(s2)</code></td>
<td style="text-align: left;"><code>s2 / s</code></td>
<td style="text-align: left;">Divides series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.mod(s2)</code></td>
<td style="text-align: left;"><code>s % s2</code></td>
<td style="text-align: left;">Modulo of series division</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rmod(s2)</code></td>
<td style="text-align: left;"><code>s2 % s</code></td>
<td style="text-align: left;">Modulo of series division</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.floordiv(s2)</code></td>
<td style="text-align: left;"><code>s // s2</code></td>
<td style="text-align: left;">Floor divide series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rfloordiv(s2)</code></td>
<td style="text-align: left;"><code>s2 // s</code></td>
<td style="text-align: left;">Floor divide series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.pow(s2)</code></td>
<td style="text-align: left;"><code>s ** s2</code></td>
<td style="text-align: left;">Exponential power of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.rpow(s2)</code></td>
<td style="text-align: left;"><code>s2 ** s</code></td>
<td style="text-align: left;">Exponential power of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.eq(s2)</code></td>
<td style="text-align: left;"><code>s2 == s</code></td>
<td style="text-align: left;">Elementwise equals of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.ne(s2)</code></td>
<td style="text-align: left;"><code>s2 != s</code></td>
<td style="text-align: left;">Elementwise not equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.gt(s2)</code></td>
<td style="text-align: left;"><code>s &gt; s2</code></td>
<td style="text-align: left;">Elementwise greater than of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.ge(s2)</code></td>
<td style="text-align: left;"><code>s &gt;= s2</code></td>
<td style="text-align: left;">Elementwise greater than or equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.lt(s2)</code></td>
<td style="text-align: left;"><code>s &lt; s2</code></td>
<td style="text-align: left;">Elementwise less than of series</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.le(s2)</code></td>
<td style="text-align: left;"><code>s &lt;= s2</code></td>
<td style="text-align: left;">Elementwise less than or equals of series</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>np.invert(s)</code></td>
<td style="text-align: left;"><code>~s</code></td>
<td style="text-align: left;">Elementwise inversion of boolean series (no pandas method)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>np.logical_and(s, s2)</code></td>
<td style="text-align: left;"><code>s &amp; s2</code></td>
<td style="text-align: left;">Elementwise logical and of boolean series (no pandas method)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>np.logical_or(s, s2)</code></td>
<td style="text-align: left;"><code>s \| s2</code></td>
<td style="text-align: left;">Elementwise logical or of boolean series (no pandas method)</td>
</tr>
</tbody>
</table>
</section>
<section id="exercise" class="level2">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<p>With a dataset of your choice: 1. Add a numeric series to itself. 2. Add 10 to a numeric series. 3. Add a numeric series to itself using the <code>.add</code> method. 4. Read the documentation for the <code>.add</code> method.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">+</span> city_mpg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>0        38
1        18
2        46
3        20
4        34
         ..
41139    38
41140    40
41141    36
41142    36
41143    32
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>city_mpg <span class="op">+</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>0        29
1        19
2        33
3        20
4        27
         ..
41139    29
41140    30
41141    28
41142    28
41143    26
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>city_mpg.add(city_mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>0        38
1        18
2        46
3        20
4        34
         ..
41139    38
41140    40
41141    36
41142    36
41143    32
Name: city08, Length: 41144, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># experimenting with fill_value parameter</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>nan_series3 <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="va">None</span>])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>nan_series4 <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="va">None</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>nan_series3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>0    2.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>nan_series4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>0    3.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># two corresponding NaN values stay NaN</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># even with fill_value = 0</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>nan_series3.add(nan_series4, fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>0    5.0
1    NaN
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="chapter-7-aggregate-methods" class="level2">
<h2 class="anchored" data-anchor-id="chapter-7-aggregate-methods">Chapter 7: Aggregate Methods</h2>
<p>Aggregate methods collapse the values of a series down to a scalar.</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the mean</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>city_mpg.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>city_mpg.is_unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).is_unique</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>city_mpg.is_monotonic_increasing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>False</code></pre>
</div>
</div>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).is_monotonic_increasing</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># default is median (50% quantile)</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>17.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile(<span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>24.0</code></pre>
</div>
</div>
<div class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple quantiles returns a Series</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>city_mpg.quantile([<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>0.1    13.0
0.5    17.0
0.9    24.0
Name: city08, dtype: float64</code></pre>
</div>
</div>
<p>If you want the count of values that meet some criteria, you can use the <code>.sum</code> method:</p>
<div class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># count of cars with mileage greater than 20</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">20</span>)</span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>     .<span class="bu">sum</span>()</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>10272</code></pre>
</div>
</div>
<div class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># percentage of cars with mileage greater than 20</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>(city_mpg</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">20</span>)</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>     .mul(<span class="dv">100</span>)</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>     .mean()</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>24.965973167412017</code></pre>
</div>
</div>
<div class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>    .gt(<span class="dv">2</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>    .mul(<span class="dv">100</span>)</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>0      0
1      0
2    100
3    100
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>(pd.Series([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>     .gt(<span class="dv">2</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>     .mul(<span class="dv">100</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>     .mean()   </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>50.0</code></pre>
</div>
</div>
<p>If you sum up a series of boolean values, the result is the count of <code>True</code> values. If you take the mean of a series of boolean values, the result is the fraction of values that are <code>True</code>.</p>
<p><code>.agg</code> can perform multiple operations.</p>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>city_mpg.agg(<span class="st">'mean'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>18.369045304297103</code></pre>
</div>
</div>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> second_to_last(s):</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> s.iloc[<span class="op">-</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>city_mpg.agg([<span class="st">'mean'</span>, np.var, <span class="bu">max</span>, second_to_last])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>mean               18.369045
var                62.503036
max               150.000000
second_to_last     18.000000
Name: city08, dtype: float64</code></pre>
</div>
</div>
<p>Aggregation strings and descriptions:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>'all'</code></td>
<td style="text-align: left;">Returns <code>True</code> if every value is truthy.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'any'</code></td>
<td style="text-align: left;">Returns <code>True</code> if any value is truthy.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'autocorr'</code></td>
<td style="text-align: left;">Returns Pearson correlation of series with shifted self. Can override <code>lag</code> as keyword argument (default is 1).</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'corr'</code></td>
<td style="text-align: left;">Returns Pearson correlation of series with other series. Need to specify <code>other</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'count'</code></td>
<td style="text-align: left;">Returns count of non-missing values.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'cov'</code></td>
<td style="text-align: left;">Returns covariance of series with other series. Need to specify <code>other</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'dtype'</code></td>
<td style="text-align: left;">Type of the series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'dtypes'</code></td>
<td style="text-align: left;">Type of the series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'empty'</code></td>
<td style="text-align: left;"><code>True</code> is no values in series.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'hasnans'</code></td>
<td style="text-align: left;"><code>True</code> if missing values in series.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'idxmax'</code></td>
<td style="text-align: left;">Returns index value of maximum value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'idxmin'</code></td>
<td style="text-align: left;">Returns index value of minimum value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'is_monotonic'</code></td>
<td style="text-align: left;"><code>True</code> if values always increase.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'is_monotonic_decreasing'</code></td>
<td style="text-align: left;"><code>True</code> if values always decrease.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'is_monotonic_increasing'</code></td>
<td style="text-align: left;"><code>True</code> if values always increase.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'kurt'</code></td>
<td style="text-align: left;">Returns “excess” kurtosis (0 is normal distribution). Values greater than 0 have more outliers than normal.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'mad'</code></td>
<td style="text-align: left;">Returns the mean absolute deviation.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'max'</code></td>
<td style="text-align: left;">Returns the maximum value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'mean'</code></td>
<td style="text-align: left;">Returns the mean value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'median'</code></td>
<td style="text-align: left;">Returns the median value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'min'</code></td>
<td style="text-align: left;">Returns the minimum value.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'nbytes'</code></td>
<td style="text-align: left;">Returns the number of bytes of the data.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'ndim'</code></td>
<td style="text-align: left;">Return the number of dimensions (1) of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'nunique'</code></td>
<td style="text-align: left;">Returns the count of unique values.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'quantile'</code></td>
<td style="text-align: left;">Returns the median value. Can override <code>q</code> to specify other quantile.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'sem'</code></td>
<td style="text-align: left;">Returns the unbiarsed standard error.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'size'</code></td>
<td style="text-align: left;">Returns the size of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'skew'</code></td>
<td style="text-align: left;">Returns the unbiased skew of the data. Negative indicates tail is on the left side.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>'std'</code></td>
<td style="text-align: left;">Returns the standard deviation of the data.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>'sum'</code></td>
<td style="text-align: left;">Returns the sum of the series.</td>
</tr>
</tbody>
</table>
<p>Aggregation methods and properties:</p>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>s.agg(func=None, axis=0, *args, **kwargs)</code></td>
<td style="text-align: left;">Returns a scalar if <code>func</code> is a single aggregation function. Returns a series if a list of aggregations are passed to <code>func</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.all(axis=0, bool_only=None, skipna=True, level=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.any(axis=0, bool_only=None, skipna=True, level=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.autocorr(lag=1)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.corr(other, method='pearson')</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.cov(other, min_periods=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.max(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.min(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.mean(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.median(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.prod(axis=None, skipna=None, level=None, numeric_only=None, min_count=0)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.quantile(q=0.5, interpolation='linear')</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.sem(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.std(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.var(axis=None, skipna=None, level=None, ddof=1, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.skew(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.kurtosis(axis=None, skipna=None, level=None, numeric_only=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.nunique(dropna=True)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.count(level=None)</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.size</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.is_unique</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.is_monotonic</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>s.is_monotonic_increasing</code></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>s.is_monotonic_decreasing</code></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>