<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vishal Bakshi">

<title>vishal bakshi - Regression and Other Stories - Notes and Excerpts</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">vishal bakshi</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#installation" id="toc-installation" class="nav-link active" data-scroll-target="#installation">Installation</a></li>
  <li><a href="#preface" id="toc-preface" class="nav-link" data-scroll-target="#preface">Preface</a>
  <ul class="collapse">
  <li><a href="#what-you-should-be-able-to-do-after-reading-and-working-through-this-book" id="toc-what-you-should-be-able-to-do-after-reading-and-working-through-this-book" class="nav-link" data-scroll-target="#what-you-should-be-able-to-do-after-reading-and-working-through-this-book">What you should be able to do after reading and working through this book</a></li>
  </ul></li>
  <li><a href="#part-1-fundamentals" id="toc-part-1-fundamentals" class="nav-link" data-scroll-target="#part-1-fundamentals">Part 1: Fundamentals</a>
  <ul class="collapse">
  <li><a href="#chapter-1-overview" id="toc-chapter-1-overview" class="nav-link" data-scroll-target="#chapter-1-overview">Chapter 1: Overview</a>
  <ul class="collapse">
  <li><a href="#the-three-challenges-of-statistics" id="toc-the-three-challenges-of-statistics" class="nav-link" data-scroll-target="#the-three-challenges-of-statistics">1.1 The three challenges of statistics</a></li>
  <li><a href="#why-learn-regression" id="toc-why-learn-regression" class="nav-link" data-scroll-target="#why-learn-regression">1.2 Why learn regression?</a></li>
  <li><a href="#some-examples-of-regression" id="toc-some-examples-of-regression" class="nav-link" data-scroll-target="#some-examples-of-regression">1.3 Some examples of regression</a></li>
  <li><a href="#challenges-in-building-understanding-and-interpreting-regressions" id="toc-challenges-in-building-understanding-and-interpreting-regressions" class="nav-link" data-scroll-target="#challenges-in-building-understanding-and-interpreting-regressions">1.4 Challenges in building, understanding, and interpreting regressions</a></li>
  <li><a href="#classical-and-bayesian-inference" id="toc-classical-and-bayesian-inference" class="nav-link" data-scroll-target="#classical-and-bayesian-inference">1.5 Classical and Bayesian Inference</a></li>
  <li><a href="#computing-least-squares-and-bayesian-regression" id="toc-computing-least-squares-and-bayesian-regression" class="nav-link" data-scroll-target="#computing-least-squares-and-bayesian-regression">1.6 Computing least squares and Bayesian regression</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regression and Other Stories - Notes and Excerpts</h1>
  <div class="quarto-categories">
    <div class="quarto-category">R</div>
    <div class="quarto-category">statistics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vishal Bakshi </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>In this blog post, I will work through the textbook <a href="https://users.aalto.fi/~ave/ROS.pdf"><em>Regression and Other Stories</em></a> by Andrew Gelman, Jennifer Hill, and Aki Vehtari. I’ll be posting excerpts (sometimes verbatim), notes (paraphrased excerpts) and my thoughts about the content (and any other related reading that I come across while understanding the textbook topics).</p>
<p>Before I get into the reading, I’ll note that I have not posted my solutions to exercises to honor the request of one of the authors, Aki Vehtari:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://twitter.com/avehtari/status/1486683277297598476?s=20"><img src="aki_vehtari_tweet_thread.png" class="img-fluid figure-img" alt="A tweet thread of Aki Vehtari explaining why they do not want solutions to the exercises published." width="438"></a></p>
</figure>
</div>
<p>However, to learn by writing, I will write about the process of doing the exercises, the results I got, and what I learned from it all.</p>
<section id="installation" class="level1">
<h1>Installation</h1>
<p>The data for this textbook is available in the <code>rosdata</code> package.</p>
<p>A couple of errors I had to resolve that I’m documenting here.</p>
<p>If you get the following error when installing a package:</p>
<pre><code>Error in file(filename, "r", encoding = encoding) : 
  cannot open the connection
Calls: source -&gt; file
In addition: Warning message:
In file(filename, "r", encoding = encoding) :
  cannot open file 'renv/activate.R': No such file or directory
Execution halted</code></pre>
<p>remove the line <code>source("renv/activate.R")</code> from both the project directory and home directory <code>.Rprofile</code> files.</p>
<p>When running <code>quarto render</code> if you get the following error:</p>
<p><code>there is no package called …</code></p>
<p>the issue might be that Quarto is not pointing towards the right <code>.libPaths()</code>. In your home directory’s <code>.Rprofile</code>, add <code>.libPaths("path/to/lib", "path/to/lib", …)</code> and it will show up in <code>quarto check</code> and may resolve this issue.</p>
</section>
<section id="preface" class="level1">
<h1>Preface</h1>
<ul>
<li>After reading this book and working through the exercises, you should be able to simulate regression models on the computer and build, critically evaluate, and use them for applied problems.</li>
<li>The other special feature of this book is its broad coverage: basics of statistics and measurement, linear regression, multiple regression, Bayesian inference, logistic regression and generalized linear models, extrapolation from sample to population, and causal inference.</li>
<li>After completing Part 1 you should have access to the tools of mathematics, statistics, and computing that will allow you to work with regression models.</li>
<li>Part 1 Goals
<ul>
<li>displaying and exploring data</li>
<li>computing and graphing linear relations</li>
<li>understanding basic probability distributions and statistical inferences</li>
<li>simulation of random processes to represent inferential and forecast uncertainty</li>
</ul></li>
<li>After completing Part 2 you should be able to build, fit, understand, use, and assess the fit of linear regression models.</li>
<li>After completing Part 3, you should be able to similarly work with logistic regression and other generalized linear models.</li>
<li>Part 4 covers data collection and extrapolation from sample to population.</li>
<li>Part 5 covers casual inference.</li>
<li>Part 6 introduces more advanced regression models.</li>
</ul>
<section id="what-you-should-be-able-to-do-after-reading-and-working-through-this-book" class="level2">
<h2 class="anchored" data-anchor-id="what-you-should-be-able-to-do-after-reading-and-working-through-this-book">What you should be able to do after reading and working through this book</h2>
<ul>
<li><p>Part 1: Review key tools and concepts in mathematics, statistics and computing</p>
<ul>
<li><p><em>Chapter 1</em>: Have a sense of the goals and challenges of regression</p></li>
<li><p><em>Chapter 2</em>: Explore data and be aware of issues of measurement and adjustment</p></li>
<li><p><em>Chapter 3</em>: Graph a straight line and know some basic mathematical tools and probability distributions</p></li>
<li><p><em>Chapter 4</em>: Understand statistical estimation and uncertainty assessment, along with the problems of hypothesis testing in applied statistics</p></li>
<li><p><em>Chapter 5</em>: Simulate probability models and uncertainty about inferences and predictions</p></li>
</ul></li>
<li><p>Part 2: Build linear regression models, use them in real problems, and evaluate their assumptions and fit to data</p>
<ul>
<li><p><em>Chapter 6</em>: Distinguish between descriptive and causal interpretations of regression, understanding these in historical context</p></li>
<li><p><em>Chapter 7</em>: Understand and work with simple linear regression with one predictor</p></li>
<li><p><em>Chapter 8</em>: Gain a conceptual understanding of least squares fitting and be able to perform these fits on the computer</p></li>
<li><p><em>Chapter 9</em>: Perform and understand probabilistic and simple Bayesian information aggregation, and be introduced to prior distributions and Bayesian inference</p></li>
<li><p><em>Chapter 10</em>: Build, fit, and understand linear models with multiple predictors</p></li>
<li><p><em>Chapter 11</em>: Understand the relative importance of different assumptions of regression models and be able to check models and evaluate their fit to data</p></li>
<li><p><em>Chapter 12</em>: Apply linear regression more effectively by transforming and combining predictors</p></li>
</ul></li>
<li><p>Part 3: Build and work with logistic regression and generalized linear models</p>
<ul>
<li><p><em>Chapter 13</em>: Fit, understand, and display logistic regression models for binary data</p></li>
<li><p><em>Chapter 14</em>: Build, understand and evaluate logistic regressions with interactions and other complexities</p></li>
<li><p><em>Chapter 15</em>: Fit, understand, and display generalized linear models, including the Poisson and negative binomial regression, ordered logistic regression, and other models</p></li>
</ul></li>
<li><p>Part 4: Design studies and use data more effectively in applied settings</p>
<ul>
<li><p><em>Chapter 16</em>: Use probability theory and simulation to guide data-collection decisions, without falling into the trap of demanding unrealistic levels of certainty</p></li>
<li><p><em>Chapter 17</em>: Use poststratification to generalize from sample to population, and use regression models to impute missing data</p></li>
</ul></li>
<li><p>Part 5: Implement and understand basic statistical designs and analyses for causal inference</p>
<ul>
<li><p><em>Chapter 18</em>: Understand assumptions underlying causal inference with a focus on randomized experiments</p></li>
<li><p><em>Chapter 19</em>: Perform causal inference in simple setting using regressions to estimate treatments and interactions</p></li>
<li><p><em>Chapter 20</em>: Understand the challenges of causal inference from observational data and statistical tools for adjusting for differences between treatment and control groups</p></li>
<li><p><em>Chapter 21</em>: Understand the assumptions underlying more advanced methods that use auxiliary variables or particular data structures to identify causal effects, and be able to fit these models to data</p></li>
</ul></li>
<li><p>Part 6: Become aware of more advanced regression models</p>
<ul>
<li><em>Chapter 22</em>: Get a sense of the directions in which linear and generalized linear models can be extended to attack various classes of applied problems</li>
</ul></li>
<li><p>Appendixes</p>
<ul>
<li><p><em>Appendix A</em>: Get started in the statistical software R, with a focus on data manipulation, statistical graphics, and fitting using regressions</p></li>
<li><p><em>Appendix B</em>: Become aware of some important ideas in regression workflow</p></li>
</ul></li>
</ul>
<p>After working through the book, you should be able to fit, graph, understand, and evaluate linear and generalized linear models and use these model fits to make predictions and inferences about quantities of interest, including causal effects of treatments and exposures.</p>
</section>
</section>
<section id="part-1-fundamentals" class="level1">
<h1>Part 1: Fundamentals</h1>
<section id="chapter-1-overview" class="level2">
<h2 class="anchored" data-anchor-id="chapter-1-overview">Chapter 1: Overview</h2>
<p>Alternate title: <em>Prediction as a unifying theme in statistics and causal inference</em></p>
<section id="the-three-challenges-of-statistics" class="level3">
<h3 class="anchored" data-anchor-id="the-three-challenges-of-statistics">1.1 The three challenges of statistics</h3>
<ol type="1">
<li><em>Generalizing from sample to population</em></li>
<li><em>Generalizing from treatment to support group</em></li>
<li><em>Generalizing from observed measurements to the underlying constructs of interest</em></li>
</ol>
<p><strong>Prediction</strong>: for new people or new items that are not in the sample, future outcomes under differently potentially assigned treatments, and underlying constructs of interest, if they could be measured exactly.</p>
<p>Key skills you should learn from this book:</p>
<ul>
<li><p><em>Understanding regression models:</em> mathematical models for predicting an outcome variable from a set of predictors, starting with straight-line fits and moving to various nonlinear generalizations</p></li>
<li><p><em>Constructing regression models:</em> with many options involving the choice of what variables to include and how to transform and constrain them</p></li>
<li><p><em>Fitting regression models to data</em></p></li>
<li><p><em>Displaying and interpreting the results</em></p></li>
</ul>
<p><strong>Inference</strong>: using mathematical models to make general claims from particular data.</p>
</section>
<section id="why-learn-regression" class="level3">
<h3 class="anchored" data-anchor-id="why-learn-regression">1.2 Why learn regression?</h3>
<p><strong>Regression</strong>: a method that allows researchers to summarize how predictions or average values of an <em>outcome</em> vary across individuals defined by a set of <em>predictors</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hibbs)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a scatterplot</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  hibbs<span class="sc">$</span>growth, </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  hibbs<span class="sc">$</span>vote, </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Average recent growth in personal income"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Incumbent party's vote share"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate the regression: y = a + bx + error</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">stan_glm</span>(vote <span class="sc">~</span> growth, <span class="at">data=</span>hibbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make a scatter plot</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  hibbs<span class="sc">$</span>growth, </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  hibbs<span class="sc">$</span>vote, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Average recent growth in personal income"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Incumbent party's vote share"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co"># add fitted line to the graph</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">coef</span>(M1), <span class="at">col =</span> <span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># display the fitted model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(M1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>stan_glm
 family:       gaussian [identity]
 formula:      vote ~ growth
 observations: 16
 predictors:   2
------
            Median MAD_SD
(Intercept) 46.3    1.6  
growth       3.0    0.7  

Auxiliary parameter(s):
      Median MAD_SD
sigma 3.9    0.7   

------
* For help interpreting the printed output see ?print.stanreg
* For info on the priors used see ?prior_summary.stanreg</code></pre>
</div>
</div>
<p><em>y</em> = 46.3 + 3.0<em>x</em></p>
<p><strong>MAD</strong>: Median Absolute Deviations.</p>
<p><strong>sigma</strong>: the scale of the variation in the data explained by the regression model (the scatter of points above and below the regression line). The linear model predicts vote share roughly to an accuracy of 3.9 percentage points.</p>
<p>Some of the most important uses of regression:</p>
<ul>
<li><p><em>Prediction</em>: Modeling existing observations or forecasting new data.</p></li>
<li><p><em>Exploring associations</em>: Summarizing how well one variable, or set of variables, predicts the outcome. One can use a model to explore associations, stratifications, or structural relationships between variables.</p></li>
<li><p><em>Extrapolation</em>: Adjusting for known differences between the <em>sample</em> (observed data) and a population of interest.</p></li>
<li><p><em>Causal inference</em>: Estimating treatment effects. A key challenge of causal inference is ensuring that treatment and control groups are similar, on average, before exposure to treatment, or else adjusting for differences between these groups.</p></li>
</ul>
</section>
<section id="some-examples-of-regression" class="level3">
<h3 class="anchored" data-anchor-id="some-examples-of-regression">1.3 Some examples of regression</h3>
<section id="estimating-public-opinion-from-an-opt-in-internet-survey" class="level4">
<h4 class="anchored" data-anchor-id="estimating-public-opinion-from-an-opt-in-internet-survey">Estimating public opinion from an opt-in internet survey</h4>
<ul>
<li>A characteristic problem of big data: a very large sample, relatively inexpensive to collect, but not immediately representative of the larger population</li>
</ul>
</section>
<section id="a-randomized-experiment-on-the-effect-of-an-educational-television-program" class="level4">
<h4 class="anchored" data-anchor-id="a-randomized-experiment-on-the-effect-of-an-educational-television-program">A randomized experiment on the effect of an educational television program</h4>
</section>
<section id="estimating-the-effects-of-united-nations-peacekeeping-using-pre-treatment-variables-to-adjust-for-differences-between-treatment-and-control-groups" class="level4">
<h4 class="anchored" data-anchor-id="estimating-the-effects-of-united-nations-peacekeeping-using-pre-treatment-variables-to-adjust-for-differences-between-treatment-and-control-groups">Estimating the effects of United Nations peacekeeping, using pre-treatment variables to adjust for differences between treatment and control groups</h4>
<ul>
<li><p>Selection bias: perhaps peacekeepers chose the easy cases, which would explain the difference in outcomes. The treatment–peacekeeping–was not randomly assigned. They had an <em>observational study</em> rather than an <em>experiment</em>, where we must do our best to adjust for pre-treatment differences between the treatment and control groups.</p></li>
<li><p>Censoring: certain ranges of data cannot be observed (e.g.&nbsp;countries where civil war had not yet returned by the time data collection ended)</p></li>
<li><p>When adjusting for badness, peacekeeping was performed in tougher conditions, on average. As a result, the adjustment increases the estimated beneficial effects of peacekeeping, at least during the study.</p></li>
</ul>
</section>
<section id="estimating-the-effects-of-gun-laws-and-the-difficulty-of-inference-using-regression-with-a-large-number-of-predictors" class="level4">
<h4 class="anchored" data-anchor-id="estimating-the-effects-of-gun-laws-and-the-difficulty-of-inference-using-regression-with-a-large-number-of-predictors">Estimating the effects of gun laws, and the difficulty of inference using regression with a large number of predictors</h4>
<ul>
<li><p>In this sort of regression with 50 data points and 30 predictors and no prior information to guide the inference, the coefficient estimates will be hopelessly noisy and compromised by dependence among predictors.</p></li>
<li><p>The treatments are observational and not externally applied. There is no reason to believe that the big differences in gun-related deaths between states are mostly attributable to particular policies.</p></li>
</ul>
</section>
<section id="comparing-the-peacekeeping-and-gun-control-studies" class="level4">
<h4 class="anchored" data-anchor-id="comparing-the-peacekeeping-and-gun-control-studies">Comparing the peacekeeping and gun-control studies</h4>
<ul>
<li><p>In both cases, policy conclusions have been drawn from observational data, using regression modeling to adjust for differences between treatment and control groups.</p></li>
<li><p>It is more practical to perform adjustments when there is a single goal (peacekeeping study)</p>
<ul>
<li><p>particular concern that the UN might be more likely to step in when the situation on the ground was not so bad</p></li>
<li><p>the data analysis found the opposite</p></li>
<li><p>the measure of badness is constructed based on particular measured variables and so it is possible that there are important unmeasured characteristics that would cause adjustments to go the other way</p></li>
</ul></li>
<li><p>The gun-control model adjusts for many potential causal variables at once</p>
<ul>
<li><p>The effect of each law is estimated conditional on all others being held constant (not realistic—no particular reason for their effects to add up in a simple manner)</p></li>
<li><p>The comparison is between states, which vary in systematic ways (it is not at all clear that a simple model can hope to adjust for the relevant differences)</p></li>
<li><p>Regression analysis was taken naively to be able to control for variation and give valid causal inference from observational data</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="challenges-in-building-understanding-and-interpreting-regressions" class="level3">
<h3 class="anchored" data-anchor-id="challenges-in-building-understanding-and-interpreting-regressions">1.4 Challenges in building, understanding, and interpreting regressions</h3>
<p>Two different ways in which regression is used for causal inference: estimating a relationship and adjusting for background variables.</p>
<section id="regression-to-estimate-a-relationship-of-interest" class="level4">
<h4 class="anchored" data-anchor-id="regression-to-estimate-a-relationship-of-interest">Regression to estimate a relationship of interest</h4>
<p><strong>Randomization:</strong> a design in which people—or, more generally, experimental units—are randomly assigned to treatment or control groups.</p>
<p>There are various ways to attain approximate comparability of treatment and control groups, and to adjust for known or modeled differences between the groups.</p>
<p>We assume the comparability of the groups assigned to different treatments so that a regression analysis predicting the outcome given the treatment gives us a direct estimate of the causal effect.</p>
<p>It is always possible to estimate a linear model, even if it does not fit the data.</p>
<p><strong>Interactions</strong>: treatment effects that vary as a function of other predictors in a model.</p>
<ul>
<li>Example: the relation between cancer rate and radon is different for smokers and nonsmokers. The effect of radon is assumed to be linear but with an interaction with smoking.</li>
</ul>
</section>
<section id="regression-to-adjust-for-differences-between-treatment-and-control-groups" class="level4">
<h4 class="anchored" data-anchor-id="regression-to-adjust-for-differences-between-treatment-and-control-groups">Regression to adjust for differences between treatment and control groups</h4>
<p>In most real-world causal inference problems, there are systematic differences between experimental units that receive treatment and control. In such settings it is important to <em>adjust</em> for pre-treatment differences between the groups, and we can use regression to do this.</p>
<p>Adjusting for background variables is particularly important when there is <em>imbalance</em> so that the treated and control groups differ on key pre-treatment predictors.</p>
<p>The estimated treatment effect is necessarily model based.</p>
</section>
<section id="interpreting-coefficients-in-a-predictive-model" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-coefficients-in-a-predictive-model">Interpreting coefficients in a predictive model</h4>
<p>A model fit to survey data: earnings = 11000 + 1500 * (height - 60) + error, with errors in the range of mean of 0 and standard deviation of 22000.</p>
<ul>
<li><p><em>Prediction</em>: useless for forecasting because errors are too large</p></li>
<li><p><em>Exploring an association</em>: best fit for this example, as the estimated slope is positive, can lead to further research to study reasons taller people earn more than shorter people</p></li>
<li><p><em>Sampling inference</em>: the regression coefficients can be interpreted directly to the extent that people in the survey are a representative sample of the population of interest</p></li>
<li><p><em>Causal inference</em>: height is not a randomly assigned treatment. Tall and short people may differ in many other ways.</p></li>
</ul>
</section>
<section id="building-interpreting-and-checking-regression-models" class="level4">
<h4 class="anchored" data-anchor-id="building-interpreting-and-checking-regression-models">Building, interpreting and checking regression models</h4>
<p>Statistical analysis cycles through four steps:</p>
<ol type="1">
<li>Model building</li>
<li>Model fitting</li>
<li>Understanding model fits</li>
<li>Criticism</li>
</ol>
<p>Accept that we can learn from statistical analysis—we can generalize from sample to population, from treatment to control, and from observed measurements to underlying constructs of interest—even while these inferences can be flawed.</p>
<p><em>Overinterpretation of noisy data</em>: the gun control study took existing variations among states and too eagerly attributed it to available factors.</p>
<p>No study is perfect.</p>
<p>We should <em>recognize</em> challenges in extrapolation and then work to <em>adjust</em> for them.</p>
</section>
</section>
<section id="classical-and-bayesian-inference" class="level3">
<h3 class="anchored" data-anchor-id="classical-and-bayesian-inference">1.5 Classical and Bayesian Inference</h3>
<p>Three concerns related to fitting models to data and using models to make predictions:</p>
<ol type="1">
<li>what <em>information</em> is being used in the estimation process</li>
<li>what <em>assumptions</em> are being made</li>
<li>how estimates and predictions are <em>interpreted</em>, in a classical or Bayesian framework</li>
</ol>
<section id="information" class="level4">
<h4 class="anchored" data-anchor-id="information">Information</h4>
<ul>
<li><p>The starting point for any regression problem is data on an outcome variable <em>y</em> and one or more predictors <em>x</em>.</p></li>
<li><p>Information should be available on what data were observed at all</p></li>
<li><p>We typically have prior knowledge coming from sources other than the data at hand. Where local data are weak it would be foolish to draw conclusions without using prior knowledge</p></li>
</ul>
</section>
<section id="assumptions" class="level4">
<h4 class="anchored" data-anchor-id="assumptions">Assumptions</h4>
<ul>
<li><p>Three sorts of assumptions that are essential to any regression model of an outcome <em>y</em> given predictors <em>x</em>.</p>
<ul>
<li><p>The functional form of the relation between <em>x</em> and <em>y</em></p></li>
<li><p>Where the data comes from (strongest assumptions tend to be simple and easy to understand, weaker assumptions, being more general, can also be more complicated)</p></li>
<li><p>Real-world relevance of the measured data</p>
<ul>
<li>The interpretation of a regression of <em>y</em> on <em>x</em> depends also on the relation between the measured <em>x</em> and the underlying predictors of interest, and on the relation between the measured <em>y</em> and the underlying outcomes of interest</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="classical-inference" class="level4">
<h4 class="anchored" data-anchor-id="classical-inference">Classical inference</h4>
<p>The traditional approach to statistical analysis is based on summarizing the information in the data, not using prior information, but getting estimates and predictions that have well-understood statistical properties, low bias and low variance.</p>
<p><strong>Unbiasedness:</strong> estimates should be true on average</p>
<p><strong>Coverage:</strong> confidence intervals should cover the true parameter value 95% of the time</p>
<p><strong>Conservatism:</strong> sometimes data are weak and we can’t make strong statements, but we’d like to be able to say, at least approximately, that our estimates are unbiased and our intervals have the advertised coverage.</p>
<p>In classical statistics there should be a clear and unambiguous (“objective”) path from data to inferences, which in turn should be checkable, at least in theory, based on their frequency properties.</p>
</section>
<section id="bayesian-inference" class="level4">
<h4 class="anchored" data-anchor-id="bayesian-inference">Bayesian inference</h4>
<p>Incorporates prior information into inferences, going beyond the goal of merely summarizing existing data. The analysis gives more reasonable results and can be used to make direct predictions about future outcomes and about the results of future experiments.</p>
<p>The prior distribution represents the arena over which any predictions will be evaluated.</p>
<p>We have a choice: classical inference, leading to pure summaries of data which can have limited value as predictions; or Bayesian inference, which in theory can yield valid predictions even with weak data, but relies on additional assumptions.</p>
<p>All Bayesian inferences are probabilistic and thus can be represented by random simulations. For this reason, whenever we want to summarize uncertainty in estimation beyond simple confidence intervals, and whenever we want to use regression models for predictions, we go Bayesian.</p>
</section>
</section>
<section id="computing-least-squares-and-bayesian-regression" class="level3">
<h3 class="anchored" data-anchor-id="computing-least-squares-and-bayesian-regression">1.6 Computing least squares and Bayesian regression</h3>
<p>In general, we recommend using Bayesian inference for regression</p>
<ul>
<li><p>If prior information is available, you can use it</p></li>
<li><p>if not, Bayesian regression with weakly informative default priors still has the advantage of yielding stable estimates and producing simulations that enable you to express inferential and predictive uncertainty (estimates with uncertainties and probabilistic predictions or forecasts)</p></li>
</ul>
<p>Bayesian regression in R:</p>
<pre><code>fit &lt;- stan_glm(y ~ x, data=mydata)

# stan_glm can run slow for large datasets, make it faster by running in optimizing mode
fit &lt;- stan_glm(y ~ x, data=mydata, algorithm="optimizing")</code></pre>
<p>least squares regression (classical statistics)</p>
<pre><code>fit &lt;- lm(y ~ x, data=mydata)</code></pre>
<p>Bayesian and simulation approaches become more important when fitting regularized regression and multilevel models.</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>